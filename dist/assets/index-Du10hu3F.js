var gE=Object.defineProperty;var vE=(e,t,r)=>t in e?gE(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Un=(e,t,r)=>vE(e,typeof t!="symbol"?t+"":t,r);import{a as b,b as yE,j as n,S as Qs,C as lo,d as Yc,L as bE,F as ma,e as us,f as wE,h as kE,B as N1,i as NE,k as tl,l as hs,m as j1,n as E1,o as jE,Z as Xr,p as EE,q as Xf,R as me,P as cn,s as is,A as Ta,t as Jr,T as ei,u as fl,v as Ar,w as ti,x as ms,y as S1,z as In,D as Yt,E as _t,G as pn,H as Yo,I as ri,J as Je,K as xs,M as hl,N as T1,O as A1,Q as SE,U as _1,V as C1,W as F1,X as D1,Y as R1,_ as lh,$ as oh,a0 as ch,a1 as M1,a2 as dh,a3 as uh,a4 as TE,a5 as fh,a6 as hh,a7 as AE,a8 as P1,a9 as qf,aa as Zf,ab as Jf,ac as dd,ad as Gd,ae as sa,af as O1,ag as mh,ah as Ws,ai as _E,g as Yd,aj as xh,ak as I1,al as oo,am as CE,an as L1,ao as FE,ap as Dx,aq as ph,ar as co,as as uo,at as DE,au as B1,av as ud,aw as gh,ax as RE,ay as Xd,az as Rx,aA as z1,aB as ME,aC as U1,aD as PE,aE as OE,aF as IE,aG as V1,aH as Qf,aI as LE,aJ as Mx,aK as Px,aL as BE,aM as H1,aN as e0,aO as zE,aP as $1,aQ as UE,aR as VE,aS as vh,aT as HE,aU as $E,aV as yh,aW as qd,aX as bh,aY as KE,aZ as wh,a_ as WE,a$ as K1,b0 as kh,b1 as GE,b2 as YE,b3 as XE,b4 as qE,b5 as W1,b6 as ZE,b7 as G1,b8 as Y1,b9 as JE,ba as QE}from"./ui-KKAQ85pP.js";import{a as eS,r as Zd,R as tS,b as zs,L as fo,C as Vi,X as Hi,Y as $i,T as Di,c as rl,P as rS,d as aS,e as nS,f as Jd,B as sS,g as iS}from"./charts-C580dW7D.js";import{t as lS,c as X1,b as Ou,a as Sl,d as Tl,e as oS,f as fd}from"./utils-DykSPjk8.js";import{i as cS,g as dS,a as uS,d as Be,b as hr,s as nr,c as Ke,u as Ut,o as fS,e as hS,f as Rs,h as mS,j as xS,k as Nh,l as ir,m as mr,n as Ki,q as Ir,p as nn,w as wt,T as an,r as Gs,t as hd,v as Xc,x as pS,y as Ox,z as gS}from"./firebase-r4gTdP5g.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();var vc={},Ix;function vS(){if(Ix)return vc;Ix=1;var e=eS();return vc.createRoot=e.createRoot,vc.hydrateRoot=e.hydrateRoot,vc}var yS=vS();/**
 * react-router v7.13.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var q1=e=>{throw TypeError(e)},bS=(e,t,r)=>t.has(e)||q1("Cannot "+r),Iu=(e,t,r)=>(bS(e,t,"read from private field"),r?r.call(e):t.get(e)),wS=(e,t,r)=>t.has(e)?q1("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),Lx="popstate";function kS(e={}){function t(a,s){let{pathname:i,search:l,hash:o}=a.location;return ho("",{pathname:i,search:l,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(a,s){return typeof s=="string"?s:Mn(s)}return jS(t,r,null,e)}function jt(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function xr(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function NS(){return Math.random().toString(36).substring(2,10)}function Bx(e,t){return{usr:e.state,key:e.key,idx:t}}function ho(e,t,r=null,a){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?Es(t):t,state:r,key:t&&t.key||a||NS()}}function Mn({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Es(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let a=e.indexOf("?");a>=0&&(t.search=e.substring(a),e=e.substring(0,a)),e&&(t.pathname=e)}return t}function jS(e,t,r,a={}){let{window:s=document.defaultView,v5Compat:i=!1}=a,l=s.history,o="POP",c=null,d=u();d==null&&(d=0,l.replaceState({...l.state,idx:d},""));function u(){return(l.state||{idx:null}).idx}function f(){o="POP";let g=u(),y=g==null?null:g-d;d=g,c&&c({action:o,location:p.location,delta:y})}function h(g,y){o="PUSH";let N=ho(p.location,g,y);d=u()+1;let v=Bx(N,d),S=p.createHref(N);try{l.pushState(v,"",S)}catch(_){if(_ instanceof DOMException&&_.name==="DataCloneError")throw _;s.location.assign(S)}i&&c&&c({action:o,location:p.location,delta:1})}function m(g,y){o="REPLACE";let N=ho(p.location,g,y);d=u();let v=Bx(N,d),S=p.createHref(N);l.replaceState(v,"",S),i&&c&&c({action:o,location:p.location,delta:0})}function x(g){return Z1(g)}let p={get action(){return o},get location(){return e(s,l)},listen(g){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(Lx,f),c=g,()=>{s.removeEventListener(Lx,f),c=null}},createHref(g){return t(s,g)},createURL:x,encodeLocation(g){let y=x(g);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:h,replace:m,go(g){return l.go(g)}};return p}function Z1(e,t=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),jt(r,"No window.location.(origin|href) available to create URL");let a=typeof e=="string"?e:Mn(e);return a=a.replace(/ $/,"%20"),!t&&a.startsWith("//")&&(a=r+a),new URL(a,r)}var Ll,zx=class{constructor(e){if(wS(this,Ll,new Map),e)for(let[t,r]of e)this.set(t,r)}get(e){if(Iu(this,Ll).has(e))return Iu(this,Ll).get(e);if(e.defaultValue!==void 0)return e.defaultValue;throw new Error("No value found for context")}set(e,t){Iu(this,Ll).set(e,t)}};Ll=new WeakMap;var ES=new Set(["lazy","caseSensitive","path","id","index","children"]);function SS(e){return ES.has(e)}var TS=new Set(["lazy","caseSensitive","path","id","index","middleware","children"]);function AS(e){return TS.has(e)}function _S(e){return e.index===!0}function mo(e,t,r=[],a={},s=!1){return e.map((i,l)=>{let o=[...r,String(l)],c=typeof i.id=="string"?i.id:o.join("-");if(jt(i.index!==!0||!i.children,"Cannot specify children on an index route"),jt(s||!a[c],`Found a route id collision on id "${c}".  Route id's must be globally unique within Data Router usages`),_S(i)){let d={...i,id:c};return a[c]=Ux(d,t(d)),d}else{let d={...i,id:c,children:void 0};return a[c]=Ux(d,t(d)),i.children&&(d.children=mo(i.children,t,o,a,s)),d}})}function Ux(e,t){return Object.assign(e,{...t,...typeof t.lazy=="object"&&t.lazy!=null?{lazy:{...e.lazy,...t.lazy}}:{}})}function ns(e,t,r="/"){return Bl(e,t,r,!1)}function Bl(e,t,r,a){let s=typeof t=="string"?Es(t):t,i=Ga(s.pathname||"/",r);if(i==null)return null;let l=J1(e);FS(l);let o=null;for(let c=0;o==null&&c<l.length;++c){let d=VS(i);o=zS(l[c],d,a)}return o}function CS(e,t){let{route:r,pathname:a,params:s}=e;return{id:r.id,pathname:a,params:s,data:t[r.id],loaderData:t[r.id],handle:r.handle}}function J1(e,t=[],r=[],a="",s=!1){let i=(l,o,c=s,d)=>{let u={relativePath:d===void 0?l.path||"":d,caseSensitive:l.caseSensitive===!0,childrenIndex:o,route:l};if(u.relativePath.startsWith("/")){if(!u.relativePath.startsWith(a)&&c)return;jt(u.relativePath.startsWith(a),`Absolute route path "${u.relativePath}" nested under path "${a}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),u.relativePath=u.relativePath.slice(a.length)}let f=Fn([a,u.relativePath]),h=r.concat(u);l.children&&l.children.length>0&&(jt(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),J1(l.children,t,h,f,c)),!(l.path==null&&!l.index)&&t.push({path:f,score:LS(f,l.index),routesMeta:h})};return e.forEach((l,o)=>{var c;if(l.path===""||!((c=l.path)!=null&&c.includes("?")))i(l,o);else for(let d of Q1(l.path))i(l,o,!0,d)}),t}function Q1(e){let t=e.split("/");if(t.length===0)return[];let[r,...a]=t,s=r.endsWith("?"),i=r.replace(/\?$/,"");if(a.length===0)return s?[i,""]:[i];let l=Q1(a.join("/")),o=[];return o.push(...l.map(c=>c===""?i:[i,c].join("/"))),s&&o.push(...l),o.map(c=>e.startsWith("/")&&c===""?"/":c)}function FS(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:BS(t.routesMeta.map(a=>a.childrenIndex),r.routesMeta.map(a=>a.childrenIndex)))}var DS=/^:[\w-]+$/,RS=3,MS=2,PS=1,OS=10,IS=-2,Vx=e=>e==="*";function LS(e,t){let r=e.split("/"),a=r.length;return r.some(Vx)&&(a+=IS),t&&(a+=MS),r.filter(s=>!Vx(s)).reduce((s,i)=>s+(DS.test(i)?RS:i===""?PS:OS),a)}function BS(e,t){return e.length===t.length&&e.slice(0,-1).every((a,s)=>a===t[s])?e[e.length-1]-t[t.length-1]:0}function zS(e,t,r=!1){let{routesMeta:a}=e,s={},i="/",l=[];for(let o=0;o<a.length;++o){let c=a[o],d=o===a.length-1,u=i==="/"?t:t.slice(i.length)||"/",f=md({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},u),h=c.route;if(!f&&d&&r&&!a[a.length-1].route.index&&(f=md({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},u)),!f)return null;Object.assign(s,f.params),l.push({params:s,pathname:Fn([i,f.pathname]),pathnameBase:KS(Fn([i,f.pathnameBase])),route:h}),f.pathnameBase!=="/"&&(i=Fn([i,f.pathnameBase]))}return l}function md(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,a]=US(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let i=s[0],l=i.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:a.reduce((d,{paramName:u,isOptional:f},h)=>{if(u==="*"){let x=o[h]||"";l=i.slice(0,i.length-x.length).replace(/(.)\/+$/,"$1")}const m=o[h];return f&&!m?d[u]=void 0:d[u]=(m||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:l,pattern:e}}function US(e,t=!1,r=!0){xr(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let a=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,o,c)=>(a.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(a.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),a]}function VS(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return xr(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Ga(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,a=e.charAt(r);return a&&a!=="/"?null:e.slice(r)||"/"}function HS({basename:e,pathname:t}){return t==="/"?e:Fn([e,t])}var ey=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,jh=e=>ey.test(e);function $S(e,t="/"){let{pathname:r,search:a="",hash:s=""}=typeof e=="string"?Es(e):e,i;return r?(r=r.replace(/\/\/+/g,"/"),r.startsWith("/")?i=Hx(r.substring(1),"/"):i=Hx(r,t)):i=t,{pathname:i,search:WS(a),hash:GS(s)}}function Hx(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function Lu(e,t,r,a){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(a)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function ty(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Qd(e){let t=ty(e);return t.map((r,a)=>a===t.length-1?r.pathname:r.pathnameBase)}function eu(e,t,r,a=!1){let s;typeof e=="string"?s=Es(e):(s={...e},jt(!s.pathname||!s.pathname.includes("?"),Lu("?","pathname","search",s)),jt(!s.pathname||!s.pathname.includes("#"),Lu("#","pathname","hash",s)),jt(!s.search||!s.search.includes("#"),Lu("#","search","hash",s)));let i=e===""||s.pathname==="",l=i?"/":s.pathname,o;if(l==null)o=r;else{let f=t.length-1;if(!a&&l.startsWith("..")){let h=l.split("/");for(;h[0]==="..";)h.shift(),f-=1;s.pathname=h.join("/")}o=f>=0?t[f]:"/"}let c=$S(s,o),d=l&&l!=="/"&&l.endsWith("/"),u=(i||l===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(d||u)&&(c.pathname+="/"),c}var Fn=e=>e.join("/").replace(/\/\/+/g,"/"),KS=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),WS=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,GS=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e,Xo=class{constructor(e,t,r,a=!1){this.status=e,this.statusText=t||"",this.internal=a,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}};function xo(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}function qo(e){return e.map(t=>t.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var ry=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function ay(e,t){let r=e;if(typeof r!="string"||!ey.test(r))return{absoluteURL:void 0,isExternal:!1,to:r};let a=r,s=!1;if(ry)try{let i=new URL(window.location.href),l=r.startsWith("//")?new URL(i.protocol+r):new URL(r),o=Ga(l.pathname,t);l.origin===i.origin&&o!=null?r=o+l.search+l.hash:s=!0}catch{xr(!1,`<Link to="${r}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:a,isExternal:s,to:r}}var ls=Symbol("Uninstrumented");function YS(e,t){let r={lazy:[],"lazy.loader":[],"lazy.action":[],"lazy.middleware":[],middleware:[],loader:[],action:[]};e.forEach(s=>s({id:t.id,index:t.index,path:t.path,instrument(i){let l=Object.keys(r);for(let o of l)i[o]&&r[o].push(i[o])}}));let a={};if(typeof t.lazy=="function"&&r.lazy.length>0){let s=Ri(r.lazy,t.lazy,()=>{});s&&(a.lazy=s)}if(typeof t.lazy=="object"){let s=t.lazy;["middleware","loader","action"].forEach(i=>{let l=s[i],o=r[`lazy.${i}`];if(typeof l=="function"&&o.length>0){let c=Ri(o,l,()=>{});c&&(a.lazy=Object.assign(a.lazy||{},{[i]:c}))}})}return["loader","action"].forEach(s=>{let i=t[s];if(typeof i=="function"&&r[s].length>0){let l=i[ls]??i,o=Ri(r[s],l,(...c)=>$x(c[0]));o&&(s==="loader"&&l.hydrate===!0&&(o.hydrate=!0),o[ls]=l,a[s]=o)}}),t.middleware&&t.middleware.length>0&&r.middleware.length>0&&(a.middleware=t.middleware.map(s=>{let i=s[ls]??s,l=Ri(r.middleware,i,(...o)=>$x(o[0]));return l?(l[ls]=i,l):s})),a}function XS(e,t){let r={navigate:[],fetch:[]};if(t.forEach(a=>a({instrument(s){let i=Object.keys(s);for(let l of i)s[l]&&r[l].push(s[l])}})),r.navigate.length>0){let a=e.navigate[ls]??e.navigate,s=Ri(r.navigate,a,(...i)=>{let[l,o]=i;return{to:typeof l=="number"||typeof l=="string"?l:l?Mn(l):".",...Kx(e,o??{})}});s&&(s[ls]=a,e.navigate=s)}if(r.fetch.length>0){let a=e.fetch[ls]??e.fetch,s=Ri(r.fetch,a,(...i)=>{let[l,,o,c]=i;return{href:o??".",fetcherKey:l,...Kx(e,c??{})}});s&&(s[ls]=a,e.fetch=s)}return e}function Ri(e,t,r){return e.length===0?null:async(...a)=>{let s=await ny(e,r(...a),()=>t(...a),e.length-1);if(s.type==="error")throw s.value;return s.value}}async function ny(e,t,r,a){let s=e[a],i;if(s){let l,o=async()=>(l?console.error("You cannot call instrumented handlers more than once"):l=ny(e,t,r,a-1),i=await l,jt(i,"Expected a result"),i.type==="error"&&i.value instanceof Error?{status:"error",error:i.value}:{status:"success",error:void 0});try{await s(o,t)}catch(c){console.error("An instrumentation function threw an error:",c)}l||await o(),await l}else try{i={type:"success",value:await r()}}catch(l){i={type:"error",value:l}}return i||{type:"error",value:new Error("No result assigned in instrumentation chain.")}}function $x(e){let{request:t,context:r,params:a,unstable_pattern:s}=e;return{request:qS(t),params:{...a},unstable_pattern:s,context:ZS(r)}}function Kx(e,t){return{currentUrl:Mn(e.state.location),..."formMethod"in t?{formMethod:t.formMethod}:{},..."formEncType"in t?{formEncType:t.formEncType}:{},..."formData"in t?{formData:t.formData}:{},..."body"in t?{body:t.body}:{}}}function qS(e){return{method:e.method,url:e.url,headers:{get:(...t)=>e.headers.get(...t)}}}function ZS(e){if(QS(e)){let t={...e};return Object.freeze(t),t}else return{get:t=>e.get(t)}}var JS=Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function QS(e){if(e===null||typeof e!="object")return!1;const t=Object.getPrototypeOf(e);return t===Object.prototype||t===null||Object.getOwnPropertyNames(t).sort().join("\0")===JS}var sy=["POST","PUT","PATCH","DELETE"],eT=new Set(sy),tT=["GET",...sy],rT=new Set(tT),iy=new Set([301,302,303,307,308]),aT=new Set([307,308]),Bu={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},nT={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Al={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},sT=e=>({hasErrorBoundary:!!e.hasErrorBoundary}),ly="remix-router-transitions",oy=Symbol("ResetLoaderData");function iT(e){const t=e.window?e.window:typeof window<"u"?window:void 0,r=typeof t<"u"&&typeof t.document<"u"&&typeof t.document.createElement<"u";jt(e.routes.length>0,"You must provide a non-empty routes array to createRouter");let a=e.hydrationRouteProperties||[],s=e.mapRouteProperties||sT,i=s;if(e.unstable_instrumentations){let ee=e.unstable_instrumentations;i=ne=>({...s(ne),...YS(ee.map(he=>he.route).filter(Boolean),ne)})}let l={},o=mo(e.routes,i,void 0,l),c,d=e.basename||"/";d.startsWith("/")||(d=`/${d}`);let u=e.dataStrategy||uT,f={...e.future},h=null,m=new Set,x=null,p=null,g=null,y=e.hydrationData!=null,N=ns(o,e.history.location,d),v=!1,S=null,_;if(N==null&&!e.patchRoutesOnNavigation){let ee=Ba(404,{pathname:e.history.location.pathname}),{matches:ne,route:he}=yc(o);_=!0,N=ne,S={[he.id]:ee}}else if(N&&!e.hydrationData&&$e(N,o,e.history.location.pathname).active&&(N=null),N)if(N.some(ee=>ee.route.lazy))_=!1;else if(!N.some(ee=>Eh(ee.route)))_=!0;else{let ee=e.hydrationData?e.hydrationData.loaderData:null,ne=e.hydrationData?e.hydrationData.errors:null;if(ne){let he=N.findIndex(ye=>ne[ye.route.id]!==void 0);_=N.slice(0,he+1).every(ye=>!r0(ye.route,ee,ne))}else _=N.every(he=>!r0(he.route,ee,ne))}else{_=!1,N=[];let ee=$e(null,o,e.history.location.pathname);ee.active&&ee.matches&&(v=!0,N=ee.matches)}let F,k={historyAction:e.history.action,location:e.history.location,matches:N,initialized:_,navigation:Bu,restoreScrollPosition:e.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:e.hydrationData&&e.hydrationData.loaderData||{},actionData:e.hydrationData&&e.hydrationData.actionData||null,errors:e.hydrationData&&e.hydrationData.errors||S,fetchers:new Map,blockers:new Map},j="POP",w=null,E=!1,A,D=!1,W=new Map,re=null,U=!1,M=!1,Y=new Set,Q=new Map,B=0,V=-1,P=new Map,T=new Set,R=new Map,L=new Map,X=new Set,J=new Map,te,G=null;function Z(){if(h=e.history.listen(({action:ee,location:ne,delta:he})=>{if(te){te(),te=void 0;return}xr(J.size===0||he!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let ye=Dt({currentLocation:k.location,nextLocation:ne,historyAction:ee});if(ye&&he!=null){let C=new Promise(K=>{te=K});e.history.go(he*-1),gt(ye,{state:"blocked",location:ne,proceed(){gt(ye,{state:"proceeding",proceed:void 0,reset:void 0,location:ne}),C.then(()=>e.history.go(he))},reset(){let K=new Map(k.blockers);K.set(ye,Al),z({blockers:K})}}),w==null||w.resolve(),w=null;return}return ve(ee,ne)}),r){_T(t,W);let ee=()=>CT(t,W);t.addEventListener("pagehide",ee),re=()=>t.removeEventListener("pagehide",ee)}return k.initialized||ve("POP",k.location,{initialHydration:!0}),F}function ae(){h&&h(),re&&re(),m.clear(),A&&A.abort(),k.fetchers.forEach((ee,ne)=>De(ne)),k.blockers.forEach((ee,ne)=>He(ne))}function de(ee){return m.add(ee),()=>m.delete(ee)}function z(ee,ne={}){ee.matches&&(ee.matches=ee.matches.map(C=>{let K=l[C.route.id],O=C.route;return O.element!==K.element||O.errorElement!==K.errorElement||O.hydrateFallbackElement!==K.hydrateFallbackElement?{...C,route:K}:C})),k={...k,...ee};let he=[],ye=[];k.fetchers.forEach((C,K)=>{C.state==="idle"&&(X.has(K)?he.push(K):ye.push(K))}),X.forEach(C=>{!k.fetchers.has(C)&&!Q.has(C)&&he.push(C)}),[...m].forEach(C=>C(k,{deletedFetchers:he,newErrors:ee.errors??null,viewTransitionOpts:ne.viewTransitionOpts,flushSync:ne.flushSync===!0})),he.forEach(C=>De(C)),ye.forEach(C=>k.fetchers.delete(C))}function Ee(ee,ne,{flushSync:he}={}){var le,ce;let ye=k.actionData!=null&&k.navigation.formMethod!=null&&Wr(k.navigation.formMethod)&&k.navigation.state==="loading"&&((le=ee.state)==null?void 0:le._isRedirect)!==!0,C;ne.actionData?Object.keys(ne.actionData).length>0?C=ne.actionData:C=null:ye?C=k.actionData:C=null;let K=ne.loaderData?tp(k.loaderData,ne.loaderData,ne.matches||[],ne.errors):k.loaderData,O=k.blockers;O.size>0&&(O=new Map(O),O.forEach((ie,oe)=>O.set(oe,Al)));let I=U?!1:_e(ee,ne.matches||k.matches),H=E===!0||k.navigation.formMethod!=null&&Wr(k.navigation.formMethod)&&((ce=ee.state)==null?void 0:ce._isRedirect)!==!0;c&&(o=c,c=void 0),U||j==="POP"||(j==="PUSH"?e.history.push(ee,ee.state):j==="REPLACE"&&e.history.replace(ee,ee.state));let q;if(j==="POP"){let ie=W.get(k.location.pathname);ie&&ie.has(ee.pathname)?q={currentLocation:k.location,nextLocation:ee}:W.has(ee.pathname)&&(q={currentLocation:ee,nextLocation:k.location})}else if(D){let ie=W.get(k.location.pathname);ie?ie.add(ee.pathname):(ie=new Set([ee.pathname]),W.set(k.location.pathname,ie)),q={currentLocation:k.location,nextLocation:ee}}z({...ne,actionData:C,loaderData:K,historyAction:j,location:ee,initialized:!0,navigation:Bu,revalidation:"idle",restoreScrollPosition:I,preventScrollReset:H,blockers:O},{viewTransitionOpts:q,flushSync:he===!0}),j="POP",E=!1,D=!1,U=!1,M=!1,w==null||w.resolve(),w=null,G==null||G.resolve(),G=null}async function ue(ee,ne){if(w==null||w.resolve(),w=null,typeof ee=="number"){w||(w=sp());let oe=w.promise;return e.history.go(ee),oe}let he=t0(k.location,k.matches,d,ee,ne==null?void 0:ne.fromRouteId,ne==null?void 0:ne.relative),{path:ye,submission:C,error:K}=Wx(!1,he,ne),O=k.location,I=ho(k.location,ye,ne&&ne.state);I={...I,...e.history.encodeLocation(I)};let H=ne&&ne.replace!=null?ne.replace:void 0,q="PUSH";H===!0?q="REPLACE":H===!1||C!=null&&Wr(C.formMethod)&&C.formAction===k.location.pathname+k.location.search&&(q="REPLACE");let le=ne&&"preventScrollReset"in ne?ne.preventScrollReset===!0:void 0,ce=(ne&&ne.flushSync)===!0,ie=Dt({currentLocation:O,nextLocation:I,historyAction:q});if(ie){gt(ie,{state:"blocked",location:I,proceed(){gt(ie,{state:"proceeding",proceed:void 0,reset:void 0,location:I}),ue(ee,ne)},reset(){let oe=new Map(k.blockers);oe.set(ie,Al),z({blockers:oe})}});return}await ve(q,I,{submission:C,pendingError:K,preventScrollReset:le,replace:ne&&ne.replace,enableViewTransition:ne&&ne.viewTransition,flushSync:ce,callSiteDefaultShouldRevalidate:ne&&ne.unstable_defaultShouldRevalidate})}function Ce(){G||(G=sp()),Ft(),z({revalidation:"loading"});let ee=G.promise;return k.navigation.state==="submitting"?ee:k.navigation.state==="idle"?(ve(k.historyAction,k.location,{startUninterruptedRevalidation:!0}),ee):(ve(j||k.historyAction,k.navigation.location,{overrideNavigation:k.navigation,enableViewTransition:D===!0}),ee)}async function ve(ee,ne,he){A&&A.abort(),A=null,j=ee,U=(he&&he.startUninterruptedRevalidation)===!0,Ae(k.location,k.matches),E=(he&&he.preventScrollReset)===!0,D=(he&&he.enableViewTransition)===!0;let ye=c||o,C=he&&he.overrideNavigation,K=he!=null&&he.initialHydration&&k.matches&&k.matches.length>0&&!v?k.matches:ns(ye,ne,d),O=(he&&he.flushSync)===!0;if(K&&k.initialized&&!M&&yT(k.location,ne)&&!(he&&he.submission&&Wr(he.submission.formMethod))){Ee(ne,{matches:K},{flushSync:O});return}let I=$e(K,ye,ne.pathname);if(I.active&&I.matches&&(K=I.matches),!K){let{error:be,notFoundMatches:Se,route:je}=mt(ne.pathname);Ee(ne,{matches:Se,loaderData:{},errors:{[je.id]:be}},{flushSync:O});return}A=new AbortController;let H=_i(e.history,ne,A.signal,he&&he.submission),q=e.getContext?await e.getContext():new zx,le;if(he&&he.pendingError)le=[ss(K).route.id,{type:"error",error:he.pendingError}];else if(he&&he.submission&&Wr(he.submission.formMethod)){let be=await ge(H,ne,he.submission,K,q,I.active,he&&he.initialHydration===!0,{replace:he.replace,flushSync:O});if(be.shortCircuited)return;if(be.pendingActionResult){let[Se,je]=be.pendingActionResult;if(wa(je)&&xo(je.error)&&je.error.status===404){A=null,Ee(ne,{matches:be.matches,loaderData:{},errors:{[Se]:je.error}});return}}K=be.matches||K,le=be.pendingActionResult,C=zu(ne,he.submission),O=!1,I.active=!1,H=_i(e.history,H.url,H.signal)}let{shortCircuited:ce,matches:ie,loaderData:oe,errors:fe}=await Fe(H,ne,K,q,I.active,C,he&&he.submission,he&&he.fetcherSubmission,he&&he.replace,he&&he.initialHydration===!0,O,le,he&&he.callSiteDefaultShouldRevalidate);ce||(A=null,Ee(ne,{matches:ie||K,...rp(le),loaderData:oe,errors:fe}))}async function ge(ee,ne,he,ye,C,K,O,I={}){Ft();let H=TT(ne,he);if(z({navigation:H},{flushSync:I.flushSync===!0}),K){let ce=await Ge(ye,ne.pathname,ee.signal);if(ce.type==="aborted")return{shortCircuited:!0};if(ce.type==="error"){if(ce.partialMatches.length===0){let{matches:oe,route:fe}=yc(o);return{matches:oe,pendingActionResult:[fe.id,{type:"error",error:ce.error}]}}let ie=ss(ce.partialMatches).route.id;return{matches:ce.partialMatches,pendingActionResult:[ie,{type:"error",error:ce.error}]}}else if(ce.matches)ye=ce.matches;else{let{notFoundMatches:ie,error:oe,route:fe}=mt(ne.pathname);return{matches:ie,pendingActionResult:[fe.id,{type:"error",error:oe}]}}}let q,le=qc(ye,ne);if(!le.route.action&&!le.route.lazy)q={type:"error",error:Ba(405,{method:ee.method,pathname:ne.pathname,routeId:le.route.id})};else{let ce=Wi(i,l,ee,ye,le,O?[]:a,C),ie=await kt(ee,ce,C,null);if(q=ie[le.route.id],!q){for(let oe of ye)if(ie[oe.route.id]){q=ie[oe.route.id];break}}if(ee.signal.aborted)return{shortCircuited:!0}}if(Us(q)){let ce;return I&&I.replace!=null?ce=I.replace:ce=Jx(q.response.headers.get("Location"),new URL(ee.url),d,e.history)===k.location.pathname+k.location.search,await Ue(ee,q,!0,{submission:he,replace:ce}),{shortCircuited:!0}}if(wa(q)){let ce=ss(ye,le.route.id);return(I&&I.replace)!==!0&&(j="PUSH"),{matches:ye,pendingActionResult:[ce.route.id,q,le.route.id]}}return{matches:ye,pendingActionResult:[le.route.id,q]}}async function Fe(ee,ne,he,ye,C,K,O,I,H,q,le,ce,ie){let oe=K||zu(ne,O),fe=O||I||np(oe),be=!U&&!q;if(C){if(be){let Xt=Ie(ce);z({navigation:oe,...Xt!==void 0?{actionData:Xt}:{}},{flushSync:le})}let Tt=await Ge(he,ne.pathname,ee.signal);if(Tt.type==="aborted")return{shortCircuited:!0};if(Tt.type==="error"){if(Tt.partialMatches.length===0){let{matches:wi,route:Ds}=yc(o);return{matches:wi,loaderData:{},errors:{[Ds.id]:Tt.error}}}let Xt=ss(Tt.partialMatches).route.id;return{matches:Tt.partialMatches,loaderData:{},errors:{[Xt]:Tt.error}}}else if(Tt.matches)he=Tt.matches;else{let{error:Xt,notFoundMatches:wi,route:Ds}=mt(ne.pathname);return{matches:wi,loaderData:{},errors:{[Ds.id]:Xt}}}}let Se=c||o,{dsMatches:je,revalidatingFetchers:Te}=Gx(ee,ye,i,l,e.history,k,he,fe,ne,q?[]:a,q===!0,M,Y,X,R,T,Se,d,e.patchRoutesOnNavigation!=null,ce,ie);if(V=++B,!e.dataStrategy&&!je.some(Tt=>Tt.shouldLoad)&&!je.some(Tt=>Tt.route.middleware&&Tt.route.middleware.length>0)&&Te.length===0){let Tt=Hr();return Ee(ne,{matches:he,loaderData:{},errors:ce&&wa(ce[1])?{[ce[0]]:ce[1].error}:null,...rp(ce),...Tt?{fetchers:new Map(k.fetchers)}:{}},{flushSync:le}),{shortCircuited:!0}}if(be){let Tt={};if(!C){Tt.navigation=oe;let Xt=Ie(ce);Xt!==void 0&&(Tt.actionData=Xt)}Te.length>0&&(Tt.fetchers=Ze(Te)),z(Tt,{flushSync:le})}Te.forEach(Tt=>{Rt(Tt.key),Tt.controller&&Q.set(Tt.key,Tt.controller)});let Le=()=>Te.forEach(Tt=>Rt(Tt.key));A&&A.signal.addEventListener("abort",Le);let{loaderResults:ot,fetcherResults:Lt}=await qe(je,Te,ee,ye);if(ee.signal.aborted)return{shortCircuited:!0};A&&A.signal.removeEventListener("abort",Le),Te.forEach(Tt=>Q.delete(Tt.key));let Mt=bc(ot);if(Mt)return await Ue(ee,Mt.result,!0,{replace:H}),{shortCircuited:!0};if(Mt=bc(Lt),Mt)return T.add(Mt.key),await Ue(ee,Mt.result,!0,{replace:H}),{shortCircuited:!0};let{loaderData:kr,errors:Za}=ep(k,he,ot,ce,Te,Lt);q&&k.errors&&(Za={...k.errors,...Za});let va=Hr(),bn=Et(V),Da=va||bn||Te.length>0;return{matches:he,loaderData:kr,errors:Za,...Da?{fetchers:new Map(k.fetchers)}:{}}}function Ie(ee){if(ee&&!wa(ee[1]))return{[ee[0]]:ee[1].data};if(k.actionData)return Object.keys(k.actionData).length===0?null:k.actionData}function Ze(ee){return ee.forEach(ne=>{let he=k.fetchers.get(ne.key),ye=_l(void 0,he?he.data:void 0);k.fetchers.set(ne.key,ye)}),new Map(k.fetchers)}async function yt(ee,ne,he,ye){Rt(ee);let C=(ye&&ye.flushSync)===!0,K=c||o,O=t0(k.location,k.matches,d,he,ne,ye==null?void 0:ye.relative),I=ns(K,O,d),H=$e(I,K,O);if(H.active&&H.matches&&(I=H.matches),!I){bt(ee,ne,Ba(404,{pathname:O}),{flushSync:C});return}let{path:q,submission:le,error:ce}=Wx(!0,O,ye);if(ce){bt(ee,ne,ce,{flushSync:C});return}let ie=e.getContext?await e.getContext():new zx,oe=(ye&&ye.preventScrollReset)===!0;if(le&&Wr(le.formMethod)){await ht(ee,ne,q,I,ie,H.active,C,oe,le,ye&&ye.unstable_defaultShouldRevalidate);return}R.set(ee,{routeId:ne,path:q}),await Ct(ee,ne,q,I,ie,H.active,C,oe,le)}async function ht(ee,ne,he,ye,C,K,O,I,H,q){Ft(),R.delete(ee);let le=k.fetchers.get(ee);Qe(ee,AT(H,le),{flushSync:O});let ce=new AbortController,ie=_i(e.history,he,ce.signal,H);if(K){let dr=await Ge(ye,new URL(ie.url).pathname,ie.signal,ee);if(dr.type==="aborted")return;if(dr.type==="error"){bt(ee,ne,dr.error,{flushSync:O});return}else if(dr.matches)ye=dr.matches;else{bt(ee,ne,Ba(404,{pathname:he}),{flushSync:O});return}}let oe=qc(ye,he);if(!oe.route.action&&!oe.route.lazy){let dr=Ba(405,{method:H.formMethod,pathname:he,routeId:ne});bt(ee,ne,dr,{flushSync:O});return}Q.set(ee,ce);let fe=B,be=Wi(i,l,ie,ye,oe,a,C),Se=await kt(ie,be,C,ee),je=Se[oe.route.id];if(!je){for(let dr of be)if(Se[dr.route.id]){je=Se[dr.route.id];break}}if(ie.signal.aborted){Q.get(ee)===ce&&Q.delete(ee);return}if(X.has(ee)){if(Us(je)||wa(je)){Qe(ee,Vn(void 0));return}}else{if(Us(je))if(Q.delete(ee),V>fe){Qe(ee,Vn(void 0));return}else return T.add(ee),Qe(ee,_l(H)),Ue(ie,je,!1,{fetcherSubmission:H,preventScrollReset:I});if(wa(je)){bt(ee,ne,je.error);return}}let Te=k.navigation.location||k.location,Le=_i(e.history,Te,ce.signal),ot=c||o,Lt=k.navigation.state!=="idle"?ns(ot,k.navigation.location,d):k.matches;jt(Lt,"Didn't find any matches after fetcher action");let Mt=++B;P.set(ee,Mt);let kr=_l(H,je.data);k.fetchers.set(ee,kr);let{dsMatches:Za,revalidatingFetchers:va}=Gx(Le,C,i,l,e.history,k,Lt,H,Te,a,!1,M,Y,X,R,T,ot,d,e.patchRoutesOnNavigation!=null,[oe.route.id,je],q);va.filter(dr=>dr.key!==ee).forEach(dr=>{let gc=dr.key,Fx=k.fetchers.get(gc),pE=_l(void 0,Fx?Fx.data:void 0);k.fetchers.set(gc,pE),Rt(gc),dr.controller&&Q.set(gc,dr.controller)}),z({fetchers:new Map(k.fetchers)});let bn=()=>va.forEach(dr=>Rt(dr.key));ce.signal.addEventListener("abort",bn);let{loaderResults:Da,fetcherResults:Tt}=await qe(Za,va,Le,C);if(ce.signal.aborted)return;if(ce.signal.removeEventListener("abort",bn),P.delete(ee),Q.delete(ee),va.forEach(dr=>Q.delete(dr.key)),k.fetchers.has(ee)){let dr=Vn(je.data);k.fetchers.set(ee,dr)}let Xt=bc(Da);if(Xt)return Ue(Le,Xt.result,!1,{preventScrollReset:I});if(Xt=bc(Tt),Xt)return T.add(Xt.key),Ue(Le,Xt.result,!1,{preventScrollReset:I});let{loaderData:wi,errors:Ds}=ep(k,Lt,Da,void 0,va,Tt);Et(Mt),k.navigation.state==="loading"&&Mt>V?(jt(j,"Expected pending action"),A&&A.abort(),Ee(k.navigation.location,{matches:Lt,loaderData:wi,errors:Ds,fetchers:new Map(k.fetchers)})):(z({errors:Ds,loaderData:tp(k.loaderData,wi,Lt,Ds),fetchers:new Map(k.fetchers)}),M=!1)}async function Ct(ee,ne,he,ye,C,K,O,I,H){let q=k.fetchers.get(ee);Qe(ee,_l(H,q?q.data:void 0),{flushSync:O});let le=new AbortController,ce=_i(e.history,he,le.signal);if(K){let je=await Ge(ye,new URL(ce.url).pathname,ce.signal,ee);if(je.type==="aborted")return;if(je.type==="error"){bt(ee,ne,je.error,{flushSync:O});return}else if(je.matches)ye=je.matches;else{bt(ee,ne,Ba(404,{pathname:he}),{flushSync:O});return}}let ie=qc(ye,he);Q.set(ee,le);let oe=B,fe=Wi(i,l,ce,ye,ie,a,C),Se=(await kt(ce,fe,C,ee))[ie.route.id];if(Q.get(ee)===le&&Q.delete(ee),!ce.signal.aborted){if(X.has(ee)){Qe(ee,Vn(void 0));return}if(Us(Se))if(V>oe){Qe(ee,Vn(void 0));return}else{T.add(ee),await Ue(ce,Se,!1,{preventScrollReset:I});return}if(wa(Se)){bt(ee,ne,Se.error);return}Qe(ee,Vn(Se.data))}}async function Ue(ee,ne,he,{submission:ye,fetcherSubmission:C,preventScrollReset:K,replace:O}={}){he||(w==null||w.resolve(),w=null),ne.response.headers.has("X-Remix-Revalidate")&&(M=!0);let I=ne.response.headers.get("Location");jt(I,"Expected a Location header on the redirect Response"),I=Jx(I,new URL(ee.url),d,e.history);let H=ho(k.location,I,{_isRedirect:!0});if(r){let fe=!1;if(ne.response.headers.has("X-Remix-Reload-Document"))fe=!0;else if(jh(I)){const be=Z1(I,!0);fe=be.origin!==t.location.origin||Ga(be.pathname,d)==null}if(fe){O?t.location.replace(I):t.location.assign(I);return}}A=null;let q=O===!0||ne.response.headers.has("X-Remix-Replace")?"REPLACE":"PUSH",{formMethod:le,formAction:ce,formEncType:ie}=k.navigation;!ye&&!C&&le&&ce&&ie&&(ye=np(k.navigation));let oe=ye||C;if(aT.has(ne.response.status)&&oe&&Wr(oe.formMethod))await ve(q,H,{submission:{...oe,formAction:I},preventScrollReset:K||E,enableViewTransition:he?D:void 0});else{let fe=zu(H,ye);await ve(q,H,{overrideNavigation:fe,fetcherSubmission:C,preventScrollReset:K||E,enableViewTransition:he?D:void 0})}}async function kt(ee,ne,he,ye){var O;let C,K={};try{C=await hT(u,ee,ne,ye,he,!1)}catch(I){return ne.filter(H=>H.shouldLoad).forEach(H=>{K[H.route.id]={type:"error",error:I}}),K}if(ee.signal.aborted)return K;if(!Wr(ee.method))for(let I of ne){if(((O=C[I.route.id])==null?void 0:O.type)==="error")break;!C.hasOwnProperty(I.route.id)&&!k.loaderData.hasOwnProperty(I.route.id)&&(!k.errors||!k.errors.hasOwnProperty(I.route.id))&&I.shouldCallHandler()&&(C[I.route.id]={type:"error",result:new Error(`No result returned from dataStrategy for route ${I.route.id}`)})}for(let[I,H]of Object.entries(C))if(NT(H)){let q=H.result;K[I]={type:"redirect",response:gT(q,ee,I,ne,d)}}else K[I]=await pT(H);return K}async function qe(ee,ne,he,ye){let C=kt(he,ee,ye,null),K=Promise.all(ne.map(async H=>{if(H.matches&&H.match&&H.request&&H.controller){let le=(await kt(H.request,H.matches,ye,H.key))[H.match.route.id];return{[H.key]:le}}else return Promise.resolve({[H.key]:{type:"error",error:Ba(404,{pathname:H.path})}})})),O=await C,I=(await K).reduce((H,q)=>Object.assign(H,q),{});return{loaderResults:O,fetcherResults:I}}function Ft(){M=!0,R.forEach((ee,ne)=>{Q.has(ne)&&Y.add(ne),Rt(ne)})}function Qe(ee,ne,he={}){k.fetchers.set(ee,ne),z({fetchers:new Map(k.fetchers)},{flushSync:(he&&he.flushSync)===!0})}function bt(ee,ne,he,ye={}){let C=ss(k.matches,ne);De(ee),z({errors:{[C.route.id]:he},fetchers:new Map(k.fetchers)},{flushSync:(ye&&ye.flushSync)===!0})}function se(ee){return L.set(ee,(L.get(ee)||0)+1),X.has(ee)&&X.delete(ee),k.fetchers.get(ee)||nT}function Ne(ee,ne){Rt(ee,ne==null?void 0:ne.reason),Qe(ee,Vn(null))}function De(ee){let ne=k.fetchers.get(ee);Q.has(ee)&&!(ne&&ne.state==="loading"&&P.has(ee))&&Rt(ee),R.delete(ee),P.delete(ee),T.delete(ee),X.delete(ee),Y.delete(ee),k.fetchers.delete(ee)}function lt(ee){let ne=(L.get(ee)||0)-1;ne<=0?(L.delete(ee),X.add(ee)):L.set(ee,ne),z({fetchers:new Map(k.fetchers)})}function Rt(ee,ne){let he=Q.get(ee);he&&(he.abort(ne),Q.delete(ee))}function _r(ee){for(let ne of ee){let he=se(ne),ye=Vn(he.data);k.fetchers.set(ne,ye)}}function Hr(){let ee=[],ne=!1;for(let he of T){let ye=k.fetchers.get(he);jt(ye,`Expected fetcher: ${he}`),ye.state==="loading"&&(T.delete(he),ee.push(he),ne=!0)}return _r(ee),ne}function Et(ee){let ne=[];for(let[he,ye]of P)if(ye<ee){let C=k.fetchers.get(he);jt(C,`Expected fetcher: ${he}`),C.state==="loading"&&(Rt(he),P.delete(he),ne.push(he))}return _r(ne),ne.length>0}function Fa(ee,ne){let he=k.blockers.get(ee)||Al;return J.get(ee)!==ne&&J.set(ee,ne),he}function He(ee){k.blockers.delete(ee),J.delete(ee)}function gt(ee,ne){let he=k.blockers.get(ee)||Al;jt(he.state==="unblocked"&&ne.state==="blocked"||he.state==="blocked"&&ne.state==="blocked"||he.state==="blocked"&&ne.state==="proceeding"||he.state==="blocked"&&ne.state==="unblocked"||he.state==="proceeding"&&ne.state==="unblocked",`Invalid blocker state transition: ${he.state} -> ${ne.state}`);let ye=new Map(k.blockers);ye.set(ee,ne),z({blockers:ye})}function Dt({currentLocation:ee,nextLocation:ne,historyAction:he}){if(J.size===0)return;J.size>1&&xr(!1,"A router only supports one blocker at a time");let ye=Array.from(J.entries()),[C,K]=ye[ye.length-1],O=k.blockers.get(C);if(!(O&&O.state==="proceeding")&&K({currentLocation:ee,nextLocation:ne,historyAction:he}))return C}function mt(ee){let ne=Ba(404,{pathname:ee}),he=c||o,{matches:ye,route:C}=yc(he);return{notFoundMatches:ye,route:C,error:ne}}function Pt(ee,ne,he){if(x=ee,g=ne,p=he||null,!y&&k.navigation===Bu){y=!0;let ye=_e(k.location,k.matches);ye!=null&&z({restoreScrollPosition:ye})}return()=>{x=null,g=null,p=null}}function Ye(ee,ne){return p&&p(ee,ne.map(ye=>CS(ye,k.loaderData)))||ee.key}function Ae(ee,ne){if(x&&g){let he=Ye(ee,ne);x[he]=g()}}function _e(ee,ne){if(x){let he=Ye(ee,ne),ye=x[he];if(typeof ye=="number")return ye}return null}function $e(ee,ne,he){if(e.patchRoutesOnNavigation)if(ee){if(Object.keys(ee[0].params).length>0)return{active:!0,matches:Bl(ne,he,d,!0)}}else return{active:!0,matches:Bl(ne,he,d,!0)||[]};return{active:!1,matches:null}}async function Ge(ee,ne,he,ye){if(!e.patchRoutesOnNavigation)return{type:"success",matches:ee};let C=ee;for(;;){let K=c==null,O=c||o,I=l;try{await e.patchRoutesOnNavigation({signal:he,path:ne,matches:C,fetcherKey:ye,patch:(le,ce)=>{he.aborted||Yx(le,ce,O,I,i,!1)}})}catch(le){return{type:"error",error:le,partialMatches:C}}finally{K&&!he.aborted&&(o=[...o])}if(he.aborted)return{type:"aborted"};let H=ns(O,ne,d),q=null;if(H){if(Object.keys(H[0].params).length===0)return{type:"success",matches:H};if(q=Bl(O,ne,d,!0),!(q&&C.length<q.length&&xt(C,q.slice(0,C.length))))return{type:"success",matches:H}}if(q||(q=Bl(O,ne,d,!0)),!q||xt(C,q))return{type:"success",matches:null};C=q}}function xt(ee,ne){return ee.length===ne.length&&ee.every((he,ye)=>he.route.id===ne[ye].route.id)}function nt(ee){l={},c=mo(ee,i,void 0,l)}function rr(ee,ne,he=!1){let ye=c==null;Yx(ee,ne,c||o,l,i,he),ye&&(o=[...o],z({}))}return F={get basename(){return d},get future(){return f},get state(){return k},get routes(){return o},get window(){return t},initialize:Z,subscribe:de,enableScrollRestoration:Pt,navigate:ue,fetch:yt,revalidate:Ce,createHref:ee=>e.history.createHref(ee),encodeLocation:ee=>e.history.encodeLocation(ee),getFetcher:se,resetFetcher:Ne,deleteFetcher:lt,dispose:ae,getBlocker:Fa,deleteBlocker:He,patchRoutes:rr,_internalFetchControllers:Q,_internalSetRoutes:nt,_internalSetStateDoNotUseOrYouWillBreakYourApp(ee){z(ee)}},e.unstable_instrumentations&&(F=XS(F,e.unstable_instrumentations.map(ee=>ee.router).filter(Boolean))),F}function lT(e){return e!=null&&("formData"in e&&e.formData!=null||"body"in e&&e.body!==void 0)}function t0(e,t,r,a,s,i){let l,o;if(s){l=[];for(let d of t)if(l.push(d),d.route.id===s){o=d;break}}else l=t,o=t[t.length-1];let c=eu(a||".",Qd(l),Ga(e.pathname,r)||e.pathname,i==="path");if(a==null&&(c.search=e.search,c.hash=e.hash),(a==null||a===""||a===".")&&o){let d=Th(c.search);if(o.route.index&&!d)c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index";else if(!o.route.index&&d){let u=new URLSearchParams(c.search),f=u.getAll("index");u.delete("index"),f.filter(m=>m).forEach(m=>u.append("index",m));let h=u.toString();c.search=h?`?${h}`:""}}return r!=="/"&&(c.pathname=HS({basename:r,pathname:c.pathname})),Mn(c)}function Wx(e,t,r){if(!r||!lT(r))return{path:t};if(r.formMethod&&!ST(r.formMethod))return{path:t,error:Ba(405,{method:r.formMethod})};let a=()=>({path:t,error:Ba(400,{type:"invalid-body"})}),i=(r.formMethod||"get").toUpperCase(),l=my(t);if(r.body!==void 0){if(r.formEncType==="text/plain"){if(!Wr(i))return a();let f=typeof r.body=="string"?r.body:r.body instanceof FormData||r.body instanceof URLSearchParams?Array.from(r.body.entries()).reduce((h,[m,x])=>`${h}${m}=${x}
`,""):String(r.body);return{path:t,submission:{formMethod:i,formAction:l,formEncType:r.formEncType,formData:void 0,json:void 0,text:f}}}else if(r.formEncType==="application/json"){if(!Wr(i))return a();try{let f=typeof r.body=="string"?JSON.parse(r.body):r.body;return{path:t,submission:{formMethod:i,formAction:l,formEncType:r.formEncType,formData:void 0,json:f,text:void 0}}}catch{return a()}}}jt(typeof FormData=="function","FormData is not available in this environment");let o,c;if(r.formData)o=n0(r.formData),c=r.formData;else if(r.body instanceof FormData)o=n0(r.body),c=r.body;else if(r.body instanceof URLSearchParams)o=r.body,c=Qx(o);else if(r.body==null)o=new URLSearchParams,c=new FormData;else try{o=new URLSearchParams(r.body),c=Qx(o)}catch{return a()}let d={formMethod:i,formAction:l,formEncType:r&&r.formEncType||"application/x-www-form-urlencoded",formData:c,json:void 0,text:void 0};if(Wr(d.formMethod))return{path:t,submission:d};let u=Es(t);return e&&u.search&&Th(u.search)&&o.append("index",""),u.search=`?${o}`,{path:Mn(u),submission:d}}function Gx(e,t,r,a,s,i,l,o,c,d,u,f,h,m,x,p,g,y,N,v,S){var U;let _=v?wa(v[1])?v[1].error:v[1].data:void 0,F=s.createURL(i.location),k=s.createURL(c),j;if(u&&i.errors){let M=Object.keys(i.errors)[0];j=l.findIndex(Y=>Y.route.id===M)}else if(v&&wa(v[1])){let M=v[0];j=l.findIndex(Y=>Y.route.id===M)-1}let w=v?v[1].statusCode:void 0,E=w&&w>=400,A={currentUrl:F,currentParams:((U=i.matches[0])==null?void 0:U.params)||{},nextUrl:k,nextParams:l[0].params,...o,actionResult:_,actionStatus:w},D=qo(l),W=l.map((M,Y)=>{let{route:Q}=M,B=null;if(j!=null&&Y>j?B=!1:Q.lazy?B=!0:Eh(Q)?u?B=r0(Q,i.loaderData,i.errors):oT(i.loaderData,i.matches[Y],M)&&(B=!0):B=!1,B!==null)return a0(r,a,e,D,M,d,t,B);let V=!1;typeof S=="boolean"?V=S:E?V=!1:(f||F.pathname+F.search===k.pathname+k.search||F.search!==k.search||cT(i.matches[Y],M))&&(V=!0);let P={...A,defaultShouldRevalidate:V},T=Gl(M,P);return a0(r,a,e,D,M,d,t,T,P,S)}),re=[];return x.forEach((M,Y)=>{if(u||!l.some(X=>X.route.id===M.routeId)||m.has(Y))return;let Q=i.fetchers.get(Y),B=Q&&Q.state!=="idle"&&Q.data===void 0,V=ns(g,M.path,y);if(!V){if(N&&B)return;re.push({key:Y,routeId:M.routeId,path:M.path,matches:null,match:null,request:null,controller:null});return}if(p.has(Y))return;let P=qc(V,M.path),T=new AbortController,R=_i(s,M.path,T.signal),L=null;if(h.has(Y))h.delete(Y),L=Wi(r,a,R,V,P,d,t);else if(B)f&&(L=Wi(r,a,R,V,P,d,t));else{let X;typeof S=="boolean"?X=S:E?X=!1:X=f;let J={...A,defaultShouldRevalidate:X};Gl(P,J)&&(L=Wi(r,a,R,V,P,d,t,J))}L&&re.push({key:Y,routeId:M.routeId,path:M.path,matches:L,match:P,request:R,controller:T})}),{dsMatches:W,revalidatingFetchers:re}}function Eh(e){return e.loader!=null||e.middleware!=null&&e.middleware.length>0}function r0(e,t,r){if(e.lazy)return!0;if(!Eh(e))return!1;let a=t!=null&&e.id in t,s=r!=null&&r[e.id]!==void 0;return!a&&s?!1:typeof e.loader=="function"&&e.loader.hydrate===!0?!0:!a&&!s}function oT(e,t,r){let a=!t||r.route.id!==t.route.id,s=!e.hasOwnProperty(r.route.id);return a||s}function cT(e,t){let r=e.route.path;return e.pathname!==t.pathname||r!=null&&r.endsWith("*")&&e.params["*"]!==t.params["*"]}function Gl(e,t){if(e.route.shouldRevalidate){let r=e.route.shouldRevalidate(t);if(typeof r=="boolean")return r}return t.defaultShouldRevalidate}function Yx(e,t,r,a,s,i){let l;if(e){let d=a[e];jt(d,`No route found to patch children into: routeId = ${e}`),d.children||(d.children=[]),l=d.children}else l=r;let o=[],c=[];if(t.forEach(d=>{let u=l.find(f=>cy(d,f));u?c.push({existingRoute:u,newRoute:d}):o.push(d)}),o.length>0){let d=mo(o,s,[e||"_","patch",String((l==null?void 0:l.length)||"0")],a);l.push(...d)}if(i&&c.length>0)for(let d=0;d<c.length;d++){let{existingRoute:u,newRoute:f}=c[d],h=u,[m]=mo([f],s,[],{},!0);Object.assign(h,{element:m.element?m.element:h.element,errorElement:m.errorElement?m.errorElement:h.errorElement,hydrateFallbackElement:m.hydrateFallbackElement?m.hydrateFallbackElement:h.hydrateFallbackElement})}}function cy(e,t){return"id"in e&&"id"in t&&e.id===t.id?!0:e.index===t.index&&e.path===t.path&&e.caseSensitive===t.caseSensitive?(!e.children||e.children.length===0)&&(!t.children||t.children.length===0)?!0:e.children.every((r,a)=>{var s;return(s=t.children)==null?void 0:s.some(i=>cy(r,i))}):!1}var Xx=new WeakMap,dy=({key:e,route:t,manifest:r,mapRouteProperties:a})=>{let s=r[t.id];if(jt(s,"No route found in manifest"),!s.lazy||typeof s.lazy!="object")return;let i=s.lazy[e];if(!i)return;let l=Xx.get(s);l||(l={},Xx.set(s,l));let o=l[e];if(o)return o;let c=(async()=>{let d=SS(e),f=s[e]!==void 0&&e!=="hasErrorBoundary";if(d)xr(!d,"Route property "+e+" is not a supported lazy route property. This property will be ignored."),l[e]=Promise.resolve();else if(f)xr(!1,`Route "${s.id}" has a static property "${e}" defined. The lazy property will be ignored.`);else{let h=await i();h!=null&&(Object.assign(s,{[e]:h}),Object.assign(s,a(s)))}typeof s.lazy=="object"&&(s.lazy[e]=void 0,Object.values(s.lazy).every(h=>h===void 0)&&(s.lazy=void 0))})();return l[e]=c,c},qx=new WeakMap;function dT(e,t,r,a,s){let i=r[e.id];if(jt(i,"No route found in manifest"),!e.lazy)return{lazyRoutePromise:void 0,lazyHandlerPromise:void 0};if(typeof e.lazy=="function"){let u=qx.get(i);if(u)return{lazyRoutePromise:u,lazyHandlerPromise:u};let f=(async()=>{jt(typeof e.lazy=="function","No lazy route function found");let h=await e.lazy(),m={};for(let x in h){let p=h[x];if(p===void 0)continue;let g=AS(x),N=i[x]!==void 0&&x!=="hasErrorBoundary";g?xr(!g,"Route property "+x+" is not a supported property to be returned from a lazy route function. This property will be ignored."):N?xr(!N,`Route "${i.id}" has a static property "${x}" defined but its lazy function is also returning a value for this property. The lazy route property "${x}" will be ignored.`):m[x]=p}Object.assign(i,m),Object.assign(i,{...a(i),lazy:void 0})})();return qx.set(i,f),f.catch(()=>{}),{lazyRoutePromise:f,lazyHandlerPromise:f}}let l=Object.keys(e.lazy),o=[],c;for(let u of l){if(s&&s.includes(u))continue;let f=dy({key:u,route:e,manifest:r,mapRouteProperties:a});f&&(o.push(f),u===t&&(c=f))}let d=o.length>0?Promise.all(o).then(()=>{}):void 0;return d==null||d.catch(()=>{}),c==null||c.catch(()=>{}),{lazyRoutePromise:d,lazyHandlerPromise:c}}async function Zx(e){let t=e.matches.filter(s=>s.shouldLoad),r={};return(await Promise.all(t.map(s=>s.resolve()))).forEach((s,i)=>{r[t[i].route.id]=s}),r}async function uT(e){return e.matches.some(t=>t.route.middleware)?uy(e,()=>Zx(e)):Zx(e)}function uy(e,t){return fT(e,t,a=>{if(ET(a))throw a;return a},wT,r);function r(a,s,i){if(i)return Promise.resolve(Object.assign(i.value,{[s]:{type:"error",result:a}}));{let{matches:l}=e,o=Math.min(Math.max(l.findIndex(d=>d.route.id===s),0),Math.max(l.findIndex(d=>d.shouldCallHandler()),0)),c=ss(l,l[o].route.id).route.id;return Promise.resolve({[c]:{type:"error",result:a}})}}}async function fT(e,t,r,a,s){let{matches:i,request:l,params:o,context:c,unstable_pattern:d}=e,u=i.flatMap(h=>h.route.middleware?h.route.middleware.map(m=>[h.route.id,m]):[]);return await fy({request:l,params:o,context:c,unstable_pattern:d},u,t,r,a,s)}async function fy(e,t,r,a,s,i,l=0){let{request:o}=e;if(o.signal.aborted)throw o.signal.reason??new Error(`Request aborted: ${o.method} ${o.url}`);let c=t[l];if(!c)return await r();let[d,u]=c,f,h=async()=>{if(f)throw new Error("You may only call `next()` once per middleware");try{return f={value:await fy(e,t,r,a,s,i,l+1)},f.value}catch(m){return f={value:await i(m,d,f)},f.value}};try{let m=await u(e,h),x=m!=null?a(m):void 0;return s(x)?x:f?x??f.value:(f={value:await h()},f.value)}catch(m){return await i(m,d,f)}}function hy(e,t,r,a,s){let i=dy({key:"middleware",route:a.route,manifest:t,mapRouteProperties:e}),l=dT(a.route,Wr(r.method)?"action":"loader",t,e,s);return{middleware:i,route:l.lazyRoutePromise,handler:l.lazyHandlerPromise}}function a0(e,t,r,a,s,i,l,o,c=null,d){let u=!1,f=hy(e,t,r,s,i);return{...s,_lazyPromises:f,shouldLoad:o,shouldRevalidateArgs:c,shouldCallHandler(h){return u=!0,c?typeof d=="boolean"?Gl(s,{...c,defaultShouldRevalidate:d}):typeof h=="boolean"?Gl(s,{...c,defaultShouldRevalidate:h}):Gl(s,c):o},resolve(h){let{lazy:m,loader:x,middleware:p}=s.route,g=u||o||h&&!Wr(r.method)&&(m||x),y=p&&p.length>0&&!x&&!m;return g&&(Wr(r.method)||!y)?mT({request:r,unstable_pattern:a,match:s,lazyHandlerPromise:f==null?void 0:f.handler,lazyRoutePromise:f==null?void 0:f.route,handlerOverride:h,scopedContext:l}):Promise.resolve({type:"data",result:void 0})}}}function Wi(e,t,r,a,s,i,l,o=null){return a.map(c=>c.route.id!==s.route.id?{...c,shouldLoad:!1,shouldRevalidateArgs:o,shouldCallHandler:()=>!1,_lazyPromises:hy(e,t,r,c,i),resolve:()=>Promise.resolve({type:"data",result:void 0})}:a0(e,t,r,qo(a),c,i,l,!0,o))}async function hT(e,t,r,a,s,i){r.some(d=>{var u;return(u=d._lazyPromises)==null?void 0:u.middleware})&&await Promise.all(r.map(d=>{var u;return(u=d._lazyPromises)==null?void 0:u.middleware}));let l={request:t,unstable_pattern:qo(r),params:r[0].params,context:s,matches:r},c=await e({...l,fetcherKey:a,runClientMiddleware:d=>{let u=l;return uy(u,()=>d({...u,fetcherKey:a,runClientMiddleware:()=>{throw new Error("Cannot call `runClientMiddleware()` from within an `runClientMiddleware` handler")}}))}});try{await Promise.all(r.flatMap(d=>{var u,f;return[(u=d._lazyPromises)==null?void 0:u.handler,(f=d._lazyPromises)==null?void 0:f.route]}))}catch{}return c}async function mT({request:e,unstable_pattern:t,match:r,lazyHandlerPromise:a,lazyRoutePromise:s,handlerOverride:i,scopedContext:l}){let o,c,d=Wr(e.method),u=d?"action":"loader",f=h=>{let m,x=new Promise((y,N)=>m=N);c=()=>m(),e.signal.addEventListener("abort",c);let p=y=>typeof h!="function"?Promise.reject(new Error(`You cannot call the handler for a route which defines a boolean "${u}" [routeId: ${r.route.id}]`)):h({request:e,unstable_pattern:t,params:r.params,context:l},...y!==void 0?[y]:[]),g=(async()=>{try{return{type:"data",result:await(i?i(N=>p(N)):p())}}catch(y){return{type:"error",result:y}}})();return Promise.race([g,x])};try{let h=d?r.route.action:r.route.loader;if(a||s)if(h){let m,[x]=await Promise.all([f(h).catch(p=>{m=p}),a,s]);if(m!==void 0)throw m;o=x}else{await a;let m=d?r.route.action:r.route.loader;if(m)[o]=await Promise.all([f(m),s]);else if(u==="action"){let x=new URL(e.url),p=x.pathname+x.search;throw Ba(405,{method:e.method,pathname:p,routeId:r.route.id})}else return{type:"data",result:void 0}}else if(h)o=await f(h);else{let m=new URL(e.url),x=m.pathname+m.search;throw Ba(404,{pathname:x})}}catch(h){return{type:"error",result:h}}finally{c&&e.signal.removeEventListener("abort",c)}return o}async function xT(e){let t=e.headers.get("Content-Type");return t&&/\bapplication\/json\b/.test(t)?e.body==null?null:e.json():e.text()}async function pT(e){var a,s,i,l,o;let{result:t,type:r}=e;if(Sh(t)){let c;try{c=await xT(t)}catch(d){return{type:"error",error:d}}return r==="error"?{type:"error",error:new Xo(t.status,t.statusText,c),statusCode:t.status,headers:t.headers}:{type:"data",data:c,statusCode:t.status,headers:t.headers}}return r==="error"?ap(t)?t.data instanceof Error?{type:"error",error:t.data,statusCode:(a=t.init)==null?void 0:a.status,headers:(s=t.init)!=null&&s.headers?new Headers(t.init.headers):void 0}:{type:"error",error:bT(t),statusCode:xo(t)?t.status:void 0,headers:(i=t.init)!=null&&i.headers?new Headers(t.init.headers):void 0}:{type:"error",error:t,statusCode:xo(t)?t.status:void 0}:ap(t)?{type:"data",data:t.data,statusCode:(l=t.init)==null?void 0:l.status,headers:(o=t.init)!=null&&o.headers?new Headers(t.init.headers):void 0}:{type:"data",data:t}}function gT(e,t,r,a,s){let i=e.headers.get("Location");if(jt(i,"Redirects returned/thrown from loaders/actions must have a Location header"),!jh(i)){let l=a.slice(0,a.findIndex(o=>o.route.id===r)+1);i=t0(new URL(t.url),l,s,i),e.headers.set("Location",i)}return e}function Jx(e,t,r,a){let s=["about:","blob:","chrome:","chrome-untrusted:","content:","data:","devtools:","file:","filesystem:","javascript:"];if(jh(e)){let i=e,l=i.startsWith("//")?new URL(t.protocol+i):new URL(i);if(s.includes(l.protocol))throw new Error("Invalid redirect location");let o=Ga(l.pathname,r)!=null;if(l.origin===t.origin&&o)return l.pathname+l.search+l.hash}try{let i=a.createURL(e);if(s.includes(i.protocol))throw new Error("Invalid redirect location")}catch{}return e}function _i(e,t,r,a){let s=e.createURL(my(t)).toString(),i={signal:r};if(a&&Wr(a.formMethod)){let{formMethod:l,formEncType:o}=a;i.method=l.toUpperCase(),o==="application/json"?(i.headers=new Headers({"Content-Type":o}),i.body=JSON.stringify(a.json)):o==="text/plain"?i.body=a.text:o==="application/x-www-form-urlencoded"&&a.formData?i.body=n0(a.formData):i.body=a.formData}return new Request(s,i)}function n0(e){let t=new URLSearchParams;for(let[r,a]of e.entries())t.append(r,typeof a=="string"?a:a.name);return t}function Qx(e){let t=new FormData;for(let[r,a]of e.entries())t.append(r,a);return t}function vT(e,t,r,a=!1,s=!1){let i={},l=null,o,c=!1,d={},u=r&&wa(r[1])?r[1].error:void 0;return e.forEach(f=>{if(!(f.route.id in t))return;let h=f.route.id,m=t[h];if(jt(!Us(m),"Cannot handle redirect results in processLoaderData"),wa(m)){let x=m.error;if(u!==void 0&&(x=u,u=void 0),l=l||{},s)l[h]=x;else{let p=ss(e,h);l[p.route.id]==null&&(l[p.route.id]=x)}a||(i[h]=oy),c||(c=!0,o=xo(m.error)?m.error.status:500),m.headers&&(d[h]=m.headers)}else i[h]=m.data,m.statusCode&&m.statusCode!==200&&!c&&(o=m.statusCode),m.headers&&(d[h]=m.headers)}),u!==void 0&&r&&(l={[r[0]]:u},r[2]&&(i[r[2]]=void 0)),{loaderData:i,errors:l,statusCode:o||200,loaderHeaders:d}}function ep(e,t,r,a,s,i){let{loaderData:l,errors:o}=vT(t,r,a);return s.filter(c=>!c.matches||c.matches.some(d=>d.shouldLoad)).forEach(c=>{let{key:d,match:u,controller:f}=c;if(f&&f.signal.aborted)return;let h=i[d];if(jt(h,"Did not find corresponding fetcher result"),wa(h)){let m=ss(e.matches,u==null?void 0:u.route.id);o&&o[m.route.id]||(o={...o,[m.route.id]:h.error}),e.fetchers.delete(d)}else if(Us(h))jt(!1,"Unhandled fetcher revalidation redirect");else{let m=Vn(h.data);e.fetchers.set(d,m)}}),{loaderData:l,errors:o}}function tp(e,t,r,a){let s=Object.entries(t).filter(([,i])=>i!==oy).reduce((i,[l,o])=>(i[l]=o,i),{});for(let i of r){let l=i.route.id;if(!t.hasOwnProperty(l)&&e.hasOwnProperty(l)&&i.route.loader&&(s[l]=e[l]),a&&a.hasOwnProperty(l))break}return s}function rp(e){return e?wa(e[1])?{actionData:{}}:{actionData:{[e[0]]:e[1].data}}:{}}function ss(e,t){return(t?e.slice(0,e.findIndex(a=>a.route.id===t)+1):[...e]).reverse().find(a=>a.route.hasErrorBoundary===!0)||e[0]}function yc(e){let t=e.length===1?e[0]:e.find(r=>r.index||!r.path||r.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:t}],route:t}}function Ba(e,{pathname:t,routeId:r,method:a,type:s,message:i}={}){let l="Unknown Server Error",o="Unknown @remix-run/router error";return e===400?(l="Bad Request",a&&t&&r?o=`You made a ${a} request to "${t}" but did not provide a \`loader\` for route "${r}", so there is no way to handle the request.`:s==="invalid-body"&&(o="Unable to encode submission body")):e===403?(l="Forbidden",o=`Route "${r}" does not match URL "${t}"`):e===404?(l="Not Found",o=`No route matches URL "${t}"`):e===405&&(l="Method Not Allowed",a&&t&&r?o=`You made a ${a.toUpperCase()} request to "${t}" but did not provide an \`action\` for route "${r}", so there is no way to handle the request.`:a&&(o=`Invalid request method "${a.toUpperCase()}"`)),new Xo(e||500,l,new Error(o),!0)}function bc(e){let t=Object.entries(e);for(let r=t.length-1;r>=0;r--){let[a,s]=t[r];if(Us(s))return{key:a,result:s}}}function my(e){let t=typeof e=="string"?Es(e):e;return Mn({...t,hash:""})}function yT(e,t){return e.pathname!==t.pathname||e.search!==t.search?!1:e.hash===""?t.hash!=="":e.hash===t.hash?!0:t.hash!==""}function bT(e){var t,r;return new Xo(((t=e.init)==null?void 0:t.status)??500,((r=e.init)==null?void 0:r.statusText)??"Internal Server Error",e.data)}function wT(e){return e!=null&&typeof e=="object"&&Object.entries(e).every(([t,r])=>typeof t=="string"&&kT(r))}function kT(e){return e!=null&&typeof e=="object"&&"type"in e&&"result"in e&&(e.type==="data"||e.type==="error")}function NT(e){return Sh(e.result)&&iy.has(e.result.status)}function wa(e){return e.type==="error"}function Us(e){return(e&&e.type)==="redirect"}function ap(e){return typeof e=="object"&&e!=null&&"type"in e&&"data"in e&&"init"in e&&e.type==="DataWithResponseInit"}function Sh(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.headers=="object"&&typeof e.body<"u"}function jT(e){return iy.has(e)}function ET(e){return Sh(e)&&jT(e.status)&&e.headers.has("Location")}function ST(e){return rT.has(e.toUpperCase())}function Wr(e){return eT.has(e.toUpperCase())}function Th(e){return new URLSearchParams(e).getAll("index").some(t=>t==="")}function qc(e,t){let r=typeof t=="string"?Es(t).search:t.search;if(e[e.length-1].route.index&&Th(r||""))return e[e.length-1];let a=ty(e);return a[a.length-1]}function np(e){let{formMethod:t,formAction:r,formEncType:a,text:s,formData:i,json:l}=e;if(!(!t||!r||!a)){if(s!=null)return{formMethod:t,formAction:r,formEncType:a,formData:void 0,json:void 0,text:s};if(i!=null)return{formMethod:t,formAction:r,formEncType:a,formData:i,json:void 0,text:void 0};if(l!==void 0)return{formMethod:t,formAction:r,formEncType:a,formData:void 0,json:l,text:void 0}}}function zu(e,t){return t?{state:"loading",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}:{state:"loading",location:e,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function TT(e,t){return{state:"submitting",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}}function _l(e,t){return e?{state:"loading",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function AT(e,t){return{state:"submitting",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t?t.data:void 0}}function Vn(e){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function _T(e,t){try{let r=e.sessionStorage.getItem(ly);if(r){let a=JSON.parse(r);for(let[s,i]of Object.entries(a||{}))i&&Array.isArray(i)&&t.set(s,new Set(i||[]))}}catch{}}function CT(e,t){if(t.size>0){let r={};for(let[a,s]of t)r[a]=[...s];try{e.sessionStorage.setItem(ly,JSON.stringify(r))}catch(a){xr(!1,`Failed to save applied view transitions in sessionStorage (${a}).`)}}}function sp(){let e,t,r=new Promise((a,s)=>{e=async i=>{a(i);try{await r}catch{}},t=async i=>{s(i);try{await r}catch{}}});return{promise:r,resolve:e,reject:t}}var ui=b.createContext(null);ui.displayName="DataRouter";var Zo=b.createContext(null);Zo.displayName="DataRouterState";var xy=b.createContext(!1);function FT(){return b.useContext(xy)}var Ah=b.createContext({isTransitioning:!1});Ah.displayName="ViewTransition";var py=b.createContext(new Map);py.displayName="Fetchers";var DT=b.createContext(null);DT.displayName="Await";var Ca=b.createContext(null);Ca.displayName="Navigation";var tu=b.createContext(null);tu.displayName="Location";var Xa=b.createContext({outlet:null,matches:[],isDataRoute:!1});Xa.displayName="Route";var _h=b.createContext(null);_h.displayName="RouteError";var gy="REACT_ROUTER_ERROR",RT="REDIRECT",MT="ROUTE_ERROR_RESPONSE";function PT(e){if(e.startsWith(`${gy}:${RT}:{`))try{let t=JSON.parse(e.slice(28));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.location=="string"&&typeof t.reloadDocument=="boolean"&&typeof t.replace=="boolean")return t}catch{}}function OT(e){if(e.startsWith(`${gy}:${MT}:{`))try{let t=JSON.parse(e.slice(40));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string")return new Xo(t.status,t.statusText,t.data)}catch{}}function IT(e,{relative:t}={}){jt(ml(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:a}=b.useContext(Ca),{hash:s,pathname:i,search:l}=Jo(e,{relative:t}),o=i;return r!=="/"&&(o=i==="/"?r:Fn([r,i])),a.createHref({pathname:o,search:l,hash:s})}function ml(){return b.useContext(tu)!=null}function ga(){return jt(ml(),"useLocation() may be used only in the context of a <Router> component."),b.useContext(tu).location}var vy="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function yy(e){b.useContext(Ca).static||b.useLayoutEffect(e)}function ca(){let{isDataRoute:e}=b.useContext(Xa);return e?JT():LT()}function LT(){jt(ml(),"useNavigate() may be used only in the context of a <Router> component.");let e=b.useContext(ui),{basename:t,navigator:r}=b.useContext(Ca),{matches:a}=b.useContext(Xa),{pathname:s}=ga(),i=JSON.stringify(Qd(a)),l=b.useRef(!1);return yy(()=>{l.current=!0}),b.useCallback((c,d={})=>{if(xr(l.current,vy),!l.current)return;if(typeof c=="number"){r.go(c);return}let u=eu(c,JSON.parse(i),s,d.relative==="path");e==null&&t!=="/"&&(u.pathname=u.pathname==="/"?t:Fn([t,u.pathname])),(d.replace?r.replace:r.push)(u,d.state,d)},[t,r,i,s,e])}var BT=b.createContext(null);function zT(e){let t=b.useContext(Xa).outlet;return b.useMemo(()=>t&&b.createElement(BT.Provider,{value:e},t),[t,e])}function Ch(){let{matches:e}=b.useContext(Xa),t=e[e.length-1];return t?t.params:{}}function Jo(e,{relative:t}={}){let{matches:r}=b.useContext(Xa),{pathname:a}=ga(),s=JSON.stringify(Qd(r));return b.useMemo(()=>eu(e,JSON.parse(s),a,t==="path"),[e,s,a,t])}function UT(e,t,r,a,s){jt(ml(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=b.useContext(Ca),{matches:l}=b.useContext(Xa),o=l[l.length-1],c=o?o.params:{},d=o?o.pathname:"/",u=o?o.pathnameBase:"/",f=o&&o.route;{let N=f&&f.path||"";wy(d,!f||N.endsWith("*")||N.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${N}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${N}"> to <Route path="${N==="/"?"*":`${N}/*`}">.`)}let h=ga(),m;m=h;let x=m.pathname||"/",p=x;if(u!=="/"){let N=u.replace(/^\//,"").split("/");p="/"+x.replace(/^\//,"").split("/").slice(N.length).join("/")}let g=ns(e,{pathname:p});return xr(f||g!=null,`No routes matched location "${m.pathname}${m.search}${m.hash}" `),xr(g==null||g[g.length-1].route.element!==void 0||g[g.length-1].route.Component!==void 0||g[g.length-1].route.lazy!==void 0,`Matched leaf route at location "${m.pathname}${m.search}${m.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),WT(g&&g.map(N=>Object.assign({},N,{params:Object.assign({},c,N.params),pathname:Fn([u,i.encodeLocation?i.encodeLocation(N.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:N.pathname]),pathnameBase:N.pathnameBase==="/"?u:Fn([u,i.encodeLocation?i.encodeLocation(N.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:N.pathnameBase])})),l,r,a,s)}function VT(){let e=ZT(),t=xo(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:a},i={padding:"2px 4px",backgroundColor:a},l=null;return console.error("Error handled by React Router default ErrorBoundary:",e),l=b.createElement(b.Fragment,null,b.createElement("p",null," Hey developer "),b.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",b.createElement("code",{style:i},"ErrorBoundary")," or"," ",b.createElement("code",{style:i},"errorElement")," prop on your route.")),b.createElement(b.Fragment,null,b.createElement("h2",null,"Unexpected Application Error!"),b.createElement("h3",{style:{fontStyle:"italic"}},t),r?b.createElement("pre",{style:s},r):null,l)}var HT=b.createElement(VT,null),by=class extends b.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.onError?this.props.onError(e,t):console.error("React Router caught the following error during render",e)}render(){let e=this.state.error;if(this.context&&typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){const r=OT(e.digest);r&&(e=r)}let t=e!==void 0?b.createElement(Xa.Provider,{value:this.props.routeContext},b.createElement(_h.Provider,{value:e,children:this.props.component})):this.props.children;return this.context?b.createElement($T,{error:e},t):t}};by.contextType=xy;var Uu=new WeakMap;function $T({children:e,error:t}){let{basename:r}=b.useContext(Ca);if(typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){let a=PT(t.digest);if(a){let s=Uu.get(t);if(s)throw s;let i=ay(a.location,r);if(ry&&!Uu.get(t))if(i.isExternal||a.reloadDocument)window.location.href=i.absoluteURL||i.to;else{const l=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(i.to,{replace:a.replace}));throw Uu.set(t,l),l}return b.createElement("meta",{httpEquiv:"refresh",content:`0;url=${i.absoluteURL||i.to}`})}}return e}function KT({routeContext:e,match:t,children:r}){let a=b.useContext(ui);return a&&a.static&&a.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=t.route.id),b.createElement(Xa.Provider,{value:e},r)}function WT(e,t=[],r=null,a=null,s=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let i=e,l=r==null?void 0:r.errors;if(l!=null){let u=i.findIndex(f=>f.route.id&&(l==null?void 0:l[f.route.id])!==void 0);jt(u>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),i=i.slice(0,Math.min(i.length,u+1))}let o=!1,c=-1;if(r)for(let u=0;u<i.length;u++){let f=i[u];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(c=u),f.route.id){let{loaderData:h,errors:m}=r,x=f.route.loader&&!h.hasOwnProperty(f.route.id)&&(!m||m[f.route.id]===void 0);if(f.route.lazy||x){o=!0,c>=0?i=i.slice(0,c+1):i=[i[0]];break}}}let d=r&&a?(u,f)=>{var h,m;a(u,{location:r.location,params:((m=(h=r.matches)==null?void 0:h[0])==null?void 0:m.params)??{},unstable_pattern:qo(r.matches),errorInfo:f})}:void 0;return i.reduceRight((u,f,h)=>{let m,x=!1,p=null,g=null;r&&(m=l&&f.route.id?l[f.route.id]:void 0,p=f.route.errorElement||HT,o&&(c<0&&h===0?(wy("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),x=!0,g=null):c===h&&(x=!0,g=f.route.hydrateFallbackElement||null)));let y=t.concat(i.slice(0,h+1)),N=()=>{let v;return m?v=p:x?v=g:f.route.Component?v=b.createElement(f.route.Component,null):f.route.element?v=f.route.element:v=u,b.createElement(KT,{match:f,routeContext:{outlet:u,matches:y,isDataRoute:r!=null},children:v})};return r&&(f.route.ErrorBoundary||f.route.errorElement||h===0)?b.createElement(by,{location:r.location,revalidation:r.revalidation,component:p,error:m,children:N(),routeContext:{outlet:null,matches:y,isDataRoute:!0},onError:d}):N()},null)}function Fh(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function GT(e){let t=b.useContext(ui);return jt(t,Fh(e)),t}function YT(e){let t=b.useContext(Zo);return jt(t,Fh(e)),t}function XT(e){let t=b.useContext(Xa);return jt(t,Fh(e)),t}function Dh(e){let t=XT(e),r=t.matches[t.matches.length-1];return jt(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function qT(){return Dh("useRouteId")}function ZT(){var a;let e=b.useContext(_h),t=YT("useRouteError"),r=Dh("useRouteError");return e!==void 0?e:(a=t.errors)==null?void 0:a[r]}function JT(){let{router:e}=GT("useNavigate"),t=Dh("useNavigate"),r=b.useRef(!1);return yy(()=>{r.current=!0}),b.useCallback(async(s,i={})=>{xr(r.current,vy),r.current&&(typeof s=="number"?await e.navigate(s):await e.navigate(s,{fromRouteId:t,...i}))},[e,t])}var ip={};function wy(e,t,r){!t&&!ip[e]&&(ip[e]=!0,xr(!1,r))}var lp={};function op(e,t){!e&&!lp[t]&&(lp[t]=!0,console.warn(t))}var QT="useOptimistic",cp=yE[QT],eA=()=>{};function tA(e){return cp?cp(e):[e,eA]}function rA(e){let t={hasErrorBoundary:e.hasErrorBoundary||e.ErrorBoundary!=null||e.errorElement!=null};return e.Component&&(e.element&&xr(!1,"You should not include both `Component` and `element` on your route - `Component` will be used."),Object.assign(t,{element:b.createElement(e.Component),Component:void 0})),e.HydrateFallback&&(e.hydrateFallbackElement&&xr(!1,"You should not include both `HydrateFallback` and `hydrateFallbackElement` on your route - `HydrateFallback` will be used."),Object.assign(t,{hydrateFallbackElement:b.createElement(e.HydrateFallback),HydrateFallback:void 0})),e.ErrorBoundary&&(e.errorElement&&xr(!1,"You should not include both `ErrorBoundary` and `errorElement` on your route - `ErrorBoundary` will be used."),Object.assign(t,{errorElement:b.createElement(e.ErrorBoundary),ErrorBoundary:void 0})),t}var aA=["HydrateFallback","hydrateFallbackElement"],nA=class{constructor(){this.status="pending",this.promise=new Promise((e,t)=>{this.resolve=r=>{this.status==="pending"&&(this.status="resolved",e(r))},this.reject=r=>{this.status==="pending"&&(this.status="rejected",t(r))}})}};function sA({router:e,flushSync:t,onError:r,unstable_useTransitions:a}){a=FT()||a;let[i,l]=b.useState(e.state),[o,c]=tA(i),[d,u]=b.useState(),[f,h]=b.useState({isTransitioning:!1}),[m,x]=b.useState(),[p,g]=b.useState(),[y,N]=b.useState(),v=b.useRef(new Map),S=b.useCallback((j,{deletedFetchers:w,newErrors:E,flushSync:A,viewTransitionOpts:D})=>{E&&r&&Object.values(E).forEach(re=>{var U;return r(re,{location:j.location,params:((U=j.matches[0])==null?void 0:U.params)??{},unstable_pattern:qo(j.matches)})}),j.fetchers.forEach((re,U)=>{re.data!==void 0&&v.current.set(U,re.data)}),w.forEach(re=>v.current.delete(re)),op(A===!1||t!=null,'You provided the `flushSync` option to a router update, but you are not using the `<RouterProvider>` from `react-router/dom` so `ReactDOM.flushSync()` is unavailable.  Please update your app to `import { RouterProvider } from "react-router/dom"` and ensure you have `react-dom` installed as a dependency to use the `flushSync` option.');let W=e.window!=null&&e.window.document!=null&&typeof e.window.document.startViewTransition=="function";if(op(D==null||W,"You provided the `viewTransition` option to a router update, but you do not appear to be running in a DOM environment as `window.startViewTransition` is not available."),!D||!W){t&&A?t(()=>l(j)):a===!1?l(j):b.startTransition(()=>{a===!0&&c(re=>dp(re,j)),l(j)});return}if(t&&A){t(()=>{p&&(m==null||m.resolve(),p.skipTransition()),h({isTransitioning:!0,flushSync:!0,currentLocation:D.currentLocation,nextLocation:D.nextLocation})});let re=e.window.document.startViewTransition(()=>{t(()=>l(j))});re.finished.finally(()=>{t(()=>{x(void 0),g(void 0),u(void 0),h({isTransitioning:!1})})}),t(()=>g(re));return}p?(m==null||m.resolve(),p.skipTransition(),N({state:j,currentLocation:D.currentLocation,nextLocation:D.nextLocation})):(u(j),h({isTransitioning:!0,flushSync:!1,currentLocation:D.currentLocation,nextLocation:D.nextLocation}))},[e.window,t,p,m,a,c,r]);b.useLayoutEffect(()=>e.subscribe(S),[e,S]),b.useEffect(()=>{f.isTransitioning&&!f.flushSync&&x(new nA)},[f]),b.useEffect(()=>{if(m&&d&&e.window){let j=d,w=m.promise,E=e.window.document.startViewTransition(async()=>{a===!1?l(j):b.startTransition(()=>{a===!0&&c(A=>dp(A,j)),l(j)}),await w});E.finished.finally(()=>{x(void 0),g(void 0),u(void 0),h({isTransitioning:!1})}),g(E)}},[d,m,e.window,a,c]),b.useEffect(()=>{m&&d&&o.location.key===d.location.key&&m.resolve()},[m,p,o.location,d]),b.useEffect(()=>{!f.isTransitioning&&y&&(u(y.state),h({isTransitioning:!0,flushSync:!1,currentLocation:y.currentLocation,nextLocation:y.nextLocation}),N(void 0))},[f.isTransitioning,y]);let _=b.useMemo(()=>({createHref:e.createHref,encodeLocation:e.encodeLocation,go:j=>e.navigate(j),push:(j,w,E)=>e.navigate(j,{state:w,preventScrollReset:E==null?void 0:E.preventScrollReset}),replace:(j,w,E)=>e.navigate(j,{replace:!0,state:w,preventScrollReset:E==null?void 0:E.preventScrollReset})}),[e]),F=e.basename||"/",k=b.useMemo(()=>({router:e,navigator:_,static:!1,basename:F,onError:r}),[e,_,F,r]);return b.createElement(b.Fragment,null,b.createElement(ui.Provider,{value:k},b.createElement(Zo.Provider,{value:o},b.createElement(py.Provider,{value:v.current},b.createElement(Ah.Provider,{value:f},b.createElement(oA,{basename:F,location:o.location,navigationType:o.historyAction,navigator:_,unstable_useTransitions:a},b.createElement(iA,{routes:e.routes,future:e.future,state:o,onError:r})))))),null)}function dp(e,t){return{...e,navigation:t.navigation.state!=="idle"?t.navigation:e.navigation,revalidation:t.revalidation!=="idle"?t.revalidation:e.revalidation,actionData:t.navigation.state!=="submitting"?t.actionData:e.actionData,fetchers:t.fetchers}}var iA=b.memo(lA);function lA({routes:e,future:t,state:r,onError:a}){return UT(e,void 0,r,a,t)}function Zc({to:e,replace:t,state:r,relative:a}){jt(ml(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=b.useContext(Ca);xr(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=b.useContext(Xa),{pathname:l}=ga(),o=ca(),c=eu(e,Qd(i),l,a==="path"),d=JSON.stringify(c);return b.useEffect(()=>{o(JSON.parse(d),{replace:t,state:r,relative:a})},[o,d,a,t,r]),null}function Rh(e){return zT(e.context)}function oA({basename:e="/",children:t=null,location:r,navigationType:a="POP",navigator:s,static:i=!1,unstable_useTransitions:l}){jt(!ml(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=e.replace(/^\/*/,"/"),c=b.useMemo(()=>({basename:o,navigator:s,static:i,unstable_useTransitions:l,future:{}}),[o,s,i,l]);typeof r=="string"&&(r=Es(r));let{pathname:d="/",search:u="",hash:f="",state:h=null,key:m="default"}=r,x=b.useMemo(()=>{let p=Ga(d,o);return p==null?null:{location:{pathname:p,search:u,hash:f,state:h,key:m},navigationType:a}},[o,d,u,f,h,m,a]);return xr(x!=null,`<Router basename="${o}"> is not able to match the URL "${d}${u}${f}" because it does not start with the basename, so the <Router> won't render anything.`),x==null?null:b.createElement(Ca.Provider,{value:c},b.createElement(tu.Provider,{children:t,value:x}))}var Jc="get",Qc="application/x-www-form-urlencoded";function ru(e){return typeof HTMLElement<"u"&&e instanceof HTMLElement}function cA(e){return ru(e)&&e.tagName.toLowerCase()==="button"}function dA(e){return ru(e)&&e.tagName.toLowerCase()==="form"}function uA(e){return ru(e)&&e.tagName.toLowerCase()==="input"}function fA(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function hA(e,t){return e.button===0&&(!t||t==="_self")&&!fA(e)}function s0(e=""){return new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let a=e[r];return t.concat(Array.isArray(a)?a.map(s=>[r,s]):[[r,a]])},[]))}function mA(e,t){let r=s0(e);return t&&t.forEach((a,s)=>{r.has(s)||t.getAll(s).forEach(i=>{r.append(s,i)})}),r}var wc=null;function xA(){if(wc===null)try{new FormData(document.createElement("form"),0),wc=!1}catch{wc=!0}return wc}var pA=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Vu(e){return e!=null&&!pA.has(e)?(xr(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Qc}"`),null):e}function gA(e,t){let r,a,s,i,l;if(dA(e)){let o=e.getAttribute("action");a=o?Ga(o,t):null,r=e.getAttribute("method")||Jc,s=Vu(e.getAttribute("enctype"))||Qc,i=new FormData(e)}else if(cA(e)||uA(e)&&(e.type==="submit"||e.type==="image")){let o=e.form;if(o==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=e.getAttribute("formaction")||o.getAttribute("action");if(a=c?Ga(c,t):null,r=e.getAttribute("formmethod")||o.getAttribute("method")||Jc,s=Vu(e.getAttribute("formenctype"))||Vu(o.getAttribute("enctype"))||Qc,i=new FormData(o,e),!xA()){let{name:d,type:u,value:f}=e;if(u==="image"){let h=d?`${d}.`:"";i.append(`${h}x`,"0"),i.append(`${h}y`,"0")}else d&&i.append(d,f)}}else{if(ru(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=Jc,a=null,s=Qc,l=e}return i&&s==="text/plain"&&(l=i,i=void 0),{action:a,method:r.toLowerCase(),encType:s,formData:i,body:l}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Mh(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function vA(e,t,r,a){let s=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return r?s.pathname.endsWith("/")?s.pathname=`${s.pathname}_.${a}`:s.pathname=`${s.pathname}.${a}`:s.pathname==="/"?s.pathname=`_root.${a}`:t&&Ga(s.pathname,t)==="/"?s.pathname=`${t.replace(/\/$/,"")}/_root.${a}`:s.pathname=`${s.pathname.replace(/\/$/,"")}.${a}`,s}async function yA(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function bA(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function wA(e,t,r){let a=await Promise.all(e.map(async s=>{let i=t.routes[s.route.id];if(i){let l=await yA(i,r);return l.links?l.links():[]}return[]}));return EA(a.flat(1).filter(bA).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function up(e,t,r,a,s,i){let l=(c,d)=>r[d]?c.route.id!==r[d].route.id:!0,o=(c,d)=>{var u;return r[d].pathname!==c.pathname||((u=r[d].route.path)==null?void 0:u.endsWith("*"))&&r[d].params["*"]!==c.params["*"]};return i==="assets"?t.filter((c,d)=>l(c,d)||o(c,d)):i==="data"?t.filter((c,d)=>{var f;let u=a.routes[c.route.id];if(!u||!u.hasLoader)return!1;if(l(c,d)||o(c,d))return!0;if(c.route.shouldRevalidate){let h=c.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((f=r[0])==null?void 0:f.params)||{},nextUrl:new URL(e,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof h=="boolean")return h}return!0}):[]}function kA(e,t,{includeHydrateFallback:r}={}){return NA(e.map(a=>{let s=t.routes[a.route.id];if(!s)return[];let i=[s.module];return s.clientActionModule&&(i=i.concat(s.clientActionModule)),s.clientLoaderModule&&(i=i.concat(s.clientLoaderModule)),r&&s.hydrateFallbackModule&&(i=i.concat(s.hydrateFallbackModule)),s.imports&&(i=i.concat(s.imports)),i}).flat(1))}function NA(e){return[...new Set(e)]}function jA(e){let t={},r=Object.keys(e).sort();for(let a of r)t[a]=e[a];return t}function EA(e,t){let r=new Set;return new Set(t),e.reduce((a,s)=>{let i=JSON.stringify(jA(s));return r.has(i)||(r.add(i),a.push({key:i,link:s})),a},[])}function ky(){let e=b.useContext(ui);return Mh(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function SA(){let e=b.useContext(Zo);return Mh(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var Ph=b.createContext(void 0);Ph.displayName="FrameworkContext";function Ny(){let e=b.useContext(Ph);return Mh(e,"You must render this element inside a <HydratedRouter> element"),e}function TA(e,t){let r=b.useContext(Ph),[a,s]=b.useState(!1),[i,l]=b.useState(!1),{onFocus:o,onBlur:c,onMouseEnter:d,onMouseLeave:u,onTouchStart:f}=t,h=b.useRef(null);b.useEffect(()=>{if(e==="render"&&l(!0),e==="viewport"){let p=y=>{y.forEach(N=>{l(N.isIntersecting)})},g=new IntersectionObserver(p,{threshold:.5});return h.current&&g.observe(h.current),()=>{g.disconnect()}}},[e]),b.useEffect(()=>{if(a){let p=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(p)}}},[a]);let m=()=>{s(!0)},x=()=>{s(!1),l(!1)};return r?e!=="intent"?[i,h,{}]:[i,h,{onFocus:Cl(o,m),onBlur:Cl(c,x),onMouseEnter:Cl(d,m),onMouseLeave:Cl(u,x),onTouchStart:Cl(f,m)}]:[!1,h,{}]}function Cl(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function AA({page:e,...t}){let{router:r}=ky(),a=b.useMemo(()=>ns(r.routes,e,r.basename),[r.routes,e,r.basename]);return a?b.createElement(CA,{page:e,matches:a,...t}):null}function _A(e){let{manifest:t,routeModules:r}=Ny(),[a,s]=b.useState([]);return b.useEffect(()=>{let i=!1;return wA(e,t,r).then(l=>{i||s(l)}),()=>{i=!0}},[e,t,r]),a}function CA({page:e,matches:t,...r}){let a=ga(),{future:s,manifest:i,routeModules:l}=Ny(),{basename:o}=ky(),{loaderData:c,matches:d}=SA(),u=b.useMemo(()=>up(e,t,d,i,a,"data"),[e,t,d,i,a]),f=b.useMemo(()=>up(e,t,d,i,a,"assets"),[e,t,d,i,a]),h=b.useMemo(()=>{if(e===a.pathname+a.search+a.hash)return[];let p=new Set,g=!1;if(t.forEach(N=>{var S;let v=i.routes[N.route.id];!v||!v.hasLoader||(!u.some(_=>_.route.id===N.route.id)&&N.route.id in c&&((S=l[N.route.id])!=null&&S.shouldRevalidate)||v.hasClientLoader?g=!0:p.add(N.route.id))}),p.size===0)return[];let y=vA(e,o,s.unstable_trailingSlashAwareDataRequests,"data");return g&&p.size>0&&y.searchParams.set("_routes",t.filter(N=>p.has(N.route.id)).map(N=>N.route.id).join(",")),[y.pathname+y.search]},[o,s.unstable_trailingSlashAwareDataRequests,c,a,i,u,t,e,l]),m=b.useMemo(()=>kA(f,i),[f,i]),x=_A(f);return b.createElement(b.Fragment,null,h.map(p=>b.createElement("link",{key:p,rel:"prefetch",as:"fetch",href:p,...r})),m.map(p=>b.createElement("link",{key:p,rel:"modulepreload",href:p,...r})),x.map(({key:p,link:g})=>b.createElement("link",{key:p,nonce:r.nonce,...g,crossOrigin:g.crossOrigin??r.crossOrigin})))}function FA(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var DA=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{DA&&(window.__reactRouterVersion="7.13.0")}catch{}function RA(e,t){return iT({basename:t==null?void 0:t.basename,getContext:t==null?void 0:t.getContext,future:t==null?void 0:t.future,history:kS({window:t==null?void 0:t.window}),hydrationData:MA(),routes:e,mapRouteProperties:rA,hydrationRouteProperties:aA,dataStrategy:t==null?void 0:t.dataStrategy,patchRoutesOnNavigation:t==null?void 0:t.patchRoutesOnNavigation,window:t==null?void 0:t.window,unstable_instrumentations:t==null?void 0:t.unstable_instrumentations}).initialize()}function MA(){let e=window==null?void 0:window.__staticRouterHydrationData;return e&&e.errors&&(e={...e,errors:PA(e.errors)}),e}function PA(e){if(!e)return null;let t=Object.entries(e),r={};for(let[a,s]of t)if(s&&s.__type==="RouteErrorResponse")r[a]=new Xo(s.status,s.statusText,s.data,s.internal===!0);else if(s&&s.__type==="Error"){if(s.__subType){let i=window[s.__subType];if(typeof i=="function")try{let l=new i(s.message);l.stack="",r[a]=l}catch{}}if(r[a]==null){let i=new Error(s.message);i.stack="",r[a]=i}}else r[a]=s;return r}var jy=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,At=b.forwardRef(function({onClick:t,discover:r="render",prefetch:a="none",relative:s,reloadDocument:i,replace:l,state:o,target:c,to:d,preventScrollReset:u,viewTransition:f,unstable_defaultShouldRevalidate:h,...m},x){let{basename:p,unstable_useTransitions:g}=b.useContext(Ca),y=typeof d=="string"&&jy.test(d),N=ay(d,p);d=N.to;let v=IT(d,{relative:s}),[S,_,F]=TA(a,m),k=BA(d,{replace:l,state:o,target:c,preventScrollReset:u,relative:s,viewTransition:f,unstable_defaultShouldRevalidate:h,unstable_useTransitions:g});function j(E){t&&t(E),E.defaultPrevented||k(E)}let w=b.createElement("a",{...m,...F,href:N.absoluteURL||v,onClick:N.isExternal||i?t:j,ref:FA(x,_),target:c,"data-discover":!y&&r==="render"?"true":void 0});return S&&!y?b.createElement(b.Fragment,null,w,b.createElement(AA,{page:v})):w});At.displayName="Link";var OA=b.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:a="",end:s=!1,style:i,to:l,viewTransition:o,children:c,...d},u){let f=Jo(l,{relative:d.relative}),h=ga(),m=b.useContext(Zo),{navigator:x,basename:p}=b.useContext(Ca),g=m!=null&&KA(f)&&o===!0,y=x.encodeLocation?x.encodeLocation(f).pathname:f.pathname,N=h.pathname,v=m&&m.navigation&&m.navigation.location?m.navigation.location.pathname:null;r||(N=N.toLowerCase(),v=v?v.toLowerCase():null,y=y.toLowerCase()),v&&p&&(v=Ga(v,p)||v);const S=y!=="/"&&y.endsWith("/")?y.length-1:y.length;let _=N===y||!s&&N.startsWith(y)&&N.charAt(S)==="/",F=v!=null&&(v===y||!s&&v.startsWith(y)&&v.charAt(y.length)==="/"),k={isActive:_,isPending:F,isTransitioning:g},j=_?t:void 0,w;typeof a=="function"?w=a(k):w=[a,_?"active":null,F?"pending":null,g?"transitioning":null].filter(Boolean).join(" ");let E=typeof i=="function"?i(k):i;return b.createElement(At,{...d,"aria-current":j,className:w,ref:u,style:E,to:l,viewTransition:o},typeof c=="function"?c(k):c)});OA.displayName="NavLink";var IA=b.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:a,replace:s,state:i,method:l=Jc,action:o,onSubmit:c,relative:d,preventScrollReset:u,viewTransition:f,unstable_defaultShouldRevalidate:h,...m},x)=>{let{unstable_useTransitions:p}=b.useContext(Ca),g=HA(),y=$A(o,{relative:d}),N=l.toLowerCase()==="get"?"get":"post",v=typeof o=="string"&&jy.test(o),S=_=>{if(c&&c(_),_.defaultPrevented)return;_.preventDefault();let F=_.nativeEvent.submitter,k=(F==null?void 0:F.getAttribute("formmethod"))||l,j=()=>g(F||_.currentTarget,{fetcherKey:t,method:k,navigate:r,replace:s,state:i,relative:d,preventScrollReset:u,viewTransition:f,unstable_defaultShouldRevalidate:h});p&&r!==!1?b.startTransition(()=>j()):j()};return b.createElement("form",{ref:x,method:N,action:y,onSubmit:a?c:S,...m,"data-discover":!v&&e==="render"?"true":void 0})});IA.displayName="Form";function LA(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Ey(e){let t=b.useContext(ui);return jt(t,LA(e)),t}function BA(e,{target:t,replace:r,state:a,preventScrollReset:s,relative:i,viewTransition:l,unstable_defaultShouldRevalidate:o,unstable_useTransitions:c}={}){let d=ca(),u=ga(),f=Jo(e,{relative:i});return b.useCallback(h=>{if(hA(h,t)){h.preventDefault();let m=r!==void 0?r:Mn(u)===Mn(f),x=()=>d(e,{replace:m,state:a,preventScrollReset:s,relative:i,viewTransition:l,unstable_defaultShouldRevalidate:o});c?b.startTransition(()=>x()):x()}},[u,d,f,r,a,t,e,s,i,l,o,c])}function zA(e){xr(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let t=b.useRef(s0(e)),r=b.useRef(!1),a=ga(),s=b.useMemo(()=>mA(a.search,r.current?null:t.current),[a.search]),i=ca(),l=b.useCallback((o,c)=>{const d=s0(typeof o=="function"?o(new URLSearchParams(s)):o);r.current=!0,i("?"+d,c)},[i,s]);return[s,l]}var UA=0,VA=()=>`__${String(++UA)}__`;function HA(){let{router:e}=Ey("useSubmit"),{basename:t}=b.useContext(Ca),r=qT(),a=e.fetch,s=e.navigate;return b.useCallback(async(i,l={})=>{let{action:o,method:c,encType:d,formData:u,body:f}=gA(i,t);if(l.navigate===!1){let h=l.fetcherKey||VA();await a(h,r,l.action||o,{unstable_defaultShouldRevalidate:l.unstable_defaultShouldRevalidate,preventScrollReset:l.preventScrollReset,formData:u,body:f,formMethod:l.method||c,formEncType:l.encType||d,flushSync:l.flushSync})}else await s(l.action||o,{unstable_defaultShouldRevalidate:l.unstable_defaultShouldRevalidate,preventScrollReset:l.preventScrollReset,formData:u,body:f,formMethod:l.method||c,formEncType:l.encType||d,replace:l.replace,state:l.state,fromRouteId:r,flushSync:l.flushSync,viewTransition:l.viewTransition})},[a,s,t,r])}function $A(e,{relative:t}={}){let{basename:r}=b.useContext(Ca),a=b.useContext(Xa);jt(a,"useFormAction must be used inside a RouteContext");let[s]=a.matches.slice(-1),i={...Jo(e||".",{relative:t})},l=ga();if(e==null){i.search=l.search;let o=new URLSearchParams(i.search),c=o.getAll("index");if(c.some(u=>u==="")){o.delete("index"),c.filter(f=>f).forEach(f=>o.append("index",f));let u=o.toString();i.search=u?`?${u}`:""}}return(!e||e===".")&&s.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(i.pathname=i.pathname==="/"?r:Fn([r,i.pathname])),Mn(i)}function KA(e,{relative:t}={}){let r=b.useContext(Ah);jt(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:a}=Ey("useViewTransitionState"),s=Jo(e,{relative:t});if(!r.isTransitioning)return!1;let i=Ga(r.currentLocation.pathname,a)||r.currentLocation.pathname,l=Ga(r.nextLocation.pathname,a)||r.nextLocation.pathname;return md(s.pathname,l)!=null||md(s.pathname,i)!=null}function WA(e){return b.createElement(sA,{flushSync:Zd.flushSync,...e})}function We(...e){return lS(X1(e))}function GA({...e}){return n.jsx("nav",{"aria-label":"breadcrumb","data-slot":"breadcrumb",...e})}function YA({className:e,...t}){return n.jsx("ol",{"data-slot":"breadcrumb-list",className:We("text-muted-foreground flex flex-wrap items-center gap-1.5 text-sm break-words sm:gap-2.5",e),...t})}function fp({className:e,...t}){return n.jsx("li",{"data-slot":"breadcrumb-item",className:We("inline-flex items-center gap-1.5",e),...t})}function XA({asChild:e,className:t,...r}){const a=e?Qs:"a";return n.jsx(a,{"data-slot":"breadcrumb-link",className:We("hover:text-foreground transition-colors",t),...r})}function qA({className:e,...t}){return n.jsx("span",{"data-slot":"breadcrumb-page",role:"link","aria-disabled":"true","aria-current":"page",className:We("text-foreground font-normal",e),...t})}function ZA({children:e,className:t,...r}){return n.jsx("li",{"data-slot":"breadcrumb-separator",role:"presentation","aria-hidden":"true",className:We("[&>svg]:size-3.5",t),...r,children:e??n.jsx(lo,{})})}function JA(){const e=ga(),r=(()=>{const a=e.pathname;return{"/":{label:"Dashboard"},"/create-offer":{label:"Teklif Olutur"},"/bulk-offer":{label:"Toplu Teklif Olutur"},"/my-offers":{label:"Tekliflerim"},"/approval":{label:"Onay Bekleyenler"},"/company":{label:"irket Ynetimi"},"/super-admin":{label:"Super Admin"},"/technical-analysis":{label:"Teknik Analiz"},"/my-sheets":{label:"Safihalarm"}}[a]||{label:"Sayfa"}})();return n.jsxs("header",{className:"h-16 border-b border-border bg-card flex items-center justify-between px-6",children:[n.jsx("div",{className:"flex items-center gap-4",children:n.jsx(GA,{children:n.jsxs(YA,{children:[n.jsx(fp,{children:n.jsx(XA,{href:"/",children:"Ana Sayfa"})}),e.pathname!=="/"&&n.jsxs(n.Fragment,{children:[n.jsx(ZA,{}),n.jsx(fp,{children:n.jsx(qA,{children:r.label})})]})]})})}),n.jsx("div",{className:"flex items-center gap-6",children:n.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[n.jsx(Yc,{size:8,fill:"var(--status-success)",stroke:"var(--status-success)"}),n.jsx("span",{className:"text-text-secondary",children:"Sistem Aktif"})]})})]})}const QA={apiKey:"AIzaSyCCfZ9vBp9Yu58kl5lVTIFtJX1JmDaX4vI",authDomain:"kolipacker.firebaseapp.com",projectId:"kolipacker",storageBucket:"kolipacker.firebasestorage.app",messagingSenderId:"1067407879909",appId:"1:1067407879909:web:8cc2d08db1803673a62e0c",measurementId:"G-DV54PLHD75"},Sy=cS(QA),wn=dS(Sy),ke=uS(Sy),Jt={SUPER_ADMIN:"super_admin",COMPANY_ADMIN:"company_admin",COMPANY_MEMBER:"company_member",INDIVIDUAL:"individual",PENDING_CORPORATE:"pending_corporate"},e_=[Jt.COMPANY_ADMIN,Jt.COMPANY_MEMBER,Jt.PENDING_CORPORATE];function Ty(e){return e_.includes(e)}function Hu(e){return e===Jt.SUPER_ADMIN}const t_=async e=>{try{const{companyCode:t,adminUid:r,name:a,expiresAt:s}=e,i=Be(ke,"companies",t);return await nr(i,{adminUid:r,name:a||"",isActive:!1,expiresAt:s,memberLimit:5,memberCount:1,createdAt:Ke(),updatedAt:Ke()}),t}catch(t){throw console.error("createCorporateCompany error:",t),t}},r_=async()=>{const e="ABCDEFGHJKLMNPQRSTUVWXYZ23456789";let t="",r=!1;for(;!r;){t="";for(let i=0;i<8;i++)t+=e.charAt(Math.floor(Math.random()*e.length)),i===3&&(t+="-");const a=Be(ke,"companies",t);(await hr(a)).exists()||(r=!0)}return t},$u=async e=>{try{const t=Be(ke,"users",e),r=await hr(t);if(!r.exists())return null;const a={id:r.id,...r.data()};return a.companyCode===null&&delete a.companyCode,a}catch(t){throw console.error("getUserData error:",t),t}},Ay=async(e,t)=>{try{const r=Be(ke,"users",e),a={...t,updatedAt:Ke()};await Ut(r,a)}catch(r){throw console.error("updateUserProfile error:",r),r}},_y=b.createContext(void 0),a_=3,n_=60*1e3,s_=60*1e3;function i_({children:e}){const[t,r]=b.useState(null),[a,s]=b.useState(null),[i,l]=b.useState(null),[o,c]=b.useState(!0),d=b.useRef(!1),[u,f]=b.useState(0),[h,m]=b.useState(0),[x,p]=b.useState(null),g=!!x&&Date.now()<x;b.useEffect(()=>{if(x){const k=setTimeout(()=>{p(null),f(0)},x-Date.now());return()=>clearTimeout(k)}},[x]);const y=()=>{const k=Date.now();if(x&&k<x){const j=Math.ceil((x-k)/1e3);throw new Error(`ok fazla deneme yapld. ${j} saniye sonra tekrar deneyin.`)}k-h>n_&&f(0)},N=()=>{const k=Date.now(),j=u+1;f(j),m(k),j>=a_&&p(k+s_)};b.useEffect(()=>{let k;const j=fS(wn,async w=>{d.current||(k&&(k(),k=void 0),w?(r(w),k=hS(Be(ke,"users",w.uid),E=>{const A=E.data();if(A){if(A.isActive!==!0){r(null),s(null),l(null),c(!1);return}s(A.role),l(A)}else r(w);c(!1)},E=>{console.error("Error listening to user profile:",E),c(!1)})):(r(null),s(null),l(null),c(!1)))});return()=>{j(),k&&k()}},[]);const v=async(k,j,w,E)=>{y();try{d.current=!0;const A=await xS(wn,k,j),D=A.user.uid,W=await $u(D);if(W&&W.isActive!==!0)throw await Rs(wn),new Error("yelik aktif deil. Ynetici onay bekleniyor.");if(w==="kurumsal"){if(!E)throw await Rs(wn),new Error("Kurumsal giri iin kurum kodu gereklidir.");if(!W)throw await Rs(wn),new Error("Kullanc kayd bulunamad.");if(!["company_admin","company_member","pending_corporate"].includes(W.role))throw await Rs(wn),new Error("Bu hesap kurumsal hesap deil. Ltfen bireysel giri yapn.");const U=E.trim().toUpperCase();if(W.companyCode!==U)throw await Rs(wn),new Error("Kurum kodu hatal. Ltfen doru kodu girin.")}else if(W){const re=["company_admin","company_member","pending_corporate"];if(W.planType==="corporate"||re.includes(W.role))throw await Rs(wn),new Error("Bu bir kurumsal hesaptr. Ltfen Kurumsal Giri sekmesini kullannz.")}r(A.user),W&&(s(W.role),l(W)),f(0),p(null)}catch(A){throw N(),A}finally{d.current=!1}},S=async k=>{y();try{d.current=!0;const w=(await mS(wn,k.email,k.password)).user;let E=null;if(k.accountType==="corporate")try{E=await r_()}catch{throw await w.delete(),new Error("Firma kodu retilemedi. Ltfen tekrar deneyin.")}let A=Jt.INDIVIDUAL;k.accountType==="corporate"&&(A=Jt.COMPANY_ADMIN);const D={fullName:k.fullName,email:k.email,phoneNumber:k.phoneNumber,accountType:k.accountType,plan:"free",subscriptionStatus:"none",createdAt:Ke(),updatedAt:Ke(),name:k.fullName,role:A,isActive:!0,planType:k.accountType,type:k.accountType,profileCompleted:!0,profileInfo:{phone:k.phoneNumber,companyName:k.companyName||""}};k.accountType==="corporate"&&k.companyName&&(D.companyName=k.companyName),k.accountType==="corporate"&&E&&(D.companyCode=E,D.companyId=E),await nr(Be(ke,"users",w.uid),D),k.accountType==="corporate"&&E&&await t_({companyCode:E,adminUid:w.uid,name:k.companyName||"Yeni Firma"});const W=await $u(w.uid);r(w),W&&(s(W.role),l(W)),f(0),p(null)}catch(j){throw N(),j}finally{d.current=!1}},_=async()=>{c(!0);try{if(t&&(i!=null&&i.activeSessionId))try{await Ay(t.uid,{activeSessionId:null,updatedAt:Ke()})}catch(k){console.error("Logout: Failed to clear session in DB",k)}await Rs(wn),r(null),s(null),l(null),window.location.assign("/")}catch(k){console.error("Logout error:",k),r(null),s(null),l(null),window.location.assign("/")}finally{c(!1)}},F=async()=>{if(t)try{const k=await $u(t.uid);k&&(s(k.role),l(k))}catch(k){console.error("Failed to refresh profile data:",k)}};return n.jsx(_y.Provider,{value:{user:t,userRole:a,userProfile:i,loading:o,login:v,register:S,logout:_,refreshProfile:F,isThrottled:g,throttleResetTime:x},children:e})}function vr(){const e=b.useContext(_y);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e}const st={FREE:"FREE",PRO:"PRO",ENTERPRISE:"ENTERPRISE"},ya={[st.FREE]:{offerLimit:20,memberLimit:2,calculationLimit:15,analysisLimit:5,features:{ocrEnabled:!1,excelExport:!1,advancedAnalytics:!1,bulkOfferEnabled:!1}},[st.PRO]:{offerLimit:1e4,memberLimit:100,calculationLimit:1e4,analysisLimit:1e4,features:{ocrEnabled:!0,excelExport:!0,advancedAnalytics:!0,bulkOfferEnabled:!0}},[st.ENTERPRISE]:{offerLimit:1e4,memberLimit:100,calculationLimit:1e4,analysisLimit:1e4,features:{ocrEnabled:!0,excelExport:!0,advancedAnalytics:!0,bulkOfferEnabled:!0}}},ps="/assets/logo-animated-D6TLHpGc.svg";function l_({collapsed:e,onToggle:t}){var d,u;const r=ga(),a=ca(),{userRole:s,userProfile:i,logout:l}=vr(),c=[{icon:bE,label:"Dashboard",path:"/"},{icon:ma,label:"Teklif Olutur",path:"/create-offer"},{icon:us,label:"Toplu Teklif",path:"/bulk-offer"},{icon:wE,label:"Tekliflerim",path:"/my-offers"},{icon:kE,label:"Teknik Analiz",path:"/technical-analysis"},{icon:N1,label:"Safihalarm",path:"/my-sheets"},{icon:NE,label:"Onay Bekleyenler",path:"/approval",visible:Ty(s)},{icon:tl,label:"irket Ynetimi",path:"/company",visible:s===Jt.COMPANY_ADMIN},{icon:hs,label:"Super Admin",path:"/super-admin",visible:Hu(s)},{icon:ma,label:"Teklif zleme",path:"/super-admin/offers",visible:Hu(s)},{icon:j1,label:"Hesapla zleme",path:"/super-admin/calculation-logs",visible:Hu(s)},{icon:tl,label:"Profil",path:"/profile",visible:!0},{icon:E1,label:"Ayarlar",path:"/settings",visible:!0}].filter(f=>f.visible===void 0?!0:f.visible);return n.jsxs("aside",{className:We("relative flex flex-col bg-card border-r border-sidebar-border transition-all duration-200",e?"w-16":"w-64"),children:[n.jsx("div",{className:We("flex items-center justify-center px-4 border-b border-border/40 relative",e?"h-16 py-3":"h-24"),children:e?n.jsx("div",{className:"flex items-center justify-center h-full w-full overflow-hidden",children:n.jsx("img",{src:ps,alt:"Ulgen One Logo",className:"h-14 w-auto max-w-none object-cover object-left",style:{objectPosition:"-2px center"}})}):n.jsx("img",{src:ps,alt:"Ulgen One Logo",className:"h-[6rem] w-auto max-w-full drop-shadow-md pb-1"})}),n.jsx("nav",{className:"flex-1 px-3 py-4 space-y-1 overflow-y-auto",children:c.map(f=>{const h=r.pathname===f.path,m=f.icon;return n.jsxs(At,{to:f.path,className:We("flex items-center gap-3 px-3 py-2.5 rounded-md transition-smooth text-sm","hover:bg-sidebar-accent",h?"bg-surface-secondary text-foreground font-black border-l-4 border-[var(--burgundy)]":"text-sidebar-foreground font-medium hover:text-foreground"),title:e?f.label:void 0,children:[n.jsx(m,{size:18,strokeWidth:h?2.5:2,className:"flex-shrink-0"}),!e&&n.jsx("span",{className:"uppercase tracking-tight text-xs",children:f.label})]},f.path)})}),n.jsx("button",{onClick:t,className:"absolute -right-3 top-20 w-6 h-6 rounded-full bg-card border border-sidebar-border shadow-sm flex items-center justify-center hover:bg-sidebar-accent transition-smooth",children:e?n.jsx(lo,{size:14}):n.jsx(jE,{size:14})}),((i==null?void 0:i.plan)||st.FREE)!==st.ENTERPRISE&&n.jsx("div",{className:We("p-4 border-t border-sidebar-border bg-sidebar-muted/30",e?"hidden":"block"),children:n.jsxs("div",{className:"bg-surface-secondary rounded-xl p-4 border border-border shadow-sm flex flex-col items-center text-center",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-[var(--burgundy)]/10 flex items-center justify-center mb-3",children:n.jsx(Xr,{className:"text-[var(--burgundy)] h-5 w-5"})}),n.jsx("h4",{className:"font-semibold text-sm mb-1 text-foreground",children:((i==null?void 0:i.plan)||st.FREE)===st.FREE?"cretsiz Plan":"Pro Plan"}),n.jsx("p",{className:"text-xs text-text-secondary mb-4",children:((i==null?void 0:i.plan)||st.FREE)===st.FREE?"Snrl zellikler, limitli hesaplama.":"Tm zellikler aktif."}),((i==null?void 0:i.plan)||st.FREE)===st.FREE&&n.jsxs("button",{onClick:()=>a("/upgrade"),className:"w-full bg-[var(--burgundy)] hover:bg-[var(--burgundy)]/90 text-white rounded-lg py-2.5 text-xs font-semibold transition-colors flex items-center justify-center gap-2",children:[n.jsx(EE,{size:14}),"Pro'ya Ge"]})]})}),n.jsx("div",{className:We("border-t border-sidebar-border/50",e?"p-2 space-y-2 flex flex-col items-center":"p-4"),children:e?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-[var(--burgundy)] to-red-900 flex items-center justify-center text-white font-bold text-sm shadow-md cursor-help",title:(i==null?void 0:i.name)||"Kullanc",children:((u=i==null?void 0:i.name)==null?void 0:u.charAt(0).toUpperCase())||"U"}),n.jsx("button",{onClick:l,className:"w-10 h-10 flex items-center justify-center text-text-secondary hover:text-status-error hover:bg-red-50 dark:hover:bg-red-950/30 rounded-xl transition-colors",title:"k Yap",children:n.jsx(Xf,{size:20})})]}):n.jsx("div",{className:"flex items-center justify-between bg-sidebar-muted p-2.5 rounded-xl border border-border/50",children:n.jsxs("div",{className:"flex items-center gap-3 w-full",children:[n.jsx("div",{className:"w-9 h-9 rounded-full bg-gradient-to-br from-[var(--burgundy)] to-red-900 flex items-center justify-center text-white font-bold text-sm shadow-md shrink-0",children:((d=i==null?void 0:i.name)==null?void 0:d.charAt(0).toUpperCase())||"U"}),n.jsxs("div",{className:"flex flex-col min-w-0 flex-1",children:[n.jsx("span",{className:"text-sm font-semibold truncate text-foreground",children:(i==null?void 0:i.name)||"Kullanc"}),n.jsx("span",{className:"text-[10px] text-text-tertiary truncate uppercase tracking-wider",children:s==null?void 0:s.replace("_"," ")})]}),n.jsx("button",{onClick:l,className:"p-2 text-text-secondary hover:text-status-error hover:bg-red-50 dark:hover:bg-red-950/30 rounded-lg transition-colors ml-1 shrink-0",title:"k Yap",children:n.jsx(Xf,{size:18})})]})})})]})}var o_=(e,t,r,a,s,i,l,o)=>{let c=document.documentElement,d=["light","dark"];function u(m){(Array.isArray(e)?e:[e]).forEach(x=>{let p=x==="class",g=p&&i?s.map(y=>i[y]||y):s;p?(c.classList.remove(...g),c.classList.add(i&&i[m]?i[m]:m)):c.setAttribute(x,m)}),f(m)}function f(m){o&&d.includes(m)&&(c.style.colorScheme=m)}function h(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}if(a)u(a);else try{let m=localStorage.getItem(t)||r,x=l&&m==="system"?h():m;u(x)}catch{}},c_=b.createContext(void 0),d_={setTheme:e=>{},themes:[]},u_=()=>{var e;return(e=b.useContext(c_))!=null?e:d_};b.memo(({forcedTheme:e,storageKey:t,attribute:r,enableSystem:a,enableColorScheme:s,defaultTheme:i,value:l,themes:o,nonce:c,scriptProps:d})=>{let u=JSON.stringify([r,t,i,e,o,l,a,s]).slice(1,-1);return b.createElement("script",{...d,suppressHydrationWarning:!0,nonce:typeof window>"u"?c:"",dangerouslySetInnerHTML:{__html:`(${o_.toString()})(${u})`}})});function f_(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}const h_=e=>{switch(e){case"success":return p_;case"info":return v_;case"warning":return g_;case"error":return y_;default:return null}},m_=Array(12).fill(0),x_=({visible:e,className:t})=>me.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},me.createElement("div",{className:"sonner-spinner"},m_.map((r,a)=>me.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${a}`})))),p_=me.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},me.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),g_=me.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},me.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),v_=me.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},me.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),y_=me.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},me.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),b_=me.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},me.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),me.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),w_=()=>{const[e,t]=me.useState(document.hidden);return me.useEffect(()=>{const r=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),e};let i0=1;class k_{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{const r=this.subscribers.indexOf(t);this.subscribers.splice(r,1)}),this.publish=t=>{this.subscribers.forEach(r=>r(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var r;const{message:a,...s}=t,i=typeof(t==null?void 0:t.id)=="number"||((r=t.id)==null?void 0:r.length)>0?t.id:i0++,l=this.toasts.find(c=>c.id===i),o=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(i)&&this.dismissedToasts.delete(i),l?this.toasts=this.toasts.map(c=>c.id===i?(this.publish({...c,...t,id:i,title:a}),{...c,...t,id:i,dismissible:o,title:a}):c):this.addToast({title:a,...s,dismissible:o,id:i}),i},this.dismiss=t=>(t?(this.dismissedToasts.add(t),requestAnimationFrame(()=>this.subscribers.forEach(r=>r({id:t,dismiss:!0})))):this.toasts.forEach(r=>{this.subscribers.forEach(a=>a({id:r.id,dismiss:!0}))}),t),this.message=(t,r)=>this.create({...r,message:t}),this.error=(t,r)=>this.create({...r,message:t,type:"error"}),this.success=(t,r)=>this.create({...r,type:"success",message:t}),this.info=(t,r)=>this.create({...r,type:"info",message:t}),this.warning=(t,r)=>this.create({...r,type:"warning",message:t}),this.loading=(t,r)=>this.create({...r,type:"loading",message:t}),this.promise=(t,r)=>{if(!r)return;let a;r.loading!==void 0&&(a=this.create({...r,promise:t,type:"loading",message:r.loading,description:typeof r.description!="function"?r.description:void 0}));const s=Promise.resolve(t instanceof Function?t():t);let i=a!==void 0,l;const o=s.then(async d=>{if(l=["resolve",d],me.isValidElement(d))i=!1,this.create({id:a,type:"default",message:d});else if(j_(d)&&!d.ok){i=!1;const f=typeof r.error=="function"?await r.error(`HTTP error! status: ${d.status}`):r.error,h=typeof r.description=="function"?await r.description(`HTTP error! status: ${d.status}`):r.description,x=typeof f=="object"&&!me.isValidElement(f)?f:{message:f};this.create({id:a,type:"error",description:h,...x})}else if(d instanceof Error){i=!1;const f=typeof r.error=="function"?await r.error(d):r.error,h=typeof r.description=="function"?await r.description(d):r.description,x=typeof f=="object"&&!me.isValidElement(f)?f:{message:f};this.create({id:a,type:"error",description:h,...x})}else if(r.success!==void 0){i=!1;const f=typeof r.success=="function"?await r.success(d):r.success,h=typeof r.description=="function"?await r.description(d):r.description,x=typeof f=="object"&&!me.isValidElement(f)?f:{message:f};this.create({id:a,type:"success",description:h,...x})}}).catch(async d=>{if(l=["reject",d],r.error!==void 0){i=!1;const u=typeof r.error=="function"?await r.error(d):r.error,f=typeof r.description=="function"?await r.description(d):r.description,m=typeof u=="object"&&!me.isValidElement(u)?u:{message:u};this.create({id:a,type:"error",description:f,...m})}}).finally(()=>{i&&(this.dismiss(a),a=void 0),r.finally==null||r.finally.call(r)}),c=()=>new Promise((d,u)=>o.then(()=>l[0]==="reject"?u(l[1]):d(l[1])).catch(u));return typeof a!="string"&&typeof a!="number"?{unwrap:c}:Object.assign(a,{unwrap:c})},this.custom=(t,r)=>{const a=(r==null?void 0:r.id)||i0++;return this.create({jsx:t(a),id:a,...r}),a},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const ua=new k_,N_=(e,t)=>{const r=(t==null?void 0:t.id)||i0++;return ua.addToast({title:e,...t,id:r}),r},j_=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",E_=N_,S_=()=>ua.toasts,T_=()=>ua.getActiveToasts(),xe=Object.assign(E_,{success:ua.success,info:ua.info,warning:ua.warning,error:ua.error,custom:ua.custom,message:ua.message,promise:ua.promise,dismiss:ua.dismiss,loading:ua.loading},{getHistory:S_,getToasts:T_});f_("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}[data-sonner-toaster][data-lifted=true]{transform:translateY(-8px)}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function kc(e){return e.label!==void 0}const A_=3,__="24px",C_="16px",hp=4e3,F_=356,D_=14,R_=45,M_=200;function kn(...e){return e.filter(Boolean).join(" ")}function P_(e){const[t,r]=e.split("-"),a=[];return t&&a.push(t),r&&a.push(r),a}const O_=e=>{var t,r,a,s,i,l,o,c,d;const{invert:u,toast:f,unstyled:h,interacting:m,setHeights:x,visibleToasts:p,heights:g,index:y,toasts:N,expanded:v,removeToast:S,defaultRichColors:_,closeButton:F,style:k,cancelButtonStyle:j,actionButtonStyle:w,className:E="",descriptionClassName:A="",duration:D,position:W,gap:re,expandByDefault:U,classNames:M,icons:Y,closeButtonAriaLabel:Q="Close toast"}=e,[B,V]=me.useState(null),[P,T]=me.useState(null),[R,L]=me.useState(!1),[X,J]=me.useState(!1),[te,G]=me.useState(!1),[Z,ae]=me.useState(!1),[de,z]=me.useState(!1),[Ee,ue]=me.useState(0),[Ce,ve]=me.useState(0),ge=me.useRef(f.duration||D||hp),Fe=me.useRef(null),Ie=me.useRef(null),Ze=y===0,yt=y+1<=p,ht=f.type,Ct=f.dismissible!==!1,Ue=f.className||"",kt=f.descriptionClassName||"",qe=me.useMemo(()=>g.findIndex(Ye=>Ye.toastId===f.id)||0,[g,f.id]),Ft=me.useMemo(()=>{var Ye;return(Ye=f.closeButton)!=null?Ye:F},[f.closeButton,F]),Qe=me.useMemo(()=>f.duration||D||hp,[f.duration,D]),bt=me.useRef(0),se=me.useRef(0),Ne=me.useRef(0),De=me.useRef(null),[lt,Rt]=W.split("-"),_r=me.useMemo(()=>g.reduce((Ye,Ae,_e)=>_e>=qe?Ye:Ye+Ae.height,0),[g,qe]),Hr=w_(),Et=f.invert||u,Fa=ht==="loading";se.current=me.useMemo(()=>qe*re+_r,[qe,_r]),me.useEffect(()=>{ge.current=Qe},[Qe]),me.useEffect(()=>{L(!0)},[]),me.useEffect(()=>{const Ye=Ie.current;if(Ye){const Ae=Ye.getBoundingClientRect().height;return ve(Ae),x(_e=>[{toastId:f.id,height:Ae,position:f.position},..._e]),()=>x(_e=>_e.filter($e=>$e.toastId!==f.id))}},[x,f.id]),me.useLayoutEffect(()=>{if(!R)return;const Ye=Ie.current,Ae=Ye.style.height;Ye.style.height="auto";const _e=Ye.getBoundingClientRect().height;Ye.style.height=Ae,ve(_e),x($e=>$e.find(xt=>xt.toastId===f.id)?$e.map(xt=>xt.toastId===f.id?{...xt,height:_e}:xt):[{toastId:f.id,height:_e,position:f.position},...$e])},[R,f.title,f.description,x,f.id]);const He=me.useCallback(()=>{J(!0),ue(se.current),x(Ye=>Ye.filter(Ae=>Ae.toastId!==f.id)),setTimeout(()=>{S(f)},M_)},[f,S,x,se]);me.useEffect(()=>{if(f.promise&&ht==="loading"||f.duration===1/0||f.type==="loading")return;let Ye;return v||m||Hr?(()=>{if(Ne.current<bt.current){const $e=new Date().getTime()-bt.current;ge.current=ge.current-$e}Ne.current=new Date().getTime()})():(()=>{ge.current!==1/0&&(bt.current=new Date().getTime(),Ye=setTimeout(()=>{f.onAutoClose==null||f.onAutoClose.call(f,f),He()},ge.current))})(),()=>clearTimeout(Ye)},[v,m,f,ht,Hr,He]),me.useEffect(()=>{f.delete&&He()},[He,f.delete]);function gt(){var Ye;if(Y!=null&&Y.loading){var Ae;return me.createElement("div",{className:kn(M==null?void 0:M.loader,f==null||(Ae=f.classNames)==null?void 0:Ae.loader,"sonner-loader"),"data-visible":ht==="loading"},Y.loading)}return me.createElement(x_,{className:kn(M==null?void 0:M.loader,f==null||(Ye=f.classNames)==null?void 0:Ye.loader),visible:ht==="loading"})}const Dt=f.icon||(Y==null?void 0:Y[ht])||h_(ht);var mt,Pt;return me.createElement("li",{tabIndex:0,ref:Ie,className:kn(E,Ue,M==null?void 0:M.toast,f==null||(t=f.classNames)==null?void 0:t.toast,M==null?void 0:M.default,M==null?void 0:M[ht],f==null||(r=f.classNames)==null?void 0:r[ht]),"data-sonner-toast":"","data-rich-colors":(mt=f.richColors)!=null?mt:_,"data-styled":!(f.jsx||f.unstyled||h),"data-mounted":R,"data-promise":!!f.promise,"data-swiped":de,"data-removed":X,"data-visible":yt,"data-y-position":lt,"data-x-position":Rt,"data-index":y,"data-front":Ze,"data-swiping":te,"data-dismissible":Ct,"data-type":ht,"data-invert":Et,"data-swipe-out":Z,"data-swipe-direction":P,"data-expanded":!!(v||U&&R),style:{"--index":y,"--toasts-before":y,"--z-index":N.length-y,"--offset":`${X?Ee:se.current}px`,"--initial-height":U?"auto":`${Ce}px`,...k,...f.style},onDragEnd:()=>{G(!1),V(null),De.current=null},onPointerDown:Ye=>{Fa||!Ct||(Fe.current=new Date,ue(se.current),Ye.target.setPointerCapture(Ye.pointerId),Ye.target.tagName!=="BUTTON"&&(G(!0),De.current={x:Ye.clientX,y:Ye.clientY}))},onPointerUp:()=>{var Ye,Ae,_e;if(Z||!Ct)return;De.current=null;const $e=Number(((Ye=Ie.current)==null?void 0:Ye.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Ge=Number(((Ae=Ie.current)==null?void 0:Ae.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),xt=new Date().getTime()-((_e=Fe.current)==null?void 0:_e.getTime()),nt=B==="x"?$e:Ge,rr=Math.abs(nt)/xt;if(Math.abs(nt)>=R_||rr>.11){ue(se.current),f.onDismiss==null||f.onDismiss.call(f,f),T(B==="x"?$e>0?"right":"left":Ge>0?"down":"up"),He(),ae(!0);return}else{var ee,ne;(ee=Ie.current)==null||ee.style.setProperty("--swipe-amount-x","0px"),(ne=Ie.current)==null||ne.style.setProperty("--swipe-amount-y","0px")}z(!1),G(!1),V(null)},onPointerMove:Ye=>{var Ae,_e,$e;if(!De.current||!Ct||((Ae=window.getSelection())==null?void 0:Ae.toString().length)>0)return;const xt=Ye.clientY-De.current.y,nt=Ye.clientX-De.current.x;var rr;const ee=(rr=e.swipeDirections)!=null?rr:P_(W);!B&&(Math.abs(nt)>1||Math.abs(xt)>1)&&V(Math.abs(nt)>Math.abs(xt)?"x":"y");let ne={x:0,y:0};const he=ye=>1/(1.5+Math.abs(ye)/20);if(B==="y"){if(ee.includes("top")||ee.includes("bottom"))if(ee.includes("top")&&xt<0||ee.includes("bottom")&&xt>0)ne.y=xt;else{const ye=xt*he(xt);ne.y=Math.abs(ye)<Math.abs(xt)?ye:xt}}else if(B==="x"&&(ee.includes("left")||ee.includes("right")))if(ee.includes("left")&&nt<0||ee.includes("right")&&nt>0)ne.x=nt;else{const ye=nt*he(nt);ne.x=Math.abs(ye)<Math.abs(nt)?ye:nt}(Math.abs(ne.x)>0||Math.abs(ne.y)>0)&&z(!0),(_e=Ie.current)==null||_e.style.setProperty("--swipe-amount-x",`${ne.x}px`),($e=Ie.current)==null||$e.style.setProperty("--swipe-amount-y",`${ne.y}px`)}},Ft&&!f.jsx&&ht!=="loading"?me.createElement("button",{"aria-label":Q,"data-disabled":Fa,"data-close-button":!0,onClick:Fa||!Ct?()=>{}:()=>{He(),f.onDismiss==null||f.onDismiss.call(f,f)},className:kn(M==null?void 0:M.closeButton,f==null||(a=f.classNames)==null?void 0:a.closeButton)},(Pt=Y==null?void 0:Y.close)!=null?Pt:b_):null,(ht||f.icon||f.promise)&&f.icon!==null&&((Y==null?void 0:Y[ht])!==null||f.icon)?me.createElement("div",{"data-icon":"",className:kn(M==null?void 0:M.icon,f==null||(s=f.classNames)==null?void 0:s.icon)},f.promise||f.type==="loading"&&!f.icon?f.icon||gt():null,f.type!=="loading"?Dt:null):null,me.createElement("div",{"data-content":"",className:kn(M==null?void 0:M.content,f==null||(i=f.classNames)==null?void 0:i.content)},me.createElement("div",{"data-title":"",className:kn(M==null?void 0:M.title,f==null||(l=f.classNames)==null?void 0:l.title)},f.jsx?f.jsx:typeof f.title=="function"?f.title():f.title),f.description?me.createElement("div",{"data-description":"",className:kn(A,kt,M==null?void 0:M.description,f==null||(o=f.classNames)==null?void 0:o.description)},typeof f.description=="function"?f.description():f.description):null),me.isValidElement(f.cancel)?f.cancel:f.cancel&&kc(f.cancel)?me.createElement("button",{"data-button":!0,"data-cancel":!0,style:f.cancelButtonStyle||j,onClick:Ye=>{kc(f.cancel)&&Ct&&(f.cancel.onClick==null||f.cancel.onClick.call(f.cancel,Ye),He())},className:kn(M==null?void 0:M.cancelButton,f==null||(c=f.classNames)==null?void 0:c.cancelButton)},f.cancel.label):null,me.isValidElement(f.action)?f.action:f.action&&kc(f.action)?me.createElement("button",{"data-button":!0,"data-action":!0,style:f.actionButtonStyle||w,onClick:Ye=>{kc(f.action)&&(f.action.onClick==null||f.action.onClick.call(f.action,Ye),!Ye.defaultPrevented&&He())},className:kn(M==null?void 0:M.actionButton,f==null||(d=f.classNames)==null?void 0:d.actionButton)},f.action.label):null)};function mp(){if(typeof window>"u"||typeof document>"u")return"ltr";const e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function I_(e,t){const r={};return[e,t].forEach((a,s)=>{const i=s===1,l=i?"--mobile-offset":"--offset",o=i?C_:__;function c(d){["top","right","bottom","left"].forEach(u=>{r[`${l}-${u}`]=typeof d=="number"?`${d}px`:d})}typeof a=="number"||typeof a=="string"?c(a):typeof a=="object"?["top","right","bottom","left"].forEach(d=>{a[d]===void 0?r[`${l}-${d}`]=o:r[`${l}-${d}`]=typeof a[d]=="number"?`${a[d]}px`:a[d]}):c(o)}),r}const L_=me.forwardRef(function(t,r){const{invert:a,position:s="bottom-right",hotkey:i=["altKey","KeyT"],expand:l,closeButton:o,className:c,offset:d,mobileOffset:u,theme:f="light",richColors:h,duration:m,style:x,visibleToasts:p=A_,toastOptions:g,dir:y=mp(),gap:N=D_,icons:v,containerAriaLabel:S="Notifications"}=t,[_,F]=me.useState([]),k=me.useMemo(()=>Array.from(new Set([s].concat(_.filter(P=>P.position).map(P=>P.position)))),[_,s]),[j,w]=me.useState([]),[E,A]=me.useState(!1),[D,W]=me.useState(!1),[re,U]=me.useState(f!=="system"?f:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),M=me.useRef(null),Y=i.join("+").replace(/Key/g,"").replace(/Digit/g,""),Q=me.useRef(null),B=me.useRef(!1),V=me.useCallback(P=>{F(T=>{var R;return(R=T.find(L=>L.id===P.id))!=null&&R.delete||ua.dismiss(P.id),T.filter(({id:L})=>L!==P.id)})},[]);return me.useEffect(()=>ua.subscribe(P=>{if(P.dismiss){requestAnimationFrame(()=>{F(T=>T.map(R=>R.id===P.id?{...R,delete:!0}:R))});return}setTimeout(()=>{tS.flushSync(()=>{F(T=>{const R=T.findIndex(L=>L.id===P.id);return R!==-1?[...T.slice(0,R),{...T[R],...P},...T.slice(R+1)]:[P,...T]})})})}),[_]),me.useEffect(()=>{if(f!=="system"){U(f);return}if(f==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?U("dark"):U("light")),typeof window>"u")return;const P=window.matchMedia("(prefers-color-scheme: dark)");try{P.addEventListener("change",({matches:T})=>{U(T?"dark":"light")})}catch{P.addListener(({matches:R})=>{try{U(R?"dark":"light")}catch(L){console.error(L)}})}},[f]),me.useEffect(()=>{_.length<=1&&A(!1)},[_]),me.useEffect(()=>{const P=T=>{var R;if(i.every(J=>T[J]||T.code===J)){var X;A(!0),(X=M.current)==null||X.focus()}T.code==="Escape"&&(document.activeElement===M.current||(R=M.current)!=null&&R.contains(document.activeElement))&&A(!1)};return document.addEventListener("keydown",P),()=>document.removeEventListener("keydown",P)},[i]),me.useEffect(()=>{if(M.current)return()=>{Q.current&&(Q.current.focus({preventScroll:!0}),Q.current=null,B.current=!1)}},[M.current]),me.createElement("section",{ref:r,"aria-label":`${S} ${Y}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},k.map((P,T)=>{var R;const[L,X]=P.split("-");return _.length?me.createElement("ol",{key:P,dir:y==="auto"?mp():y,tabIndex:-1,ref:M,className:c,"data-sonner-toaster":!0,"data-sonner-theme":re,"data-y-position":L,"data-lifted":E&&_.length>1&&!l,"data-x-position":X,style:{"--front-toast-height":`${((R=j[0])==null?void 0:R.height)||0}px`,"--width":`${F_}px`,"--gap":`${N}px`,...x,...I_(d,u)},onBlur:J=>{B.current&&!J.currentTarget.contains(J.relatedTarget)&&(B.current=!1,Q.current&&(Q.current.focus({preventScroll:!0}),Q.current=null))},onFocus:J=>{J.target instanceof HTMLElement&&J.target.dataset.dismissible==="false"||B.current||(B.current=!0,Q.current=J.relatedTarget)},onMouseEnter:()=>A(!0),onMouseMove:()=>A(!0),onMouseLeave:()=>{D||A(!1)},onDragEnd:()=>A(!1),onPointerDown:J=>{J.target instanceof HTMLElement&&J.target.dataset.dismissible==="false"||W(!0)},onPointerUp:()=>W(!1)},_.filter(J=>!J.position&&T===0||J.position===P).map((J,te)=>{var G,Z;return me.createElement(O_,{key:J.id,icons:v,index:te,toast:J,defaultRichColors:h,duration:(G=g==null?void 0:g.duration)!=null?G:m,className:g==null?void 0:g.className,descriptionClassName:g==null?void 0:g.descriptionClassName,invert:a,visibleToasts:p,closeButton:(Z=g==null?void 0:g.closeButton)!=null?Z:o,interacting:D,position:P,style:g==null?void 0:g.style,unstyled:g==null?void 0:g.unstyled,classNames:g==null?void 0:g.classNames,cancelButtonStyle:g==null?void 0:g.cancelButtonStyle,actionButtonStyle:g==null?void 0:g.actionButtonStyle,closeButtonAriaLabel:g==null?void 0:g.closeButtonAriaLabel,removeToast:V,toasts:_.filter(ae=>ae.position==J.position),heights:j.filter(ae=>ae.position==J.position),setHeights:w,expandByDefault:l,gap:N,expanded:E,swipeDirections:t.swipeDirections})})):null}))}),au=({...e})=>{const{theme:t="system"}=u_();return n.jsx(L_,{theme:t,className:"toaster group",style:{"--normal-bg":"var(--popover)","--normal-text":"var(--popover-foreground)","--normal-border":"var(--border)"},...e})},xp=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,pp=X1,Cy=(e,t)=>r=>{var a;if((t==null?void 0:t.variants)==null)return pp(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:s,defaultVariants:i}=t,l=Object.keys(s).map(d=>{const u=r==null?void 0:r[d],f=i==null?void 0:i[d];if(u===null)return null;const h=xp(u)||xp(f);return s[d][h]}),o=r&&Object.entries(r).reduce((d,u)=>{let[f,h]=u;return h===void 0||(d[f]=h),d},{}),c=t==null||(a=t.compoundVariants)===null||a===void 0?void 0:a.reduce((d,u)=>{let{class:f,className:h,...m}=u;return Object.entries(m).every(x=>{let[p,g]=x;return Array.isArray(g)?g.includes({...i,...o}[p]):{...i,...o}[p]===g})?[...d,f,h]:d},[]);return pp(e,l,c,r==null?void 0:r.class,r==null?void 0:r.className)},B_=Cy("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function ut({className:e,variant:t,asChild:r=!1,...a}){const s=r?Qs:"span";return n.jsx(s,{"data-slot":"badge",className:We(B_({variant:t}),e),...a})}const z_=Cy("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background text-foreground hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9 rounded-md"}},defaultVariants:{variant:"default",size:"default"}}),Re=b.forwardRef(({className:e,variant:t,size:r,asChild:a=!1,...s},i)=>{const l=a?Qs:"button";return n.jsx(l,{"data-slot":"button",className:We(z_({variant:t,size:r,className:e})),ref:i,...s})});Re.displayName="Button";function tt({className:e,...t}){return n.jsx("div",{"data-slot":"card",className:We("bg-card text-card-foreground flex flex-col gap-6 rounded-md border-2 border-border/60 shadow-sm",e),...t})}function Fy({className:e,...t}){return n.jsx("div",{"data-slot":"card-header",className:We("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 pt-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...t})}function Dy({className:e,...t}){return n.jsx("h4",{"data-slot":"card-title",className:We("leading-none",e),...t})}function xd({className:e,...t}){return n.jsx("div",{"data-slot":"card-content",className:We("px-6 [&:last-child]:pb-6",e),...t})}function U_(){const{user:e,userProfile:t,refreshProfile:r}=vr(),a=ca(),[s,i]=b.useState(1),[l,o]=b.useState(!1),[c,d]=b.useState(!1);b.useEffect(()=>{e&&t&&t.profileCompleted===!0&&t.onboardingCompleted!==!0?o(!0):o(!1)},[e,t]);const u=async()=>{if(e){d(!0);try{await nr(Be(ke,"users",e.uid),{onboardingCompleted:!0},{merge:!0}),r&&await r(),o(!1)}catch(f){console.error(f)}finally{d(!1)}}};return l?n.jsx("div",{className:"fixed inset-0 z-[100] bg-black/60 backdrop-blur-sm flex items-center justify-center p-4",children:n.jsxs("div",{className:"bg-white w-full max-w-2xl rounded-2xl shadow-[0_20px_50px_rgba(0,0,0,0.3)] border border-gray-100 overflow-hidden animate-in fade-in zoom-in duration-300 flex flex-col",children:[n.jsxs("div",{className:"p-5 flex items-center justify-between bg-white border-b border-gray-100",children:[n.jsxs("div",{className:"text-sm font-medium text-gray-500 flex items-center gap-2",children:[n.jsxs("span",{className:"text-[var(--burgundy)] font-bold",children:["Adm ",s]}),n.jsx("span",{className:"text-gray-300 mx-1",children:"/"}),n.jsx("span",{className:"text-gray-600",children:"4"})]}),n.jsx("div",{className:"flex gap-2",children:[1,2,3,4].map(f=>n.jsx("div",{className:`h-1.5 w-8 rounded-full transition-colors duration-300 ${s>=f?"bg-[var(--burgundy)]":"bg-gray-200"}`},f))})]}),n.jsxs("div",{className:"p-8 min-h-[340px] flex flex-col justify-center bg-white",children:[s===1&&n.jsxs("div",{className:"text-center space-y-6 animate-in slide-in-from-right-8 duration-500",children:[n.jsx("div",{className:"w-24 h-24 bg-[var(--burgundy)]/10 text-[var(--burgundy)] rounded-full flex items-center justify-center mx-auto mb-6 shadow-inner",children:n.jsx(cn,{size:44,strokeWidth:1.5,className:"ml-1"})}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("h2",{className:"text-4xl font-extrabold text-gray-900 tracking-tight",children:["Ulgen One'a",n.jsx("br",{}),n.jsx("span",{className:"text-[var(--burgundy)]",children:"Ho Geldiniz"})]}),n.jsx("p",{className:"text-lg text-gray-500 max-w-md mx-auto leading-relaxed",children:"Trkiye'nin en gelimi ambalaj retim ve teklif ynetim platformuna adm attnz."})]})]}),s===2&&n.jsxs("div",{className:"space-y-8 animate-in slide-in-from-right-8 duration-500 max-w-lg mx-auto w-full",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Hzl Demo Hesap"}),n.jsx("p",{className:"text-gray-600",children:"Bu rnek zerinden sistemin nasl altn inceleyebilirsiniz."})]}),n.jsxs(tt,{className:"p-0 border-gray-200 shadow-xl bg-white relative overflow-hidden flex flex-col",children:[n.jsxs("div",{className:"bg-gray-900 text-white p-4 flex justify-between items-center",children:[n.jsx("span",{className:"text-xs font-bold uppercase tracking-widest opacity-80",children:"Teknik Analiz Raporu (Demo)"}),n.jsx(ut,{className:"bg-[var(--burgundy)] text-white border-0",children:"A-1 Koli"})]}),n.jsxs("div",{className:"p-6 space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-1",children:[n.jsx("p",{className:"text-[10px] text-gray-400 uppercase font-bold tracking-tighter",children:"Koli lleri"}),n.jsxs("div",{className:"flex items-baseline gap-1",children:[n.jsx("span",{className:"text-2xl font-black text-gray-900",children:"60"}),n.jsx("span",{className:"text-xs text-gray-500 font-medium",children:"x"}),n.jsx("span",{className:"text-2xl font-black text-gray-900",children:"40"}),n.jsx("span",{className:"text-xs text-gray-500 font-medium",children:"x"}),n.jsx("span",{className:"text-2xl font-black text-gray-900",children:"40"}),n.jsx("span",{className:"text-xs text-gray-400 ml-1",children:"cm"})]})]}),n.jsxs("div",{className:"space-y-1 text-right",children:[n.jsx("p",{className:"text-[10px] text-gray-400 uppercase font-bold tracking-tighter",children:"Sipari Miktar"}),n.jsxs("p",{className:"text-2xl font-black text-[var(--burgundy)]",children:["500 ",n.jsx("span",{className:"text-xs font-medium opacity-60",children:"Adet"})]})]})]}),n.jsx("div",{className:"h-px bg-gray-100"}),n.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex justify-between items-end border-b border-gray-50 pb-1",children:[n.jsx("span",{className:"text-[11px] text-gray-500 font-medium",children:"Safiha ls:"}),n.jsx("span",{className:"text-xs font-bold text-gray-800",children:"2040 x 800 mm"})]}),n.jsxs("div",{className:"flex justify-between items-end border-b border-gray-50 pb-1",children:[n.jsx("span",{className:"text-[11px] text-gray-500 font-medium",children:"Boy Rilleri:"}),n.jsx("span",{className:"text-xs font-bold text-gray-800",children:"200 + 400 + 400 + 400 + 200 mm"})]}),n.jsxs("div",{className:"flex justify-between items-end border-b border-gray-50 pb-1",children:[n.jsx("span",{className:"text-[11px] text-gray-500 font-medium",children:"En Rilleri:"}),n.jsx("span",{className:"text-xs font-bold text-gray-800",children:"200 + 400 + 200 mm"})]})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex justify-between items-end border-b border-gray-50 pb-1",children:[n.jsx("span",{className:"text-[11px] text-gray-500 font-medium",children:"m Birim Fiyat:"}),n.jsx("span",{className:"text-xs font-bold text-status-info",children:"18.50"})]}),n.jsxs("div",{className:"flex justify-between items-end border-b border-gray-50 pb-1",children:[n.jsx("span",{className:"text-[11px] text-gray-500 font-medium",children:"Toplam m:"}),n.jsx("span",{className:"text-xs font-bold text-gray-800",children:"1.632 m"})]}),n.jsxs("div",{className:"flex justify-between items-end border-b border-gray-50 pb-1",children:[n.jsx("span",{className:"text-[11px] text-gray-500 font-medium",children:"Fire Oran:"}),n.jsx("span",{className:"text-xs font-bold text-status-warning",children:"%6.2"})]})]})]}),n.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 flex justify-between items-center border border-gray-100",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-[10px] text-gray-400 uppercase font-black tracking-widest",children:"Birim Sat Fiyat"}),n.jsxs("p",{className:"text-2xl font-black text-gray-900",children:["34.82 ",n.jsx("span",{className:"text-[10px] font-medium text-gray-400",children:"+ KDV"})]})]}),n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"text-[10px] text-gray-400 uppercase font-black tracking-widest",children:"Toplam Tutar"}),n.jsx("p",{className:"text-xl font-bold text-[var(--burgundy)]",children:"17,410.00"})]})]})]})]})]}),s===3&&n.jsxs("div",{className:"text-center space-y-6 animate-in slide-in-from-right-8 duration-500",children:[n.jsx("div",{className:"w-20 h-20 bg-[var(--burgundy)]/10 text-[var(--burgundy)] rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(is,{size:40})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-3",children:"lk Teklif"}),n.jsx("p",{className:"text-lg text-gray-600 max-w-md mx-auto",children:"Hesaplama motorumuz test edildiinde nasl altn grdnz. imdi kendi gerek llerinizle ilk teklifinizi oluturmann tam zaman."})]})]}),s===4&&n.jsxs("div",{className:"text-center space-y-8 animate-in slide-in-from-right-8 duration-500 max-w-lg mx-auto",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"leri Seviye Optimizasyonlar"}),n.jsx("p",{className:"text-gray-600 mb-6",children:"Platformu daha verimli kullanmak iin bu opsiyonel zellikleri kefedebilirsiniz:"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs(tt,{className:"p-4 border-gray-200 shadow-sm hover:border-[var(--burgundy)]/50 transition-colors text-left group",children:[n.jsx("div",{className:"w-10 h-10 rounded bg-[#E4002B]/10 flex items-center justify-center mb-3",children:n.jsx(cn,{size:20,className:"text-[#E4002B]"})}),n.jsx("h4",{className:"font-bold text-gray-900 text-sm mb-1 group-hover:text-[var(--burgundy)] transition-colors",children:"Safiha Ekleme"}),n.jsx("p",{className:"text-xs text-gray-500 leading-relaxed",children:"Kartondaki fire orann en aza indirmek iin kendi safiha stounuzu tanmlayn."})]}),n.jsxs(tt,{className:"p-4 border-gray-200 shadow-sm hover:border-[var(--burgundy)]/50 transition-colors text-left group",children:[n.jsx("div",{className:"w-10 h-10 rounded bg-[#E4002B]/10 flex items-center justify-center mb-3",children:n.jsx(is,{size:20,className:"text-[#E4002B]"})}),n.jsx("h4",{className:"font-bold text-gray-900 text-sm mb-1 group-hover:text-[var(--burgundy)] transition-colors",children:"Fiyat Listesi"}),n.jsx("p",{className:"text-xs text-gray-500 leading-relaxed",children:"Size zel m birim fiyatlarnz kolaylkla Excel dosyasndan ie aktarn."})]})]})]})]}),n.jsxs("div",{className:"p-6 border-t border-gray-100 bg-gray-50 flex items-center justify-between mt-auto",children:[s===1?n.jsx(Re,{variant:"ghost",className:"text-gray-500 hover:text-gray-900 hover:bg-gray-200",onClick:u,disabled:c,children:"imdilik Ge"}):n.jsx(Re,{variant:"outline",className:"border-gray-200 text-gray-700 hover:bg-white",onClick:()=>i(s-1),disabled:c,children:"Geri"}),s===1&&n.jsxs(Re,{className:"bg-[var(--burgundy)] text-white hover:bg-[var(--burgundy-hover)] gap-2 px-6",onClick:()=>i(2),children:["Balayalm ",n.jsx(Ta,{size:16})]}),s===2&&n.jsxs(Re,{className:"bg-[var(--burgundy)] text-white hover:bg-[var(--burgundy-hover)] gap-2 px-6",onClick:()=>i(3),children:["Analizi Gr ",n.jsx(Ta,{size:16})]}),s===3&&n.jsxs("div",{className:"flex gap-3",children:[n.jsxs(Re,{className:"bg-[var(--burgundy)] text-white hover:bg-[var(--burgundy-hover)] gap-2 px-6",onClick:()=>{u().then(()=>{a("/create-offer")})},disabled:c,children:["Kendi Teklifimi Olutur ",n.jsx(Ta,{size:16})]}),n.jsxs(Re,{variant:"outline",className:"border-gray-200 text-gray-700 hover:bg-white",onClick:()=>i(4),disabled:c,children:["leri Seviye Bilgisi ",n.jsx(Ta,{size:16})]})]}),s===4&&n.jsx(Re,{className:"bg-[var(--burgundy)] text-white hover:bg-[var(--burgundy-hover)] min-w-[160px]",onClick:u,disabled:c,children:c?"Kaydediliyor...":"Onboarding'i Tamamla"})]})]})}):null}function V_(){const[e,t]=b.useState(!1);return n.jsxs("div",{className:"flex h-screen bg-background overflow-hidden",children:[n.jsx(l_,{collapsed:e,onToggle:()=>t(!e)}),n.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[n.jsx(JA,{}),n.jsx("main",{className:"flex-1 overflow-auto bg-[#FAFBFC]",children:n.jsx(Rh,{})})]}),n.jsx(au,{position:"top-right"}),n.jsx(U_,{})]})}function H_(){const[e,t]=me.useState(!1),r=ga();me.useEffect(()=>{const s=()=>{t(window.scrollY>20)};return window.addEventListener("scroll",s,{passive:!0}),()=>window.removeEventListener("scroll",s)},[]);const a=[{name:"RN",path:"/urun"},{name:"TEKNK ANALZ",path:"/teknik-analiz"},{name:"FRE SMLASYONU",path:"/fire-simulasyonu"},{name:"BLG MERKEZ",path:"/blog"},{name:"HAKKIMIZDA",path:"/hakkimizda"},{name:"LETM",path:"/iletisim"}];return n.jsx("nav",{className:`fixed top-0 w-full z-50 transition-all duration-200 border-b ${e?"bg-white border-[#E2E8F0] shadow-sm h-16":"bg-white/90 border-transparent h-20"}`,children:n.jsxs("div",{className:"max-w-[1440px] mx-auto px-6 h-full flex items-center justify-between",children:[n.jsx(At,{to:"/",className:"flex items-center gap-3",children:n.jsx("img",{src:ps,alt:"Ulgen One Logo",className:"h-[4.5rem] lg:h-[5.5rem] w-auto -ml-3"})}),n.jsx("div",{className:"hidden lg:flex items-center gap-10",children:a.map(s=>n.jsxs(At,{to:s.path,className:`text-[11px] font-black tracking-[0.1em] transition-all relative py-2 ${r.pathname===s.path?"text-[#800020]":"text-[#6B7280] hover:text-[#1A1D1F]"}`,children:[s.name,r.pathname===s.path&&n.jsx("span",{className:"absolute bottom-0 left-0 w-full h-[3px] bg-[#800020]"})]},s.path))}),n.jsxs("div",{className:"flex items-center gap-6",children:[n.jsx(At,{to:"/login",className:"text-[11px] font-black tracking-widest text-[#6B7280] hover:text-[#1A1D1F] transition-colors uppercase",children:"GR YAP"}),n.jsx(At,{to:"/register",className:"bg-[#1A1D1F] text-white px-6 py-3 rounded-sm font-black text-[11px] tracking-widest hover:bg-black transition-all shadow-md active:translate-y-[1px] uppercase",children:"KAYIT OL"})]})]})})}function $_(){return n.jsx("footer",{className:"bg-[#0A1015] text-[#94A3B8] border-t border-white/5",children:n.jsxs("div",{className:"max-w-[1440px] mx-auto pt-24 pb-16 px-6",children:[n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-12 lg:gap-8",children:[n.jsxs("div",{className:"col-span-2 space-y-8",children:[n.jsx("div",{className:"flex items-center gap-3 text-white font-black text-2xl tracking-tighter cursor-default w-fit",children:n.jsx("img",{src:ps,alt:"Ulgen One Logo",className:"h-[6rem] lg:h-[7.5rem] w-auto brightness-0 invert -ml-4"})}),n.jsx("p",{className:"text-sm leading-relaxed max-w-sm opacity-60 font-medium",children:"Oluklu mukavva endstrisi iin gelitirilmi, deterministik algoritmalarla alan teknik fiyatlama ve retim optimizasyon platformu."}),n.jsxs("div",{className:"flex gap-4",children:[n.jsx("div",{className:"p-3 border border-white/10 rounded-sm bg-white/5 text-[10px] font-black tracking-widest text-[#800020]",children:"v2.4.8-CORE"}),n.jsx("div",{className:"p-3 border border-white/10 rounded-sm bg-white/5 text-[10px] font-black tracking-widest text-[#10B981]",children:"SYSTEM: ONLINE"})]})]}),n.jsxs("div",{className:"space-y-6",children:[n.jsx("h4",{className:"text-white font-black text-[10px] uppercase tracking-[0.2em] opacity-50",children:"ZMLER"}),n.jsxs("ul",{className:"space-y-4 text-xs font-bold tracking-tight",children:[n.jsx("li",{children:n.jsx(At,{to:"/urun",className:"hover:text-white transition-colors",children:"Safiha Optimizasyonu"})}),n.jsx("li",{children:n.jsx(At,{to:"/fire-simulasyonu",className:"hover:text-white transition-colors",children:"Fire Simlatr"})}),n.jsx("li",{children:n.jsx(At,{to:"/teknik-analiz",className:"hover:text-white transition-colors",children:"Teknik Analiz Motoru"})}),n.jsx("li",{children:n.jsx(At,{to:"/blog",className:"hover:text-white transition-colors",children:"Maliyet Analizi"})})]})]}),n.jsxs("div",{className:"space-y-6",children:[n.jsx("h4",{className:"text-white font-black text-[10px] uppercase tracking-[0.2em] opacity-50",children:"KURUMSAL"}),n.jsxs("ul",{className:"space-y-4 text-xs font-bold tracking-tight",children:[n.jsx("li",{children:n.jsx(At,{to:"/hakkimizda",className:"hover:text-white transition-colors",children:"Vizyon & Misyon"})}),n.jsx("li",{children:n.jsx(At,{to:"/blog",className:"hover:text-white transition-colors",children:"Bilgi Merkezi"})}),n.jsx("li",{children:n.jsx(At,{to:"/iletisim",className:"hover:text-white transition-colors",children:"letiim"})}),n.jsx("li",{children:n.jsx(At,{to:"/register",className:"text-[#800020] hover:text-[#A00028] transition-colors",children:"Kurumsal yelik"})})]})]}),n.jsxs("div",{className:"space-y-6",children:[n.jsx("h4",{className:"text-white font-black text-[10px] uppercase tracking-[0.2em] opacity-50",children:"HUKUK"}),n.jsxs("ul",{className:"space-y-4 text-xs font-bold tracking-tight",children:[n.jsx("li",{children:n.jsx(At,{to:"/kvkk",className:"hover:text-white transition-colors",children:"KVKK Aydnlatma Metni"})}),n.jsx("li",{children:n.jsx(At,{to:"/gizlilik",className:"hover:text-white transition-colors",children:"Gizlilik Politikas"})}),n.jsx("li",{children:n.jsx(At,{to:"/kullanim-sartlari",className:"hover:text-white transition-colors",children:"Kullanm artlar"})})]})]}),n.jsxs("div",{className:"space-y-6",children:[n.jsx("h4",{className:"text-white font-black text-[10px] uppercase tracking-[0.2em] opacity-50",children:"DESTEK"}),n.jsxs("ul",{className:"space-y-4 text-xs font-bold tracking-tight",children:[n.jsx("li",{children:n.jsx("a",{href:"mailto:destek@ulgen.one",className:"hover:text-white transition-colors",children:"destek@ulgen.one"})}),n.jsx("li",{className:"text-white/40 italic",children:"09:00 - 18:00 (GMT+3)"})]})]})]}),n.jsxs("div",{className:"mt-24 pt-12 border-t border-white/5 flex flex-col md:flex-row justify-between items-center gap-8 text-[10px] font-black uppercase tracking-[0.3em]",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("span",{children:[" ",new Date().getFullYear()," ULGEN ONE INDUSTRY SOLUTIONS"]}),n.jsx("span",{className:"w-1 h-1 rounded-full bg-white/20"}),n.jsx("span",{className:"opacity-40",children:"ISO 27001 COMPLIANT ARCHITECTURE"})]}),n.jsxs("div",{className:"flex gap-8 opacity-40",children:[n.jsx("span",{className:"hover:opacity-100 transition-opacity cursor-default",children:"SYSTEM ARCHITECTURE"}),n.jsx("span",{className:"hover:opacity-100 transition-opacity cursor-default",children:"DATA INTEGRITY"}),n.jsx("span",{className:"hover:opacity-100 transition-opacity cursor-default",children:"PRECISION ANALYTICS"})]})]})]})})}function K_(){return n.jsxs("div",{className:"min-h-screen bg-white text-[#1A1D1F] font-sans selection:bg-[#800020]/10 overflow-x-hidden",children:[n.jsx(H_,{}),n.jsx("main",{children:n.jsx(Rh,{})}),n.jsx($_,{})]})}function po({className:e,children:t,...r}){return n.jsx("main",{className:We("w-full max-w-[1440px] mx-auto p-6 lg:p-12 space-y-8",e),...r,children:t})}function nu({title:e,description:t,actions:r,className:a}){return n.jsxs("header",{className:We("flex flex-col sm:flex-row sm:justify-between sm:items-end gap-6 border-b border-border pb-6",a),children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx("h1",{className:"text-3xl font-black tracking-tighter uppercase text-foreground",children:e}),t&&n.jsx("p",{className:"text-muted-foreground font-medium text-sm leading-relaxed max-w-2xl",children:t})]}),r&&n.jsx("div",{className:"flex flex-wrap gap-3 shrink-0",children:r})]})}function W_({title:e,value:t,description:r,icon:a,trend:s,accent:i="default",className:l,...o}){const c={default:"border-border bg-card",burgundy:"border-[#800020]/20 bg-[#800020]/5",navy:"border-[#1A1D1F]/20 bg-[#1A1D1F]/5",success:"border-[#10B981]/20 bg-[#10B981]/5"},d={default:"text-foreground",burgundy:"text-[#800020]",navy:"text-[#1A1D1F]",success:"text-[#10B981]"};return n.jsxs(tt,{className:We("p-6 flex flex-col gap-4 relative overflow-hidden",c[i],l),...o,children:[n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsxs("div",{className:"space-y-1",children:[n.jsx("h4",{className:"text-[10px] font-black uppercase tracking-widest text-muted-foreground",children:e}),n.jsx("div",{className:We("text-3xl font-black tracking-tighter",d[i]),children:t})]}),a&&n.jsx("div",{className:"text-muted-foreground opacity-50 shrink-0",children:a})]}),(r||s)&&n.jsxs("div",{className:"pt-4 border-t border-border/50 text-xs font-medium text-muted-foreground flex justify-between items-center",children:[r&&n.jsx("span",{children:r}),s&&n.jsx("span",{className:We("font-bold flex items-center gap-1",s.positive===!0?"text-status-success":s.positive===!1?"text-status-error":"text-muted-foreground"),children:s.text})]})]})}const G_="modulepreload",Y_=function(e){return"/"+e},gp={},su=function(t,r,a){let s=Promise.resolve();if(r&&r.length>0){let l=function(d){return Promise.all(d.map(u=>Promise.resolve(u).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=l(r.map(d=>{if(d=Y_(d),d in gp)return;gp[d]=!0;const u=d.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${f}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":G_,u||(h.as="script"),h.crossOrigin="",h.href=d,c&&h.setAttribute("nonce",c),document.head.appendChild(h),u)return new Promise((m,x)=>{h.addEventListener("load",m),h.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${d}`)))})}))}function i(l){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=l,window.dispatchEvent(o),!o.defaultPrevented)throw l}return s.then(l=>{for(const o of l||[])o.status==="rejected"&&i(o.reason);return t().catch(i)})},ft={DRAFT:"draft",PENDING_APPROVAL:"pending_approval",APPROVED:"approved",REJECTED:"rejected",IN_PRODUCTION:"in_production",DELIVERED:"delivered",PAYMENT_PENDING:"payment_pending",PAID:"paid",DELETED:"deleted"},Yl={[ft.DRAFT]:"Taslak",[ft.PENDING_APPROVAL]:"Onay Bekliyor",[ft.APPROVED]:"Onayland",[ft.REJECTED]:"Reddedildi",[ft.IN_PRODUCTION]:"retimde",[ft.DELIVERED]:"Teslim Edildi",[ft.PAYMENT_PENDING]:"deme Bekliyor",[ft.PAID]:"dendi"},ed={[ft.DRAFT]:"default",[ft.PENDING_APPROVAL]:"warning",[ft.APPROVED]:"success",[ft.REJECTED]:"error",[ft.IN_PRODUCTION]:"warning",[ft.DELIVERED]:"success",[ft.PAYMENT_PENDING]:"warning",[ft.PAID]:"success"},sr={async logAction(e){try{await Nh(ir(ke,"auditLogs"),{...e,timestamp:Ke()})}catch(t){console.error("AuditLog Error:",t)}}},$r="offers",vp=()=>`TKL-${Math.floor(Math.random()*1e4).toString().padStart(4,"0")}`,Wt={async createOffer(e){var s,i;const t=vp(),r=Be(ke,$r,t),a={...e,id:t,isDeleted:!1,createdAt:Ke(),updatedAt:Ke(),date:new Date().toISOString(),amount:((s=e.payload)==null?void 0:s.toplamTutar)||0,toplamTutar:((i=e.payload)==null?void 0:i.toplamTutar)||0};return a.companyCode&&su(async()=>{const{quotaService:l}=await Promise.resolve().then(()=>My);return{quotaService:l}},[]).then(({quotaService:l})=>{l.incrementOfferUsage(a.companyCode)}),await nr(r,a),t},async getUserOffers(e){const t=Ir(ir(ke,$r),wt("createdByUid","==",e),wt("isDeleted","==",!1),nn("createdAt","desc"));return(await mr(t)).docs.map(a=>({id:a.id,...a.data()}))},getOffersByUser(e){return this.getUserOffers(e)},async getOffersByCompany(e){const t=Ir(ir(ke,$r),wt("companyCode","==",e),wt("isDeleted","==",!1),nn("createdAt","desc"));return(await mr(t)).docs.map(a=>({id:a.id,...a.data()}))},async getPendingOffers(e){const t=Ir(ir(ke,$r),wt("companyCode","==",e),wt("status","==",ft.PENDING_APPROVAL),wt("isDeleted","==",!1),nn("createdAt","desc"));return(await mr(t)).docs.map(a=>({id:a.id,...a.data()}))},getPendingApprovalOffersForCompany(e){return this.getPendingOffers(e)},async getCompanyOffersByStatus(e,t){const r=Ir(ir(ke,$r),wt("companyCode","==",e),wt("status","==",t),wt("isDeleted","==",!1),nn("createdAt","desc"));return(await mr(r)).docs.map(s=>({id:s.id,...s.data()}))},async getOfferById(e){const t=Be(ke,$r,e),r=await hr(t);return r.exists()?{id:r.id,...r.data()}:null},async updateOffer(e,t){const r=Be(ke,$r,e);await Ut(r,{...t,updatedAt:Ke()})},async submitForApproval(e,t,r){const a=Be(ke,$r,e);await Ut(a,{status:ft.PENDING_APPROVAL,submittedAt:Ke(),submittedByUid:t,updatedAt:Ke()}),await sr.logAction({actorUid:t,actionType:"OFFER_SUBMIT",targetType:"offer",targetId:e,metadata:{status:ft.PENDING_APPROVAL,actorRole:r}})},async withdrawOffer(e,t,r){const a=Be(ke,$r,e);await Ut(a,{status:ft.DRAFT,updatedAt:Ke()}),await sr.logAction({actorUid:t,actionType:"OFFER_WITHDRAW",targetType:"offer",targetId:e,metadata:{status:ft.DRAFT,actorRole:r}})},async approveOffer(e,t,r){const a=Be(ke,$r,e);await Ut(a,{status:ft.APPROVED,approvedByUid:t,approvedAt:Ke(),updatedAt:Ke()}),await sr.logAction({actorUid:t,actionType:"OFFER_APPROVE",targetType:"offer",targetId:e,metadata:{status:ft.APPROVED,actorRole:r}})},async rejectOffer(e,t,r,a){const s=Be(ke,$r,e);await Ut(s,{status:ft.REJECTED,rejectedByUid:t,rejectionReason:r,rejectedAt:Ke(),updatedAt:Ke()}),await sr.logAction({actorUid:t,actionType:"OFFER_REJECT",targetType:"offer",targetId:e,metadata:{status:ft.REJECTED,reason:r,actorRole:a}})},async cloneOfferToDraft(e,t){const r=Be(ke,$r,e),a=await hr(r);if(!a.exists())throw new Error("Teklif bulunamad");const s=a.data(),i=vp(),l=Be(ke,$r,i),o={...s,id:i,status:ft.DRAFT,isDeleted:!1,createdByUid:t,createdAt:Ke(),updatedAt:Ke(),date:new Date().toISOString(),submittedAt:null,approvedByUid:void 0,approvedAt:null,rejectedByUid:void 0,rejectedAt:null,rejectionReason:void 0};return await nr(l,o),await sr.logAction({actorUid:t,actionType:"OFFER_CLONE",targetType:"offer",targetId:e,metadata:{newOfferId:i}}),i},async softDeleteOffer(e,t,r){const a=Be(ke,$r,e);await Ut(a,{isDeleted:!0,status:ft.DELETED,deletedAt:Ke(),deletedByUid:t,deletedByRole:r,updatedAt:Ke()}),await sr.logAction({actorUid:t,actionType:"OFFER_DELETE",targetType:"offer",targetId:e,metadata:{actorRole:r}})},async deleteOffer(e){const t=Be(ke,$r,e);await Ki(t)},async migrateLegacyOffers(){console.log("Migration started: Checking for legacy offers...");const e=await mr(ir(ke,$r));let t=0;const r=e.docs.map(async a=>{a.data().isDeleted===void 0&&(await Ut(a.ref,{isDeleted:!1}),t++)});return await Promise.all(r),console.log(`Migration complete: Updated ${t} legacy offers.`),t}},Ja="bulkOffers",X_=()=>`TKT-${Math.floor(Math.random()*1e4).toString().padStart(4,"0")}`,Ua={async createBulkOffer(e){const t=X_(),r=Be(ke,Ja,t),a={...e,id:t,isDeleted:!1,createdAt:Ke(),updatedAt:Ke(),date:new Date().toISOString(),amount:e.totalRevenue||0};return a.companyCode&&su(async()=>{const{quotaService:s}=await Promise.resolve().then(()=>My);return{quotaService:s}},void 0).then(({quotaService:s})=>{s.incrementOfferUsage(a.companyCode)}),await nr(r,a),t},async getUserBulkOffers(e){const t=Ir(ir(ke,Ja),wt("createdByUid","==",e),wt("isDeleted","==",!1),nn("createdAt","desc"));return(await mr(t)).docs.map(a=>({id:a.id,...a.data()}))},async getBulkOffersByCompany(e){const t=Ir(ir(ke,Ja),wt("companyCode","==",e),wt("isDeleted","==",!1),nn("createdAt","desc"));return(await mr(t)).docs.map(a=>({id:a.id,...a.data()}))},async getPendingApprovalBulkOffersForCompany(e){const t=Ir(ir(ke,Ja),wt("companyCode","==",e),wt("status","==",ft.PENDING_APPROVAL),wt("isDeleted","==",!1),nn("createdAt","desc"));return(await mr(t)).docs.map(a=>({id:a.id,...a.data()}))},async getBulkOfferById(e){const t=Be(ke,Ja,e),r=await hr(t);return r.exists()?{id:r.id,...r.data()}:null},async updateBulkOffer(e,t){const r=Be(ke,Ja,e);await Ut(r,{...t,updatedAt:Ke()})},async submitForApproval(e,t,r){const a=Be(ke,Ja,e);await Ut(a,{status:ft.PENDING_APPROVAL,submittedAt:Ke(),updatedAt:Ke()}),await sr.logAction({actorUid:t,actionType:"BULK_OFFER_SUBMIT",targetType:"bulkOffer",targetId:e,metadata:{status:ft.PENDING_APPROVAL,actorRole:r}})},async withdrawOffer(e,t,r){const a=Be(ke,Ja,e);await Ut(a,{status:ft.DRAFT,updatedAt:Ke()}),await sr.logAction({actorUid:t,actionType:"BULK_OFFER_WITHDRAW",targetType:"bulkOffer",targetId:e,metadata:{status:ft.DRAFT,actorRole:r}})},async approveOffer(e,t,r){const a=Be(ke,Ja,e);await Ut(a,{status:ft.APPROVED,approvedByUid:t,approvedAt:Ke(),updatedAt:Ke()}),await sr.logAction({actorUid:t,actionType:"BULK_OFFER_APPROVE",targetType:"bulkOffer",targetId:e,metadata:{status:ft.APPROVED,actorRole:r}})},async rejectOffer(e,t,r,a){const s=Be(ke,Ja,e);await Ut(s,{status:ft.REJECTED,rejectedByUid:t,rejectionReason:r,rejectedAt:Ke(),updatedAt:Ke()}),await sr.logAction({actorUid:t,actionType:"BULK_OFFER_REJECT",targetType:"bulkOffer",targetId:e,metadata:{status:ft.REJECTED,reason:r,actorRole:a}})},async softDeleteBulkOffer(e,t,r){const a=Be(ke,Ja,e);await Ut(a,{isDeleted:!0,status:ft.DELETED,deletedAt:Ke(),deletedByUid:t,updatedAt:Ke()}),await sr.logAction({actorUid:t,actionType:"BULK_OFFER_DELETE",targetType:"bulkOffer",targetId:e,metadata:{actorRole:r}})}},yp="subscriptions",Ry={async getSubscription(e){if(!e)return null;const t=Be(ke,yp,e),r=await hr(t);return r.exists()?r.data():null},async setSubscription(e,t,r){if(r!=="super_admin")throw new Error("FORBIDDEN_ACTION");const a=Be(ke,yp,e),s=await hr(a),i={companyCode:e,planType:t.planType,status:t.status,endDate:an.fromDate(t.endDate),monthlyPrice:t.monthlyPrice||0,updatedAt:Ke()};s.exists()?await Ut(a,i):await nr(a,{...i,startDate:Ke(),createdAt:Ke()})},async getEffectiveExpiry(e,t){const r=await this.getSubscription(e);return r&&r.status==="ACTIVE"?r.endDate:t}},Nc="usage",ha={getCurrentMonthKey(){const e=new Date;return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}`},async incrementOfferUsage(e){if(!e)return;const t=this.getCurrentMonthKey(),r=Be(ke,Nc,e,"monthly",t);(await hr(r)).exists()?await Ut(r,{offerCount:Gs(1),updatedAt:Ke()}):await nr(r,{offerCount:1,calculationCount:0,analysisCount:0,memberCountSnapshot:0,createdAt:Ke(),updatedAt:Ke()})},async incrementCalculationUsage(e){if(!e)return;const t=this.getCurrentMonthKey(),r=Be(ke,Nc,e,"monthly",t);(await hr(r)).exists()?await Ut(r,{calculationCount:Gs(1),updatedAt:Ke()}):await nr(r,{offerCount:0,calculationCount:1,analysisCount:0,memberCountSnapshot:0,createdAt:Ke(),updatedAt:Ke()})},async incrementAnalysisUsage(e){if(!e)return;const t=this.getCurrentMonthKey(),r=Be(ke,Nc,e,"monthly",t);(await hr(r)).exists()?await Ut(r,{analysisCount:Gs(1),updatedAt:Ke()}):await nr(r,{offerCount:0,calculationCount:0,analysisCount:1,memberCountSnapshot:0,createdAt:Ke(),updatedAt:Ke()})},async getUsage(e){if(!e)return{offerCount:0,calculationCount:0,analysisCount:0,memberCountSnapshot:0};const t=this.getCurrentMonthKey(),r=Be(ke,Nc,e,"monthly",t),a=await hr(r);return a.exists()?a.data():{offerCount:0,calculationCount:0,analysisCount:0,memberCountSnapshot:0}},async checkQuota(e,t){var u;if(!e)return{allowed:!0,exceeded:!1};const[r,a]=await Promise.all([Ry.getSubscription(e),this.getUsage(e)]),s=(r==null?void 0:r.planType)||st.FREE,i=ya[s];let l=!1,o="",c=0,d=0;return s===st.PRO||s===st.ENTERPRISE?l=!1:t==="offer"?(c=a.offerCount||0,d=i.offerLimit,c>=d&&(l=!0,o=`Quota Warning: Company ${e} exceeded plan limit (${c}/${d})`),c>=30&&console.info(`MONETIZATION_TARGET: Company ${e} reached ${c} offers. Candidate for PRO plan.`)):t==="calculation"?(c=a.calculationCount||0,d=i.calculationLimit,c>=d&&(l=!0,o=`Quota Warning: Company ${e} exceeded plan calculation limit (${c}/${d})`)):t==="analysis"&&(c=a.analysisCount||0,d=i.analysisLimit,c>=d&&(l=!0,o=`Quota Warning: Company ${e} exceeded plan analysis limit (${c}/${d})`)),l&&console.warn(o),{allowed:!l,exceeded:l,usage:c,limit:d,plan:s,endDate:((u=r==null?void 0:r.endDate)==null?void 0:u.toDate())||null}}},My=Object.freeze(Object.defineProperty({__proto__:null,quotaService:ha},Symbol.toStringTag,{value:"Module"}));function Ku(e){return ir(ke,"users",e,"sheets")}const Mi={async getUserSheets(e){return(await mr(Ku(e))).docs.map(r=>({id:r.id,...r.data()}))},async addSheet(e,t){return(await Nh(Ku(e),{...t,createdAt:Ke()})).id},async addSheetsBatch(e,t){const r=hd(ke);let a=0;for(const s of t){const i=Be(Ku(e));r.set(i,{...s,createdAt:Ke()}),a++,a%450===0&&await r.commit()}return a%450!==0&&await r.commit(),a},async deleteSheet(e,t){const r=Be(ke,"users",e,"sheets",t);await Ki(r)}};function q_(){const{user:e,userProfile:t}=vr(),[r,a]=b.useState(!1),[s,i]=b.useState(!1),[l,o]=b.useState(!0),c=(t==null?void 0:t.onboardingCompleted)===!0;return b.useEffect(()=>{let u=!0;async function f(){if(e)try{const h=await Mi.getUserSheets(e.uid);if(!u)return;a(h.length>0);const m=await Wt.getOffersByUser(e.uid);if(!u)return;i(m.length>0)}catch(h){console.error("Checklist error:",h)}finally{u&&o(!1)}}return f(),()=>{u=!1}},[e]),l||c&&r&&s?null:n.jsxs(tt,{className:"p-4 bg-surface-secondary/50 border-[var(--burgundy)]/20 shadow-sm relative overflow-hidden mt-2",children:[n.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-[var(--burgundy)]/5 rounded-full -translate-y-16 translate-x-16 blur-2xl flex-shrink-0"}),n.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[n.jsxs("div",{children:[n.jsxs("h3",{className:"text-sm font-bold text-[var(--burgundy)] flex items-center gap-2",children:[n.jsx("span",{children:""})," Balang Admlar"]}),n.jsx("p",{className:"text-xs text-text-secondary mt-1",children:"Sistemi kullanmaya tam anlamyla balamak iin eksik admlar tamamlayn."})]}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-6 bg-surface p-3 rounded border border-border/50",children:[n.jsxs("div",{className:`flex items-center gap-2 text-[13px] ${c?"text-status-success font-medium":"text-text-secondary"}`,children:[c?n.jsx(Jr,{size:16}):n.jsx(Yc,{size:16}),n.jsx("span",{children:"lk analiz yapld"})]}),n.jsxs("div",{className:`flex items-center gap-2 text-[13px] ${s?"text-status-success font-medium":"text-text-secondary"}`,children:[s?n.jsx(Jr,{size:16}):n.jsx(Yc,{size:16}),n.jsx("span",{children:"lk teklif oluturuldu"})]}),n.jsxs("div",{className:`flex items-center gap-2 text-[13px] ${r?"text-status-success font-medium":"text-text-secondary"}`,children:[r?n.jsx(Jr,{size:16}):n.jsx(Yc,{size:16}),n.jsx("span",{children:"Safiha tanmland"})]})]})]})]})}var Oh={};(function e(t,r,a,s){var i=!!(t.Worker&&t.Blob&&t.Promise&&t.OffscreenCanvas&&t.OffscreenCanvasRenderingContext2D&&t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype.transferControlToOffscreen&&t.URL&&t.URL.createObjectURL),l=typeof Path2D=="function"&&typeof DOMMatrix=="function",o=(function(){if(!t.OffscreenCanvas)return!1;try{var V=new OffscreenCanvas(1,1),P=V.getContext("2d");P.fillRect(0,0,1,1);var T=V.transferToImageBitmap();P.createPattern(T,"no-repeat")}catch{return!1}return!0})();function c(){}function d(V){var P=r.exports.Promise,T=P!==void 0?P:t.Promise;return typeof T=="function"?new T(V):(V(c,c),null)}var u=(function(V,P){return{transform:function(T){if(V)return T;if(P.has(T))return P.get(T);var R=new OffscreenCanvas(T.width,T.height),L=R.getContext("2d");return L.drawImage(T,0,0),P.set(T,R),R},clear:function(){P.clear()}}})(o,new Map),f=(function(){var V=Math.floor(16.666666666666668),P,T,R={},L=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(P=function(X){var J=Math.random();return R[J]=requestAnimationFrame(function te(G){L===G||L+V-1<G?(L=G,delete R[J],X()):R[J]=requestAnimationFrame(te)}),J},T=function(X){R[X]&&cancelAnimationFrame(R[X])}):(P=function(X){return setTimeout(X,V)},T=function(X){return clearTimeout(X)}),{frame:P,cancel:T}})(),h=(function(){var V,P,T={};function R(L){function X(J,te){L.postMessage({options:J||{},callback:te})}L.init=function(te){var G=te.transferControlToOffscreen();L.postMessage({canvas:G},[G])},L.fire=function(te,G,Z){if(P)return X(te,null),P;var ae=Math.random().toString(36).slice(2);return P=d(function(de){function z(Ee){Ee.data.callback===ae&&(delete T[ae],L.removeEventListener("message",z),P=null,u.clear(),Z(),de())}L.addEventListener("message",z),X(te,ae),T[ae]=z.bind(null,{data:{callback:ae}})}),P},L.reset=function(){L.postMessage({reset:!0});for(var te in T)T[te](),delete T[te]}}return function(){if(V)return V;if(!a&&i){var L=["var CONFETTI, SIZE = {}, module = {};","("+e.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{V=new Worker(URL.createObjectURL(new Blob([L])))}catch(X){return typeof console<"u"&&typeof console.warn=="function"&&console.warn(" Could not load worker",X),null}R(V)}return V}})(),m={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function x(V,P){return P?P(V):V}function p(V){return V!=null}function g(V,P,T){return x(V&&p(V[P])?V[P]:m[P],T)}function y(V){return V<0?0:Math.floor(V)}function N(V,P){return Math.floor(Math.random()*(P-V))+V}function v(V){return parseInt(V,16)}function S(V){return V.map(_)}function _(V){var P=String(V).replace(/[^0-9a-f]/gi,"");return P.length<6&&(P=P[0]+P[0]+P[1]+P[1]+P[2]+P[2]),{r:v(P.substring(0,2)),g:v(P.substring(2,4)),b:v(P.substring(4,6))}}function F(V){var P=g(V,"origin",Object);return P.x=g(P,"x",Number),P.y=g(P,"y",Number),P}function k(V){V.width=document.documentElement.clientWidth,V.height=document.documentElement.clientHeight}function j(V){var P=V.getBoundingClientRect();V.width=P.width,V.height=P.height}function w(V){var P=document.createElement("canvas");return P.style.position="fixed",P.style.top="0px",P.style.left="0px",P.style.pointerEvents="none",P.style.zIndex=V,P}function E(V,P,T,R,L,X,J,te,G){V.save(),V.translate(P,T),V.rotate(X),V.scale(R,L),V.arc(0,0,1,J,te,G),V.restore()}function A(V){var P=V.angle*(Math.PI/180),T=V.spread*(Math.PI/180);return{x:V.x,y:V.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:V.startVelocity*.5+Math.random()*V.startVelocity,angle2D:-P+(.5*T-Math.random()*T),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:V.color,shape:V.shape,tick:0,totalTicks:V.ticks,decay:V.decay,drift:V.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:V.gravity*3,ovalScalar:.6,scalar:V.scalar,flat:V.flat}}function D(V,P){P.x+=Math.cos(P.angle2D)*P.velocity+P.drift,P.y+=Math.sin(P.angle2D)*P.velocity+P.gravity,P.velocity*=P.decay,P.flat?(P.wobble=0,P.wobbleX=P.x+10*P.scalar,P.wobbleY=P.y+10*P.scalar,P.tiltSin=0,P.tiltCos=0,P.random=1):(P.wobble+=P.wobbleSpeed,P.wobbleX=P.x+10*P.scalar*Math.cos(P.wobble),P.wobbleY=P.y+10*P.scalar*Math.sin(P.wobble),P.tiltAngle+=.1,P.tiltSin=Math.sin(P.tiltAngle),P.tiltCos=Math.cos(P.tiltAngle),P.random=Math.random()+2);var T=P.tick++/P.totalTicks,R=P.x+P.random*P.tiltCos,L=P.y+P.random*P.tiltSin,X=P.wobbleX+P.random*P.tiltCos,J=P.wobbleY+P.random*P.tiltSin;if(V.fillStyle="rgba("+P.color.r+", "+P.color.g+", "+P.color.b+", "+(1-T)+")",V.beginPath(),l&&P.shape.type==="path"&&typeof P.shape.path=="string"&&Array.isArray(P.shape.matrix))V.fill(Y(P.shape.path,P.shape.matrix,P.x,P.y,Math.abs(X-R)*.1,Math.abs(J-L)*.1,Math.PI/10*P.wobble));else if(P.shape.type==="bitmap"){var te=Math.PI/10*P.wobble,G=Math.abs(X-R)*.1,Z=Math.abs(J-L)*.1,ae=P.shape.bitmap.width*P.scalar,de=P.shape.bitmap.height*P.scalar,z=new DOMMatrix([Math.cos(te)*G,Math.sin(te)*G,-Math.sin(te)*Z,Math.cos(te)*Z,P.x,P.y]);z.multiplySelf(new DOMMatrix(P.shape.matrix));var Ee=V.createPattern(u.transform(P.shape.bitmap),"no-repeat");Ee.setTransform(z),V.globalAlpha=1-T,V.fillStyle=Ee,V.fillRect(P.x-ae/2,P.y-de/2,ae,de),V.globalAlpha=1}else if(P.shape==="circle")V.ellipse?V.ellipse(P.x,P.y,Math.abs(X-R)*P.ovalScalar,Math.abs(J-L)*P.ovalScalar,Math.PI/10*P.wobble,0,2*Math.PI):E(V,P.x,P.y,Math.abs(X-R)*P.ovalScalar,Math.abs(J-L)*P.ovalScalar,Math.PI/10*P.wobble,0,2*Math.PI);else if(P.shape==="star")for(var ue=Math.PI/2*3,Ce=4*P.scalar,ve=8*P.scalar,ge=P.x,Fe=P.y,Ie=5,Ze=Math.PI/Ie;Ie--;)ge=P.x+Math.cos(ue)*ve,Fe=P.y+Math.sin(ue)*ve,V.lineTo(ge,Fe),ue+=Ze,ge=P.x+Math.cos(ue)*Ce,Fe=P.y+Math.sin(ue)*Ce,V.lineTo(ge,Fe),ue+=Ze;else V.moveTo(Math.floor(P.x),Math.floor(P.y)),V.lineTo(Math.floor(P.wobbleX),Math.floor(L)),V.lineTo(Math.floor(X),Math.floor(J)),V.lineTo(Math.floor(R),Math.floor(P.wobbleY));return V.closePath(),V.fill(),P.tick<P.totalTicks}function W(V,P,T,R,L){var X=P.slice(),J=V.getContext("2d"),te,G,Z=d(function(ae){function de(){te=G=null,J.clearRect(0,0,R.width,R.height),u.clear(),L(),ae()}function z(){a&&!(R.width===s.width&&R.height===s.height)&&(R.width=V.width=s.width,R.height=V.height=s.height),!R.width&&!R.height&&(T(V),R.width=V.width,R.height=V.height),J.clearRect(0,0,R.width,R.height),X=X.filter(function(Ee){return D(J,Ee)}),X.length?te=f.frame(z):de()}te=f.frame(z),G=de});return{addFettis:function(ae){return X=X.concat(ae),Z},canvas:V,promise:Z,reset:function(){te&&f.cancel(te),G&&G()}}}function re(V,P){var T=!V,R=!!g(P||{},"resize"),L=!1,X=g(P,"disableForReducedMotion",Boolean),J=i&&!!g(P||{},"useWorker"),te=J?h():null,G=T?k:j,Z=V&&te?!!V.__confetti_initialized:!1,ae=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,de;function z(ue,Ce,ve){for(var ge=g(ue,"particleCount",y),Fe=g(ue,"angle",Number),Ie=g(ue,"spread",Number),Ze=g(ue,"startVelocity",Number),yt=g(ue,"decay",Number),ht=g(ue,"gravity",Number),Ct=g(ue,"drift",Number),Ue=g(ue,"colors",S),kt=g(ue,"ticks",Number),qe=g(ue,"shapes"),Ft=g(ue,"scalar"),Qe=!!g(ue,"flat"),bt=F(ue),se=ge,Ne=[],De=V.width*bt.x,lt=V.height*bt.y;se--;)Ne.push(A({x:De,y:lt,angle:Fe,spread:Ie,startVelocity:Ze,color:Ue[se%Ue.length],shape:qe[N(0,qe.length)],ticks:kt,decay:yt,gravity:ht,drift:Ct,scalar:Ft,flat:Qe}));return de?de.addFettis(Ne):(de=W(V,Ne,G,Ce,ve),de.promise)}function Ee(ue){var Ce=X||g(ue,"disableForReducedMotion",Boolean),ve=g(ue,"zIndex",Number);if(Ce&&ae)return d(function(Ze){Ze()});T&&de?V=de.canvas:T&&!V&&(V=w(ve),document.body.appendChild(V)),R&&!Z&&G(V);var ge={width:V.width,height:V.height};te&&!Z&&te.init(V),Z=!0,te&&(V.__confetti_initialized=!0);function Fe(){if(te){var Ze={getBoundingClientRect:function(){if(!T)return V.getBoundingClientRect()}};G(Ze),te.postMessage({resize:{width:Ze.width,height:Ze.height}});return}ge.width=ge.height=null}function Ie(){de=null,R&&(L=!1,t.removeEventListener("resize",Fe)),T&&V&&(document.body.contains(V)&&document.body.removeChild(V),V=null,Z=!1)}return R&&!L&&(L=!0,t.addEventListener("resize",Fe,!1)),te?te.fire(ue,ge,Ie):z(ue,ge,Ie)}return Ee.reset=function(){te&&te.reset(),de&&de.reset()},Ee}var U;function M(){return U||(U=re(null,{useWorker:!0,resize:!0})),U}function Y(V,P,T,R,L,X,J){var te=new Path2D(V),G=new Path2D;G.addPath(te,new DOMMatrix(P));var Z=new Path2D;return Z.addPath(G,new DOMMatrix([Math.cos(J)*L,Math.sin(J)*L,-Math.sin(J)*X,Math.cos(J)*X,T,R])),Z}function Q(V){if(!l)throw new Error("path confetti are not supported in this browser");var P,T;typeof V=="string"?P=V:(P=V.path,T=V.matrix);var R=new Path2D(P),L=document.createElement("canvas"),X=L.getContext("2d");if(!T){for(var J=1e3,te=J,G=J,Z=0,ae=0,de,z,Ee=0;Ee<J;Ee+=2)for(var ue=0;ue<J;ue+=2)X.isPointInPath(R,Ee,ue,"nonzero")&&(te=Math.min(te,Ee),G=Math.min(G,ue),Z=Math.max(Z,Ee),ae=Math.max(ae,ue));de=Z-te,z=ae-G;var Ce=10,ve=Math.min(Ce/de,Ce/z);T=[ve,0,0,ve,-Math.round(de/2+te)*ve,-Math.round(z/2+G)*ve]}return{type:"path",path:P,matrix:T}}function B(V){var P,T=1,R="#000000",L='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof V=="string"?P=V:(P=V.text,T="scalar"in V?V.scalar:T,L="fontFamily"in V?V.fontFamily:L,R="color"in V?V.color:R);var X=10*T,J=""+X+"px "+L,te=new OffscreenCanvas(X,X),G=te.getContext("2d");G.font=J;var Z=G.measureText(P),ae=Math.ceil(Z.actualBoundingBoxRight+Z.actualBoundingBoxLeft),de=Math.ceil(Z.actualBoundingBoxAscent+Z.actualBoundingBoxDescent),z=2,Ee=Z.actualBoundingBoxLeft+z,ue=Z.actualBoundingBoxAscent+z;ae+=z+z,de+=z+z,te=new OffscreenCanvas(ae,de),G=te.getContext("2d"),G.font=J,G.fillStyle=R,G.fillText(P,Ee,ue);var Ce=1/T;return{type:"bitmap",bitmap:te.transferToImageBitmap(),matrix:[Ce,0,0,Ce,-ae*Ce/2,-de*Ce/2]}}r.exports=function(){return M().apply(this,arguments)},r.exports.reset=function(){M().reset()},r.exports.create=re,r.exports.shapeFromPath=Q,r.exports.shapeFromText=B})((function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}})(),Oh,!1);const bp=Oh.exports;Oh.exports.create;const ki=e=>{var t,r;return Number(((t=e.payload)==null?void 0:t.finalCustomerTotal)||((r=e.payload)==null?void 0:r.toplamTutar)||0)},Ms=e=>e.createdAt&&typeof e.createdAt.toDate=="function"?e.createdAt.toDate():new Date,jc=e=>e>=1e6?`${(e/1e6).toFixed(1)}M`:e>=1e3?`${(e/1e3).toFixed(1)}K`:`${e.toLocaleString("tr-TR")}`,Z_={draft:"#94a3b8",pending_approval:"#f59e0b",approved:"#22c55e",rejected:"#ef4444",in_production:"#3b82f6",delivered:"#06b6d4",payment_pending:"#a855f7",paid:"#10b981",canceled:"#6b7280"},J_={E:"E Dalga",B:"B Dalga",C:"C Dalga",BE:"BE Dalga",BC:"BC Dalga",CE:"CE Dalga"};function Q_(){var F,k,j;const e=ca(),{user:t,userRole:r,userProfile:a}=vr(),[s,i]=b.useState(!0),[l,o]=b.useState([]),[c,d]=b.useState({used:0,limit:0,plan:st.FREE,analysisUsed:0,analysisLimit:0,planEndDate:null});b.useEffect(()=>{if(!t||!c.plan||c.plan===st.FREE)return;if((c.plan===st.PRO||c.plan===st.ENTERPRISE)&&c.planEndDate){const E=`celebrated_pro_${t.uid}`,A=localStorage.getItem(E),D=c.planEndDate.getTime().toString();A!==D&&setTimeout(()=>{const W=Date.now()+3e3,re=["#f59e0b","#3b82f6","#10b981","#ef4444"];(function U(){bp({particleCount:5,angle:60,spread:55,origin:{x:0},colors:re}),bp({particleCount:5,angle:120,spread:55,origin:{x:1},colors:re}),Date.now()<W&&requestAnimationFrame(U)})(),xe.success("Tebrikler! Pro Plan'a Gei Yaptnz ",{description:"imdi tm premium zelliklerin ve snrsz kotalarnzn keyfini karn.",duration:8e3,position:"top-center"}),localStorage.setItem(E,D)},500)}},[c.plan,c.planEndDate,t]),b.useEffect(()=>{async function w(){if(t)try{i(!0);let E=[],A=[];if(r&&(a!=null&&a.companyCode)){const[re,U]=await Promise.all([Wt.getOffersByCompany(a.companyCode),Ua.getBulkOffersByCompany(a.companyCode)]);E=re,A=U;try{const M=await ha.checkQuota(a.companyCode,"calculation"),Y=await ha.checkQuota(a.companyCode,"analysis");d({used:M.usage||0,limit:M.limit||ya[st.FREE].calculationLimit,plan:M.plan||st.FREE,analysisUsed:Y.usage||0,analysisLimit:Y.limit||ya[st.FREE].analysisLimit,planEndDate:M.endDate||null})}catch(M){console.warn("Quota check failed:",M)}}else{const[re,U]=await Promise.all([Wt.getOffersByUser(t.uid),Ua.getUserBulkOffers(t.uid)]);E=re,A=U;try{const M=await ha.checkQuota(t.uid,"calculation"),Y=await ha.checkQuota(t.uid,"analysis");d({used:M.usage||0,limit:M.limit||ya[st.FREE].calculationLimit,plan:(a==null?void 0:a.plan)||st.FREE,analysisUsed:Y.usage||0,analysisLimit:Y.limit||ya[(a==null?void 0:a.plan)||st.FREE].analysisLimit,planEndDate:M.endDate||null})}catch{d({used:E.length+A.length,limit:ya[st.FREE].calculationLimit,plan:(a==null?void 0:a.plan)||st.FREE,analysisUsed:0,analysisLimit:ya[(a==null?void 0:a.plan)||st.FREE].analysisLimit,planEndDate:null})}}const D=A.map(re=>({id:re.id,customerName:re.customerName,status:re.status,createdAt:re.createdAt,submittedAt:re.submittedAt,approvedAt:re.approvedAt,companyCode:re.companyCode,createdByUid:re.createdByUid,payload:{toplamTutar:re.totalRevenue,finalCustomerTotal:re.totalRevenue,toplamHamMaliyet:re.totalCost,profitMargin:re.totalCost>0?re.totalProfit/re.totalCost*100:0,waveType:"Toplu"}})),W=[...E,...D];W.sort((re,U)=>Ms(U).getTime()-Ms(re).getTime()),o(W)}catch(E){console.error("Error fetching dashboard data:",E)}finally{i(!1)}}w()},[t,r,a]);const u=b.useMemo(()=>{const w=l.length,E=l.filter(Q=>Q.status===ft.APPROVED).length,A=l.filter(Q=>Q.status===ft.PENDING_APPROVAL).length,D=l.filter(Q=>Q.status===ft.REJECTED).length,W=l.filter(Q=>Q.status===ft.DRAFT).length,re=l.filter(Q=>Q.status===ft.APPROVED).reduce((Q,B)=>Q+ki(B),0),U=w>0?E/w*100:0,M=l.filter(Q=>Q.status===ft.APPROVED&&Q.submittedAt&&Q.approvedAt);let Y=0;return M.length>0&&(Y=M.reduce((B,V)=>{var R,L;const P=(R=V.submittedAt)!=null&&R.toDate?V.submittedAt.toDate():new Date(V.submittedAt),T=(L=V.approvedAt)!=null&&L.toDate?V.approvedAt.toDate():new Date(V.approvedAt);return B+Math.max((T.getTime()-P.getTime())/864e5,0)},0)/M.length),{total:w,approved:E,pending:A,rejected:D,draft:W,revenue:re,approvalRate:U,avgWaitTime:Y}},[l]),f=b.useMemo(()=>{const w=new Date,E=new Date(w.getFullYear(),w.getMonth(),1),A=new Date(w.getFullYear(),w.getMonth()-1,1),D=l.filter(V=>Ms(V)>=E),W=l.filter(V=>{const P=Ms(V);return P>=A&&P<E}),re=D.length,U=W.length,M=D.filter(V=>V.status===ft.APPROVED).reduce((V,P)=>V+ki(P),0),Y=W.filter(V=>V.status===ft.APPROVED).reduce((V,P)=>V+ki(P),0),Q=U>0?(re-U)/U*100:re>0?100:0,B=Y>0?(M-Y)/Y*100:M>0?100:0;return{thisCount:re,lastCount:U,thisRevenue:M,lastRevenue:Y,countChange:Q,revenueChange:B}},[l]),h=b.useMemo(()=>{const w={};return l.forEach(E=>{w[E.status]=(w[E.status]||0)+1}),Object.entries(w).map(([E,A])=>({name:Yl[E]||E,value:A,color:Z_[E]||"#94a3b8"})).sort((E,A)=>A.value-E.value)},[l]),m=b.useMemo(()=>{const w={};return l.forEach(E=>{const A=E.customerName||"Bilinmeyen";w[A]||(w[A]={count:0,revenue:0}),w[A].count++,E.status===ft.APPROVED&&(w[A].revenue+=ki(E))}),Object.entries(w).map(([E,A])=>({name:E,...A})).sort((E,A)=>A.revenue-E.revenue||A.count-E.count).slice(0,5)},[l]),x=m.length>0?m[0].revenue:1,p=b.useMemo(()=>l.slice(0,30).reverse().map(w=>{var E;return{date:Ms(w).toLocaleDateString("tr-TR",{day:"numeric",month:"short"}),margin:Number(((E=w.payload)==null?void 0:E.profitMargin)||0),id:w.id}}),[l]),g=b.useMemo(()=>{const w=[];u.pending>0&&w.push({type:"warning",message:`${u.pending} teklif onay bekliyor`,action:"/my-offers"}),u.rejected>0&&w.push({type:"error",message:`${u.rejected} teklif reddedildi`,action:"/my-offers"});const E=c.limit>0?c.used/c.limit*100:0;return E>=90?w.push({type:"error",message:`Kota limitinizin %${E.toFixed(0)}'na ulatnz`}):E>=70&&w.push({type:"warning",message:`Kota kullanmnz %${E.toFixed(0)} seviyesinde`}),w},[u,c]),y=b.useMemo(()=>{const w={};return l.forEach(E=>{var D;const A=((D=E.payload)==null?void 0:D.waveType)||"Dier";w[A]=(w[A]||0)+1}),Object.entries(w).map(([E,A])=>({name:J_[E]||E,count:A})).sort((E,A)=>A.count-E.count)},[l]),N=b.useMemo(()=>l.slice(0,30).reverse().map(w=>({date:Ms(w).toLocaleDateString("tr-TR",{day:"numeric",month:"short"}),amount:ki(w)})),[l]),v=c.limit>0?c.used/c.limit*100:0,S=u.revenue,_=[{label:"Hesaplama Kotanz",value:c.plan===st.PRO||c.plan===st.ENTERPRISE?"":`${c.used} / ${c.limit}`,change:c.plan,changeType:c.plan===st.FREE?"neutral":"positive",subInfo:c.plan===st.PRO||c.plan===st.ENTERPRISE?c.planEndDate?`Snrsz (${new Date(c.planEndDate).toLocaleDateString("tr-TR")} biti)`:"Snrsz":"cretsiz plan hakknz",icon:Xr},{label:"Toplam Teklifler",value:u.total.toString(),change:f.countChange!==0?`${f.countChange>0?"+":""}${f.countChange.toFixed(0)}%`:`${u.approved} onayl`,changeType:f.countChange>0?"positive":f.countChange<0?"negative":"neutral",subInfo:f.lastCount>0?`Geen ay: ${f.lastCount}`:"Tm zamanlar",icon:ma},{label:"Analiz Kotanz",value:c.plan===st.PRO||c.plan===st.ENTERPRISE?"":`${c.analysisUsed} / ${c.analysisLimit}`,change:"",changeType:"neutral",subInfo:c.plan===st.PRO||c.plan===st.ENTERPRISE?c.planEndDate?`Snrsz (${new Date(c.planEndDate).toLocaleDateString("tr-TR")} biti)`:"Snrsz":"cretsiz analiz hakknz",icon:ei},{label:"Toplam Ciro",value:jc(S),change:f.revenueChange!==0?`${f.revenueChange>0?"+":""}${f.revenueChange.toFixed(0)}%`:`%${u.approvalRate.toFixed(0)} onay`,changeType:f.revenueChange>=0?"positive":"negative",subInfo:f.lastRevenue>0?`Geen ay: ${jc(f.lastRevenue)}`:"Onaylanan tekliflerden",icon:fl}];return s?n.jsx("div",{className:"flex h-96 items-center justify-center",children:n.jsx(Ar,{className:"h-8 w-8 animate-spin text-[var(--burgundy)]"})}):n.jsxs(po,{children:[n.jsx(nu,{title:"Dashboard",description:"retim takip ve teklif ynetim sistemi",actions:n.jsx(n.Fragment,{children:n.jsxs(Re,{onClick:()=>e("/create-offer"),className:"bg-[var(--burgundy)] hover:bg-[var(--burgundy-hover)] text-white gap-2 shadow-sm",children:[n.jsx(ti,{size:16}),"Yeni Teklif"]})})}),n.jsx(q_,{}),g.length>0&&n.jsx("div",{className:"space-y-3",children:g.map((w,E)=>n.jsxs("div",{className:`flex items-center justify-between px-5 py-4 rounded-md border-2 cursor-pointer transition-smooth shadow-sm ${w.type==="error"?"bg-[#FEF2F2] border-[#FCA5A5] text-[#991B1B]":w.type==="warning"?"bg-[#FFFBEB] border-[#FDE68A] text-[#92400E]":"bg-surface-secondary border-border/60 text-foreground"}`,onClick:()=>w.action&&e(w.action),children:[n.jsxs("div",{className:"flex items-center gap-3",children:[w.type==="error"?n.jsx(ms,{size:18}):n.jsx(S1,{size:18}),n.jsx("span",{className:"text-sm font-bold tracking-tight",children:w.message})]}),w.action&&n.jsx(lo,{size:18,className:"opacity-50"})]},E))}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:_.map((w,E)=>{const A=E===0&&v>90?"default":E===0?"burgundy":"default",D=w.icon;return n.jsxs("div",{className:"relative",children:[n.jsx(W_,{title:w.label,value:w.value,icon:n.jsx(D,{size:24}),trend:{text:w.change,positive:w.changeType==="positive"?!0:w.changeType==="negative"?!1:null},description:w.subInfo,accent:A}),w.label==="Aylk Kotanz"&&n.jsx("div",{className:"absolute bottom-1 left-[2px] right-[2px] h-1 bg-surface-secondary/50 rounded-b-md overflow-hidden z-10 mx-0.5",children:n.jsx("div",{className:`h-full transition-all duration-500 rounded-b-md ${v>90?"bg-status-error":"bg-[var(--burgundy)]"}`,style:{width:`${Math.min(v,100)}%`}})})]},E)})}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[n.jsxs(tt,{className:"p-6 lg:col-span-2",children:[n.jsxs("div",{className:"mb-6",children:[n.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:"Ciro Trendi"}),n.jsx("p",{className:"text-caption mt-1",children:"Son 30 teklifin tutar dalm"})]}),N.length>0?n.jsx(zs,{width:"100%",height:280,children:n.jsxs(fo,{data:N,children:[n.jsx(Vi,{strokeDasharray:"3 3",stroke:"var(--border-light)",vertical:!1}),n.jsx(Hi,{dataKey:"date",stroke:"var(--text-tertiary)",fontSize:11,tickLine:!1,axisLine:{stroke:"var(--border-light)"}}),n.jsx($i,{stroke:"var(--text-tertiary)",fontSize:11,tickLine:!1,axisLine:{stroke:"var(--border-light)"},tickFormatter:w=>w>=1e3?`${(w/1e3).toFixed(0)}K`:w}),n.jsx(Di,{contentStyle:{backgroundColor:"var(--card)",border:"1px solid var(--border)",borderRadius:"6px",fontSize:"12px"},formatter:w=>[`${w.toLocaleString("tr-TR",{minimumFractionDigits:2})}`,"Tutar"]}),n.jsx(rl,{type:"monotone",dataKey:"amount",stroke:"var(--burgundy)",strokeWidth:2,dot:{fill:"var(--burgundy)",r:3},name:"Tutar"})]})}):n.jsx("div",{className:"flex items-center justify-center h-[280px] text-text-tertiary",children:"Henz teklif verisi bulunmuyor"})]}),n.jsxs(tt,{className:"p-6",children:[n.jsxs("div",{className:"mb-4",children:[n.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:"Durum Dalm"}),n.jsx("p",{className:"text-caption mt-1",children:"Tekliflerin duruma gre dalm"})]}),h.length>0?n.jsxs(n.Fragment,{children:[n.jsx(zs,{width:"100%",height:200,children:n.jsxs(rS,{children:[n.jsx(aS,{data:h,cx:"50%",cy:"50%",innerRadius:55,outerRadius:80,paddingAngle:3,dataKey:"value",children:h.map((w,E)=>n.jsx(nS,{fill:w.color},E))}),n.jsx(Di,{contentStyle:{backgroundColor:"var(--card)",border:"1px solid var(--border)",borderRadius:"6px",fontSize:"12px"},formatter:(w,E)=>[`${w} adet`,E]})]})}),n.jsx("div",{className:"space-y-2 mt-2",children:h.map((w,E)=>n.jsxs("div",{className:"flex items-center justify-between text-sm",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:w.color}}),n.jsx("span",{className:"text-text-secondary",children:w.name})]}),n.jsx("span",{className:"font-medium text-text-primary",children:w.value})]},E))})]}):n.jsx("div",{className:"flex items-center justify-center h-[200px] text-text-tertiary",children:"Veri yok"})]})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[n.jsxs(tt,{className:"p-6 lg:col-span-2 relative overflow-hidden",children:[n.jsxs("div",{className:"mb-6",children:[n.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:"Kar Marj Trendi"}),n.jsxs("p",{className:"text-caption mt-1",children:["Son 30 teklifin kar marj  kesikli izgi: %",((F=a==null?void 0:a.settings)==null?void 0:F.defaultMargin)??20," hedef"]})]}),n.jsx("div",{className:ya[(c==null?void 0:c.plan)||st.FREE].features.advancedAnalytics?"":"blur-sm opacity-50 pointer-events-none",children:p.length>0?n.jsx(zs,{width:"100%",height:260,children:n.jsxs(fo,{data:p,children:[n.jsx(Vi,{strokeDasharray:"3 3",stroke:"var(--border-light)",vertical:!1}),n.jsx(Hi,{dataKey:"date",stroke:"var(--text-tertiary)",fontSize:11,tickLine:!1,axisLine:{stroke:"var(--border-light)"}}),n.jsx($i,{stroke:"var(--text-tertiary)",fontSize:11,tickLine:!1,axisLine:{stroke:"var(--border-light)"},tickFormatter:w=>`%${w}`,domain:[0,"auto"]}),n.jsx(Jd,{y:((k=a==null?void 0:a.settings)==null?void 0:k.defaultMargin)??20,stroke:"#ef4444",strokeDasharray:"6 4",strokeWidth:1.5,label:{value:`%${((j=a==null?void 0:a.settings)==null?void 0:j.defaultMargin)??20} Hedef`,position:"insideTopRight",fill:"#ef4444",fontSize:10}}),n.jsx(Di,{contentStyle:{backgroundColor:"var(--card)",border:"1px solid var(--border)",borderRadius:"6px",fontSize:"12px"},formatter:(w,E,A)=>[`%${w.toFixed(1)}`,A.payload.id]}),n.jsx(rl,{type:"monotone",dataKey:"margin",stroke:"#22c55e",strokeWidth:2,dot:{fill:"#22c55e",r:3},name:"Marj"})]})}):n.jsx("div",{className:"flex items-center justify-center h-[260px] text-text-tertiary",children:"Veri yok"})}),!ya[(c==null?void 0:c.plan)||st.FREE].features.advancedAnalytics&&n.jsx("div",{className:"absolute inset-0 z-10 flex flex-col items-center justify-center bg-white/40 backdrop-blur-[2px]",children:n.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-xl border border-slate-200 text-center max-w-xs",children:[n.jsx("div",{className:"w-12 h-12 bg-[#800020]/10 rounded-full flex items-center justify-center mx-auto mb-3",children:n.jsx(Xr,{className:"text-[#800020]",size:24})}),n.jsx("h3",{className:"font-bold text-slate-800 mb-2",children:"Premium zellik"}),n.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Gelimi krllk analizi ve marj takibini grmek iin Pro plana gein."}),n.jsx(Re,{onClick:()=>e("/upgrade"),className:"w-full bg-[#800020] hover:bg-[#600018] text-white",children:"Plan Ykselt"})]})})]}),n.jsxs(tt,{className:"p-6 relative overflow-hidden",children:[n.jsxs("div",{className:"mb-4",children:[n.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:"Malzeme Dalm"}),n.jsx("p",{className:"text-caption mt-1",children:"Dalga tipi baznda teklif says"})]}),n.jsx("div",{className:ya[(c==null?void 0:c.plan)||st.FREE].features.advancedAnalytics?"":"blur-sm opacity-50 pointer-events-none",children:y.length>0?n.jsx(zs,{width:"100%",height:260,children:n.jsxs(sS,{data:y,layout:"vertical",margin:{left:10},children:[n.jsx(Vi,{strokeDasharray:"3 3",stroke:"var(--border-light)",horizontal:!1}),n.jsx(Hi,{type:"number",stroke:"var(--text-tertiary)",fontSize:11,tickLine:!1}),n.jsx($i,{dataKey:"name",type:"category",stroke:"var(--text-tertiary)",fontSize:11,tickLine:!1,width:70}),n.jsx(Di,{contentStyle:{backgroundColor:"var(--card)",border:"1px solid var(--border)",borderRadius:"6px",fontSize:"12px"},formatter:w=>[`${w} adet`,"Teklif"]}),n.jsx(iS,{dataKey:"count",fill:"var(--burgundy)",radius:[0,4,4,0],barSize:20})]})}):n.jsx("div",{className:"flex items-center justify-center h-[260px] text-text-tertiary",children:"Veri yok"})}),!ya[(c==null?void 0:c.plan)||st.FREE].features.advancedAnalytics&&n.jsx("div",{className:"absolute inset-0 z-10 flex flex-col items-center justify-center bg-white/40 backdrop-blur-[2px]",children:n.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-xl border border-slate-200 text-center max-w-xs",children:[n.jsx("div",{className:"w-12 h-12 bg-[#800020]/10 rounded-full flex items-center justify-center mx-auto mb-3",children:n.jsx(Xr,{className:"text-[#800020]",size:24})}),n.jsx("h3",{className:"font-bold text-slate-800 mb-2",children:"Premium zellik"}),n.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"retim dalmn grmek iin Pro plana gein."}),n.jsx(Re,{onClick:()=>e("/upgrade"),className:"w-full bg-[#800020] hover:bg-[#600018] text-white",children:"Plan Ykselt"})]})})]})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs(tt,{className:"p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:"Son Teklifler"}),n.jsx("p",{className:"text-caption mt-1",children:"En son oluturulan 5 teklif"})]}),n.jsxs(Re,{variant:"ghost",size:"sm",className:"text-[var(--burgundy)]",onClick:()=>e("/my-offers"),children:["Tmn Gr",n.jsx(lo,{size:14,className:"ml-1"})]})]}),l.length>0?n.jsx("div",{className:"space-y-3",children:l.slice(0,5).map(w=>{var E;return n.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-surface-secondary/50 hover:bg-surface-secondary cursor-pointer transition-smooth",onClick:()=>e("/my-offers"),children:[n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-sm font-semibold text-[var(--burgundy)]",children:w.id}),n.jsx(ut,{variant:ed[w.status],className:"text-[10px]",children:Yl[w.status]})]}),n.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[n.jsx("span",{className:"text-sm text-text-primary truncate",children:w.customerName}),n.jsx("span",{className:"text-[10px] text-text-tertiary",children:Ms(w).toLocaleDateString("tr-TR")})]})]}),n.jsxs("div",{className:"text-right ml-3",children:[n.jsx("div",{className:"text-sm font-bold text-text-primary numeric",children:jc(ki(w))}),n.jsxs("div",{className:"text-[10px] text-text-tertiary numeric",children:["%",Number(((E=w.payload)==null?void 0:E.profitMargin)||0).toFixed(1)," marj"]})]})]},w.id)})}):n.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-text-tertiary",children:[n.jsx(ma,{size:32,className:"mb-2 opacity-20"}),n.jsx("p",{className:"text-sm",children:"Henz teklif oluturulmam"}),n.jsxs(Re,{variant:"default",size:"sm",className:"mt-3 bg-[var(--burgundy)] hover:bg-[var(--burgundy-hover)] text-xs",onClick:()=>e("/create-offer"),children:[n.jsx(ti,{size:12,className:"mr-1"})," lk Teklifinizi Oluturun"]})]})]}),n.jsxs(tt,{className:"p-6 relative overflow-hidden",children:[n.jsxs("div",{className:"mb-4",children:[n.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:"En ok Teklif Verilen Mteriler"}),n.jsx("p",{className:"text-caption mt-1",children:"Ciro baznda Top 5"})]}),n.jsx("div",{className:ya[(c==null?void 0:c.plan)||st.FREE].features.advancedAnalytics?"":"blur-sm opacity-50 pointer-events-none",children:m.length>0?n.jsx("div",{className:"space-y-4",children:m.map((w,E)=>n.jsxs("div",{className:"space-y-1.5",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"w-5 h-5 rounded-full bg-[var(--burgundy)] text-white flex items-center justify-center text-[10px] font-bold",children:E+1}),n.jsx("span",{className:"text-sm font-medium text-text-primary truncate max-w-[160px]",children:w.name})]}),n.jsxs("div",{className:"text-right",children:[n.jsx("span",{className:"text-sm font-bold text-text-primary numeric",children:jc(w.revenue)}),n.jsxs("span",{className:"text-[10px] text-text-tertiary ml-2",children:[w.count," teklif"]})]})]}),n.jsx("div",{className:"h-1.5 bg-surface-secondary rounded-full overflow-hidden",children:n.jsx("div",{className:"h-full bg-[var(--burgundy)] rounded-full transition-all duration-500",style:{width:`${x>0?w.revenue/x*100:0}%`}})})]},w.name))}):n.jsx("div",{className:"flex items-center justify-center py-12 text-text-tertiary",children:n.jsx("p",{className:"text-sm",children:"Henz mteri verisi yok"})})}),!ya[(c==null?void 0:c.plan)||st.FREE].features.advancedAnalytics&&n.jsx("div",{className:"absolute inset-0 z-10 flex flex-col items-center justify-center bg-white/40 backdrop-blur-[2px]",children:n.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-xl border border-slate-200 text-center max-w-xs",children:[n.jsx("div",{className:"w-12 h-12 bg-[#800020]/10 rounded-full flex items-center justify-center mx-auto mb-3",children:n.jsx(Xr,{className:"text-[#800020]",size:24})}),n.jsx("h3",{className:"font-bold text-slate-800 mb-2",children:"Premium zellik"}),n.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Mteri byme trendlerini grmek iin Pro plana gein."}),n.jsx(Re,{onClick:()=>e("/upgrade"),className:"w-full bg-[#800020] hover:bg-[#600018] text-white",children:"Plan Ykselt"})]})})]})]})]})}function iu(e){const t=e+"CollectionProvider",[r,a]=In(t),[s,i]=r(t,{collectionRef:{current:null},itemMap:new Map}),l=m=>{const{scope:x,children:p}=m,g=me.useRef(null),y=me.useRef(new Map).current;return n.jsx(s,{scope:x,itemMap:y,collectionRef:g,children:p})};l.displayName=t;const o=e+"CollectionSlot",c=me.forwardRef((m,x)=>{const{scope:p,children:g}=m,y=i(o,p),N=Yt(x,y.collectionRef);return n.jsx(Qs,{ref:N,children:g})});c.displayName=o;const d=e+"CollectionItemSlot",u="data-radix-collection-item",f=me.forwardRef((m,x)=>{const{scope:p,children:g,...y}=m,N=me.useRef(null),v=Yt(x,N),S=i(d,p);return me.useEffect(()=>(S.itemMap.set(N,{ref:N,...y}),()=>void S.itemMap.delete(N))),n.jsx(Qs,{[u]:"",ref:v,children:g})});f.displayName=d;function h(m){const x=i(e+"CollectionConsumer",m);return me.useCallback(()=>{const g=x.collectionRef.current;if(!g)return[];const y=Array.from(g.querySelectorAll(`[${u}]`));return Array.from(x.itemMap.values()).sort((S,_)=>y.indexOf(S.ref.current)-y.indexOf(_.ref.current))},[x.collectionRef,x.itemMap])}return[{Provider:l,Slot:c,ItemSlot:f},h,a]}var eC=b.createContext(void 0);function Qo(e){const t=b.useContext(eC);return e||t||"ltr"}const tC=["top","right","bottom","left"],gs=Math.min,ka=Math.max,pd=Math.round,Ec=Math.floor,Dn=e=>({x:e,y:e}),rC={left:"right",right:"left",bottom:"top",top:"bottom"},aC={start:"end",end:"start"};function l0(e,t,r){return ka(e,gs(t,r))}function Gn(e,t){return typeof e=="function"?e(t):e}function Yn(e){return e.split("-")[0]}function xl(e){return e.split("-")[1]}function Ih(e){return e==="x"?"y":"x"}function Lh(e){return e==="y"?"height":"width"}const nC=new Set(["top","bottom"]);function An(e){return nC.has(Yn(e))?"y":"x"}function Bh(e){return Ih(An(e))}function sC(e,t,r){r===void 0&&(r=!1);const a=xl(e),s=Bh(e),i=Lh(s);let l=s==="x"?a===(r?"end":"start")?"right":"left":a==="start"?"bottom":"top";return t.reference[i]>t.floating[i]&&(l=gd(l)),[l,gd(l)]}function iC(e){const t=gd(e);return[o0(e),t,o0(t)]}function o0(e){return e.replace(/start|end/g,t=>aC[t])}const wp=["left","right"],kp=["right","left"],lC=["top","bottom"],oC=["bottom","top"];function cC(e,t,r){switch(e){case"top":case"bottom":return r?t?kp:wp:t?wp:kp;case"left":case"right":return t?lC:oC;default:return[]}}function dC(e,t,r,a){const s=xl(e);let i=cC(Yn(e),r==="start",a);return s&&(i=i.map(l=>l+"-"+s),t&&(i=i.concat(i.map(o0)))),i}function gd(e){return e.replace(/left|right|bottom|top/g,t=>rC[t])}function uC(e){return{top:0,right:0,bottom:0,left:0,...e}}function Py(e){return typeof e!="number"?uC(e):{top:e,right:e,bottom:e,left:e}}function vd(e){const{x:t,y:r,width:a,height:s}=e;return{width:a,height:s,top:r,left:t,right:t+a,bottom:r+s,x:t,y:r}}function Np(e,t,r){let{reference:a,floating:s}=e;const i=An(t),l=Bh(t),o=Lh(l),c=Yn(t),d=i==="y",u=a.x+a.width/2-s.width/2,f=a.y+a.height/2-s.height/2,h=a[o]/2-s[o]/2;let m;switch(c){case"top":m={x:u,y:a.y-s.height};break;case"bottom":m={x:u,y:a.y+a.height};break;case"right":m={x:a.x+a.width,y:f};break;case"left":m={x:a.x-s.width,y:f};break;default:m={x:a.x,y:a.y}}switch(xl(t)){case"start":m[l]-=h*(r&&d?-1:1);break;case"end":m[l]+=h*(r&&d?-1:1);break}return m}async function fC(e,t){var r;t===void 0&&(t={});const{x:a,y:s,platform:i,rects:l,elements:o,strategy:c}=e,{boundary:d="clippingAncestors",rootBoundary:u="viewport",elementContext:f="floating",altBoundary:h=!1,padding:m=0}=Gn(t,e),x=Py(m),g=o[h?f==="floating"?"reference":"floating":f],y=vd(await i.getClippingRect({element:(r=await(i.isElement==null?void 0:i.isElement(g)))==null||r?g:g.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(o.floating)),boundary:d,rootBoundary:u,strategy:c})),N=f==="floating"?{x:a,y:s,width:l.floating.width,height:l.floating.height}:l.reference,v=await(i.getOffsetParent==null?void 0:i.getOffsetParent(o.floating)),S=await(i.isElement==null?void 0:i.isElement(v))?await(i.getScale==null?void 0:i.getScale(v))||{x:1,y:1}:{x:1,y:1},_=vd(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:N,offsetParent:v,strategy:c}):N);return{top:(y.top-_.top+x.top)/S.y,bottom:(_.bottom-y.bottom+x.bottom)/S.y,left:(y.left-_.left+x.left)/S.x,right:(_.right-y.right+x.right)/S.x}}const hC=async(e,t,r)=>{const{placement:a="bottom",strategy:s="absolute",middleware:i=[],platform:l}=r,o=i.filter(Boolean),c=await(l.isRTL==null?void 0:l.isRTL(t));let d=await l.getElementRects({reference:e,floating:t,strategy:s}),{x:u,y:f}=Np(d,a,c),h=a,m={},x=0;for(let g=0;g<o.length;g++){var p;const{name:y,fn:N}=o[g],{x:v,y:S,data:_,reset:F}=await N({x:u,y:f,initialPlacement:a,placement:h,strategy:s,middlewareData:m,rects:d,platform:{...l,detectOverflow:(p=l.detectOverflow)!=null?p:fC},elements:{reference:e,floating:t}});u=v??u,f=S??f,m={...m,[y]:{...m[y],..._}},F&&x<=50&&(x++,typeof F=="object"&&(F.placement&&(h=F.placement),F.rects&&(d=F.rects===!0?await l.getElementRects({reference:e,floating:t,strategy:s}):F.rects),{x:u,y:f}=Np(d,h,c)),g=-1)}return{x:u,y:f,placement:h,strategy:s,middlewareData:m}},mC=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:a,placement:s,rects:i,platform:l,elements:o,middlewareData:c}=t,{element:d,padding:u=0}=Gn(e,t)||{};if(d==null)return{};const f=Py(u),h={x:r,y:a},m=Bh(s),x=Lh(m),p=await l.getDimensions(d),g=m==="y",y=g?"top":"left",N=g?"bottom":"right",v=g?"clientHeight":"clientWidth",S=i.reference[x]+i.reference[m]-h[m]-i.floating[x],_=h[m]-i.reference[m],F=await(l.getOffsetParent==null?void 0:l.getOffsetParent(d));let k=F?F[v]:0;(!k||!await(l.isElement==null?void 0:l.isElement(F)))&&(k=o.floating[v]||i.floating[x]);const j=S/2-_/2,w=k/2-p[x]/2-1,E=gs(f[y],w),A=gs(f[N],w),D=E,W=k-p[x]-A,re=k/2-p[x]/2+j,U=l0(D,re,W),M=!c.arrow&&xl(s)!=null&&re!==U&&i.reference[x]/2-(re<D?E:A)-p[x]/2<0,Y=M?re<D?re-D:re-W:0;return{[m]:h[m]+Y,data:{[m]:U,centerOffset:re-U-Y,...M&&{alignmentOffset:Y}},reset:M}}}),xC=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,a;const{placement:s,middlewareData:i,rects:l,initialPlacement:o,platform:c,elements:d}=t,{mainAxis:u=!0,crossAxis:f=!0,fallbackPlacements:h,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:x="none",flipAlignment:p=!0,...g}=Gn(e,t);if((r=i.arrow)!=null&&r.alignmentOffset)return{};const y=Yn(s),N=An(o),v=Yn(o)===o,S=await(c.isRTL==null?void 0:c.isRTL(d.floating)),_=h||(v||!p?[gd(o)]:iC(o)),F=x!=="none";!h&&F&&_.push(...dC(o,p,x,S));const k=[o,..._],j=await c.detectOverflow(t,g),w=[];let E=((a=i.flip)==null?void 0:a.overflows)||[];if(u&&w.push(j[y]),f){const re=sC(s,l,S);w.push(j[re[0]],j[re[1]])}if(E=[...E,{placement:s,overflows:w}],!w.every(re=>re<=0)){var A,D;const re=(((A=i.flip)==null?void 0:A.index)||0)+1,U=k[re];if(U&&(!(f==="alignment"?N!==An(U):!1)||E.every(Q=>An(Q.placement)===N?Q.overflows[0]>0:!0)))return{data:{index:re,overflows:E},reset:{placement:U}};let M=(D=E.filter(Y=>Y.overflows[0]<=0).sort((Y,Q)=>Y.overflows[1]-Q.overflows[1])[0])==null?void 0:D.placement;if(!M)switch(m){case"bestFit":{var W;const Y=(W=E.filter(Q=>{if(F){const B=An(Q.placement);return B===N||B==="y"}return!0}).map(Q=>[Q.placement,Q.overflows.filter(B=>B>0).reduce((B,V)=>B+V,0)]).sort((Q,B)=>Q[1]-B[1])[0])==null?void 0:W[0];Y&&(M=Y);break}case"initialPlacement":M=o;break}if(s!==M)return{reset:{placement:M}}}return{}}}};function jp(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function Ep(e){return tC.some(t=>e[t]>=0)}const pC=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:r,platform:a}=t,{strategy:s="referenceHidden",...i}=Gn(e,t);switch(s){case"referenceHidden":{const l=await a.detectOverflow(t,{...i,elementContext:"reference"}),o=jp(l,r.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:Ep(o)}}}case"escaped":{const l=await a.detectOverflow(t,{...i,altBoundary:!0}),o=jp(l,r.floating);return{data:{escapedOffsets:o,escaped:Ep(o)}}}default:return{}}}}},Oy=new Set(["left","top"]);async function gC(e,t){const{placement:r,platform:a,elements:s}=e,i=await(a.isRTL==null?void 0:a.isRTL(s.floating)),l=Yn(r),o=xl(r),c=An(r)==="y",d=Oy.has(l)?-1:1,u=i&&c?-1:1,f=Gn(t,e);let{mainAxis:h,crossAxis:m,alignmentAxis:x}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:f.mainAxis||0,crossAxis:f.crossAxis||0,alignmentAxis:f.alignmentAxis};return o&&typeof x=="number"&&(m=o==="end"?x*-1:x),c?{x:m*u,y:h*d}:{x:h*d,y:m*u}}const vC=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,a;const{x:s,y:i,placement:l,middlewareData:o}=t,c=await gC(t,e);return l===((r=o.offset)==null?void 0:r.placement)&&(a=o.arrow)!=null&&a.alignmentOffset?{}:{x:s+c.x,y:i+c.y,data:{...c,placement:l}}}}},yC=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:a,placement:s,platform:i}=t,{mainAxis:l=!0,crossAxis:o=!1,limiter:c={fn:y=>{let{x:N,y:v}=y;return{x:N,y:v}}},...d}=Gn(e,t),u={x:r,y:a},f=await i.detectOverflow(t,d),h=An(Yn(s)),m=Ih(h);let x=u[m],p=u[h];if(l){const y=m==="y"?"top":"left",N=m==="y"?"bottom":"right",v=x+f[y],S=x-f[N];x=l0(v,x,S)}if(o){const y=h==="y"?"top":"left",N=h==="y"?"bottom":"right",v=p+f[y],S=p-f[N];p=l0(v,p,S)}const g=c.fn({...t,[m]:x,[h]:p});return{...g,data:{x:g.x-r,y:g.y-a,enabled:{[m]:l,[h]:o}}}}}},bC=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:a,placement:s,rects:i,middlewareData:l}=t,{offset:o=0,mainAxis:c=!0,crossAxis:d=!0}=Gn(e,t),u={x:r,y:a},f=An(s),h=Ih(f);let m=u[h],x=u[f];const p=Gn(o,t),g=typeof p=="number"?{mainAxis:p,crossAxis:0}:{mainAxis:0,crossAxis:0,...p};if(c){const v=h==="y"?"height":"width",S=i.reference[h]-i.floating[v]+g.mainAxis,_=i.reference[h]+i.reference[v]-g.mainAxis;m<S?m=S:m>_&&(m=_)}if(d){var y,N;const v=h==="y"?"width":"height",S=Oy.has(Yn(s)),_=i.reference[f]-i.floating[v]+(S&&((y=l.offset)==null?void 0:y[f])||0)+(S?0:g.crossAxis),F=i.reference[f]+i.reference[v]+(S?0:((N=l.offset)==null?void 0:N[f])||0)-(S?g.crossAxis:0);x<_?x=_:x>F&&(x=F)}return{[h]:m,[f]:x}}}},wC=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var r,a;const{placement:s,rects:i,platform:l,elements:o}=t,{apply:c=()=>{},...d}=Gn(e,t),u=await l.detectOverflow(t,d),f=Yn(s),h=xl(s),m=An(s)==="y",{width:x,height:p}=i.floating;let g,y;f==="top"||f==="bottom"?(g=f,y=h===(await(l.isRTL==null?void 0:l.isRTL(o.floating))?"start":"end")?"left":"right"):(y=f,g=h==="end"?"top":"bottom");const N=p-u.top-u.bottom,v=x-u.left-u.right,S=gs(p-u[g],N),_=gs(x-u[y],v),F=!t.middlewareData.shift;let k=S,j=_;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(j=v),(a=t.middlewareData.shift)!=null&&a.enabled.y&&(k=N),F&&!h){const E=ka(u.left,0),A=ka(u.right,0),D=ka(u.top,0),W=ka(u.bottom,0);m?j=x-2*(E!==0||A!==0?E+A:ka(u.left,u.right)):k=p-2*(D!==0||W!==0?D+W:ka(u.top,u.bottom))}await c({...t,availableWidth:j,availableHeight:k});const w=await l.getDimensions(o.floating);return x!==w.width||p!==w.height?{reset:{rects:!0}}:{}}}};function lu(){return typeof window<"u"}function pl(e){return Iy(e)?(e.nodeName||"").toLowerCase():"#document"}function Aa(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Ln(e){var t;return(t=(Iy(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function Iy(e){return lu()?e instanceof Node||e instanceof Aa(e).Node:!1}function gn(e){return lu()?e instanceof Element||e instanceof Aa(e).Element:!1}function Pn(e){return lu()?e instanceof HTMLElement||e instanceof Aa(e).HTMLElement:!1}function Sp(e){return!lu()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Aa(e).ShadowRoot}const kC=new Set(["inline","contents"]);function ec(e){const{overflow:t,overflowX:r,overflowY:a,display:s}=vn(e);return/auto|scroll|overlay|hidden|clip/.test(t+a+r)&&!kC.has(s)}const NC=new Set(["table","td","th"]);function jC(e){return NC.has(pl(e))}const EC=[":popover-open",":modal"];function ou(e){return EC.some(t=>{try{return e.matches(t)}catch{return!1}})}const SC=["transform","translate","scale","rotate","perspective"],TC=["transform","translate","scale","rotate","perspective","filter"],AC=["paint","layout","strict","content"];function zh(e){const t=Uh(),r=gn(e)?vn(e):e;return SC.some(a=>r[a]?r[a]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||TC.some(a=>(r.willChange||"").includes(a))||AC.some(a=>(r.contain||"").includes(a))}function _C(e){let t=vs(e);for(;Pn(t)&&!al(t);){if(zh(t))return t;if(ou(t))return null;t=vs(t)}return null}function Uh(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const CC=new Set(["html","body","#document"]);function al(e){return CC.has(pl(e))}function vn(e){return Aa(e).getComputedStyle(e)}function cu(e){return gn(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function vs(e){if(pl(e)==="html")return e;const t=e.assignedSlot||e.parentNode||Sp(e)&&e.host||Ln(e);return Sp(t)?t.host:t}function Ly(e){const t=vs(e);return al(t)?e.ownerDocument?e.ownerDocument.body:e.body:Pn(t)&&ec(t)?t:Ly(t)}function go(e,t,r){var a;t===void 0&&(t=[]),r===void 0&&(r=!0);const s=Ly(e),i=s===((a=e.ownerDocument)==null?void 0:a.body),l=Aa(s);if(i){const o=c0(l);return t.concat(l,l.visualViewport||[],ec(s)?s:[],o&&r?go(o):[])}return t.concat(s,go(s,[],r))}function c0(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function By(e){const t=vn(e);let r=parseFloat(t.width)||0,a=parseFloat(t.height)||0;const s=Pn(e),i=s?e.offsetWidth:r,l=s?e.offsetHeight:a,o=pd(r)!==i||pd(a)!==l;return o&&(r=i,a=l),{width:r,height:a,$:o}}function Vh(e){return gn(e)?e:e.contextElement}function Gi(e){const t=Vh(e);if(!Pn(t))return Dn(1);const r=t.getBoundingClientRect(),{width:a,height:s,$:i}=By(t);let l=(i?pd(r.width):r.width)/a,o=(i?pd(r.height):r.height)/s;return(!l||!Number.isFinite(l))&&(l=1),(!o||!Number.isFinite(o))&&(o=1),{x:l,y:o}}const FC=Dn(0);function zy(e){const t=Aa(e);return!Uh()||!t.visualViewport?FC:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function DC(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==Aa(e)?!1:t}function ai(e,t,r,a){t===void 0&&(t=!1),r===void 0&&(r=!1);const s=e.getBoundingClientRect(),i=Vh(e);let l=Dn(1);t&&(a?gn(a)&&(l=Gi(a)):l=Gi(e));const o=DC(i,r,a)?zy(i):Dn(0);let c=(s.left+o.x)/l.x,d=(s.top+o.y)/l.y,u=s.width/l.x,f=s.height/l.y;if(i){const h=Aa(i),m=a&&gn(a)?Aa(a):a;let x=h,p=c0(x);for(;p&&a&&m!==x;){const g=Gi(p),y=p.getBoundingClientRect(),N=vn(p),v=y.left+(p.clientLeft+parseFloat(N.paddingLeft))*g.x,S=y.top+(p.clientTop+parseFloat(N.paddingTop))*g.y;c*=g.x,d*=g.y,u*=g.x,f*=g.y,c+=v,d+=S,x=Aa(p),p=c0(x)}}return vd({width:u,height:f,x:c,y:d})}function du(e,t){const r=cu(e).scrollLeft;return t?t.left+r:ai(Ln(e)).left+r}function Uy(e,t){const r=e.getBoundingClientRect(),a=r.left+t.scrollLeft-du(e,r),s=r.top+t.scrollTop;return{x:a,y:s}}function RC(e){let{elements:t,rect:r,offsetParent:a,strategy:s}=e;const i=s==="fixed",l=Ln(a),o=t?ou(t.floating):!1;if(a===l||o&&i)return r;let c={scrollLeft:0,scrollTop:0},d=Dn(1);const u=Dn(0),f=Pn(a);if((f||!f&&!i)&&((pl(a)!=="body"||ec(l))&&(c=cu(a)),Pn(a))){const m=ai(a);d=Gi(a),u.x=m.x+a.clientLeft,u.y=m.y+a.clientTop}const h=l&&!f&&!i?Uy(l,c):Dn(0);return{width:r.width*d.x,height:r.height*d.y,x:r.x*d.x-c.scrollLeft*d.x+u.x+h.x,y:r.y*d.y-c.scrollTop*d.y+u.y+h.y}}function MC(e){return Array.from(e.getClientRects())}function PC(e){const t=Ln(e),r=cu(e),a=e.ownerDocument.body,s=ka(t.scrollWidth,t.clientWidth,a.scrollWidth,a.clientWidth),i=ka(t.scrollHeight,t.clientHeight,a.scrollHeight,a.clientHeight);let l=-r.scrollLeft+du(e);const o=-r.scrollTop;return vn(a).direction==="rtl"&&(l+=ka(t.clientWidth,a.clientWidth)-s),{width:s,height:i,x:l,y:o}}const Tp=25;function OC(e,t){const r=Aa(e),a=Ln(e),s=r.visualViewport;let i=a.clientWidth,l=a.clientHeight,o=0,c=0;if(s){i=s.width,l=s.height;const u=Uh();(!u||u&&t==="fixed")&&(o=s.offsetLeft,c=s.offsetTop)}const d=du(a);if(d<=0){const u=a.ownerDocument,f=u.body,h=getComputedStyle(f),m=u.compatMode==="CSS1Compat"&&parseFloat(h.marginLeft)+parseFloat(h.marginRight)||0,x=Math.abs(a.clientWidth-f.clientWidth-m);x<=Tp&&(i-=x)}else d<=Tp&&(i+=d);return{width:i,height:l,x:o,y:c}}const IC=new Set(["absolute","fixed"]);function LC(e,t){const r=ai(e,!0,t==="fixed"),a=r.top+e.clientTop,s=r.left+e.clientLeft,i=Pn(e)?Gi(e):Dn(1),l=e.clientWidth*i.x,o=e.clientHeight*i.y,c=s*i.x,d=a*i.y;return{width:l,height:o,x:c,y:d}}function Ap(e,t,r){let a;if(t==="viewport")a=OC(e,r);else if(t==="document")a=PC(Ln(e));else if(gn(t))a=LC(t,r);else{const s=zy(e);a={x:t.x-s.x,y:t.y-s.y,width:t.width,height:t.height}}return vd(a)}function Vy(e,t){const r=vs(e);return r===t||!gn(r)||al(r)?!1:vn(r).position==="fixed"||Vy(r,t)}function BC(e,t){const r=t.get(e);if(r)return r;let a=go(e,[],!1).filter(o=>gn(o)&&pl(o)!=="body"),s=null;const i=vn(e).position==="fixed";let l=i?vs(e):e;for(;gn(l)&&!al(l);){const o=vn(l),c=zh(l);!c&&o.position==="fixed"&&(s=null),(i?!c&&!s:!c&&o.position==="static"&&!!s&&IC.has(s.position)||ec(l)&&!c&&Vy(e,l))?a=a.filter(u=>u!==l):s=o,l=vs(l)}return t.set(e,a),a}function zC(e){let{element:t,boundary:r,rootBoundary:a,strategy:s}=e;const l=[...r==="clippingAncestors"?ou(t)?[]:BC(t,this._c):[].concat(r),a],o=l[0],c=l.reduce((d,u)=>{const f=Ap(t,u,s);return d.top=ka(f.top,d.top),d.right=gs(f.right,d.right),d.bottom=gs(f.bottom,d.bottom),d.left=ka(f.left,d.left),d},Ap(t,o,s));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function UC(e){const{width:t,height:r}=By(e);return{width:t,height:r}}function VC(e,t,r){const a=Pn(t),s=Ln(t),i=r==="fixed",l=ai(e,!0,i,t);let o={scrollLeft:0,scrollTop:0};const c=Dn(0);function d(){c.x=du(s)}if(a||!a&&!i)if((pl(t)!=="body"||ec(s))&&(o=cu(t)),a){const m=ai(t,!0,i,t);c.x=m.x+t.clientLeft,c.y=m.y+t.clientTop}else s&&d();i&&!a&&s&&d();const u=s&&!a&&!i?Uy(s,o):Dn(0),f=l.left+o.scrollLeft-c.x-u.x,h=l.top+o.scrollTop-c.y-u.y;return{x:f,y:h,width:l.width,height:l.height}}function Wu(e){return vn(e).position==="static"}function _p(e,t){if(!Pn(e)||vn(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return Ln(e)===r&&(r=r.ownerDocument.body),r}function Hy(e,t){const r=Aa(e);if(ou(e))return r;if(!Pn(e)){let s=vs(e);for(;s&&!al(s);){if(gn(s)&&!Wu(s))return s;s=vs(s)}return r}let a=_p(e,t);for(;a&&jC(a)&&Wu(a);)a=_p(a,t);return a&&al(a)&&Wu(a)&&!zh(a)?r:a||_C(e)||r}const HC=async function(e){const t=this.getOffsetParent||Hy,r=this.getDimensions,a=await r(e.floating);return{reference:VC(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:a.width,height:a.height}}};function $C(e){return vn(e).direction==="rtl"}const KC={convertOffsetParentRelativeRectToViewportRelativeRect:RC,getDocumentElement:Ln,getClippingRect:zC,getOffsetParent:Hy,getElementRects:HC,getClientRects:MC,getDimensions:UC,getScale:Gi,isElement:gn,isRTL:$C};function $y(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function WC(e,t){let r=null,a;const s=Ln(e);function i(){var o;clearTimeout(a),(o=r)==null||o.disconnect(),r=null}function l(o,c){o===void 0&&(o=!1),c===void 0&&(c=1),i();const d=e.getBoundingClientRect(),{left:u,top:f,width:h,height:m}=d;if(o||t(),!h||!m)return;const x=Ec(f),p=Ec(s.clientWidth-(u+h)),g=Ec(s.clientHeight-(f+m)),y=Ec(u),v={rootMargin:-x+"px "+-p+"px "+-g+"px "+-y+"px",threshold:ka(0,gs(1,c))||1};let S=!0;function _(F){const k=F[0].intersectionRatio;if(k!==c){if(!S)return l();k?l(!1,k):a=setTimeout(()=>{l(!1,1e-7)},1e3)}k===1&&!$y(d,e.getBoundingClientRect())&&l(),S=!1}try{r=new IntersectionObserver(_,{...v,root:s.ownerDocument})}catch{r=new IntersectionObserver(_,v)}r.observe(e)}return l(!0),i}function GC(e,t,r,a){a===void 0&&(a={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:l=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:c=!1}=a,d=Vh(e),u=s||i?[...d?go(d):[],...go(t)]:[];u.forEach(y=>{s&&y.addEventListener("scroll",r,{passive:!0}),i&&y.addEventListener("resize",r)});const f=d&&o?WC(d,r):null;let h=-1,m=null;l&&(m=new ResizeObserver(y=>{let[N]=y;N&&N.target===d&&m&&(m.unobserve(t),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var v;(v=m)==null||v.observe(t)})),r()}),d&&!c&&m.observe(d),m.observe(t));let x,p=c?ai(e):null;c&&g();function g(){const y=ai(e);p&&!$y(p,y)&&r(),p=y,x=requestAnimationFrame(g)}return r(),()=>{var y;u.forEach(N=>{s&&N.removeEventListener("scroll",r),i&&N.removeEventListener("resize",r)}),f==null||f(),(y=m)==null||y.disconnect(),m=null,c&&cancelAnimationFrame(x)}}const YC=vC,XC=yC,qC=xC,ZC=wC,JC=pC,Cp=mC,QC=bC,e4=(e,t,r)=>{const a=new Map,s={platform:KC,...r},i={...s.platform,_c:a};return hC(e,t,{...s,platform:i})};var t4=typeof document<"u",r4=function(){},td=t4?b.useLayoutEffect:r4;function yd(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,a,s;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(a=r;a--!==0;)if(!yd(e[a],t[a]))return!1;return!0}if(s=Object.keys(e),r=s.length,r!==Object.keys(t).length)return!1;for(a=r;a--!==0;)if(!{}.hasOwnProperty.call(t,s[a]))return!1;for(a=r;a--!==0;){const i=s[a];if(!(i==="_owner"&&e.$$typeof)&&!yd(e[i],t[i]))return!1}return!0}return e!==e&&t!==t}function Ky(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function Fp(e,t){const r=Ky(e);return Math.round(t*r)/r}function Gu(e){const t=b.useRef(e);return td(()=>{t.current=e}),t}function a4(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:a=[],platform:s,elements:{reference:i,floating:l}={},transform:o=!0,whileElementsMounted:c,open:d}=e,[u,f]=b.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[h,m]=b.useState(a);yd(h,a)||m(a);const[x,p]=b.useState(null),[g,y]=b.useState(null),N=b.useCallback(Q=>{Q!==F.current&&(F.current=Q,p(Q))},[]),v=b.useCallback(Q=>{Q!==k.current&&(k.current=Q,y(Q))},[]),S=i||x,_=l||g,F=b.useRef(null),k=b.useRef(null),j=b.useRef(u),w=c!=null,E=Gu(c),A=Gu(s),D=Gu(d),W=b.useCallback(()=>{if(!F.current||!k.current)return;const Q={placement:t,strategy:r,middleware:h};A.current&&(Q.platform=A.current),e4(F.current,k.current,Q).then(B=>{const V={...B,isPositioned:D.current!==!1};re.current&&!yd(j.current,V)&&(j.current=V,Zd.flushSync(()=>{f(V)}))})},[h,t,r,A,D]);td(()=>{d===!1&&j.current.isPositioned&&(j.current.isPositioned=!1,f(Q=>({...Q,isPositioned:!1})))},[d]);const re=b.useRef(!1);td(()=>(re.current=!0,()=>{re.current=!1}),[]),td(()=>{if(S&&(F.current=S),_&&(k.current=_),S&&_){if(E.current)return E.current(S,_,W);W()}},[S,_,W,E,w]);const U=b.useMemo(()=>({reference:F,floating:k,setReference:N,setFloating:v}),[N,v]),M=b.useMemo(()=>({reference:S,floating:_}),[S,_]),Y=b.useMemo(()=>{const Q={position:r,left:0,top:0};if(!M.floating)return Q;const B=Fp(M.floating,u.x),V=Fp(M.floating,u.y);return o?{...Q,transform:"translate("+B+"px, "+V+"px)",...Ky(M.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:B,top:V}},[r,o,M.floating,u.x,u.y]);return b.useMemo(()=>({...u,update:W,refs:U,elements:M,floatingStyles:Y}),[u,W,U,M,Y])}const n4=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:a,padding:s}=typeof e=="function"?e(r):e;return a&&t(a)?a.current!=null?Cp({element:a.current,padding:s}).fn(r):{}:a?Cp({element:a,padding:s}).fn(r):{}}}},s4=(e,t)=>({...YC(e),options:[e,t]}),i4=(e,t)=>({...XC(e),options:[e,t]}),l4=(e,t)=>({...QC(e),options:[e,t]}),o4=(e,t)=>({...qC(e),options:[e,t]}),c4=(e,t)=>({...ZC(e),options:[e,t]}),d4=(e,t)=>({...JC(e),options:[e,t]}),u4=(e,t)=>({...n4(e),options:[e,t]});var f4="Arrow",Wy=b.forwardRef((e,t)=>{const{children:r,width:a=10,height:s=5,...i}=e;return n.jsx(_t.svg,{...i,ref:t,width:a,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:n.jsx("polygon",{points:"0,0 30,0 15,10"})})});Wy.displayName=f4;var h4=Wy;function uu(e){const[t,r]=b.useState(void 0);return pn(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const a=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let l,o;if("borderBoxSize"in i){const c=i.borderBoxSize,d=Array.isArray(c)?c[0]:c;l=d.inlineSize,o=d.blockSize}else l=e.offsetWidth,o=e.offsetHeight;r({width:l,height:o})});return a.observe(e,{box:"border-box"}),()=>a.unobserve(e)}else r(void 0)},[e]),t}var Hh="Popper",[Gy,fu]=In(Hh),[m4,Yy]=Gy(Hh),Xy=e=>{const{__scopePopper:t,children:r}=e,[a,s]=b.useState(null);return n.jsx(m4,{scope:t,anchor:a,onAnchorChange:s,children:r})};Xy.displayName=Hh;var qy="PopperAnchor",Zy=b.forwardRef((e,t)=>{const{__scopePopper:r,virtualRef:a,...s}=e,i=Yy(qy,r),l=b.useRef(null),o=Yt(t,l);return b.useEffect(()=>{i.onAnchorChange((a==null?void 0:a.current)||l.current)}),a?null:n.jsx(_t.div,{...s,ref:o})});Zy.displayName=qy;var $h="PopperContent",[x4,p4]=Gy($h),Jy=b.forwardRef((e,t)=>{var te,G,Z,ae,de,z;const{__scopePopper:r,side:a="bottom",sideOffset:s=0,align:i="center",alignOffset:l=0,arrowPadding:o=0,avoidCollisions:c=!0,collisionBoundary:d=[],collisionPadding:u=0,sticky:f="partial",hideWhenDetached:h=!1,updatePositionStrategy:m="optimized",onPlaced:x,...p}=e,g=Yy($h,r),[y,N]=b.useState(null),v=Yt(t,Ee=>N(Ee)),[S,_]=b.useState(null),F=uu(S),k=(F==null?void 0:F.width)??0,j=(F==null?void 0:F.height)??0,w=a+(i!=="center"?"-"+i:""),E=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},A=Array.isArray(d)?d:[d],D=A.length>0,W={padding:E,boundary:A.filter(v4),altBoundary:D},{refs:re,floatingStyles:U,placement:M,isPositioned:Y,middlewareData:Q}=a4({strategy:"fixed",placement:w,whileElementsMounted:(...Ee)=>GC(...Ee,{animationFrame:m==="always"}),elements:{reference:g.anchor},middleware:[s4({mainAxis:s+j,alignmentAxis:l}),c&&i4({mainAxis:!0,crossAxis:!1,limiter:f==="partial"?l4():void 0,...W}),c&&o4({...W}),c4({...W,apply:({elements:Ee,rects:ue,availableWidth:Ce,availableHeight:ve})=>{const{width:ge,height:Fe}=ue.reference,Ie=Ee.floating.style;Ie.setProperty("--radix-popper-available-width",`${Ce}px`),Ie.setProperty("--radix-popper-available-height",`${ve}px`),Ie.setProperty("--radix-popper-anchor-width",`${ge}px`),Ie.setProperty("--radix-popper-anchor-height",`${Fe}px`)}}),S&&u4({element:S,padding:o}),y4({arrowWidth:k,arrowHeight:j}),h&&d4({strategy:"referenceHidden",...W})]}),[B,V]=tb(M),P=Yo(x);pn(()=>{Y&&(P==null||P())},[Y,P]);const T=(te=Q.arrow)==null?void 0:te.x,R=(G=Q.arrow)==null?void 0:G.y,L=((Z=Q.arrow)==null?void 0:Z.centerOffset)!==0,[X,J]=b.useState();return pn(()=>{y&&J(window.getComputedStyle(y).zIndex)},[y]),n.jsx("div",{ref:re.setFloating,"data-radix-popper-content-wrapper":"",style:{...U,transform:Y?U.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:X,"--radix-popper-transform-origin":[(ae=Q.transformOrigin)==null?void 0:ae.x,(de=Q.transformOrigin)==null?void 0:de.y].join(" "),...((z=Q.hide)==null?void 0:z.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:n.jsx(x4,{scope:r,placedSide:B,onArrowChange:_,arrowX:T,arrowY:R,shouldHideArrow:L,children:n.jsx(_t.div,{"data-side":B,"data-align":V,...p,ref:v,style:{...p.style,animation:Y?void 0:"none"}})})})});Jy.displayName=$h;var Qy="PopperArrow",g4={top:"bottom",right:"left",bottom:"top",left:"right"},eb=b.forwardRef(function(t,r){const{__scopePopper:a,...s}=t,i=p4(Qy,a),l=g4[i.placedSide];return n.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[l]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:n.jsx(h4,{...s,ref:r,style:{...s.style,display:"block"}})})});eb.displayName=Qy;function v4(e){return e!==null}var y4=e=>({name:"transformOrigin",options:e,fn(t){var g,y,N;const{placement:r,rects:a,middlewareData:s}=t,l=((g=s.arrow)==null?void 0:g.centerOffset)!==0,o=l?0:e.arrowWidth,c=l?0:e.arrowHeight,[d,u]=tb(r),f={start:"0%",center:"50%",end:"100%"}[u],h=(((y=s.arrow)==null?void 0:y.x)??0)+o/2,m=(((N=s.arrow)==null?void 0:N.y)??0)+c/2;let x="",p="";return d==="bottom"?(x=l?f:`${h}px`,p=`${-c}px`):d==="top"?(x=l?f:`${h}px`,p=`${a.floating.height+c}px`):d==="right"?(x=`${-c}px`,p=l?f:`${m}px`):d==="left"&&(x=`${a.floating.width+c}px`,p=l?f:`${m}px`),{data:{x,y:p}}}});function tb(e){const[t,r="center"]=e.split("-");return[t,r]}var rb=Xy,ab=Zy,nb=Jy,sb=eb,Yu="rovingFocusGroup.onEntryFocus",b4={bubbles:!1,cancelable:!0},hu="RovingFocusGroup",[d0,ib,w4]=iu(hu),[k4,mu]=In(hu,[w4]),[N4,j4]=k4(hu),lb=b.forwardRef((e,t)=>n.jsx(d0.Provider,{scope:e.__scopeRovingFocusGroup,children:n.jsx(d0.Slot,{scope:e.__scopeRovingFocusGroup,children:n.jsx(E4,{...e,ref:t})})}));lb.displayName=hu;var E4=b.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,orientation:a,loop:s=!1,dir:i,currentTabStopId:l,defaultCurrentTabStopId:o,onCurrentTabStopIdChange:c,onEntryFocus:d,preventScrollOnEntryFocus:u=!1,...f}=e,h=b.useRef(null),m=Yt(t,h),x=Qo(i),[p=null,g]=xs({prop:l,defaultProp:o,onChange:c}),[y,N]=b.useState(!1),v=Yo(d),S=ib(r),_=b.useRef(!1),[F,k]=b.useState(0);return b.useEffect(()=>{const j=h.current;if(j)return j.addEventListener(Yu,v),()=>j.removeEventListener(Yu,v)},[v]),n.jsx(N4,{scope:r,orientation:a,dir:x,loop:s,currentTabStopId:p,onItemFocus:b.useCallback(j=>g(j),[g]),onItemShiftTab:b.useCallback(()=>N(!0),[]),onFocusableItemAdd:b.useCallback(()=>k(j=>j+1),[]),onFocusableItemRemove:b.useCallback(()=>k(j=>j-1),[]),children:n.jsx(_t.div,{tabIndex:y||F===0?-1:0,"data-orientation":a,...f,ref:m,style:{outline:"none",...e.style},onMouseDown:Je(e.onMouseDown,()=>{_.current=!0}),onFocus:Je(e.onFocus,j=>{const w=!_.current;if(j.target===j.currentTarget&&w&&!y){const E=new CustomEvent(Yu,b4);if(j.currentTarget.dispatchEvent(E),!E.defaultPrevented){const A=S().filter(M=>M.focusable),D=A.find(M=>M.active),W=A.find(M=>M.id===p),U=[D,W,...A].filter(Boolean).map(M=>M.ref.current);db(U,u)}}_.current=!1}),onBlur:Je(e.onBlur,()=>N(!1))})})}),ob="RovingFocusGroupItem",cb=b.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,focusable:a=!0,active:s=!1,tabStopId:i,...l}=e,o=ri(),c=i||o,d=j4(ob,r),u=d.currentTabStopId===c,f=ib(r),{onFocusableItemAdd:h,onFocusableItemRemove:m}=d;return b.useEffect(()=>{if(a)return h(),()=>m()},[a,h,m]),n.jsx(d0.ItemSlot,{scope:r,id:c,focusable:a,active:s,children:n.jsx(_t.span,{tabIndex:u?0:-1,"data-orientation":d.orientation,...l,ref:t,onMouseDown:Je(e.onMouseDown,x=>{a?d.onItemFocus(c):x.preventDefault()}),onFocus:Je(e.onFocus,()=>d.onItemFocus(c)),onKeyDown:Je(e.onKeyDown,x=>{if(x.key==="Tab"&&x.shiftKey){d.onItemShiftTab();return}if(x.target!==x.currentTarget)return;const p=A4(x,d.orientation,d.dir);if(p!==void 0){if(x.metaKey||x.ctrlKey||x.altKey||x.shiftKey)return;x.preventDefault();let y=f().filter(N=>N.focusable).map(N=>N.ref.current);if(p==="last")y.reverse();else if(p==="prev"||p==="next"){p==="prev"&&y.reverse();const N=y.indexOf(x.currentTarget);y=d.loop?_4(y,N+1):y.slice(N+1)}setTimeout(()=>db(y))}})})})});cb.displayName=ob;var S4={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function T4(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function A4(e,t,r){const a=T4(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(a))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(a)))return S4[a]}function db(e,t=!1){const r=document.activeElement;for(const a of e)if(a===r||(a.focus({preventScroll:t}),document.activeElement!==r))return}function _4(e,t){return e.map((r,a)=>e[(t+a)%e.length])}var ub=lb,fb=cb,u0=["Enter"," "],C4=["ArrowDown","PageUp","Home"],hb=["ArrowUp","PageDown","End"],F4=[...C4,...hb],D4={ltr:[...u0,"ArrowRight"],rtl:[...u0,"ArrowLeft"]},R4={ltr:["ArrowLeft"],rtl:["ArrowRight"]},tc="Menu",[vo,M4,P4]=iu(tc),[fi,mb]=In(tc,[P4,fu,mu]),xu=fu(),xb=mu(),[O4,hi]=fi(tc),[I4,rc]=fi(tc),pb=e=>{const{__scopeMenu:t,open:r=!1,children:a,dir:s,onOpenChange:i,modal:l=!0}=e,o=xu(t),[c,d]=b.useState(null),u=b.useRef(!1),f=Yo(i),h=Qo(s);return b.useEffect(()=>{const m=()=>{u.current=!0,document.addEventListener("pointerdown",x,{capture:!0,once:!0}),document.addEventListener("pointermove",x,{capture:!0,once:!0})},x=()=>u.current=!1;return document.addEventListener("keydown",m,{capture:!0}),()=>{document.removeEventListener("keydown",m,{capture:!0}),document.removeEventListener("pointerdown",x,{capture:!0}),document.removeEventListener("pointermove",x,{capture:!0})}},[]),n.jsx(rb,{...o,children:n.jsx(O4,{scope:t,open:r,onOpenChange:f,content:c,onContentChange:d,children:n.jsx(I4,{scope:t,onClose:b.useCallback(()=>f(!1),[f]),isUsingKeyboardRef:u,dir:h,modal:l,children:a})})})};pb.displayName=tc;var L4="MenuAnchor",Kh=b.forwardRef((e,t)=>{const{__scopeMenu:r,...a}=e,s=xu(r);return n.jsx(ab,{...s,...a,ref:t})});Kh.displayName=L4;var Wh="MenuPortal",[B4,gb]=fi(Wh,{forceMount:void 0}),vb=e=>{const{__scopeMenu:t,forceMount:r,children:a,container:s}=e,i=hi(Wh,t);return n.jsx(B4,{scope:t,forceMount:r,children:n.jsx(hl,{present:r||i.open,children:n.jsx(T1,{asChild:!0,container:s,children:a})})})};vb.displayName=Wh;var $a="MenuContent",[z4,Gh]=fi($a),yb=b.forwardRef((e,t)=>{const r=gb($a,e.__scopeMenu),{forceMount:a=r.forceMount,...s}=e,i=hi($a,e.__scopeMenu),l=rc($a,e.__scopeMenu);return n.jsx(vo.Provider,{scope:e.__scopeMenu,children:n.jsx(hl,{present:a||i.open,children:n.jsx(vo.Slot,{scope:e.__scopeMenu,children:l.modal?n.jsx(U4,{...s,ref:t}):n.jsx(V4,{...s,ref:t})})})})}),U4=b.forwardRef((e,t)=>{const r=hi($a,e.__scopeMenu),a=b.useRef(null),s=Yt(t,a);return b.useEffect(()=>{const i=a.current;if(i)return A1(i)},[]),n.jsx(Yh,{...e,ref:s,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:Je(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),V4=b.forwardRef((e,t)=>{const r=hi($a,e.__scopeMenu);return n.jsx(Yh,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),Yh=b.forwardRef((e,t)=>{const{__scopeMenu:r,loop:a=!1,trapFocus:s,onOpenAutoFocus:i,onCloseAutoFocus:l,disableOutsidePointerEvents:o,onEntryFocus:c,onEscapeKeyDown:d,onPointerDownOutside:u,onFocusOutside:f,onInteractOutside:h,onDismiss:m,disableOutsideScroll:x,...p}=e,g=hi($a,r),y=rc($a,r),N=xu(r),v=xb(r),S=M4(r),[_,F]=b.useState(null),k=b.useRef(null),j=Yt(t,k,g.onContentChange),w=b.useRef(0),E=b.useRef(""),A=b.useRef(0),D=b.useRef(null),W=b.useRef("right"),re=b.useRef(0),U=x?C1:b.Fragment,M=x?{as:Qs,allowPinchZoom:!0}:void 0,Y=B=>{var te,G;const V=E.current+B,P=S().filter(Z=>!Z.disabled),T=document.activeElement,R=(te=P.find(Z=>Z.ref.current===T))==null?void 0:te.textValue,L=P.map(Z=>Z.textValue),X=eF(L,V,R),J=(G=P.find(Z=>Z.textValue===X))==null?void 0:G.ref.current;(function Z(ae){E.current=ae,window.clearTimeout(w.current),ae!==""&&(w.current=window.setTimeout(()=>Z(""),1e3))})(V),J&&setTimeout(()=>J.focus())};b.useEffect(()=>()=>window.clearTimeout(w.current),[]),_1();const Q=b.useCallback(B=>{var P,T;return W.current===((P=D.current)==null?void 0:P.side)&&rF(B,(T=D.current)==null?void 0:T.area)},[]);return n.jsx(z4,{scope:r,searchRef:E,onItemEnter:b.useCallback(B=>{Q(B)&&B.preventDefault()},[Q]),onItemLeave:b.useCallback(B=>{var V;Q(B)||((V=k.current)==null||V.focus(),F(null))},[Q]),onTriggerLeave:b.useCallback(B=>{Q(B)&&B.preventDefault()},[Q]),pointerGraceTimerRef:A,onPointerGraceIntentChange:b.useCallback(B=>{D.current=B},[]),children:n.jsx(U,{...M,children:n.jsx(F1,{asChild:!0,trapped:s,onMountAutoFocus:Je(i,B=>{var V;B.preventDefault(),(V=k.current)==null||V.focus({preventScroll:!0})}),onUnmountAutoFocus:l,children:n.jsx(D1,{asChild:!0,disableOutsidePointerEvents:o,onEscapeKeyDown:d,onPointerDownOutside:u,onFocusOutside:f,onInteractOutside:h,onDismiss:m,children:n.jsx(ub,{asChild:!0,...v,dir:y.dir,orientation:"vertical",loop:a,currentTabStopId:_,onCurrentTabStopIdChange:F,onEntryFocus:Je(c,B=>{y.isUsingKeyboardRef.current||B.preventDefault()}),preventScrollOnEntryFocus:!0,children:n.jsx(nb,{role:"menu","aria-orientation":"vertical","data-state":Pb(g.open),"data-radix-menu-content":"",dir:y.dir,...N,...p,ref:j,style:{outline:"none",...p.style},onKeyDown:Je(p.onKeyDown,B=>{const P=B.target.closest("[data-radix-menu-content]")===B.currentTarget,T=B.ctrlKey||B.altKey||B.metaKey,R=B.key.length===1;P&&(B.key==="Tab"&&B.preventDefault(),!T&&R&&Y(B.key));const L=k.current;if(B.target!==L||!F4.includes(B.key))return;B.preventDefault();const J=S().filter(te=>!te.disabled).map(te=>te.ref.current);hb.includes(B.key)&&J.reverse(),J4(J)}),onBlur:Je(e.onBlur,B=>{B.currentTarget.contains(B.target)||(window.clearTimeout(w.current),E.current="")}),onPointerMove:Je(e.onPointerMove,yo(B=>{const V=B.target,P=re.current!==B.clientX;if(B.currentTarget.contains(V)&&P){const T=B.clientX>re.current?"right":"left";W.current=T,re.current=B.clientX}}))})})})})})})});yb.displayName=$a;var H4="MenuGroup",Xh=b.forwardRef((e,t)=>{const{__scopeMenu:r,...a}=e;return n.jsx(_t.div,{role:"group",...a,ref:t})});Xh.displayName=H4;var $4="MenuLabel",bb=b.forwardRef((e,t)=>{const{__scopeMenu:r,...a}=e;return n.jsx(_t.div,{...a,ref:t})});bb.displayName=$4;var bd="MenuItem",Dp="menu.itemSelect",pu=b.forwardRef((e,t)=>{const{disabled:r=!1,onSelect:a,...s}=e,i=b.useRef(null),l=rc(bd,e.__scopeMenu),o=Gh(bd,e.__scopeMenu),c=Yt(t,i),d=b.useRef(!1),u=()=>{const f=i.current;if(!r&&f){const h=new CustomEvent(Dp,{bubbles:!0,cancelable:!0});f.addEventListener(Dp,m=>a==null?void 0:a(m),{once:!0}),SE(f,h),h.defaultPrevented?d.current=!1:l.onClose()}};return n.jsx(wb,{...s,ref:c,disabled:r,onClick:Je(e.onClick,u),onPointerDown:f=>{var h;(h=e.onPointerDown)==null||h.call(e,f),d.current=!0},onPointerUp:Je(e.onPointerUp,f=>{var h;d.current||(h=f.currentTarget)==null||h.click()}),onKeyDown:Je(e.onKeyDown,f=>{const h=o.searchRef.current!=="";r||h&&f.key===" "||u0.includes(f.key)&&(f.currentTarget.click(),f.preventDefault())})})});pu.displayName=bd;var wb=b.forwardRef((e,t)=>{const{__scopeMenu:r,disabled:a=!1,textValue:s,...i}=e,l=Gh(bd,r),o=xb(r),c=b.useRef(null),d=Yt(t,c),[u,f]=b.useState(!1),[h,m]=b.useState("");return b.useEffect(()=>{const x=c.current;x&&m((x.textContent??"").trim())},[i.children]),n.jsx(vo.ItemSlot,{scope:r,disabled:a,textValue:s??h,children:n.jsx(fb,{asChild:!0,...o,focusable:!a,children:n.jsx(_t.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":a||void 0,"data-disabled":a?"":void 0,...i,ref:d,onPointerMove:Je(e.onPointerMove,yo(x=>{a?l.onItemLeave(x):(l.onItemEnter(x),x.defaultPrevented||x.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Je(e.onPointerLeave,yo(x=>l.onItemLeave(x))),onFocus:Je(e.onFocus,()=>f(!0)),onBlur:Je(e.onBlur,()=>f(!1))})})})}),K4="MenuCheckboxItem",kb=b.forwardRef((e,t)=>{const{checked:r=!1,onCheckedChange:a,...s}=e;return n.jsx(Tb,{scope:e.__scopeMenu,checked:r,children:n.jsx(pu,{role:"menuitemcheckbox","aria-checked":wd(r)?"mixed":r,...s,ref:t,"data-state":Zh(r),onSelect:Je(s.onSelect,()=>a==null?void 0:a(wd(r)?!0:!r),{checkForDefaultPrevented:!1})})})});kb.displayName=K4;var Nb="MenuRadioGroup",[W4,G4]=fi(Nb,{value:void 0,onValueChange:()=>{}}),jb=b.forwardRef((e,t)=>{const{value:r,onValueChange:a,...s}=e,i=Yo(a);return n.jsx(W4,{scope:e.__scopeMenu,value:r,onValueChange:i,children:n.jsx(Xh,{...s,ref:t})})});jb.displayName=Nb;var Eb="MenuRadioItem",Sb=b.forwardRef((e,t)=>{const{value:r,...a}=e,s=G4(Eb,e.__scopeMenu),i=r===s.value;return n.jsx(Tb,{scope:e.__scopeMenu,checked:i,children:n.jsx(pu,{role:"menuitemradio","aria-checked":i,...a,ref:t,"data-state":Zh(i),onSelect:Je(a.onSelect,()=>{var l;return(l=s.onValueChange)==null?void 0:l.call(s,r)},{checkForDefaultPrevented:!1})})})});Sb.displayName=Eb;var qh="MenuItemIndicator",[Tb,Y4]=fi(qh,{checked:!1}),Ab=b.forwardRef((e,t)=>{const{__scopeMenu:r,forceMount:a,...s}=e,i=Y4(qh,r);return n.jsx(hl,{present:a||wd(i.checked)||i.checked===!0,children:n.jsx(_t.span,{...s,ref:t,"data-state":Zh(i.checked)})})});Ab.displayName=qh;var X4="MenuSeparator",_b=b.forwardRef((e,t)=>{const{__scopeMenu:r,...a}=e;return n.jsx(_t.div,{role:"separator","aria-orientation":"horizontal",...a,ref:t})});_b.displayName=X4;var q4="MenuArrow",Cb=b.forwardRef((e,t)=>{const{__scopeMenu:r,...a}=e,s=xu(r);return n.jsx(sb,{...s,...a,ref:t})});Cb.displayName=q4;var Z4="MenuSub",[uG,Fb]=fi(Z4),zl="MenuSubTrigger",Db=b.forwardRef((e,t)=>{const r=hi(zl,e.__scopeMenu),a=rc(zl,e.__scopeMenu),s=Fb(zl,e.__scopeMenu),i=Gh(zl,e.__scopeMenu),l=b.useRef(null),{pointerGraceTimerRef:o,onPointerGraceIntentChange:c}=i,d={__scopeMenu:e.__scopeMenu},u=b.useCallback(()=>{l.current&&window.clearTimeout(l.current),l.current=null},[]);return b.useEffect(()=>u,[u]),b.useEffect(()=>{const f=o.current;return()=>{window.clearTimeout(f),c(null)}},[o,c]),n.jsx(Kh,{asChild:!0,...d,children:n.jsx(wb,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":s.contentId,"data-state":Pb(r.open),...e,ref:R1(t,s.onTriggerChange),onClick:f=>{var h;(h=e.onClick)==null||h.call(e,f),!(e.disabled||f.defaultPrevented)&&(f.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:Je(e.onPointerMove,yo(f=>{i.onItemEnter(f),!f.defaultPrevented&&!e.disabled&&!r.open&&!l.current&&(i.onPointerGraceIntentChange(null),l.current=window.setTimeout(()=>{r.onOpenChange(!0),u()},100))})),onPointerLeave:Je(e.onPointerLeave,yo(f=>{var m,x;u();const h=(m=r.content)==null?void 0:m.getBoundingClientRect();if(h){const p=(x=r.content)==null?void 0:x.dataset.side,g=p==="right",y=g?-5:5,N=h[g?"left":"right"],v=h[g?"right":"left"];i.onPointerGraceIntentChange({area:[{x:f.clientX+y,y:f.clientY},{x:N,y:h.top},{x:v,y:h.top},{x:v,y:h.bottom},{x:N,y:h.bottom}],side:p}),window.clearTimeout(o.current),o.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(f),f.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:Je(e.onKeyDown,f=>{var m;const h=i.searchRef.current!=="";e.disabled||h&&f.key===" "||D4[a.dir].includes(f.key)&&(r.onOpenChange(!0),(m=r.content)==null||m.focus(),f.preventDefault())})})})});Db.displayName=zl;var Rb="MenuSubContent",Mb=b.forwardRef((e,t)=>{const r=gb($a,e.__scopeMenu),{forceMount:a=r.forceMount,...s}=e,i=hi($a,e.__scopeMenu),l=rc($a,e.__scopeMenu),o=Fb(Rb,e.__scopeMenu),c=b.useRef(null),d=Yt(t,c);return n.jsx(vo.Provider,{scope:e.__scopeMenu,children:n.jsx(hl,{present:a||i.open,children:n.jsx(vo.Slot,{scope:e.__scopeMenu,children:n.jsx(Yh,{id:o.contentId,"aria-labelledby":o.triggerId,...s,ref:d,align:"start",side:l.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{var f;l.isUsingKeyboardRef.current&&((f=c.current)==null||f.focus()),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:Je(e.onFocusOutside,u=>{u.target!==o.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:Je(e.onEscapeKeyDown,u=>{l.onClose(),u.preventDefault()}),onKeyDown:Je(e.onKeyDown,u=>{var m;const f=u.currentTarget.contains(u.target),h=R4[l.dir].includes(u.key);f&&h&&(i.onOpenChange(!1),(m=o.trigger)==null||m.focus(),u.preventDefault())})})})})})});Mb.displayName=Rb;function Pb(e){return e?"open":"closed"}function wd(e){return e==="indeterminate"}function Zh(e){return wd(e)?"indeterminate":e?"checked":"unchecked"}function J4(e){const t=document.activeElement;for(const r of e)if(r===t||(r.focus(),document.activeElement!==t))return}function Q4(e,t){return e.map((r,a)=>e[(t+a)%e.length])}function eF(e,t,r){const s=t.length>1&&Array.from(t).every(d=>d===t[0])?t[0]:t,i=r?e.indexOf(r):-1;let l=Q4(e,Math.max(i,0));s.length===1&&(l=l.filter(d=>d!==r));const c=l.find(d=>d.toLowerCase().startsWith(s.toLowerCase()));return c!==r?c:void 0}function tF(e,t){const{x:r,y:a}=e;let s=!1;for(let i=0,l=t.length-1;i<t.length;l=i++){const o=t[i].x,c=t[i].y,d=t[l].x,u=t[l].y;c>a!=u>a&&r<(d-o)*(a-c)/(u-c)+o&&(s=!s)}return s}function rF(e,t){if(!t)return!1;const r={x:e.clientX,y:e.clientY};return tF(r,t)}function yo(e){return t=>t.pointerType==="mouse"?e(t):void 0}var aF=pb,nF=Kh,sF=vb,iF=yb,lF=Xh,oF=bb,cF=pu,dF=kb,uF=jb,fF=Sb,hF=Ab,mF=_b,xF=Cb,pF=Db,gF=Mb,Jh="DropdownMenu",[vF]=In(Jh,[mb]),da=mb(),[yF,Ob]=vF(Jh),Ib=e=>{const{__scopeDropdownMenu:t,children:r,dir:a,open:s,defaultOpen:i,onOpenChange:l,modal:o=!0}=e,c=da(t),d=b.useRef(null),[u=!1,f]=xs({prop:s,defaultProp:i,onChange:l});return n.jsx(yF,{scope:t,triggerId:ri(),triggerRef:d,contentId:ri(),open:u,onOpenChange:f,onOpenToggle:b.useCallback(()=>f(h=>!h),[f]),modal:o,children:n.jsx(aF,{...c,open:u,onOpenChange:f,dir:a,modal:o,children:r})})};Ib.displayName=Jh;var Lb="DropdownMenuTrigger",Bb=b.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,disabled:a=!1,...s}=e,i=Ob(Lb,r),l=da(r);return n.jsx(nF,{asChild:!0,...l,children:n.jsx(_t.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":a?"":void 0,disabled:a,...s,ref:R1(t,i.triggerRef),onPointerDown:Je(e.onPointerDown,o=>{!a&&o.button===0&&o.ctrlKey===!1&&(i.onOpenToggle(),i.open||o.preventDefault())}),onKeyDown:Je(e.onKeyDown,o=>{a||(["Enter"," "].includes(o.key)&&i.onOpenToggle(),o.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(o.key)&&o.preventDefault())})})})});Bb.displayName=Lb;var bF="DropdownMenuPortal",zb=e=>{const{__scopeDropdownMenu:t,...r}=e,a=da(t);return n.jsx(sF,{...a,...r})};zb.displayName=bF;var Ub="DropdownMenuContent",Vb=b.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...a}=e,s=Ob(Ub,r),i=da(r),l=b.useRef(!1);return n.jsx(iF,{id:s.contentId,"aria-labelledby":s.triggerId,...i,...a,ref:t,onCloseAutoFocus:Je(e.onCloseAutoFocus,o=>{var c;l.current||(c=s.triggerRef.current)==null||c.focus(),l.current=!1,o.preventDefault()}),onInteractOutside:Je(e.onInteractOutside,o=>{const c=o.detail.originalEvent,d=c.button===0&&c.ctrlKey===!0,u=c.button===2||d;(!s.modal||u)&&(l.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Vb.displayName=Ub;var wF="DropdownMenuGroup",kF=b.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...a}=e,s=da(r);return n.jsx(lF,{...s,...a,ref:t})});kF.displayName=wF;var NF="DropdownMenuLabel",Hb=b.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...a}=e,s=da(r);return n.jsx(oF,{...s,...a,ref:t})});Hb.displayName=NF;var jF="DropdownMenuItem",$b=b.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...a}=e,s=da(r);return n.jsx(cF,{...s,...a,ref:t})});$b.displayName=jF;var EF="DropdownMenuCheckboxItem",SF=b.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...a}=e,s=da(r);return n.jsx(dF,{...s,...a,ref:t})});SF.displayName=EF;var TF="DropdownMenuRadioGroup",AF=b.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...a}=e,s=da(r);return n.jsx(uF,{...s,...a,ref:t})});AF.displayName=TF;var _F="DropdownMenuRadioItem",CF=b.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...a}=e,s=da(r);return n.jsx(fF,{...s,...a,ref:t})});CF.displayName=_F;var FF="DropdownMenuItemIndicator",DF=b.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...a}=e,s=da(r);return n.jsx(hF,{...s,...a,ref:t})});DF.displayName=FF;var RF="DropdownMenuSeparator",Kb=b.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...a}=e,s=da(r);return n.jsx(mF,{...s,...a,ref:t})});Kb.displayName=RF;var MF="DropdownMenuArrow",PF=b.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...a}=e,s=da(r);return n.jsx(xF,{...s,...a,ref:t})});PF.displayName=MF;var OF="DropdownMenuSubTrigger",IF=b.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...a}=e,s=da(r);return n.jsx(pF,{...s,...a,ref:t})});IF.displayName=OF;var LF="DropdownMenuSubContent",BF=b.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...a}=e,s=da(r);return n.jsx(gF,{...s,...a,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});BF.displayName=LF;var zF=Ib,UF=Bb,VF=zb,HF=Vb,$F=Hb,KF=$b,WF=Kb;function nl({...e}){return n.jsx(zF,{"data-slot":"dropdown-menu",...e})}function sl({...e}){return n.jsx(UF,{"data-slot":"dropdown-menu-trigger",...e})}function il({className:e,sideOffset:t=4,...r}){return n.jsx(VF,{children:n.jsx(HF,{"data-slot":"dropdown-menu-content",sideOffset:t,className:We("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",e),...r})})}function Vt({className:e,inset:t,variant:r="default",...a}){return n.jsx(KF,{"data-slot":"dropdown-menu-item","data-inset":t,"data-variant":r,className:We("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...a})}function GF({className:e,inset:t,...r}){return n.jsx($F,{"data-slot":"dropdown-menu-label","data-inset":t,className:We("px-2 py-1.5 text-sm font-medium data-[inset]:pl-8",e),...r})}function YF({className:e,...t}){return n.jsx(WF,{"data-slot":"dropdown-menu-separator",className:We("bg-border -mx-1 my-1 h-px",e),...t})}function bo({...e}){return n.jsx(lh,{"data-slot":"dialog",...e})}function Wb({...e}){return n.jsx(TE,{"data-slot":"dialog-trigger",...e})}function XF({...e}){return n.jsx(fh,{"data-slot":"dialog-portal",...e})}function qF({className:e,...t}){return n.jsx(hh,{"data-slot":"dialog-overlay",className:We("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...t})}function wo({className:e,children:t,...r}){return n.jsxs(XF,{"data-slot":"dialog-portal",children:[n.jsx(qF,{}),n.jsxs(oh,{"data-slot":"dialog-content",className:We("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",e),...r,children:[t,n.jsxs(ch,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[n.jsx(M1,{}),n.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function ko({className:e,...t}){return n.jsx("div",{"data-slot":"dialog-header",className:We("flex flex-col gap-2 text-center sm:text-left",e),...t})}function Gb({className:e,...t}){return n.jsx("div",{"data-slot":"dialog-footer",className:We("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",e),...t})}function No({className:e,...t}){return n.jsx(dh,{"data-slot":"dialog-title",className:We("text-lg leading-none font-semibold",e),...t})}function kd({className:e,...t}){return n.jsx(uh,{"data-slot":"dialog-description",className:We("text-muted-foreground text-sm",e),...t})}function et({className:e,...t}){return n.jsx(AE,{"data-slot":"label",className:We("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...t})}function ze({className:e,type:t,...r}){return n.jsx("input",{type:t,"data-slot":"input",className:We("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border px-3 py-1 text-base bg-input-background transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...r})}const ZF={draft:"TASLAK",pending_approval:"ONAY BEKLYOR",approved:"ONAYLANDI",rejected:"REDDEDLD",deleted:"SLND"};function Yb({currentUserRole:e,offerStatus:t,offerId:r,isProcessing:a=!1,onAction:s,disabled:i=!1}){const[l,o]=b.useState(!1),[c,d]=b.useState(""),[u,f]=b.useState(!1),h=async(p,g)=>{f(!0);try{await s(p,g)}finally{f(!1)}},m=a||u,x=()=>{if(e==="pending_corporate")return n.jsx(Re,{disabled:!0,className:"w-full bg-slate-200 text-slate-500",children:"Yetki Bekleniyor"});const p=()=>e!==Jt.SUPER_ADMIN?null:n.jsxs(nl,{children:[n.jsx(sl,{asChild:!0,children:n.jsx(Re,{variant:"outline",size:"icon",className:"h-14 w-14 rounded-2xl border-slate-200",children:n.jsx(O1,{size:20,className:"text-status-error"})})}),n.jsxs(il,{align:"end",className:"w-56",children:[n.jsx(GF,{children:"Sper Admin Yetkileri"}),n.jsx(YF,{}),n.jsxs(Vt,{onClick:()=>h("FORCE_APPROVE"),children:[n.jsx(qf,{size:16,className:"mr-2 text-status-success"})," Zorla Onayla"]}),n.jsxs(Vt,{onClick:()=>h("FORCE_REJECT"),children:[n.jsx(Zf,{size:16,className:"mr-2 text-status-error"})," Zorla Reddet"]}),n.jsxs(Vt,{onClick:()=>h("FORCE_DRAFT"),children:[n.jsx(Jf,{size:16,className:"mr-2 text-slate-500"})," Taslaa ek"]})]})]});switch(t){case"draft":return n.jsxs("div",{className:"flex flex-col gap-3 w-full",children:[n.jsxs("div",{className:"flex gap-2 w-full",children:[n.jsxs(Re,{onClick:()=>h("SUBMIT"),disabled:m||i,className:"flex-1 bg-[var(--burgundy)] hover:bg-[var(--burgundy-hover)] text-white h-14 rounded-2xl text-lg font-bold shadow-xl shadow-burgundy/20 transition-all",children:[m?n.jsx(Ar,{className:"animate-spin mr-2"}):n.jsx(dd,{size:20,className:"mr-3"}),"Onaya Gnder"]}),p()]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs(Re,{variant:"outline",onClick:()=>h("SAVE"),disabled:m||i,className:"flex-1 h-11 rounded-xl border-slate-200",children:[n.jsx(Gd,{size:18,className:"mr-2"}),"Taslak Kaydet"]}),r&&n.jsx(Re,{variant:"ghost",onClick:()=>h("DELETE"),disabled:m||i,className:"text-status-error hover:bg-status-error/5 h-11 rounded-xl",children:n.jsx(sa,{size:18})})]})]});case"pending_approval":return e===Jt.COMPANY_ADMIN||e===Jt.SUPER_ADMIN?n.jsxs("div",{className:"flex flex-col gap-3 w-full",children:[n.jsxs("div",{className:"flex gap-2 w-full",children:[n.jsxs(Re,{onClick:()=>h("APPROVE"),disabled:m||i,className:"flex-1 bg-status-success hover:bg-status-success/90 text-white h-14 rounded-2xl text-lg font-bold shadow-xl shadow-success/20 transition-all",children:[m?n.jsx(Ar,{className:"animate-spin mr-2"}):n.jsx(qf,{size:20,className:"mr-3"}),"Onayla"]}),p()]}),n.jsxs(Re,{variant:"outline",onClick:()=>o(!0),disabled:m||i,className:"h-11 rounded-xl border-status-error/20 text-status-error hover:bg-status-error/5",children:[n.jsx(Zf,{size:18,className:"mr-2"}),"Reddet"]})]}):n.jsxs("div",{className:"flex flex-col gap-3 w-full",children:[n.jsxs("div",{className:"flex gap-2 w-full",children:[n.jsx(Re,{disabled:!0,className:"flex-1 bg-slate-100 text-slate-400 h-14 rounded-2xl text-lg font-bold",children:"Onay Bekliyor"}),p()]}),n.jsxs(Re,{variant:"outline",onClick:()=>h("WITHDRAW"),disabled:m||i,className:"h-11 rounded-xl border-slate-200",children:[n.jsx(Jf,{size:18,className:"mr-2"}),"Geri ek"]})]});case"approved":return n.jsxs("div",{className:"flex flex-col gap-3 w-full",children:[n.jsxs("div",{className:"flex gap-2 w-full",children:[n.jsxs(Re,{onClick:()=>h("PDF"),disabled:m||i,className:"flex-1 bg-slate-800 hover:bg-slate-900 text-white h-14 rounded-2xl text-lg font-bold shadow-xl transition-all",children:[n.jsx(ma,{size:20,className:"mr-3"}),"PDF ndir"]}),p()]}),n.jsx("p",{className:"text-xs text-center text-slate-400 italic",children:"Onaylanm teklifler zerinde dzenleme yaplamaz."})]});case"rejected":return n.jsxs("div",{className:"flex flex-col gap-3 w-full",children:[n.jsxs("div",{className:"flex gap-2 w-full",children:[n.jsxs(Re,{onClick:()=>h("CLONE"),disabled:m||i,className:"flex-1 bg-[var(--burgundy)] hover:bg-[var(--burgundy-hover)] text-white h-14 rounded-2xl text-lg font-bold shadow-xl shadow-burgundy/20 transition-all",children:[n.jsx(P1,{size:20,className:"mr-3"}),"Kopyala ve Dzenle"]}),p()]}),n.jsx("div",{className:"p-3 bg-status-error/5 rounded-xl border border-status-error/10",children:n.jsx("p",{className:"text-[11px] text-status-error text-center font-medium",children:"Bu teklif reddedilmitir. Yeni bir teklif oluturmak iin kopyalayabilirsiniz."})})]});default:return null}};return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between px-1",children:[n.jsx("span",{className:"text-[10px] font-black text-slate-400 uppercase tracking-[0.2em]",children:"Sistem Durumu"}),n.jsx(ut,{className:`font-black tracking-wider px-3 py-1 ${t==="approved"?"bg-status-success/10 text-status-success":t==="rejected"?"bg-status-error/10 text-status-error":t==="pending_approval"?"bg-status-warning/10 text-status-warning":"bg-slate-100 text-slate-500"}`,variant:"outline",children:ZF[t]})]}),x(),n.jsx(bo,{open:l,onOpenChange:o,children:n.jsxs(wo,{children:[n.jsxs(ko,{children:[n.jsx(No,{children:"Teklifi Reddet"}),n.jsx(kd,{children:"Ltfen bu teklifi reddetme nedeninizi belirtin. Bu bilgi teklifi oluturan kiiye iletilecektir."})]}),n.jsxs("div",{className:"py-4",children:[n.jsx(et,{htmlFor:"reason",className:"mb-2 block",children:"Red Nedeni"}),n.jsx(ze,{id:"reason",placeholder:"Fiyat ok yksek, termin sresi uygun deil vb.",value:c,onChange:p=>d(p.target.value)})]}),n.jsxs(Gb,{children:[n.jsx(Re,{variant:"outline",onClick:()=>o(!1),children:"ptal"}),n.jsx(Re,{className:"bg-status-error hover:bg-status-error/90 text-white",disabled:!c||m,onClick:async()=>{await h("REJECT",{reason:c}),o(!1)},children:"Reddet"})]})]})})]})}function Nd(e,[t,r]){return Math.min(r,Math.max(t,e))}function gu(e){const t=b.useRef({value:e,previous:e});return b.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var JF="VisuallyHidden",Xb=b.forwardRef((e,t)=>n.jsx(_t.span,{...e,ref:t,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...e.style}}));Xb.displayName=JF;var QF=[" ","Enter","ArrowUp","ArrowDown"],eD=[" ","Enter"],ac="Select",[vu,yu,tD]=iu(ac),[gl]=In(ac,[tD,fu]),bu=fu(),[rD,Ss]=gl(ac),[aD,nD]=gl(ac),qb=e=>{const{__scopeSelect:t,children:r,open:a,defaultOpen:s,onOpenChange:i,value:l,defaultValue:o,onValueChange:c,dir:d,name:u,autoComplete:f,disabled:h,required:m,form:x}=e,p=bu(t),[g,y]=b.useState(null),[N,v]=b.useState(null),[S,_]=b.useState(!1),F=Qo(d),[k=!1,j]=xs({prop:a,defaultProp:s,onChange:i}),[w,E]=xs({prop:l,defaultProp:o,onChange:c}),A=b.useRef(null),D=g?x||!!g.closest("form"):!0,[W,re]=b.useState(new Set),U=Array.from(W).map(M=>M.props.value).join(";");return n.jsx(rb,{...p,children:n.jsxs(rD,{required:m,scope:t,trigger:g,onTriggerChange:y,valueNode:N,onValueNodeChange:v,valueNodeHasChildren:S,onValueNodeHasChildrenChange:_,contentId:ri(),value:w,onValueChange:E,open:k,onOpenChange:j,dir:F,triggerPointerDownPosRef:A,disabled:h,children:[n.jsx(vu.Provider,{scope:t,children:n.jsx(aD,{scope:e.__scopeSelect,onNativeOptionAdd:b.useCallback(M=>{re(Y=>new Set(Y).add(M))},[]),onNativeOptionRemove:b.useCallback(M=>{re(Y=>{const Q=new Set(Y);return Q.delete(M),Q})},[]),children:r})}),D?n.jsxs(yw,{"aria-hidden":!0,required:m,tabIndex:-1,name:u,autoComplete:f,value:w,onChange:M=>E(M.target.value),disabled:h,form:x,children:[w===void 0?n.jsx("option",{value:""}):null,Array.from(W)]},U):null]})})};qb.displayName=ac;var Zb="SelectTrigger",Jb=b.forwardRef((e,t)=>{const{__scopeSelect:r,disabled:a=!1,...s}=e,i=bu(r),l=Ss(Zb,r),o=l.disabled||a,c=Yt(t,l.onTriggerChange),d=yu(r),u=b.useRef("touch"),[f,h,m]=bw(p=>{const g=d().filter(v=>!v.disabled),y=g.find(v=>v.value===l.value),N=ww(g,p,y);N!==void 0&&l.onValueChange(N.value)}),x=p=>{o||(l.onOpenChange(!0),m()),p&&(l.triggerPointerDownPosRef.current={x:Math.round(p.pageX),y:Math.round(p.pageY)})};return n.jsx(ab,{asChild:!0,...i,children:n.jsx(_t.button,{type:"button",role:"combobox","aria-controls":l.contentId,"aria-expanded":l.open,"aria-required":l.required,"aria-autocomplete":"none",dir:l.dir,"data-state":l.open?"open":"closed",disabled:o,"data-disabled":o?"":void 0,"data-placeholder":vw(l.value)?"":void 0,...s,ref:c,onClick:Je(s.onClick,p=>{p.currentTarget.focus(),u.current!=="mouse"&&x(p)}),onPointerDown:Je(s.onPointerDown,p=>{u.current=p.pointerType;const g=p.target;g.hasPointerCapture(p.pointerId)&&g.releasePointerCapture(p.pointerId),p.button===0&&p.ctrlKey===!1&&p.pointerType==="mouse"&&(x(p),p.preventDefault())}),onKeyDown:Je(s.onKeyDown,p=>{const g=f.current!=="";!(p.ctrlKey||p.altKey||p.metaKey)&&p.key.length===1&&h(p.key),!(g&&p.key===" ")&&QF.includes(p.key)&&(x(),p.preventDefault())})})})});Jb.displayName=Zb;var Qb="SelectValue",ew=b.forwardRef((e,t)=>{const{__scopeSelect:r,className:a,style:s,children:i,placeholder:l="",...o}=e,c=Ss(Qb,r),{onValueNodeHasChildrenChange:d}=c,u=i!==void 0,f=Yt(t,c.onValueNodeChange);return pn(()=>{d(u)},[d,u]),n.jsx(_t.span,{...o,ref:f,style:{pointerEvents:"none"},children:vw(c.value)?n.jsx(n.Fragment,{children:l}):i})});ew.displayName=Qb;var sD="SelectIcon",tw=b.forwardRef((e,t)=>{const{__scopeSelect:r,children:a,...s}=e;return n.jsx(_t.span,{"aria-hidden":!0,...s,ref:t,children:a||""})});tw.displayName=sD;var iD="SelectPortal",rw=e=>n.jsx(T1,{asChild:!0,...e});rw.displayName=iD;var ni="SelectContent",aw=b.forwardRef((e,t)=>{const r=Ss(ni,e.__scopeSelect),[a,s]=b.useState();if(pn(()=>{s(new DocumentFragment)},[]),!r.open){const i=a;return i?Zd.createPortal(n.jsx(nw,{scope:e.__scopeSelect,children:n.jsx(vu.Slot,{scope:e.__scopeSelect,children:n.jsx("div",{children:e.children})})}),i):null}return n.jsx(sw,{...e,ref:t})});aw.displayName=ni;var tn=10,[nw,Ts]=gl(ni),lD="SelectContentImpl",sw=b.forwardRef((e,t)=>{const{__scopeSelect:r,position:a="item-aligned",onCloseAutoFocus:s,onEscapeKeyDown:i,onPointerDownOutside:l,side:o,sideOffset:c,align:d,alignOffset:u,arrowPadding:f,collisionBoundary:h,collisionPadding:m,sticky:x,hideWhenDetached:p,avoidCollisions:g,...y}=e,N=Ss(ni,r),[v,S]=b.useState(null),[_,F]=b.useState(null),k=Yt(t,te=>S(te)),[j,w]=b.useState(null),[E,A]=b.useState(null),D=yu(r),[W,re]=b.useState(!1),U=b.useRef(!1);b.useEffect(()=>{if(v)return A1(v)},[v]),_1();const M=b.useCallback(te=>{const[G,...Z]=D().map(z=>z.ref.current),[ae]=Z.slice(-1),de=document.activeElement;for(const z of te)if(z===de||(z==null||z.scrollIntoView({block:"nearest"}),z===G&&_&&(_.scrollTop=0),z===ae&&_&&(_.scrollTop=_.scrollHeight),z==null||z.focus(),document.activeElement!==de))return},[D,_]),Y=b.useCallback(()=>M([j,v]),[M,j,v]);b.useEffect(()=>{W&&Y()},[W,Y]);const{onOpenChange:Q,triggerPointerDownPosRef:B}=N;b.useEffect(()=>{if(v){let te={x:0,y:0};const G=ae=>{var de,z;te={x:Math.abs(Math.round(ae.pageX)-(((de=B.current)==null?void 0:de.x)??0)),y:Math.abs(Math.round(ae.pageY)-(((z=B.current)==null?void 0:z.y)??0))}},Z=ae=>{te.x<=10&&te.y<=10?ae.preventDefault():v.contains(ae.target)||Q(!1),document.removeEventListener("pointermove",G),B.current=null};return B.current!==null&&(document.addEventListener("pointermove",G),document.addEventListener("pointerup",Z,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",G),document.removeEventListener("pointerup",Z,{capture:!0})}}},[v,Q,B]),b.useEffect(()=>{const te=()=>Q(!1);return window.addEventListener("blur",te),window.addEventListener("resize",te),()=>{window.removeEventListener("blur",te),window.removeEventListener("resize",te)}},[Q]);const[V,P]=bw(te=>{const G=D().filter(de=>!de.disabled),Z=G.find(de=>de.ref.current===document.activeElement),ae=ww(G,te,Z);ae&&setTimeout(()=>ae.ref.current.focus())}),T=b.useCallback((te,G,Z)=>{const ae=!U.current&&!Z;(N.value!==void 0&&N.value===G||ae)&&(w(te),ae&&(U.current=!0))},[N.value]),R=b.useCallback(()=>v==null?void 0:v.focus(),[v]),L=b.useCallback((te,G,Z)=>{const ae=!U.current&&!Z;(N.value!==void 0&&N.value===G||ae)&&A(te)},[N.value]),X=a==="popper"?f0:iw,J=X===f0?{side:o,sideOffset:c,align:d,alignOffset:u,arrowPadding:f,collisionBoundary:h,collisionPadding:m,sticky:x,hideWhenDetached:p,avoidCollisions:g}:{};return n.jsx(nw,{scope:r,content:v,viewport:_,onViewportChange:F,itemRefCallback:T,selectedItem:j,onItemLeave:R,itemTextRefCallback:L,focusSelectedItem:Y,selectedItemText:E,position:a,isPositioned:W,searchRef:V,children:n.jsx(C1,{as:Qs,allowPinchZoom:!0,children:n.jsx(F1,{asChild:!0,trapped:N.open,onMountAutoFocus:te=>{te.preventDefault()},onUnmountAutoFocus:Je(s,te=>{var G;(G=N.trigger)==null||G.focus({preventScroll:!0}),te.preventDefault()}),children:n.jsx(D1,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:l,onFocusOutside:te=>te.preventDefault(),onDismiss:()=>N.onOpenChange(!1),children:n.jsx(X,{role:"listbox",id:N.contentId,"data-state":N.open?"open":"closed",dir:N.dir,onContextMenu:te=>te.preventDefault(),...y,...J,onPlaced:()=>re(!0),ref:k,style:{display:"flex",flexDirection:"column",outline:"none",...y.style},onKeyDown:Je(y.onKeyDown,te=>{const G=te.ctrlKey||te.altKey||te.metaKey;if(te.key==="Tab"&&te.preventDefault(),!G&&te.key.length===1&&P(te.key),["ArrowUp","ArrowDown","Home","End"].includes(te.key)){let ae=D().filter(de=>!de.disabled).map(de=>de.ref.current);if(["ArrowUp","End"].includes(te.key)&&(ae=ae.slice().reverse()),["ArrowUp","ArrowDown"].includes(te.key)){const de=te.target,z=ae.indexOf(de);ae=ae.slice(z+1)}setTimeout(()=>M(ae)),te.preventDefault()}})})})})})})});sw.displayName=lD;var oD="SelectItemAlignedPosition",iw=b.forwardRef((e,t)=>{const{__scopeSelect:r,onPlaced:a,...s}=e,i=Ss(ni,r),l=Ts(ni,r),[o,c]=b.useState(null),[d,u]=b.useState(null),f=Yt(t,k=>u(k)),h=yu(r),m=b.useRef(!1),x=b.useRef(!0),{viewport:p,selectedItem:g,selectedItemText:y,focusSelectedItem:N}=l,v=b.useCallback(()=>{if(i.trigger&&i.valueNode&&o&&d&&p&&g&&y){const k=i.trigger.getBoundingClientRect(),j=d.getBoundingClientRect(),w=i.valueNode.getBoundingClientRect(),E=y.getBoundingClientRect();if(i.dir!=="rtl"){const de=E.left-j.left,z=w.left-de,Ee=k.left-z,ue=k.width+Ee,Ce=Math.max(ue,j.width),ve=window.innerWidth-tn,ge=Nd(z,[tn,Math.max(tn,ve-Ce)]);o.style.minWidth=ue+"px",o.style.left=ge+"px"}else{const de=j.right-E.right,z=window.innerWidth-w.right-de,Ee=window.innerWidth-k.right-z,ue=k.width+Ee,Ce=Math.max(ue,j.width),ve=window.innerWidth-tn,ge=Nd(z,[tn,Math.max(tn,ve-Ce)]);o.style.minWidth=ue+"px",o.style.right=ge+"px"}const A=h(),D=window.innerHeight-tn*2,W=p.scrollHeight,re=window.getComputedStyle(d),U=parseInt(re.borderTopWidth,10),M=parseInt(re.paddingTop,10),Y=parseInt(re.borderBottomWidth,10),Q=parseInt(re.paddingBottom,10),B=U+M+W+Q+Y,V=Math.min(g.offsetHeight*5,B),P=window.getComputedStyle(p),T=parseInt(P.paddingTop,10),R=parseInt(P.paddingBottom,10),L=k.top+k.height/2-tn,X=D-L,J=g.offsetHeight/2,te=g.offsetTop+J,G=U+M+te,Z=B-G;if(G<=L){const de=A.length>0&&g===A[A.length-1].ref.current;o.style.bottom="0px";const z=d.clientHeight-p.offsetTop-p.offsetHeight,Ee=Math.max(X,J+(de?R:0)+z+Y),ue=G+Ee;o.style.height=ue+"px"}else{const de=A.length>0&&g===A[0].ref.current;o.style.top="0px";const Ee=Math.max(L,U+p.offsetTop+(de?T:0)+J)+Z;o.style.height=Ee+"px",p.scrollTop=G-L+p.offsetTop}o.style.margin=`${tn}px 0`,o.style.minHeight=V+"px",o.style.maxHeight=D+"px",a==null||a(),requestAnimationFrame(()=>m.current=!0)}},[h,i.trigger,i.valueNode,o,d,p,g,y,i.dir,a]);pn(()=>v(),[v]);const[S,_]=b.useState();pn(()=>{d&&_(window.getComputedStyle(d).zIndex)},[d]);const F=b.useCallback(k=>{k&&x.current===!0&&(v(),N==null||N(),x.current=!1)},[v,N]);return n.jsx(dD,{scope:r,contentWrapper:o,shouldExpandOnScrollRef:m,onScrollButtonChange:F,children:n.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:S},children:n.jsx(_t.div,{...s,ref:f,style:{boxSizing:"border-box",maxHeight:"100%",...s.style}})})})});iw.displayName=oD;var cD="SelectPopperPosition",f0=b.forwardRef((e,t)=>{const{__scopeSelect:r,align:a="start",collisionPadding:s=tn,...i}=e,l=bu(r);return n.jsx(nb,{...l,...i,ref:t,align:a,collisionPadding:s,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});f0.displayName=cD;var[dD,Qh]=gl(ni,{}),h0="SelectViewport",lw=b.forwardRef((e,t)=>{const{__scopeSelect:r,nonce:a,...s}=e,i=Ts(h0,r),l=Qh(h0,r),o=Yt(t,i.onViewportChange),c=b.useRef(0);return n.jsxs(n.Fragment,{children:[n.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:a}),n.jsx(vu.Slot,{scope:r,children:n.jsx(_t.div,{"data-radix-select-viewport":"",role:"presentation",...s,ref:o,style:{position:"relative",flex:1,overflow:"hidden auto",...s.style},onScroll:Je(s.onScroll,d=>{const u=d.currentTarget,{contentWrapper:f,shouldExpandOnScrollRef:h}=l;if(h!=null&&h.current&&f){const m=Math.abs(c.current-u.scrollTop);if(m>0){const x=window.innerHeight-tn*2,p=parseFloat(f.style.minHeight),g=parseFloat(f.style.height),y=Math.max(p,g);if(y<x){const N=y+m,v=Math.min(x,N),S=N-v;f.style.height=v+"px",f.style.bottom==="0px"&&(u.scrollTop=S>0?S:0,f.style.justifyContent="flex-end")}}}c.current=u.scrollTop})})})]})});lw.displayName=h0;var ow="SelectGroup",[uD,fD]=gl(ow),hD=b.forwardRef((e,t)=>{const{__scopeSelect:r,...a}=e,s=ri();return n.jsx(uD,{scope:r,id:s,children:n.jsx(_t.div,{role:"group","aria-labelledby":s,...a,ref:t})})});hD.displayName=ow;var cw="SelectLabel",mD=b.forwardRef((e,t)=>{const{__scopeSelect:r,...a}=e,s=fD(cw,r);return n.jsx(_t.div,{id:s.id,...a,ref:t})});mD.displayName=cw;var jd="SelectItem",[xD,dw]=gl(jd),uw=b.forwardRef((e,t)=>{const{__scopeSelect:r,value:a,disabled:s=!1,textValue:i,...l}=e,o=Ss(jd,r),c=Ts(jd,r),d=o.value===a,[u,f]=b.useState(i??""),[h,m]=b.useState(!1),x=Yt(t,N=>{var v;return(v=c.itemRefCallback)==null?void 0:v.call(c,N,a,s)}),p=ri(),g=b.useRef("touch"),y=()=>{s||(o.onValueChange(a),o.onOpenChange(!1))};if(a==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return n.jsx(xD,{scope:r,value:a,disabled:s,textId:p,isSelected:d,onItemTextChange:b.useCallback(N=>{f(v=>v||((N==null?void 0:N.textContent)??"").trim())},[]),children:n.jsx(vu.ItemSlot,{scope:r,value:a,disabled:s,textValue:u,children:n.jsx(_t.div,{role:"option","aria-labelledby":p,"data-highlighted":h?"":void 0,"aria-selected":d&&h,"data-state":d?"checked":"unchecked","aria-disabled":s||void 0,"data-disabled":s?"":void 0,tabIndex:s?void 0:-1,...l,ref:x,onFocus:Je(l.onFocus,()=>m(!0)),onBlur:Je(l.onBlur,()=>m(!1)),onClick:Je(l.onClick,()=>{g.current!=="mouse"&&y()}),onPointerUp:Je(l.onPointerUp,()=>{g.current==="mouse"&&y()}),onPointerDown:Je(l.onPointerDown,N=>{g.current=N.pointerType}),onPointerMove:Je(l.onPointerMove,N=>{var v;g.current=N.pointerType,s?(v=c.onItemLeave)==null||v.call(c):g.current==="mouse"&&N.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Je(l.onPointerLeave,N=>{var v;N.currentTarget===document.activeElement&&((v=c.onItemLeave)==null||v.call(c))}),onKeyDown:Je(l.onKeyDown,N=>{var S;((S=c.searchRef)==null?void 0:S.current)!==""&&N.key===" "||(eD.includes(N.key)&&y(),N.key===" "&&N.preventDefault())})})})})});uw.displayName=jd;var Ul="SelectItemText",fw=b.forwardRef((e,t)=>{const{__scopeSelect:r,className:a,style:s,...i}=e,l=Ss(Ul,r),o=Ts(Ul,r),c=dw(Ul,r),d=nD(Ul,r),[u,f]=b.useState(null),h=Yt(t,y=>f(y),c.onItemTextChange,y=>{var N;return(N=o.itemTextRefCallback)==null?void 0:N.call(o,y,c.value,c.disabled)}),m=u==null?void 0:u.textContent,x=b.useMemo(()=>n.jsx("option",{value:c.value,disabled:c.disabled,children:m},c.value),[c.disabled,c.value,m]),{onNativeOptionAdd:p,onNativeOptionRemove:g}=d;return pn(()=>(p(x),()=>g(x)),[p,g,x]),n.jsxs(n.Fragment,{children:[n.jsx(_t.span,{id:c.textId,...i,ref:h}),c.isSelected&&l.valueNode&&!l.valueNodeHasChildren?Zd.createPortal(i.children,l.valueNode):null]})});fw.displayName=Ul;var hw="SelectItemIndicator",mw=b.forwardRef((e,t)=>{const{__scopeSelect:r,...a}=e;return dw(hw,r).isSelected?n.jsx(_t.span,{"aria-hidden":!0,...a,ref:t}):null});mw.displayName=hw;var m0="SelectScrollUpButton",xw=b.forwardRef((e,t)=>{const r=Ts(m0,e.__scopeSelect),a=Qh(m0,e.__scopeSelect),[s,i]=b.useState(!1),l=Yt(t,a.onScrollButtonChange);return pn(()=>{if(r.viewport&&r.isPositioned){let o=function(){const d=c.scrollTop>0;i(d)};const c=r.viewport;return o(),c.addEventListener("scroll",o),()=>c.removeEventListener("scroll",o)}},[r.viewport,r.isPositioned]),s?n.jsx(gw,{...e,ref:l,onAutoScroll:()=>{const{viewport:o,selectedItem:c}=r;o&&c&&(o.scrollTop=o.scrollTop-c.offsetHeight)}}):null});xw.displayName=m0;var x0="SelectScrollDownButton",pw=b.forwardRef((e,t)=>{const r=Ts(x0,e.__scopeSelect),a=Qh(x0,e.__scopeSelect),[s,i]=b.useState(!1),l=Yt(t,a.onScrollButtonChange);return pn(()=>{if(r.viewport&&r.isPositioned){let o=function(){const d=c.scrollHeight-c.clientHeight,u=Math.ceil(c.scrollTop)<d;i(u)};const c=r.viewport;return o(),c.addEventListener("scroll",o),()=>c.removeEventListener("scroll",o)}},[r.viewport,r.isPositioned]),s?n.jsx(gw,{...e,ref:l,onAutoScroll:()=>{const{viewport:o,selectedItem:c}=r;o&&c&&(o.scrollTop=o.scrollTop+c.offsetHeight)}}):null});pw.displayName=x0;var gw=b.forwardRef((e,t)=>{const{__scopeSelect:r,onAutoScroll:a,...s}=e,i=Ts("SelectScrollButton",r),l=b.useRef(null),o=yu(r),c=b.useCallback(()=>{l.current!==null&&(window.clearInterval(l.current),l.current=null)},[]);return b.useEffect(()=>()=>c(),[c]),pn(()=>{var u;const d=o().find(f=>f.ref.current===document.activeElement);(u=d==null?void 0:d.ref.current)==null||u.scrollIntoView({block:"nearest"})},[o]),n.jsx(_t.div,{"aria-hidden":!0,...s,ref:t,style:{flexShrink:0,...s.style},onPointerDown:Je(s.onPointerDown,()=>{l.current===null&&(l.current=window.setInterval(a,50))}),onPointerMove:Je(s.onPointerMove,()=>{var d;(d=i.onItemLeave)==null||d.call(i),l.current===null&&(l.current=window.setInterval(a,50))}),onPointerLeave:Je(s.onPointerLeave,()=>{c()})})}),pD="SelectSeparator",gD=b.forwardRef((e,t)=>{const{__scopeSelect:r,...a}=e;return n.jsx(_t.div,{"aria-hidden":!0,...a,ref:t})});gD.displayName=pD;var p0="SelectArrow",vD=b.forwardRef((e,t)=>{const{__scopeSelect:r,...a}=e,s=bu(r),i=Ss(p0,r),l=Ts(p0,r);return i.open&&l.position==="popper"?n.jsx(sb,{...s,...a,ref:t}):null});vD.displayName=p0;function vw(e){return e===""||e===void 0}var yw=b.forwardRef((e,t)=>{const{value:r,...a}=e,s=b.useRef(null),i=Yt(t,s),l=gu(r);return b.useEffect(()=>{const o=s.current,c=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(c,"value").set;if(l!==r&&u){const f=new Event("change",{bubbles:!0});u.call(o,r),o.dispatchEvent(f)}},[l,r]),n.jsx(Xb,{asChild:!0,children:n.jsx("select",{...a,ref:i,defaultValue:r})})});yw.displayName="BubbleSelect";function bw(e){const t=Yo(e),r=b.useRef(""),a=b.useRef(0),s=b.useCallback(l=>{const o=r.current+l;t(o),(function c(d){r.current=d,window.clearTimeout(a.current),d!==""&&(a.current=window.setTimeout(()=>c(""),1e3))})(o)},[t]),i=b.useCallback(()=>{r.current="",window.clearTimeout(a.current)},[]);return b.useEffect(()=>()=>window.clearTimeout(a.current),[]),[r,s,i]}function ww(e,t,r){const s=t.length>1&&Array.from(t).every(d=>d===t[0])?t[0]:t,i=r?e.indexOf(r):-1;let l=yD(e,Math.max(i,0));s.length===1&&(l=l.filter(d=>d!==r));const c=l.find(d=>d.textValue.toLowerCase().startsWith(s.toLowerCase()));return c!==r?c:void 0}function yD(e,t){return e.map((r,a)=>e[(t+a)%e.length])}var bD=qb,wD=Jb,kD=ew,ND=tw,jD=rw,ED=aw,SD=lw,TD=uw,AD=fw,_D=mw,CD=xw,FD=pw;function jo({...e}){return n.jsx(bD,{"data-slot":"select",...e})}function Eo({...e}){return n.jsx(kD,{"data-slot":"select-value",...e})}function So({className:e,size:t="default",children:r,...a}){return n.jsxs(wD,{"data-slot":"select-trigger","data-size":t,className:We("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-full items-center justify-between gap-2 rounded-md border bg-input-background px-3 py-2 text-sm whitespace-nowrap transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...a,children:[r,n.jsx(ND,{asChild:!0,children:n.jsx(mh,{className:"size-4 opacity-50"})})]})}function To({className:e,children:t,position:r="popper",...a}){return n.jsx(jD,{children:n.jsxs(ED,{"data-slot":"select-content",className:We("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...a,children:[n.jsx(DD,{}),n.jsx(SD,{className:We("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:t}),n.jsx(RD,{})]})})}function _n({className:e,children:t,...r}){return n.jsxs(TD,{"data-slot":"select-item",className:We("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",e),...r,children:[n.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:n.jsx(_D,{children:n.jsx(Ws,{className:"size-4"})})}),n.jsx(AD,{children:t})]})}function DD({className:e,...t}){return n.jsx(CD,{"data-slot":"select-scroll-up-button",className:We("flex cursor-default items-center justify-center py-1",e),...t,children:n.jsx(_E,{className:"size-4"})})}function RD({className:e,...t}){return n.jsx(FD,{"data-slot":"select-scroll-down-button",className:We("flex cursor-default items-center justify-center py-1",e),...t,children:n.jsx(mh,{className:"size-4"})})}var em="Switch",[MD]=In(em),[PD,OD]=MD(em),kw=b.forwardRef((e,t)=>{const{__scopeSwitch:r,name:a,checked:s,defaultChecked:i,required:l,disabled:o,value:c="on",onCheckedChange:d,form:u,...f}=e,[h,m]=b.useState(null),x=Yt(t,v=>m(v)),p=b.useRef(!1),g=h?u||!!h.closest("form"):!0,[y=!1,N]=xs({prop:s,defaultProp:i,onChange:d});return n.jsxs(PD,{scope:r,checked:y,disabled:o,children:[n.jsx(_t.button,{type:"button",role:"switch","aria-checked":y,"aria-required":l,"data-state":Ew(y),"data-disabled":o?"":void 0,disabled:o,value:c,...f,ref:x,onClick:Je(e.onClick,v=>{N(S=>!S),g&&(p.current=v.isPropagationStopped(),p.current||v.stopPropagation())})}),g&&n.jsx(ID,{control:h,bubbles:!p.current,name:a,value:c,checked:y,required:l,disabled:o,form:u,style:{transform:"translateX(-100%)"}})]})});kw.displayName=em;var Nw="SwitchThumb",jw=b.forwardRef((e,t)=>{const{__scopeSwitch:r,...a}=e,s=OD(Nw,r);return n.jsx(_t.span,{"data-state":Ew(s.checked),"data-disabled":s.disabled?"":void 0,...a,ref:t})});jw.displayName=Nw;var ID=e=>{const{control:t,checked:r,bubbles:a=!0,...s}=e,i=b.useRef(null),l=gu(r),o=uu(t);return b.useEffect(()=>{const c=i.current,d=window.HTMLInputElement.prototype,f=Object.getOwnPropertyDescriptor(d,"checked").set;if(l!==r&&f){const h=new Event("click",{bubbles:a});f.call(c,r),c.dispatchEvent(h)}},[l,r,a]),n.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...s,tabIndex:-1,ref:i,style:{...e.style,...o,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function Ew(e){return e?"checked":"unchecked"}var LD=kw,BD=jw;function tm({className:e,...t}){return n.jsx(LD,{"data-slot":"switch",className:We("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-switch-background focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:n.jsx(BD,{"data-slot":"switch-thumb",className:We("bg-card dark:data-[state=unchecked]:bg-card-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}const rm=b.createContext({});function am(e){const t=b.useRef(null);return t.current===null&&(t.current=e()),t.current}const Sw=typeof window<"u",Tw=Sw?b.useLayoutEffect:b.useEffect,wu=b.createContext(null);function nm(e,t){e.indexOf(t)===-1&&e.push(t)}function Ed(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}const On=(e,t,r)=>r>t?t:r<e?e:r;let sm=()=>{};const Xn={},Aw=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function _w(e){return typeof e=="object"&&e!==null}const Cw=e=>/^0[^.\s]+$/u.test(e);function im(e){let t;return()=>(t===void 0&&(t=e()),t)}const Ka=e=>e,zD=(e,t)=>r=>t(e(r)),nc=(...e)=>e.reduce(zD),Ao=(e,t,r)=>{const a=t-e;return a===0?1:(r-e)/a};class lm{constructor(){this.subscriptions=[]}add(t){return nm(this.subscriptions,t),()=>Ed(this.subscriptions,t)}notify(t,r,a){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](t,r,a);else for(let i=0;i<s;i++){const l=this.subscriptions[i];l&&l(t,r,a)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const dn=e=>e*1e3,Va=e=>e/1e3;function Fw(e,t){return t?e*(1e3/t):0}const Dw=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,UD=1e-7,VD=12;function HD(e,t,r,a,s){let i,l,o=0;do l=t+(r-t)/2,i=Dw(l,a,s)-e,i>0?r=l:t=l;while(Math.abs(i)>UD&&++o<VD);return l}function sc(e,t,r,a){if(e===t&&r===a)return Ka;const s=i=>HD(i,0,1,e,r);return i=>i===0||i===1?i:Dw(s(i),t,a)}const Rw=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,Mw=e=>t=>1-e(1-t),Pw=sc(.33,1.53,.69,.99),om=Mw(Pw),Ow=Rw(om),Iw=e=>(e*=2)<1?.5*om(e):.5*(2-Math.pow(2,-10*(e-1))),cm=e=>1-Math.sin(Math.acos(e)),Lw=Mw(cm),Bw=Rw(cm),$D=sc(.42,0,1,1),KD=sc(0,0,.58,1),zw=sc(.42,0,.58,1),WD=e=>Array.isArray(e)&&typeof e[0]!="number",Uw=e=>Array.isArray(e)&&typeof e[0]=="number",GD={linear:Ka,easeIn:$D,easeInOut:zw,easeOut:KD,circIn:cm,circInOut:Bw,circOut:Lw,backIn:om,backInOut:Ow,backOut:Pw,anticipate:Iw},YD=e=>typeof e=="string",Rp=e=>{if(Uw(e)){sm(e.length===4);const[t,r,a,s]=e;return sc(t,r,a,s)}else if(YD(e))return GD[e];return e},Sc=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function XD(e,t){let r=new Set,a=new Set,s=!1,i=!1;const l=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function c(u){l.has(u)&&(d.schedule(u),e()),u(o)}const d={schedule:(u,f=!1,h=!1)=>{const x=h&&s?r:a;return f&&l.add(u),x.has(u)||x.add(u),u},cancel:u=>{a.delete(u),l.delete(u)},process:u=>{if(o=u,s){i=!0;return}s=!0,[r,a]=[a,r],r.forEach(c),r.clear(),s=!1,i&&(i=!1,d.process(u))}};return d}const qD=40;function Vw(e,t){let r=!1,a=!0;const s={delta:0,timestamp:0,isProcessing:!1},i=()=>r=!0,l=Sc.reduce((v,S)=>(v[S]=XD(i),v),{}),{setup:o,read:c,resolveKeyframes:d,preUpdate:u,update:f,preRender:h,render:m,postRender:x}=l,p=()=>{const v=Xn.useManualTiming?s.timestamp:performance.now();r=!1,Xn.useManualTiming||(s.delta=a?1e3/60:Math.max(Math.min(v-s.timestamp,qD),1)),s.timestamp=v,s.isProcessing=!0,o.process(s),c.process(s),d.process(s),u.process(s),f.process(s),h.process(s),m.process(s),x.process(s),s.isProcessing=!1,r&&t&&(a=!1,e(p))},g=()=>{r=!0,a=!0,s.isProcessing||e(p)};return{schedule:Sc.reduce((v,S)=>{const _=l[S];return v[S]=(F,k=!1,j=!1)=>(r||g(),_.schedule(F,k,j)),v},{}),cancel:v=>{for(let S=0;S<Sc.length;S++)l[Sc[S]].cancel(v)},state:s,steps:l}}const{schedule:qt,cancel:ys,state:zr,steps:Xu}=Vw(typeof requestAnimationFrame<"u"?requestAnimationFrame:Ka,!0);let rd;function ZD(){rd=void 0}const ia={now:()=>(rd===void 0&&ia.set(zr.isProcessing||Xn.useManualTiming?zr.timestamp:performance.now()),rd),set:e=>{rd=e,queueMicrotask(ZD)}},Hw=e=>t=>typeof t=="string"&&t.startsWith(e),$w=Hw("--"),JD=Hw("var(--"),dm=e=>JD(e)?QD.test(e.split("/*")[0].trim()):!1,QD=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu;function Mp(e){return typeof e!="string"?!1:e.split("/*")[0].includes("var(--")}const vl={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},_o={...vl,transform:e=>On(0,1,e)},Tc={...vl,default:1},Xl=e=>Math.round(e*1e5)/1e5,um=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function eR(e){return e==null}const tR=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,fm=(e,t)=>r=>!!(typeof r=="string"&&tR.test(r)&&r.startsWith(e)||t&&!eR(r)&&Object.prototype.hasOwnProperty.call(r,t)),Kw=(e,t,r)=>a=>{if(typeof a!="string")return a;const[s,i,l,o]=a.match(um);return{[e]:parseFloat(s),[t]:parseFloat(i),[r]:parseFloat(l),alpha:o!==void 0?parseFloat(o):1}},rR=e=>On(0,255,e),qu={...vl,transform:e=>Math.round(rR(e))},Vs={test:fm("rgb","red"),parse:Kw("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:a=1})=>"rgba("+qu.transform(e)+", "+qu.transform(t)+", "+qu.transform(r)+", "+Xl(_o.transform(a))+")"};function aR(e){let t="",r="",a="",s="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),a=e.substring(5,7),s=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),a=e.substring(3,4),s=e.substring(4,5),t+=t,r+=r,a+=a,s+=s),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(a,16),alpha:s?parseInt(s,16)/255:1}}const g0={test:fm("#"),parse:aR,transform:Vs.transform},ic=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),rs=ic("deg"),Rn=ic("%"),Xe=ic("px"),nR=ic("vh"),sR=ic("vw"),Pp={...Rn,parse:e=>Rn.parse(e)/100,transform:e=>Rn.transform(e*100)},Pi={test:fm("hsl","hue"),parse:Kw("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:a=1})=>"hsla("+Math.round(e)+", "+Rn.transform(Xl(t))+", "+Rn.transform(Xl(r))+", "+Xl(_o.transform(a))+")"},Tr={test:e=>Vs.test(e)||g0.test(e)||Pi.test(e),parse:e=>Vs.test(e)?Vs.parse(e):Pi.test(e)?Pi.parse(e):g0.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?Vs.transform(e):Pi.transform(e),getAnimatableNone:e=>{const t=Tr.parse(e);return t.alpha=0,Tr.transform(t)}},iR=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function lR(e){var t,r;return isNaN(e)&&typeof e=="string"&&(((t=e.match(um))==null?void 0:t.length)||0)+(((r=e.match(iR))==null?void 0:r.length)||0)>0}const Ww="number",Gw="color",oR="var",cR="var(",Op="${}",dR=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Co(e){const t=e.toString(),r=[],a={color:[],number:[],var:[]},s=[];let i=0;const o=t.replace(dR,c=>(Tr.test(c)?(a.color.push(i),s.push(Gw),r.push(Tr.parse(c))):c.startsWith(cR)?(a.var.push(i),s.push(oR),r.push(c)):(a.number.push(i),s.push(Ww),r.push(parseFloat(c))),++i,Op)).split(Op);return{values:r,split:o,indexes:a,types:s}}function Yw(e){return Co(e).values}function Xw(e){const{split:t,types:r}=Co(e),a=t.length;return s=>{let i="";for(let l=0;l<a;l++)if(i+=t[l],s[l]!==void 0){const o=r[l];o===Ww?i+=Xl(s[l]):o===Gw?i+=Tr.transform(s[l]):i+=s[l]}return i}}const uR=e=>typeof e=="number"?0:Tr.test(e)?Tr.getAnimatableNone(e):e;function fR(e){const t=Yw(e);return Xw(e)(t.map(uR))}const bs={test:lR,parse:Yw,createTransformer:Xw,getAnimatableNone:fR};function Zu(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function hR({hue:e,saturation:t,lightness:r,alpha:a}){e/=360,t/=100,r/=100;let s=0,i=0,l=0;if(!t)s=i=l=r;else{const o=r<.5?r*(1+t):r+t-r*t,c=2*r-o;s=Zu(c,o,e+1/3),i=Zu(c,o,e),l=Zu(c,o,e-1/3)}return{red:Math.round(s*255),green:Math.round(i*255),blue:Math.round(l*255),alpha:a}}function Sd(e,t){return r=>r>0?t:e}const lr=(e,t,r)=>e+(t-e)*r,Ju=(e,t,r)=>{const a=e*e,s=r*(t*t-a)+a;return s<0?0:Math.sqrt(s)},mR=[g0,Vs,Pi],xR=e=>mR.find(t=>t.test(e));function Ip(e){const t=xR(e);if(!t)return!1;let r=t.parse(e);return t===Pi&&(r=hR(r)),r}const Lp=(e,t)=>{const r=Ip(e),a=Ip(t);if(!r||!a)return Sd(e,t);const s={...r};return i=>(s.red=Ju(r.red,a.red,i),s.green=Ju(r.green,a.green,i),s.blue=Ju(r.blue,a.blue,i),s.alpha=lr(r.alpha,a.alpha,i),Vs.transform(s))},v0=new Set(["none","hidden"]);function pR(e,t){return v0.has(e)?r=>r<=0?e:t:r=>r>=1?t:e}function gR(e,t){return r=>lr(e,t,r)}function hm(e){return typeof e=="number"?gR:typeof e=="string"?dm(e)?Sd:Tr.test(e)?Lp:bR:Array.isArray(e)?qw:typeof e=="object"?Tr.test(e)?Lp:vR:Sd}function qw(e,t){const r=[...e],a=r.length,s=e.map((i,l)=>hm(i)(i,t[l]));return i=>{for(let l=0;l<a;l++)r[l]=s[l](i);return r}}function vR(e,t){const r={...e,...t},a={};for(const s in r)e[s]!==void 0&&t[s]!==void 0&&(a[s]=hm(e[s])(e[s],t[s]));return s=>{for(const i in a)r[i]=a[i](s);return r}}function yR(e,t){const r=[],a={color:0,var:0,number:0};for(let s=0;s<t.values.length;s++){const i=t.types[s],l=e.indexes[i][a[i]],o=e.values[l]??0;r[s]=o,a[i]++}return r}const bR=(e,t)=>{const r=bs.createTransformer(t),a=Co(e),s=Co(t);return a.indexes.var.length===s.indexes.var.length&&a.indexes.color.length===s.indexes.color.length&&a.indexes.number.length>=s.indexes.number.length?v0.has(e)&&!s.values.length||v0.has(t)&&!a.values.length?pR(e,t):nc(qw(yR(a,s),s.values),r):Sd(e,t)};function Zw(e,t,r){return typeof e=="number"&&typeof t=="number"&&typeof r=="number"?lr(e,t,r):hm(e)(e,t)}const wR=e=>{const t=({timestamp:r})=>e(r);return{start:(r=!0)=>qt.update(t,r),stop:()=>ys(t),now:()=>zr.isProcessing?zr.timestamp:ia.now()}},Jw=(e,t,r=10)=>{let a="";const s=Math.max(Math.round(t/r),2);for(let i=0;i<s;i++)a+=Math.round(e(i/(s-1))*1e4)/1e4+", ";return`linear(${a.substring(0,a.length-2)})`},Td=2e4;function mm(e){let t=0;const r=50;let a=e.next(t);for(;!a.done&&t<Td;)t+=r,a=e.next(t);return t>=Td?1/0:t}function kR(e,t=100,r){const a=r({...e,keyframes:[0,t]}),s=Math.min(mm(a),Td);return{type:"keyframes",ease:i=>a.next(s*i).value/t,duration:Va(s)}}const NR=5;function Qw(e,t,r){const a=Math.max(t-NR,0);return Fw(r-e(a),t-a)}const ur={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Qu=.001;function jR({duration:e=ur.duration,bounce:t=ur.bounce,velocity:r=ur.velocity,mass:a=ur.mass}){let s,i,l=1-t;l=On(ur.minDamping,ur.maxDamping,l),e=On(ur.minDuration,ur.maxDuration,Va(e)),l<1?(s=d=>{const u=d*l,f=u*e,h=u-r,m=y0(d,l),x=Math.exp(-f);return Qu-h/m*x},i=d=>{const f=d*l*e,h=f*r+r,m=Math.pow(l,2)*Math.pow(d,2)*e,x=Math.exp(-f),p=y0(Math.pow(d,2),l);return(-s(d)+Qu>0?-1:1)*((h-m)*x)/p}):(s=d=>{const u=Math.exp(-d*e),f=(d-r)*e+1;return-Qu+u*f},i=d=>{const u=Math.exp(-d*e),f=(r-d)*(e*e);return u*f});const o=5/e,c=SR(s,i,o);if(e=dn(e),isNaN(c))return{stiffness:ur.stiffness,damping:ur.damping,duration:e};{const d=Math.pow(c,2)*a;return{stiffness:d,damping:l*2*Math.sqrt(a*d),duration:e}}}const ER=12;function SR(e,t,r){let a=r;for(let s=1;s<ER;s++)a=a-e(a)/t(a);return a}function y0(e,t){return e*Math.sqrt(1-t*t)}const TR=["duration","bounce"],AR=["stiffness","damping","mass"];function Bp(e,t){return t.some(r=>e[r]!==void 0)}function _R(e){let t={velocity:ur.velocity,stiffness:ur.stiffness,damping:ur.damping,mass:ur.mass,isResolvedFromDuration:!1,...e};if(!Bp(e,AR)&&Bp(e,TR))if(e.visualDuration){const r=e.visualDuration,a=2*Math.PI/(r*1.2),s=a*a,i=2*On(.05,1,1-(e.bounce||0))*Math.sqrt(s);t={...t,mass:ur.mass,stiffness:s,damping:i}}else{const r=jR(e);t={...t,...r,mass:ur.mass},t.isResolvedFromDuration=!0}return t}function Ad(e=ur.visualDuration,t=ur.bounce){const r=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:a,restDelta:s}=r;const i=r.keyframes[0],l=r.keyframes[r.keyframes.length-1],o={done:!1,value:i},{stiffness:c,damping:d,mass:u,duration:f,velocity:h,isResolvedFromDuration:m}=_R({...r,velocity:-Va(r.velocity||0)}),x=h||0,p=d/(2*Math.sqrt(c*u)),g=l-i,y=Va(Math.sqrt(c/u)),N=Math.abs(g)<5;a||(a=N?ur.restSpeed.granular:ur.restSpeed.default),s||(s=N?ur.restDelta.granular:ur.restDelta.default);let v;if(p<1){const _=y0(y,p);v=F=>{const k=Math.exp(-p*y*F);return l-k*((x+p*y*g)/_*Math.sin(_*F)+g*Math.cos(_*F))}}else if(p===1)v=_=>l-Math.exp(-y*_)*(g+(x+y*g)*_);else{const _=y*Math.sqrt(p*p-1);v=F=>{const k=Math.exp(-p*y*F),j=Math.min(_*F,300);return l-k*((x+p*y*g)*Math.sinh(j)+_*g*Math.cosh(j))/_}}const S={calculatedDuration:m&&f||null,next:_=>{const F=v(_);if(m)o.done=_>=f;else{let k=_===0?x:0;p<1&&(k=_===0?dn(x):Qw(v,_,F));const j=Math.abs(k)<=a,w=Math.abs(l-F)<=s;o.done=j&&w}return o.value=o.done?l:F,o},toString:()=>{const _=Math.min(mm(S),Td),F=Jw(k=>S.next(_*k).value,_,30);return _+"ms "+F},toTransition:()=>{}};return S}Ad.applyToOptions=e=>{const t=kR(e,100,Ad);return e.ease=t.ease,e.duration=dn(t.duration),e.type="keyframes",e};function b0({keyframes:e,velocity:t=0,power:r=.8,timeConstant:a=325,bounceDamping:s=10,bounceStiffness:i=500,modifyTarget:l,min:o,max:c,restDelta:d=.5,restSpeed:u}){const f=e[0],h={done:!1,value:f},m=j=>o!==void 0&&j<o||c!==void 0&&j>c,x=j=>o===void 0?c:c===void 0||Math.abs(o-j)<Math.abs(c-j)?o:c;let p=r*t;const g=f+p,y=l===void 0?g:l(g);y!==g&&(p=y-f);const N=j=>-p*Math.exp(-j/a),v=j=>y+N(j),S=j=>{const w=N(j),E=v(j);h.done=Math.abs(w)<=d,h.value=h.done?y:E};let _,F;const k=j=>{m(h.value)&&(_=j,F=Ad({keyframes:[h.value,x(h.value)],velocity:Qw(v,j,h.value),damping:s,stiffness:i,restDelta:d,restSpeed:u}))};return k(0),{calculatedDuration:null,next:j=>{let w=!1;return!F&&_===void 0&&(w=!0,S(j),k(j)),_!==void 0&&j>=_?F.next(j-_):(!w&&S(j),h)}}}function CR(e,t,r){const a=[],s=r||Xn.mix||Zw,i=e.length-1;for(let l=0;l<i;l++){let o=s(e[l],e[l+1]);if(t){const c=Array.isArray(t)?t[l]||Ka:t;o=nc(c,o)}a.push(o)}return a}function FR(e,t,{clamp:r=!0,ease:a,mixer:s}={}){const i=e.length;if(sm(i===t.length),i===1)return()=>t[0];if(i===2&&t[0]===t[1])return()=>t[1];const l=e[0]===e[1];e[0]>e[i-1]&&(e=[...e].reverse(),t=[...t].reverse());const o=CR(t,a,s),c=o.length,d=u=>{if(l&&u<e[0])return t[0];let f=0;if(c>1)for(;f<e.length-2&&!(u<e[f+1]);f++);const h=Ao(e[f],e[f+1],u);return o[f](h)};return r?u=>d(On(e[0],e[i-1],u)):d}function DR(e,t){const r=e[e.length-1];for(let a=1;a<=t;a++){const s=Ao(0,t,a);e.push(lr(r,1,s))}}function RR(e){const t=[0];return DR(t,e.length-1),t}function MR(e,t){return e.map(r=>r*t)}function PR(e,t){return e.map(()=>t||zw).splice(0,e.length-1)}function ql({duration:e=300,keyframes:t,times:r,ease:a="easeInOut"}){const s=WD(a)?a.map(Rp):Rp(a),i={done:!1,value:t[0]},l=MR(r&&r.length===t.length?r:RR(t),e),o=FR(l,t,{ease:Array.isArray(s)?s:PR(t,s)});return{calculatedDuration:e,next:c=>(i.value=o(c),i.done=c>=e,i)}}const OR=e=>e!==null;function xm(e,{repeat:t,repeatType:r="loop"},a,s=1){const i=e.filter(OR),o=s<0||t&&r!=="loop"&&t%2===1?0:i.length-1;return!o||a===void 0?i[o]:a}const IR={decay:b0,inertia:b0,tween:ql,keyframes:ql,spring:Ad};function ek(e){typeof e.type=="string"&&(e.type=IR[e.type])}class pm{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,r){return this.finished.then(t,r)}}const LR=e=>e/100;class gm extends pm{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var a,s;const{motionValue:r}=this.options;r&&r.updatedAt!==ia.now()&&this.tick(ia.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(s=(a=this.options).onStop)==null||s.call(a))},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;ek(t);const{type:r=ql,repeat:a=0,repeatDelay:s=0,repeatType:i,velocity:l=0}=t;let{keyframes:o}=t;const c=r||ql;c!==ql&&typeof o[0]!="number"&&(this.mixKeyframes=nc(LR,Zw(o[0],o[1])),o=[0,100]);const d=c({...t,keyframes:o});i==="mirror"&&(this.mirroredGenerator=c({...t,keyframes:[...o].reverse(),velocity:-l})),d.calculatedDuration===null&&(d.calculatedDuration=mm(d));const{calculatedDuration:u}=d;this.calculatedDuration=u,this.resolvedDuration=u+s,this.totalDuration=this.resolvedDuration*(a+1)-s,this.generator=d}updateTime(t){const r=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(t,r=!1){const{generator:a,totalDuration:s,mixKeyframes:i,mirroredGenerator:l,resolvedDuration:o,calculatedDuration:c}=this;if(this.startTime===null)return a.next(0);const{delay:d=0,keyframes:u,repeat:f,repeatType:h,repeatDelay:m,type:x,onUpdate:p,finalKeyframe:g}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-s/this.speed,this.startTime)),r?this.currentTime=t:this.updateTime(t);const y=this.currentTime-d*(this.playbackSpeed>=0?1:-1),N=this.playbackSpeed>=0?y<0:y>s;this.currentTime=Math.max(y,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=s);let v=this.currentTime,S=a;if(f){const j=Math.min(this.currentTime,s)/o;let w=Math.floor(j),E=j%1;!E&&j>=1&&(E=1),E===1&&w--,w=Math.min(w,f+1),!!(w%2)&&(h==="reverse"?(E=1-E,m&&(E-=m/o)):h==="mirror"&&(S=l)),v=On(0,1,E)*o}const _=N?{done:!1,value:u[0]}:S.next(v);i&&(_.value=i(_.value));let{done:F}=_;!N&&c!==null&&(F=this.playbackSpeed>=0?this.currentTime>=s:this.currentTime<=0);const k=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&F);return k&&x!==b0&&(_.value=xm(u,this.options,g,this.speed)),p&&p(_.value),k&&this.finish(),_}then(t,r){return this.finished.then(t,r)}get duration(){return Va(this.calculatedDuration)}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+Va(t)}get time(){return Va(this.currentTime)}set time(t){var r;t=dn(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),(r=this.driver)==null||r.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(ia.now());const r=this.playbackSpeed!==t;this.playbackSpeed=t,r&&(this.time=Va(this.currentTime))}play(){var s,i;if(this.isStopped)return;const{driver:t=wR,startTime:r}=this.options;this.driver||(this.driver=t(l=>this.tick(l))),(i=(s=this.options).onPlay)==null||i.call(s);const a=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=a):this.holdTime!==null?this.startTime=a-this.holdTime:this.startTime||(this.startTime=r??a),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(ia.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var t,r;this.notifyFinished(),this.teardown(),this.state="finished",(r=(t=this.options).onComplete)==null||r.call(t)}cancel(){var t,r;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(r=(t=this.options).onCancel)==null||r.call(t)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){var r;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(r=this.driver)==null||r.stop(),t.observe(this)}}function BR(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const Hs=e=>e*180/Math.PI,w0=e=>{const t=Hs(Math.atan2(e[1],e[0]));return k0(t)},zR={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:w0,rotateZ:w0,skewX:e=>Hs(Math.atan(e[1])),skewY:e=>Hs(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},k0=e=>(e=e%360,e<0&&(e+=360),e),zp=w0,Up=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),Vp=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),UR={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:Up,scaleY:Vp,scale:e=>(Up(e)+Vp(e))/2,rotateX:e=>k0(Hs(Math.atan2(e[6],e[5]))),rotateY:e=>k0(Hs(Math.atan2(-e[2],e[0]))),rotateZ:zp,rotate:zp,skewX:e=>Hs(Math.atan(e[4])),skewY:e=>Hs(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function N0(e){return e.includes("scale")?1:0}function j0(e,t){if(!e||e==="none")return N0(t);const r=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let a,s;if(r)a=UR,s=r;else{const o=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);a=zR,s=o}if(!s)return N0(t);const i=a[t],l=s[1].split(",").map(HR);return typeof i=="function"?i(l):l[i]}const VR=(e,t)=>{const{transform:r="none"}=getComputedStyle(e);return j0(r,t)};function HR(e){return parseFloat(e.trim())}const yl=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],bl=new Set(yl),Hp=e=>e===vl||e===Xe,$R=new Set(["x","y","z"]),KR=yl.filter(e=>!$R.has(e));function WR(e){const t=[];return KR.forEach(r=>{const a=e.getValue(r);a!==void 0&&(t.push([r,a.get()]),a.set(r.startsWith("scale")?1:0))}),t}const os={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>j0(t,"x"),y:(e,{transform:t})=>j0(t,"y")};os.translateX=os.x;os.translateY=os.y;const Ys=new Set;let E0=!1,S0=!1,T0=!1;function tk(){if(S0){const e=Array.from(Ys).filter(a=>a.needsMeasurement),t=new Set(e.map(a=>a.element)),r=new Map;t.forEach(a=>{const s=WR(a);s.length&&(r.set(a,s),a.render())}),e.forEach(a=>a.measureInitialState()),t.forEach(a=>{a.render();const s=r.get(a);s&&s.forEach(([i,l])=>{var o;(o=a.getValue(i))==null||o.set(l)})}),e.forEach(a=>a.measureEndState()),e.forEach(a=>{a.suspendedScrollY!==void 0&&window.scrollTo(0,a.suspendedScrollY)})}S0=!1,E0=!1,Ys.forEach(e=>e.complete(T0)),Ys.clear()}function rk(){Ys.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(S0=!0)})}function GR(){T0=!0,rk(),tk(),T0=!1}class vm{constructor(t,r,a,s,i,l=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=r,this.name=a,this.motionValue=s,this.element=i,this.isAsync=l}scheduleResolve(){this.state="scheduled",this.isAsync?(Ys.add(this),E0||(E0=!0,qt.read(rk),qt.resolveKeyframes(tk))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:r,element:a,motionValue:s}=this;if(t[0]===null){const i=s==null?void 0:s.get(),l=t[t.length-1];if(i!==void 0)t[0]=i;else if(a&&r){const o=a.readValue(r,l);o!=null&&(t[0]=o)}t[0]===void 0&&(t[0]=l),s&&i===void 0&&s.set(t[0])}BR(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),Ys.delete(this)}cancel(){this.state==="scheduled"&&(Ys.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const YR=e=>e.startsWith("--");function XR(e,t,r){YR(t)?e.style.setProperty(t,r):e.style[t]=r}const qR=im(()=>window.ScrollTimeline!==void 0),ZR={};function JR(e,t){const r=im(e);return()=>ZR[t]??r()}const ak=JR(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Vl=([e,t,r,a])=>`cubic-bezier(${e}, ${t}, ${r}, ${a})`,$p={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Vl([0,.65,.55,1]),circOut:Vl([.55,0,1,.45]),backIn:Vl([.31,.01,.66,-.59]),backOut:Vl([.33,1.53,.69,.99])};function nk(e,t){if(e)return typeof e=="function"?ak()?Jw(e,t):"ease-out":Uw(e)?Vl(e):Array.isArray(e)?e.map(r=>nk(r,t)||$p.easeOut):$p[e]}function QR(e,t,r,{delay:a=0,duration:s=300,repeat:i=0,repeatType:l="loop",ease:o="easeOut",times:c}={},d=void 0){const u={[t]:r};c&&(u.offset=c);const f=nk(o,s);Array.isArray(f)&&(u.easing=f);const h={delay:a,duration:s,easing:Array.isArray(f)?"linear":f,fill:"both",iterations:i+1,direction:l==="reverse"?"alternate":"normal"};return d&&(h.pseudoElement=d),e.animate(u,h)}function sk(e){return typeof e=="function"&&"applyToOptions"in e}function eM({type:e,...t}){return sk(e)&&ak()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class ik extends pm{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,this.manualStartTime=null,!t)return;const{element:r,name:a,keyframes:s,pseudoElement:i,allowFlatten:l=!1,finalKeyframe:o,onComplete:c}=t;this.isPseudoElement=!!i,this.allowFlatten=l,this.options=t,sm(typeof t.type!="string");const d=eM(t);this.animation=QR(r,a,s,d,i),d.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!i){const u=xm(s,this.options,o,this.speed);this.updateMotionValue?this.updateMotionValue(u):XR(r,a,u),this.animation.cancel()}c==null||c(),this.notifyFinished()}}play(){this.isStopped||(this.manualStartTime=null,this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var t,r;(r=(t=this.animation).finish)==null||r.call(t)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var r,a,s;const t=(r=this.options)==null?void 0:r.element;!this.isPseudoElement&&(t!=null&&t.isConnected)&&((s=(a=this.animation).commitStyles)==null||s.call(a))}get duration(){var r,a;const t=((a=(r=this.animation.effect)==null?void 0:r.getComputedTiming)==null?void 0:a.call(r).duration)||0;return Va(Number(t))}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+Va(t)}get time(){return Va(Number(this.animation.currentTime)||0)}set time(t){this.manualStartTime=null,this.finishedTime=null,this.animation.currentTime=dn(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return this.manualStartTime??Number(this.animation.startTime)}set startTime(t){this.manualStartTime=this.animation.startTime=t}attachTimeline({timeline:t,observe:r}){var a;return this.allowFlatten&&((a=this.animation.effect)==null||a.updateTiming({easing:"linear"})),this.animation.onfinish=null,t&&qR()?(this.animation.timeline=t,Ka):r(this)}}const lk={anticipate:Iw,backInOut:Ow,circInOut:Bw};function tM(e){return e in lk}function rM(e){typeof e.ease=="string"&&tM(e.ease)&&(e.ease=lk[e.ease])}const ef=10;class aM extends ik{constructor(t){rM(t),ek(t),super(t),t.startTime!==void 0&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:r,onUpdate:a,onComplete:s,element:i,...l}=this.options;if(!r)return;if(t!==void 0){r.set(t);return}const o=new gm({...l,autoplay:!1}),c=Math.max(ef,ia.now()-this.startTime),d=On(0,ef,c-ef);r.setWithVelocity(o.sample(Math.max(0,c-d)).value,o.sample(c).value,d),o.stop()}}const Kp=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(bs.test(e)||e==="0")&&!e.startsWith("url("));function nM(e){const t=e[0];if(e.length===1)return!0;for(let r=0;r<e.length;r++)if(e[r]!==t)return!0}function sM(e,t,r,a){const s=e[0];if(s===null)return!1;if(t==="display"||t==="visibility")return!0;const i=e[e.length-1],l=Kp(s,t),o=Kp(i,t);return!l||!o?!1:nM(e)||(r==="spring"||sk(r))&&a}function A0(e){e.duration=0,e.type="keyframes"}const iM=new Set(["opacity","clipPath","filter","transform"]),lM=im(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function oM(e){var u;const{motionValue:t,name:r,repeatDelay:a,repeatType:s,damping:i,type:l}=e;if(!(((u=t==null?void 0:t.owner)==null?void 0:u.current)instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:d}=t.owner.getProps();return lM()&&r&&iM.has(r)&&(r!=="transform"||!d)&&!c&&!a&&s!=="mirror"&&i!==0&&l!=="inertia"}const cM=40;class dM extends pm{constructor({autoplay:t=!0,delay:r=0,type:a="keyframes",repeat:s=0,repeatDelay:i=0,repeatType:l="loop",keyframes:o,name:c,motionValue:d,element:u,...f}){var x;super(),this.stop=()=>{var p,g;this._animation&&(this._animation.stop(),(p=this.stopTimeline)==null||p.call(this)),(g=this.keyframeResolver)==null||g.cancel()},this.createdAt=ia.now();const h={autoplay:t,delay:r,type:a,repeat:s,repeatDelay:i,repeatType:l,name:c,motionValue:d,element:u,...f},m=(u==null?void 0:u.KeyframeResolver)||vm;this.keyframeResolver=new m(o,(p,g,y)=>this.onKeyframesResolved(p,g,h,!y),c,d,u),(x=this.keyframeResolver)==null||x.scheduleResolve()}onKeyframesResolved(t,r,a,s){var g,y;this.keyframeResolver=void 0;const{name:i,type:l,velocity:o,delay:c,isHandoff:d,onUpdate:u}=a;this.resolvedAt=ia.now(),sM(t,i,l,o)||((Xn.instantAnimations||!c)&&(u==null||u(xm(t,a,r))),t[0]=t[t.length-1],A0(a),a.repeat=0);const h={startTime:s?this.resolvedAt?this.resolvedAt-this.createdAt>cM?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...a,keyframes:t},m=!d&&oM(h),x=(y=(g=h.motionValue)==null?void 0:g.owner)==null?void 0:y.current,p=m?new aM({...h,element:x}):new gm(h);p.finished.then(()=>{this.notifyFinished()}).catch(Ka),this.pendingTimeline&&(this.stopTimeline=p.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=p}get finished(){return this._animation?this.animation.finished:this._finished}then(t,r){return this.finished.finally(t).then(()=>{})}get animation(){var t;return this._animation||((t=this.keyframeResolver)==null||t.resume(),GR()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var t;this._animation&&this.animation.cancel(),(t=this.keyframeResolver)==null||t.cancel()}}function ok(e,t,r,a=0,s=1){const i=Array.from(e).sort((d,u)=>d.sortNodePosition(u)).indexOf(t),l=e.size,o=(l-1)*a;return typeof r=="function"?r(i,l):s===1?i*a:o-i*a}const uM=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function fM(e){const t=uM.exec(e);if(!t)return[,];const[,r,a,s]=t;return[`--${r??a}`,s]}function ck(e,t,r=1){const[a,s]=fM(e);if(!a)return;const i=window.getComputedStyle(t).getPropertyValue(a);if(i){const l=i.trim();return Aw(l)?parseFloat(l):l}return dm(s)?ck(s,t,r+1):s}const hM={type:"spring",stiffness:500,damping:25,restSpeed:10},mM=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),xM={type:"keyframes",duration:.8},pM={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},gM=(e,{keyframes:t})=>t.length>2?xM:bl.has(e)?e.startsWith("scale")?mM(t[1]):hM:pM,vM=e=>e!==null;function yM(e,{repeat:t,repeatType:r="loop"},a){const s=e.filter(vM),i=t&&r!=="loop"&&t%2===1?0:s.length-1;return s[i]}function dk(e,t){if(e!=null&&e.inherit&&t){const{inherit:r,...a}=e;return{...t,...a}}return e}function ym(e,t){const r=(e==null?void 0:e[t])??(e==null?void 0:e.default)??e;return r!==e?dk(r,e):r}function bM({when:e,delay:t,delayChildren:r,staggerChildren:a,staggerDirection:s,repeat:i,repeatType:l,repeatDelay:o,from:c,elapsed:d,...u}){return!!Object.keys(u).length}const bm=(e,t,r,a={},s,i)=>l=>{const o=ym(a,e)||{},c=o.delay||a.delay||0;let{elapsed:d=0}=a;d=d-dn(c);const u={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:t.getVelocity(),...o,delay:-d,onUpdate:h=>{t.set(h),o.onUpdate&&o.onUpdate(h)},onComplete:()=>{l(),o.onComplete&&o.onComplete()},name:e,motionValue:t,element:i?void 0:s};bM(o)||Object.assign(u,gM(e,u)),u.duration&&(u.duration=dn(u.duration)),u.repeatDelay&&(u.repeatDelay=dn(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let f=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(A0(u),u.delay===0&&(f=!0)),(Xn.instantAnimations||Xn.skipAnimations||s!=null&&s.shouldSkipAnimations)&&(f=!0,A0(u),u.delay=0),u.allowFlatten=!o.type&&!o.ease,f&&!i&&t.get()!==void 0){const h=yM(u.keyframes,o);if(h!==void 0){qt.update(()=>{u.onUpdate(h),u.onComplete()});return}}return o.isSync?new gm(u):new dM(u)};function Wp(e){const t=[{},{}];return e==null||e.values.forEach((r,a)=>{t[0][a]=r.get(),t[1][a]=r.getVelocity()}),t}function wm(e,t,r,a){if(typeof t=="function"){const[s,i]=Wp(a);t=t(r!==void 0?r:e.custom,s,i)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[s,i]=Wp(a);t=t(r!==void 0?r:e.custom,s,i)}return t}function Yi(e,t,r){const a=e.getProps();return wm(a,t,r!==void 0?r:a.custom,e)}const uk=new Set(["width","height","top","left","right","bottom",...yl]),Gp=30,wM=e=>!isNaN(parseFloat(e));class kM{constructor(t,r={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=a=>{var i;const s=ia.now();if(this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(a),this.current!==this.prev&&((i=this.events.change)==null||i.notify(this.current),this.dependents))for(const l of this.dependents)l.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=r.owner}setCurrent(t){this.current=t,this.updatedAt=ia.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=wM(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new lm);const a=this.events[t].add(r);return t==="change"?()=>{a(),qt.read(()=>{this.events.change.getSize()||this.stop()})}:a}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,r,a){this.set(r),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-a}jump(t,r=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var t;(t=this.events.change)==null||t.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=ia.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>Gp)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,Gp);return Fw(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var t,r;(t=this.dependents)==null||t.clear(),(r=this.events.destroy)==null||r.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function ll(e,t){return new kM(e,t)}const _0=e=>Array.isArray(e);function NM(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,ll(r))}function jM(e){return _0(e)?e[e.length-1]||0:e}function EM(e,t){const r=Yi(e,t);let{transitionEnd:a={},transition:s={},...i}=r||{};i={...i,...a};for(const l in i){const o=jM(i[l]);NM(e,l,o)}}const Qr=e=>!!(e&&e.getVelocity);function SM(e){return!!(Qr(e)&&e.add)}function C0(e,t){const r=e.getValue("willChange");if(SM(r))return r.add(t);if(!r&&Xn.WillChange){const a=new Xn.WillChange("auto");e.addValue("willChange",a),a.add(t)}}function km(e){return e.replace(/([A-Z])/g,t=>`-${t.toLowerCase()}`)}const TM="framerAppearId",fk="data-"+km(TM);function hk(e){return e.props[fk]}function AM({protectedKeys:e,needsAnimating:t},r){const a=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,a}function mk(e,t,{delay:r=0,transitionOverride:a,type:s}={}){let{transition:i,transitionEnd:l,...o}=t;const c=e.getDefaultTransition();i=i?dk(i,c):c;const d=i==null?void 0:i.reduceMotion;a&&(i=a);const u=[],f=s&&e.animationState&&e.animationState.getState()[s];for(const h in o){const m=e.getValue(h,e.latestValues[h]??null),x=o[h];if(x===void 0||f&&AM(f,h))continue;const p={delay:r,...ym(i||{},h)},g=m.get();if(g!==void 0&&!m.isAnimating&&!Array.isArray(x)&&x===g&&!p.velocity)continue;let y=!1;if(window.MotionHandoffAnimation){const S=hk(e);if(S){const _=window.MotionHandoffAnimation(S,h,qt);_!==null&&(p.startTime=_,y=!0)}}C0(e,h);const N=d??e.shouldReduceMotion;m.start(bm(h,m,x,N&&uk.has(h)?{type:!1}:p,e,y));const v=m.animation;v&&u.push(v)}if(l){const h=()=>qt.update(()=>{l&&EM(e,l)});u.length?Promise.all(u).then(h):h()}return u}function F0(e,t,r={}){var c;const a=Yi(e,t,r.type==="exit"?(c=e.presenceContext)==null?void 0:c.custom:void 0);let{transition:s=e.getDefaultTransition()||{}}=a||{};r.transitionOverride&&(s=r.transitionOverride);const i=a?()=>Promise.all(mk(e,a,r)):()=>Promise.resolve(),l=e.variantChildren&&e.variantChildren.size?(d=0)=>{const{delayChildren:u=0,staggerChildren:f,staggerDirection:h}=s;return _M(e,t,d,u,f,h,r)}:()=>Promise.resolve(),{when:o}=s;if(o){const[d,u]=o==="beforeChildren"?[i,l]:[l,i];return d().then(()=>u())}else return Promise.all([i(),l(r.delay)])}function _M(e,t,r=0,a=0,s=0,i=1,l){const o=[];for(const c of e.variantChildren)c.notify("AnimationStart",t),o.push(F0(c,t,{...l,delay:r+(typeof a=="function"?0:a)+ok(e.variantChildren,c,a,s,i)}).then(()=>c.notify("AnimationComplete",t)));return Promise.all(o)}function CM(e,t,r={}){e.notify("AnimationStart",t);let a;if(Array.isArray(t)){const s=t.map(i=>F0(e,i,r));a=Promise.all(s)}else if(typeof t=="string")a=F0(e,t,r);else{const s=typeof t=="function"?Yi(e,t,r.custom):t;a=Promise.all(mk(e,s,r))}return a.then(()=>{e.notify("AnimationComplete",t)})}const FM={test:e=>e==="auto",parse:e=>e},xk=e=>t=>t.test(e),pk=[vl,Xe,Rn,rs,sR,nR,FM],Yp=e=>pk.find(xk(e));function DM(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||Cw(e):!0}const RM=new Set(["brightness","contrast","saturate","opacity"]);function MM(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[a]=r.match(um)||[];if(!a)return e;const s=r.replace(a,"");let i=RM.has(t)?1:0;return a!==r&&(i*=100),t+"("+i+s+")"}const PM=/\b([a-z-]*)\(.*?\)/gu,D0={...bs,getAnimatableNone:e=>{const t=e.match(PM);return t?t.map(MM).join(" "):e}},Xp={...vl,transform:Math.round},OM={rotate:rs,rotateX:rs,rotateY:rs,rotateZ:rs,scale:Tc,scaleX:Tc,scaleY:Tc,scaleZ:Tc,skew:rs,skewX:rs,skewY:rs,distance:Xe,translateX:Xe,translateY:Xe,translateZ:Xe,x:Xe,y:Xe,z:Xe,perspective:Xe,transformPerspective:Xe,opacity:_o,originX:Pp,originY:Pp,originZ:Xe},Nm={borderWidth:Xe,borderTopWidth:Xe,borderRightWidth:Xe,borderBottomWidth:Xe,borderLeftWidth:Xe,borderRadius:Xe,borderTopLeftRadius:Xe,borderTopRightRadius:Xe,borderBottomRightRadius:Xe,borderBottomLeftRadius:Xe,width:Xe,maxWidth:Xe,height:Xe,maxHeight:Xe,top:Xe,right:Xe,bottom:Xe,left:Xe,inset:Xe,insetBlock:Xe,insetBlockStart:Xe,insetBlockEnd:Xe,insetInline:Xe,insetInlineStart:Xe,insetInlineEnd:Xe,padding:Xe,paddingTop:Xe,paddingRight:Xe,paddingBottom:Xe,paddingLeft:Xe,paddingBlock:Xe,paddingBlockStart:Xe,paddingBlockEnd:Xe,paddingInline:Xe,paddingInlineStart:Xe,paddingInlineEnd:Xe,margin:Xe,marginTop:Xe,marginRight:Xe,marginBottom:Xe,marginLeft:Xe,marginBlock:Xe,marginBlockStart:Xe,marginBlockEnd:Xe,marginInline:Xe,marginInlineStart:Xe,marginInlineEnd:Xe,fontSize:Xe,backgroundPositionX:Xe,backgroundPositionY:Xe,...OM,zIndex:Xp,fillOpacity:_o,strokeOpacity:_o,numOctaves:Xp},IM={...Nm,color:Tr,backgroundColor:Tr,outlineColor:Tr,fill:Tr,stroke:Tr,borderColor:Tr,borderTopColor:Tr,borderRightColor:Tr,borderBottomColor:Tr,borderLeftColor:Tr,filter:D0,WebkitFilter:D0},gk=e=>IM[e];function vk(e,t){let r=gk(e);return r!==D0&&(r=bs),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const LM=new Set(["auto","none","0"]);function BM(e,t,r){let a=0,s;for(;a<e.length&&!s;){const i=e[a];typeof i=="string"&&!LM.has(i)&&Co(i).values.length&&(s=e[a]),a++}if(s&&r)for(const i of t)e[i]=vk(r,s)}class zM extends vm{constructor(t,r,a,s,i){super(t,r,a,s,i,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:r,name:a}=this;if(!r||!r.current)return;super.readKeyframes();for(let u=0;u<t.length;u++){let f=t[u];if(typeof f=="string"&&(f=f.trim(),dm(f))){const h=ck(f,r.current);h!==void 0&&(t[u]=h),u===t.length-1&&(this.finalKeyframe=f)}}if(this.resolveNoneKeyframes(),!uk.has(a)||t.length!==2)return;const[s,i]=t,l=Yp(s),o=Yp(i),c=Mp(s),d=Mp(i);if(c!==d&&os[a]){this.needsMeasurement=!0;return}if(l!==o)if(Hp(l)&&Hp(o))for(let u=0;u<t.length;u++){const f=t[u];typeof f=="string"&&(t[u]=parseFloat(f))}else os[a]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:r}=this,a=[];for(let s=0;s<t.length;s++)(t[s]===null||DM(t[s]))&&a.push(s);a.length&&BM(t,a,r)}measureInitialState(){const{element:t,unresolvedKeyframes:r,name:a}=this;if(!t||!t.current)return;a==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=os[a](t.measureViewportBox(),window.getComputedStyle(t.current)),r[0]=this.measuredOrigin;const s=r[r.length-1];s!==void 0&&t.getValue(a,s).jump(s,!1)}measureEndState(){var o;const{element:t,name:r,unresolvedKeyframes:a}=this;if(!t||!t.current)return;const s=t.getValue(r);s&&s.jump(this.measuredOrigin,!1);const i=a.length-1,l=a[i];a[i]=os[r](t.measureViewportBox(),window.getComputedStyle(t.current)),l!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=l),(o=this.removedTransforms)!=null&&o.length&&this.removedTransforms.forEach(([c,d])=>{t.getValue(c).set(d)}),this.resolveNoneKeyframes()}}const UM=new Set(["opacity","clipPath","filter","transform"]);function yk(e,t,r){if(e==null)return[];if(e instanceof EventTarget)return[e];if(typeof e=="string"){let a=document;const s=(r==null?void 0:r[e])??a.querySelectorAll(e);return s?Array.from(s):[]}return Array.from(e).filter(a=>a!=null)}const bk=(e,t)=>t&&typeof e=="number"?t.transform(e):e;function R0(e){return _w(e)&&"offsetHeight"in e}const{schedule:jm}=Vw(queueMicrotask,!1),rn={x:!1,y:!1};function wk(){return rn.x||rn.y}function VM(e){return e==="x"||e==="y"?rn[e]?null:(rn[e]=!0,()=>{rn[e]=!1}):rn.x||rn.y?null:(rn.x=rn.y=!0,()=>{rn.x=rn.y=!1})}function kk(e,t){const r=yk(e),a=new AbortController,s={passive:!0,...t,signal:a.signal};return[r,s,()=>a.abort()]}function HM(e){return!(e.pointerType==="touch"||wk())}function $M(e,t,r={}){const[a,s,i]=kk(e,r);return a.forEach(l=>{let o=!1,c=!1,d;const u=()=>{l.removeEventListener("pointerleave",x)},f=g=>{d&&(d(g),d=void 0),u()},h=g=>{o=!1,window.removeEventListener("pointerup",h),window.removeEventListener("pointercancel",h),c&&(c=!1,f(g))},m=()=>{o=!0,window.addEventListener("pointerup",h,s),window.addEventListener("pointercancel",h,s)},x=g=>{if(g.pointerType!=="touch"){if(o){c=!0;return}f(g)}},p=g=>{if(!HM(g))return;c=!1;const y=t(l,g);typeof y=="function"&&(d=y,l.addEventListener("pointerleave",x,s))};l.addEventListener("pointerenter",p,s),l.addEventListener("pointerdown",m,s)}),i}const Nk=(e,t)=>t?e===t?!0:Nk(e,t.parentElement):!1,Em=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,KM=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function WM(e){return KM.has(e.tagName)||e.isContentEditable===!0}const GM=new Set(["INPUT","SELECT","TEXTAREA"]);function YM(e){return GM.has(e.tagName)||e.isContentEditable===!0}const ad=new WeakSet;function qp(e){return t=>{t.key==="Enter"&&e(t)}}function tf(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const XM=(e,t)=>{const r=e.currentTarget;if(!r)return;const a=qp(()=>{if(ad.has(r))return;tf(r,"down");const s=qp(()=>{tf(r,"up")}),i=()=>tf(r,"cancel");r.addEventListener("keyup",s,t),r.addEventListener("blur",i,t)});r.addEventListener("keydown",a,t),r.addEventListener("blur",()=>r.removeEventListener("keydown",a),t)};function Zp(e){return Em(e)&&!wk()}const Jp=new WeakSet;function qM(e,t,r={}){const[a,s,i]=kk(e,r),l=o=>{const c=o.currentTarget;if(!Zp(o)||Jp.has(o))return;ad.add(c),r.stopPropagation&&Jp.add(o);const d=t(c,o),u=(m,x)=>{window.removeEventListener("pointerup",f),window.removeEventListener("pointercancel",h),ad.has(c)&&ad.delete(c),Zp(m)&&typeof d=="function"&&d(m,{success:x})},f=m=>{u(m,c===window||c===document||r.useGlobalTarget||Nk(c,m.target))},h=m=>{u(m,!1)};window.addEventListener("pointerup",f,s),window.addEventListener("pointercancel",h,s)};return a.forEach(o=>{(r.useGlobalTarget?window:o).addEventListener("pointerdown",l,s),R0(o)&&(o.addEventListener("focus",d=>XM(d,s)),!WM(o)&&!o.hasAttribute("tabindex")&&(o.tabIndex=0))}),i}function Sm(e){return _w(e)&&"ownerSVGElement"in e}const nd=new WeakMap;let as;const jk=(e,t,r)=>(a,s)=>s&&s[0]?s[0][e+"Size"]:Sm(a)&&"getBBox"in a?a.getBBox()[t]:a[r],ZM=jk("inline","width","offsetWidth"),JM=jk("block","height","offsetHeight");function QM({target:e,borderBoxSize:t}){var r;(r=nd.get(e))==null||r.forEach(a=>{a(e,{get width(){return ZM(e,t)},get height(){return JM(e,t)}})})}function e3(e){e.forEach(QM)}function t3(){typeof ResizeObserver>"u"||(as=new ResizeObserver(e3))}function r3(e,t){as||t3();const r=yk(e);return r.forEach(a=>{let s=nd.get(a);s||(s=new Set,nd.set(a,s)),s.add(t),as==null||as.observe(a)}),()=>{r.forEach(a=>{const s=nd.get(a);s==null||s.delete(t),s!=null&&s.size||as==null||as.unobserve(a)})}}const sd=new Set;let Oi;function a3(){Oi=()=>{const e={get width(){return window.innerWidth},get height(){return window.innerHeight}};sd.forEach(t=>t(e))},window.addEventListener("resize",Oi)}function n3(e){return sd.add(e),Oi||a3(),()=>{sd.delete(e),!sd.size&&typeof Oi=="function"&&(window.removeEventListener("resize",Oi),Oi=void 0)}}function Qp(e,t){return typeof e=="function"?n3(e):r3(e,t)}function s3(e){return Sm(e)&&e.tagName==="svg"}const i3=[...pk,Tr,bs],l3=e=>i3.find(xk(e)),eg=()=>({translate:0,scale:1,origin:0,originPoint:0}),Ii=()=>({x:eg(),y:eg()}),tg=()=>({min:0,max:0}),Cr=()=>({x:tg(),y:tg()}),o3=new WeakMap;function ku(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function Fo(e){return typeof e=="string"||Array.isArray(e)}const Tm=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Am=["initial",...Tm];function Nu(e){return ku(e.animate)||Am.some(t=>Fo(e[t]))}function Ek(e){return!!(Nu(e)||e.variants)}function c3(e,t,r){for(const a in t){const s=t[a],i=r[a];if(Qr(s))e.addValue(a,s);else if(Qr(i))e.addValue(a,ll(s,{owner:e}));else if(i!==s)if(e.hasValue(a)){const l=e.getValue(a);l.liveStyle===!0?l.jump(s):l.hasAnimated||l.set(s)}else{const l=e.getStaticValue(a);e.addValue(a,ll(l!==void 0?l:s,{owner:e}))}}for(const a in r)t[a]===void 0&&e.removeValue(a);return t}const M0={current:null},Sk={current:!1},d3=typeof window<"u";function u3(){if(Sk.current=!0,!!d3)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>M0.current=e.matches;e.addEventListener("change",t),t()}else M0.current=!1}const rg=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];let _d={};function Tk(e){_d=e}function f3(){return _d}class h3{scrapeMotionValuesFromProps(t,r,a){return{}}constructor({parent:t,props:r,presenceContext:a,reducedMotionConfig:s,skipAnimations:i,blockInitialAnimation:l,visualState:o},c={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.shouldSkipAnimations=!1,this.values=new Map,this.KeyframeResolver=vm,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.hasBeenMounted=!1,this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const m=ia.now();this.renderScheduledAt<m&&(this.renderScheduledAt=m,qt.render(this.render,!1,!0))};const{latestValues:d,renderState:u}=o;this.latestValues=d,this.baseTarget={...d},this.initialValues=r.initial?{...d}:{},this.renderState=u,this.parent=t,this.props=r,this.presenceContext=a,this.depth=t?t.depth+1:0,this.reducedMotionConfig=s,this.skipAnimationsConfig=i,this.options=c,this.blockInitialAnimation=!!l,this.isControllingVariants=Nu(r),this.isVariantNode=Ek(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:f,...h}=this.scrapeMotionValuesFromProps(r,{},this);for(const m in h){const x=h[m];d[m]!==void 0&&Qr(x)&&x.set(d[m])}}mount(t){var r,a;if(this.hasBeenMounted)for(const s in this.initialValues)(r=this.values.get(s))==null||r.jump(this.initialValues[s]),this.latestValues[s]=this.initialValues[s];this.current=t,o3.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((s,i)=>this.bindToMotionValue(i,s)),this.reducedMotionConfig==="never"?this.shouldReduceMotion=!1:this.reducedMotionConfig==="always"?this.shouldReduceMotion=!0:(Sk.current||u3(),this.shouldReduceMotion=M0.current),this.shouldSkipAnimations=this.skipAnimationsConfig??!1,(a=this.parent)==null||a.addChild(this),this.update(this.props,this.presenceContext),this.hasBeenMounted=!0}unmount(){var t;this.projection&&this.projection.unmount(),ys(this.notifyUpdate),ys(this.render),this.valueSubscriptions.forEach(r=>r()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(t=this.parent)==null||t.removeChild(this);for(const r in this.events)this.events[r].clear();for(const r in this.features){const a=this.features[r];a&&(a.unmount(),a.isMounted=!1)}this.current=null}addChild(t){this.children.add(t),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(t)}removeChild(t){this.children.delete(t),this.enteringChildren&&this.enteringChildren.delete(t)}bindToMotionValue(t,r){if(this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)(),r.accelerate&&UM.has(t)&&this.current instanceof HTMLElement){const{factory:l,keyframes:o,times:c,ease:d,duration:u}=r.accelerate,f=new ik({element:this.current,name:t,keyframes:o,times:c,ease:d,duration:dn(u)}),h=l(f);this.valueSubscriptions.set(t,()=>{h(),f.cancel()});return}const a=bl.has(t);a&&this.onBindTransform&&this.onBindTransform();const s=r.on("change",l=>{this.latestValues[t]=l,this.props.onUpdate&&qt.preRender(this.notifyUpdate),a&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let i;typeof window<"u"&&window.MotionCheckAppearSync&&(i=window.MotionCheckAppearSync(this,t,r)),this.valueSubscriptions.set(t,()=>{s(),i&&i(),r.owner&&r.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in _d){const r=_d[t];if(!r)continue;const{isEnabled:a,Feature:s}=r;if(!this.features[t]&&s&&a(this.props)&&(this.features[t]=new s(this)),this.features[t]){const i=this.features[t];i.isMounted?i.update():(i.mount(),i.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Cr()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let a=0;a<rg.length;a++){const s=rg[a];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const i="on"+s,l=t[i];l&&(this.propEventSubscriptions[s]=this.on(s,l))}this.prevMotionValues=c3(this,this.scrapeMotionValuesFromProps(t,this.prevProps||{},this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){const a=this.values.get(t);r!==a&&(a&&this.removeValue(t),this.bindToMotionValue(t,r),this.values.set(t,r),this.latestValues[t]=r.get())}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let a=this.values.get(t);return a===void 0&&r!==void 0&&(a=ll(r===null?void 0:r,{owner:this}),this.addValue(t,a)),a}readValue(t,r){let a=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return a!=null&&(typeof a=="string"&&(Aw(a)||Cw(a))?a=parseFloat(a):!l3(a)&&bs.test(r)&&(a=vk(t,r)),this.setBaseTarget(t,Qr(a)?a.get():a)),Qr(a)?a.get():a}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){var i;const{initial:r}=this.props;let a;if(typeof r=="string"||typeof r=="object"){const l=wm(this.props,r,(i=this.presenceContext)==null?void 0:i.custom);l&&(a=l[t])}if(r&&a!==void 0)return a;const s=this.getBaseTargetFromProps(this.props,t);return s!==void 0&&!Qr(s)?s:this.initialValues[t]!==void 0&&a===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new lm),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}scheduleRenderMicrotask(){jm.render(this.render)}}class Ak extends h3{constructor(){super(...arguments),this.KeyframeResolver=zM}sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){const a=t.style;return a?a[r]:void 0}removeValueFromRenderState(t,{vars:r,style:a}){delete r[t],delete a[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;Qr(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}class As{constructor(t){this.isMounted=!1,this.node=t}update(){}}function _k({top:e,left:t,right:r,bottom:a}){return{x:{min:t,max:r},y:{min:e,max:a}}}function m3({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function x3(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),a=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:a.y,right:a.x}}function rf(e){return e===void 0||e===1}function P0({scale:e,scaleX:t,scaleY:r}){return!rf(e)||!rf(t)||!rf(r)}function Ls(e){return P0(e)||Ck(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function Ck(e){return ag(e.x)||ag(e.y)}function ag(e){return e&&e!=="0%"}function Cd(e,t,r){const a=e-r,s=t*a;return r+s}function ng(e,t,r,a,s){return s!==void 0&&(e=Cd(e,s,a)),Cd(e,r,a)+t}function O0(e,t=0,r=1,a,s){e.min=ng(e.min,t,r,a,s),e.max=ng(e.max,t,r,a,s)}function Fk(e,{x:t,y:r}){O0(e.x,t.translate,t.scale,t.originPoint),O0(e.y,r.translate,r.scale,r.originPoint)}const sg=.999999999999,ig=1.0000000000001;function p3(e,t,r,a=!1){const s=r.length;if(!s)return;t.x=t.y=1;let i,l;for(let o=0;o<s;o++){i=r[o],l=i.projectionDelta;const{visualElement:c}=i.options;c&&c.props.style&&c.props.style.display==="contents"||(a&&i.options.layoutScroll&&i.scroll&&i!==i.root&&Bi(e,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),l&&(t.x*=l.x.scale,t.y*=l.y.scale,Fk(e,l)),a&&Ls(i.latestValues)&&Bi(e,i.latestValues))}t.x<ig&&t.x>sg&&(t.x=1),t.y<ig&&t.y>sg&&(t.y=1)}function Li(e,t){e.min=e.min+t,e.max=e.max+t}function lg(e,t,r,a,s=.5){const i=lr(e.min,e.max,s);O0(e,t,r,i,a)}function Bi(e,t){lg(e.x,t.x,t.scaleX,t.scale,t.originX),lg(e.y,t.y,t.scaleY,t.scale,t.originY)}function Dk(e,t){return _k(x3(e.getBoundingClientRect(),t))}function g3(e,t,r){const a=Dk(e,r),{scroll:s}=t;return s&&(Li(a.x,s.offset.x),Li(a.y,s.offset.y)),a}const v3={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},y3=yl.length;function b3(e,t,r){let a="",s=!0;for(let i=0;i<y3;i++){const l=yl[i],o=e[l];if(o===void 0)continue;let c=!0;if(typeof o=="number")c=o===(l.startsWith("scale")?1:0);else{const d=parseFloat(o);c=l.startsWith("scale")?d===1:d===0}if(!c||r){const d=bk(o,Nm[l]);if(!c){s=!1;const u=v3[l]||l;a+=`${u}(${d}) `}r&&(t[l]=d)}}return a=a.trim(),r?a=r(t,s?"":a):s&&(a="none"),a}function _m(e,t,r){const{style:a,vars:s,transformOrigin:i}=e;let l=!1,o=!1;for(const c in t){const d=t[c];if(bl.has(c)){l=!0;continue}else if($w(c)){s[c]=d;continue}else{const u=bk(d,Nm[c]);c.startsWith("origin")?(o=!0,i[c]=u):a[c]=u}}if(t.transform||(l||r?a.transform=b3(t,e.transform,r):a.transform&&(a.transform="none")),o){const{originX:c="50%",originY:d="50%",originZ:u=0}=i;a.transformOrigin=`${c} ${d} ${u}`}}function Rk(e,{style:t,vars:r},a,s){const i=e.style;let l;for(l in t)i[l]=t[l];s==null||s.applyProjectionStyles(i,a);for(l in r)i.setProperty(l,r[l])}function og(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const Fl={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(Xe.test(e))e=parseFloat(e);else return e;const r=og(e,t.target.x),a=og(e,t.target.y);return`${r}% ${a}%`}},w3={correct:(e,{treeScale:t,projectionDelta:r})=>{const a=e,s=bs.parse(e);if(s.length>5)return a;const i=bs.createTransformer(e),l=typeof s[0]!="number"?1:0,o=r.x.scale*t.x,c=r.y.scale*t.y;s[0+l]/=o,s[1+l]/=c;const d=lr(o,c,.5);return typeof s[2+l]=="number"&&(s[2+l]/=d),typeof s[3+l]=="number"&&(s[3+l]/=d),i(s)}},I0={borderRadius:{...Fl,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Fl,borderTopRightRadius:Fl,borderBottomLeftRadius:Fl,borderBottomRightRadius:Fl,boxShadow:w3};function Mk(e,{layout:t,layoutId:r}){return bl.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!I0[e]||e==="opacity")}function Cm(e,t,r){var l;const a=e.style,s=t==null?void 0:t.style,i={};if(!a)return i;for(const o in a)(Qr(a[o])||s&&Qr(s[o])||Mk(o,e)||((l=r==null?void 0:r.getValue(o))==null?void 0:l.liveStyle)!==void 0)&&(i[o]=a[o]);return i}function k3(e){return window.getComputedStyle(e)}class N3 extends Ak{constructor(){super(...arguments),this.type="html",this.renderInstance=Rk}readValueFromInstance(t,r){var a;if(bl.has(r))return(a=this.projection)!=null&&a.isProjecting?N0(r):VR(t,r);{const s=k3(t),i=($w(r)?s.getPropertyValue(r):s[r])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(t,{transformPagePoint:r}){return Dk(t,r)}build(t,r,a){_m(t,r,a.transformTemplate)}scrapeMotionValuesFromProps(t,r,a){return Cm(t,r,a)}}const j3={offset:"stroke-dashoffset",array:"stroke-dasharray"},E3={offset:"strokeDashoffset",array:"strokeDasharray"};function S3(e,t,r=1,a=0,s=!0){e.pathLength=1;const i=s?j3:E3;e[i.offset]=`${-a}`,e[i.array]=`${t} ${r}`}const T3=["offsetDistance","offsetPath","offsetRotate","offsetAnchor"];function Pk(e,{attrX:t,attrY:r,attrScale:a,pathLength:s,pathSpacing:i=1,pathOffset:l=0,...o},c,d,u){if(_m(e,o,d),c){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:f,style:h}=e;f.transform&&(h.transform=f.transform,delete f.transform),(h.transform||f.transformOrigin)&&(h.transformOrigin=f.transformOrigin??"50% 50%",delete f.transformOrigin),h.transform&&(h.transformBox=(u==null?void 0:u.transformBox)??"fill-box",delete f.transformBox);for(const m of T3)f[m]!==void 0&&(h[m]=f[m],delete f[m]);t!==void 0&&(f.x=t),r!==void 0&&(f.y=r),a!==void 0&&(f.scale=a),s!==void 0&&S3(f,s,i,l,!1)}const Ok=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]),Ik=e=>typeof e=="string"&&e.toLowerCase()==="svg";function A3(e,t,r,a){Rk(e,t,void 0,a);for(const s in t.attrs)e.setAttribute(Ok.has(s)?s:km(s),t.attrs[s])}function Lk(e,t,r){const a=Cm(e,t,r);for(const s in e)if(Qr(e[s])||Qr(t[s])){const i=yl.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;a[i]=e[s]}return a}class _3 extends Ak{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Cr}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(bl.has(r)){const a=gk(r);return a&&a.default||0}return r=Ok.has(r)?r:km(r),t.getAttribute(r)}scrapeMotionValuesFromProps(t,r,a){return Lk(t,r,a)}build(t,r,a){Pk(t,r,this.isSVGTag,a.transformTemplate,a.style)}renderInstance(t,r,a,s){A3(t,r,a,s)}mount(t){this.isSVGTag=Ik(t.tagName),super.mount(t)}}const C3=Am.length;function Bk(e){if(!e)return;if(!e.isControllingVariants){const r=e.parent?Bk(e.parent)||{}:{};return e.props.initial!==void 0&&(r.initial=e.props.initial),r}const t={};for(let r=0;r<C3;r++){const a=Am[r],s=e.props[a];(Fo(s)||s===!1)&&(t[a]=s)}return t}function zk(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let a=0;a<r;a++)if(t[a]!==e[a])return!1;return!0}const F3=[...Tm].reverse(),D3=Tm.length;function R3(e){return t=>Promise.all(t.map(({animation:r,options:a})=>CM(e,r,a)))}function M3(e){let t=R3(e),r=cg(),a=!0;const s=c=>(d,u)=>{var h;const f=Yi(e,u,c==="exit"?(h=e.presenceContext)==null?void 0:h.custom:void 0);if(f){const{transition:m,transitionEnd:x,...p}=f;d={...d,...p,...x}}return d};function i(c){t=c(e)}function l(c){const{props:d}=e,u=Bk(e.parent)||{},f=[],h=new Set;let m={},x=1/0;for(let g=0;g<D3;g++){const y=F3[g],N=r[y],v=d[y]!==void 0?d[y]:u[y],S=Fo(v),_=y===c?N.isActive:null;_===!1&&(x=g);let F=v===u[y]&&v!==d[y]&&S;if(F&&a&&e.manuallyAnimateOnMount&&(F=!1),N.protectedKeys={...m},!N.isActive&&_===null||!v&&!N.prevProp||ku(v)||typeof v=="boolean")continue;if(y==="exit"&&N.isActive&&_!==!0){N.prevResolvedValues&&(m={...m,...N.prevResolvedValues});continue}const k=P3(N.prevProp,v);let j=k||y===c&&N.isActive&&!F&&S||g>x&&S,w=!1;const E=Array.isArray(v)?v:[v];let A=E.reduce(s(y),{});_===!1&&(A={});const{prevResolvedValues:D={}}=N,W={...D,...A},re=Y=>{j=!0,h.has(Y)&&(w=!0,h.delete(Y)),N.needsAnimating[Y]=!0;const Q=e.getValue(Y);Q&&(Q.liveStyle=!1)};for(const Y in W){const Q=A[Y],B=D[Y];if(m.hasOwnProperty(Y))continue;let V=!1;_0(Q)&&_0(B)?V=!zk(Q,B):V=Q!==B,V?Q!=null?re(Y):h.add(Y):Q!==void 0&&h.has(Y)?re(Y):N.protectedKeys[Y]=!0}N.prevProp=v,N.prevResolvedValues=A,N.isActive&&(m={...m,...A}),a&&e.blockInitialAnimation&&(j=!1);const U=F&&k;j&&(!U||w)&&f.push(...E.map(Y=>{const Q={type:y};if(typeof Y=="string"&&a&&!U&&e.manuallyAnimateOnMount&&e.parent){const{parent:B}=e,V=Yi(B,Y);if(B.enteringChildren&&V){const{delayChildren:P}=V.transition||{};Q.delay=ok(B.enteringChildren,e,P)}}return{animation:Y,options:Q}}))}if(h.size){const g={};if(typeof d.initial!="boolean"){const y=Yi(e,Array.isArray(d.initial)?d.initial[0]:d.initial);y&&y.transition&&(g.transition=y.transition)}h.forEach(y=>{const N=e.getBaseTarget(y),v=e.getValue(y);v&&(v.liveStyle=!0),g[y]=N??null}),f.push({animation:g})}let p=!!f.length;return a&&(d.initial===!1||d.initial===d.animate)&&!e.manuallyAnimateOnMount&&(p=!1),a=!1,p?t(f):Promise.resolve()}function o(c,d){var f;if(r[c].isActive===d)return Promise.resolve();(f=e.variantChildren)==null||f.forEach(h=>{var m;return(m=h.animationState)==null?void 0:m.setActive(c,d)}),r[c].isActive=d;const u=l(c);for(const h in r)r[h].protectedKeys={};return u}return{animateChanges:l,setActive:o,setAnimateFunction:i,getState:()=>r,reset:()=>{r=cg()}}}function P3(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!zk(t,e):!1}function Ps(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function cg(){return{animate:Ps(!0),whileInView:Ps(),whileHover:Ps(),whileTap:Ps(),whileDrag:Ps(),whileFocus:Ps(),exit:Ps()}}function dg(e,t){e.min=t.min,e.max=t.max}function Qa(e,t){dg(e.x,t.x),dg(e.y,t.y)}function ug(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}const Uk=1e-4,O3=1-Uk,I3=1+Uk,Vk=.01,L3=0-Vk,B3=0+Vk;function la(e){return e.max-e.min}function z3(e,t,r){return Math.abs(e-t)<=r}function fg(e,t,r,a=.5){e.origin=a,e.originPoint=lr(t.min,t.max,e.origin),e.scale=la(r)/la(t),e.translate=lr(r.min,r.max,e.origin)-e.originPoint,(e.scale>=O3&&e.scale<=I3||isNaN(e.scale))&&(e.scale=1),(e.translate>=L3&&e.translate<=B3||isNaN(e.translate))&&(e.translate=0)}function Zl(e,t,r,a){fg(e.x,t.x,r.x,a?a.originX:void 0),fg(e.y,t.y,r.y,a?a.originY:void 0)}function hg(e,t,r){e.min=r.min+t.min,e.max=e.min+la(t)}function U3(e,t,r){hg(e.x,t.x,r.x),hg(e.y,t.y,r.y)}function mg(e,t,r){e.min=t.min-r.min,e.max=e.min+la(t)}function Fd(e,t,r){mg(e.x,t.x,r.x),mg(e.y,t.y,r.y)}function xg(e,t,r,a,s){return e-=t,e=Cd(e,1/r,a),s!==void 0&&(e=Cd(e,1/s,a)),e}function V3(e,t=0,r=1,a=.5,s,i=e,l=e){if(Rn.test(t)&&(t=parseFloat(t),t=lr(l.min,l.max,t/100)-l.min),typeof t!="number")return;let o=lr(i.min,i.max,a);e===i&&(o-=t),e.min=xg(e.min,t,r,o,s),e.max=xg(e.max,t,r,o,s)}function pg(e,t,[r,a,s],i,l){V3(e,t[r],t[a],t[s],t.scale,i,l)}const H3=["x","scaleX","originX"],$3=["y","scaleY","originY"];function gg(e,t,r,a){pg(e.x,t,H3,r?r.x:void 0,a?a.x:void 0),pg(e.y,t,$3,r?r.y:void 0,a?a.y:void 0)}function vg(e){return e.translate===0&&e.scale===1}function Hk(e){return vg(e.x)&&vg(e.y)}function yg(e,t){return e.min===t.min&&e.max===t.max}function K3(e,t){return yg(e.x,t.x)&&yg(e.y,t.y)}function bg(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function $k(e,t){return bg(e.x,t.x)&&bg(e.y,t.y)}function wg(e){return la(e.x)/la(e.y)}function kg(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}function Sn(e){return[e("x"),e("y")]}function W3(e,t,r){let a="";const s=e.x.translate/t.x,i=e.y.translate/t.y,l=(r==null?void 0:r.z)||0;if((s||i||l)&&(a=`translate3d(${s}px, ${i}px, ${l}px) `),(t.x!==1||t.y!==1)&&(a+=`scale(${1/t.x}, ${1/t.y}) `),r){const{transformPerspective:d,rotate:u,rotateX:f,rotateY:h,skewX:m,skewY:x}=r;d&&(a=`perspective(${d}px) ${a}`),u&&(a+=`rotate(${u}deg) `),f&&(a+=`rotateX(${f}deg) `),h&&(a+=`rotateY(${h}deg) `),m&&(a+=`skewX(${m}deg) `),x&&(a+=`skewY(${x}deg) `)}const o=e.x.scale*t.x,c=e.y.scale*t.y;return(o!==1||c!==1)&&(a+=`scale(${o}, ${c})`),a||"none"}const Kk=["TopLeft","TopRight","BottomLeft","BottomRight"],G3=Kk.length,Ng=e=>typeof e=="string"?parseFloat(e):e,jg=e=>typeof e=="number"||Xe.test(e);function Y3(e,t,r,a,s,i){s?(e.opacity=lr(0,r.opacity??1,X3(a)),e.opacityExit=lr(t.opacity??1,0,q3(a))):i&&(e.opacity=lr(t.opacity??1,r.opacity??1,a));for(let l=0;l<G3;l++){const o=`border${Kk[l]}Radius`;let c=Eg(t,o),d=Eg(r,o);if(c===void 0&&d===void 0)continue;c||(c=0),d||(d=0),c===0||d===0||jg(c)===jg(d)?(e[o]=Math.max(lr(Ng(c),Ng(d),a),0),(Rn.test(d)||Rn.test(c))&&(e[o]+="%")):e[o]=d}(t.rotate||r.rotate)&&(e.rotate=lr(t.rotate||0,r.rotate||0,a))}function Eg(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const X3=Wk(0,.5,Lw),q3=Wk(.5,.95,Ka);function Wk(e,t,r){return a=>a<e?0:a>t?1:r(Ao(e,t,a))}function Z3(e,t,r){const a=Qr(e)?e:ll(e);return a.start(bm("",a,t,r)),a.animation}function Do(e,t,r,a={passive:!0}){return e.addEventListener(t,r,a),()=>e.removeEventListener(t,r)}const J3=(e,t)=>e.depth-t.depth;class Q3{constructor(){this.children=[],this.isDirty=!1}add(t){nm(this.children,t),this.isDirty=!0}remove(t){Ed(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(J3),this.isDirty=!1,this.children.forEach(t)}}function eP(e,t){const r=ia.now(),a=({timestamp:s})=>{const i=s-r;i>=t&&(ys(a),e(i-t))};return qt.setup(a,!0),()=>ys(a)}function id(e){return Qr(e)?e.get():e}class tP{constructor(){this.members=[]}add(t){nm(this.members,t);for(let r=this.members.length-1;r>=0;r--){const a=this.members[r];if(a===t||a===this.lead||a===this.prevLead)continue;const s=a.instance;s&&s.isConnected===!1&&a.isPresent!==!1&&!a.snapshot&&Ed(this.members,a)}t.scheduleRender()}remove(t){if(Ed(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(s=>t===s);if(r===0)return!1;let a;for(let s=r;s>=0;s--){const i=this.members[s],l=i.instance;if(i.isPresent!==!1&&(!l||l.isConnected!==!1)){a=i;break}}return a?(this.promote(a),!0):!1}promote(t,r){const a=this.lead;if(t!==a&&(this.prevLead=a,this.lead=t,t.show(),a)){a.instance&&a.scheduleRender(),t.scheduleRender();const s=a.options.layoutDependency,i=t.options.layoutDependency;if(!(s!==void 0&&i!==void 0&&s===i)){const c=a.instance;c&&c.isConnected===!1&&!a.snapshot||(t.resumeFrom=a,r&&(t.resumeFrom.preserveOpacity=!0),a.snapshot&&(t.snapshot=a.snapshot,t.snapshot.latestValues=a.animationValues||a.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0))}const{crossfade:o}=t.options;o===!1&&a.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:a}=t;r.onExitComplete&&r.onExitComplete(),a&&a.options.onExitComplete&&a.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}const ld={hasAnimatedSinceResize:!0,hasEverUpdated:!1},af=["","X","Y","Z"],rP=1e3;let aP=0;function nf(e,t,r,a){const{latestValues:s}=t;s[e]&&(r[e]=s[e],t.setStaticValue(e,0),a&&(a[e]=0))}function Gk(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const r=hk(t);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:s,layoutId:i}=e.options;window.MotionCancelOptimisedAnimation(r,"transform",qt,!(s||i))}const{parent:a}=e;a&&!a.hasCheckedOptimisedAppear&&Gk(a)}function Yk({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:a,resetTransform:s}){return class{constructor(l={},o=t==null?void 0:t()){this.id=aP++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(iP),this.nodes.forEach(dP),this.nodes.forEach(uP),this.nodes.forEach(lP)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=l,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new Q3)}addEventListener(l,o){return this.eventHandlers.has(l)||this.eventHandlers.set(l,new lm),this.eventHandlers.get(l).add(o)}notifyListeners(l,...o){const c=this.eventHandlers.get(l);c&&c.notify(...o)}hasListeners(l){return this.eventHandlers.has(l)}mount(l){if(this.instance)return;this.isSVG=Sm(l)&&!s3(l),this.instance=l;const{layoutId:o,layout:c,visualElement:d}=this.options;if(d&&!d.current&&d.mount(l),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(c||o)&&(this.isLayoutDirty=!0),e){let u,f=0;const h=()=>this.root.updateBlockedByResize=!1;qt.read(()=>{f=window.innerWidth}),e(l,()=>{const m=window.innerWidth;m!==f&&(f=m,this.root.updateBlockedByResize=!0,u&&u(),u=eP(h,250),ld.hasAnimatedSinceResize&&(ld.hasAnimatedSinceResize=!1,this.nodes.forEach(Ag)))})}o&&this.root.registerSharedNode(o,this),this.options.animate!==!1&&d&&(o||c)&&this.addEventListener("didUpdate",({delta:u,hasLayoutChanged:f,hasRelativeLayoutChanged:h,layout:m})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const x=this.options.transition||d.getDefaultTransition()||pP,{onLayoutAnimationStart:p,onLayoutAnimationComplete:g}=d.getProps(),y=!this.targetLayout||!$k(this.targetLayout,m),N=!f&&h;if(this.options.layoutRoot||this.resumeFrom||N||f&&(y||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const v={...ym(x,"layout"),onPlay:p,onComplete:g};(d.shouldReduceMotion||this.options.layoutRoot)&&(v.delay=0,v.type=!1),this.startAnimation(v),this.setAnimationOrigin(u,N)}else f||Ag(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=m})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const l=this.getStack();l&&l.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),ys(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(fP),this.animationId++)}getTransformTemplate(){const{visualElement:l}=this.options;return l&&l.getProps().transformTemplate}willUpdate(l=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&Gk(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const f=this.path[u];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:o,layout:c}=this.options;if(o===void 0&&!c)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),l&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(Sg);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(Tg);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(cP),this.nodes.forEach(nP),this.nodes.forEach(sP)):this.nodes.forEach(Tg),this.clearAllSnapshots();const o=ia.now();zr.delta=On(0,1e3/60,o-zr.timestamp),zr.timestamp=o,zr.isProcessing=!0,Xu.update.process(zr),Xu.preRender.process(zr),Xu.render.process(zr),zr.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,jm.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(oP),this.sharedNodes.forEach(hP)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,qt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){qt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!la(this.snapshot.measuredBox.x)&&!la(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const l=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=Cr(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,l?l.layoutBox:void 0)}updateScroll(l="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===l&&(o=!1),o&&this.instance){const c=a(this.instance);this.scroll={animationId:this.root.animationId,phase:l,isRoot:c,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!s)return;const l=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!Hk(this.projectionDelta),c=this.getTransformTemplate(),d=c?c(this.latestValues,""):void 0,u=d!==this.prevTransformTemplateValue;l&&this.instance&&(o||Ls(this.latestValues)||u)&&(s(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(l=!0){const o=this.measurePageBox();let c=this.removeElementScroll(o);return l&&(c=this.removeTransform(c)),gP(c),{animationId:this.root.animationId,measuredBox:o,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){var d;const{visualElement:l}=this.options;if(!l)return Cr();const o=l.measureViewportBox();if(!(((d=this.scroll)==null?void 0:d.wasRoot)||this.path.some(vP))){const{scroll:u}=this.root;u&&(Li(o.x,u.offset.x),Li(o.y,u.offset.y))}return o}removeElementScroll(l){var c;const o=Cr();if(Qa(o,l),(c=this.scroll)!=null&&c.wasRoot)return o;for(let d=0;d<this.path.length;d++){const u=this.path[d],{scroll:f,options:h}=u;u!==this.root&&f&&h.layoutScroll&&(f.wasRoot&&Qa(o,l),Li(o.x,f.offset.x),Li(o.y,f.offset.y))}return o}applyTransform(l,o=!1){const c=Cr();Qa(c,l);for(let d=0;d<this.path.length;d++){const u=this.path[d];!o&&u.options.layoutScroll&&u.scroll&&u!==u.root&&Bi(c,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),Ls(u.latestValues)&&Bi(c,u.latestValues)}return Ls(this.latestValues)&&Bi(c,this.latestValues),c}removeTransform(l){const o=Cr();Qa(o,l);for(let c=0;c<this.path.length;c++){const d=this.path[c];if(!d.instance||!Ls(d.latestValues))continue;P0(d.latestValues)&&d.updateSnapshot();const u=Cr(),f=d.measurePageBox();Qa(u,f),gg(o,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,u)}return Ls(this.latestValues)&&gg(o,this.latestValues),o}setTargetDelta(l){this.targetDelta=l,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(l){this.options={...this.options,...l,crossfade:l.crossfade!==void 0?l.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==zr.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(l=!1){var m;const o=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=o.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=o.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=o.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==o;if(!(l||c&&this.isSharedProjectionDirty||this.isProjectionDirty||(m=this.parent)!=null&&m.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:u,layoutId:f}=this.options;if(!this.layout||!(u||f))return;this.resolvedRelativeTargetAt=zr.timestamp;const h=this.getClosestProjectingParent();h&&this.linkedParentVersion!==h.layoutVersion&&!h.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(h&&h.layout?this.createRelativeTarget(h,this.layout.layoutBox,h.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Cr(),this.targetWithTransforms=Cr()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),U3(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Qa(this.target,this.layout.layoutBox),Fk(this.target,this.targetDelta)):Qa(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,h&&!!h.resumingFrom==!!this.resumingFrom&&!h.options.layoutScroll&&h.target&&this.animationProgress!==1?this.createRelativeTarget(h,this.target,h.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(!(!this.parent||P0(this.parent.latestValues)||Ck(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(l,o,c){this.relativeParent=l,this.linkedParentVersion=l.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Cr(),this.relativeTargetOrigin=Cr(),Fd(this.relativeTargetOrigin,o,c),Qa(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){var x;const l=this.getLead(),o=!!this.resumingFrom||this!==l;let c=!0;if((this.isProjectionDirty||(x=this.parent)!=null&&x.isProjectionDirty)&&(c=!1),o&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===zr.timestamp&&(c=!1),c)return;const{layout:d,layoutId:u}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||u))return;Qa(this.layoutCorrected,this.layout.layoutBox);const f=this.treeScale.x,h=this.treeScale.y;p3(this.layoutCorrected,this.treeScale,this.path,o),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox,l.targetWithTransforms=Cr());const{target:m}=l;if(!m){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(ug(this.prevProjectionDelta.x,this.projectionDelta.x),ug(this.prevProjectionDelta.y,this.projectionDelta.y)),Zl(this.projectionDelta,this.layoutCorrected,m,this.latestValues),(this.treeScale.x!==f||this.treeScale.y!==h||!kg(this.projectionDelta.x,this.prevProjectionDelta.x)||!kg(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",m))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(l=!0){var o;if((o=this.options.visualElement)==null||o.scheduleRender(),l){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Ii(),this.projectionDelta=Ii(),this.projectionDeltaWithTransform=Ii()}setAnimationOrigin(l,o=!1){const c=this.snapshot,d=c?c.latestValues:{},u={...this.latestValues},f=Ii();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const h=Cr(),m=c?c.source:void 0,x=this.layout?this.layout.source:void 0,p=m!==x,g=this.getStack(),y=!g||g.members.length<=1,N=!!(p&&!y&&this.options.crossfade===!0&&!this.path.some(xP));this.animationProgress=0;let v;this.mixTargetDelta=S=>{const _=S/1e3;_g(f.x,l.x,_),_g(f.y,l.y,_),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Fd(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),mP(this.relativeTarget,this.relativeTargetOrigin,h,_),v&&K3(this.relativeTarget,v)&&(this.isProjectionDirty=!1),v||(v=Cr()),Qa(v,this.relativeTarget)),p&&(this.animationValues=u,Y3(u,d,this.latestValues,_,N,y)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=_},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(l){var o,c,d;this.notifyListeners("animationStart"),(o=this.currentAnimation)==null||o.stop(),(d=(c=this.resumingFrom)==null?void 0:c.currentAnimation)==null||d.stop(),this.pendingAnimation&&(ys(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=qt.update(()=>{ld.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=ll(0)),this.currentAnimation=Z3(this.motionValue,[0,1e3],{...l,velocity:0,isSync:!0,onUpdate:u=>{this.mixTargetDelta(u),l.onUpdate&&l.onUpdate(u)},onStop:()=>{},onComplete:()=>{l.onComplete&&l.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const l=this.getStack();l&&l.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(rP),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const l=this.getLead();let{targetWithTransforms:o,target:c,layout:d,latestValues:u}=l;if(!(!o||!c||!d)){if(this!==l&&this.layout&&d&&Xk(this.options.animationType,this.layout.layoutBox,d.layoutBox)){c=this.target||Cr();const f=la(this.layout.layoutBox.x);c.x.min=l.target.x.min,c.x.max=c.x.min+f;const h=la(this.layout.layoutBox.y);c.y.min=l.target.y.min,c.y.max=c.y.min+h}Qa(o,c),Bi(o,u),Zl(this.projectionDeltaWithTransform,this.layoutCorrected,o,u)}}registerSharedNode(l,o){this.sharedNodes.has(l)||this.sharedNodes.set(l,new tP),this.sharedNodes.get(l).add(o);const d=o.options.initialPromotionConfig;o.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(o):void 0})}isLead(){const l=this.getStack();return l?l.lead===this:!0}getLead(){var o;const{layoutId:l}=this.options;return l?((o=this.getStack())==null?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:l}=this.options;return l?(o=this.getStack())==null?void 0:o.prevLead:void 0}getStack(){const{layoutId:l}=this.options;if(l)return this.root.sharedNodes.get(l)}promote({needsReset:l,transition:o,preserveFollowOpacity:c}={}){const d=this.getStack();d&&d.promote(this,c),l&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const l=this.getStack();return l?l.relegate(this):!1}resetSkewAndRotation(){const{visualElement:l}=this.options;if(!l)return;let o=!1;const{latestValues:c}=l;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(o=!0),!o)return;const d={};c.z&&nf("z",l,d,this.animationValues);for(let u=0;u<af.length;u++)nf(`rotate${af[u]}`,l,d,this.animationValues),nf(`skew${af[u]}`,l,d,this.animationValues);l.render();for(const u in d)l.setStaticValue(u,d[u]),this.animationValues&&(this.animationValues[u]=d[u]);l.scheduleRender()}applyProjectionStyles(l,o){if(!this.instance||this.isSVG)return;if(!this.isVisible){l.visibility="hidden";return}const c=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,l.visibility="",l.opacity="",l.pointerEvents=id(o==null?void 0:o.pointerEvents)||"",l.transform=c?c(this.latestValues,""):"none";return}const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){this.options.layoutId&&(l.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,l.pointerEvents=id(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!Ls(this.latestValues)&&(l.transform=c?c({},""):"none",this.hasProjected=!1);return}l.visibility="";const u=d.animationValues||d.latestValues;this.applyTransformsToTarget();let f=W3(this.projectionDeltaWithTransform,this.treeScale,u);c&&(f=c(u,f)),l.transform=f;const{x:h,y:m}=this.projectionDelta;l.transformOrigin=`${h.origin*100}% ${m.origin*100}% 0`,d.animationValues?l.opacity=d===this?u.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:u.opacityExit:l.opacity=d===this?u.opacity!==void 0?u.opacity:"":u.opacityExit!==void 0?u.opacityExit:0;for(const x in I0){if(u[x]===void 0)continue;const{correct:p,applyTo:g,isCSSVariable:y}=I0[x],N=f==="none"?u[x]:p(u[x],d);if(g){const v=g.length;for(let S=0;S<v;S++)l[g[S]]=N}else y?this.options.visualElement.renderState.vars[x]=N:l[x]=N}this.options.layoutId&&(l.pointerEvents=d===this?id(o==null?void 0:o.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(l=>{var o;return(o=l.currentAnimation)==null?void 0:o.stop()}),this.root.nodes.forEach(Sg),this.root.sharedNodes.clear()}}}function nP(e){e.updateLayout()}function sP(e){var r;const t=((r=e.resumeFrom)==null?void 0:r.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:a,measuredBox:s}=e.layout,{animationType:i}=e.options,l=t.source!==e.layout.source;i==="size"?Sn(f=>{const h=l?t.measuredBox[f]:t.layoutBox[f],m=la(h);h.min=a[f].min,h.max=h.min+m}):Xk(i,t.layoutBox,a)&&Sn(f=>{const h=l?t.measuredBox[f]:t.layoutBox[f],m=la(a[f]);h.max=h.min+m,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[f].max=e.relativeTarget[f].min+m)});const o=Ii();Zl(o,a,t.layoutBox);const c=Ii();l?Zl(c,e.applyTransform(s,!0),t.measuredBox):Zl(c,a,t.layoutBox);const d=!Hk(o);let u=!1;if(!e.resumeFrom){const f=e.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:h,layout:m}=f;if(h&&m){const x=Cr();Fd(x,t.layoutBox,h.layoutBox);const p=Cr();Fd(p,a,m.layoutBox),$k(x,p)||(u=!0),f.options.layoutRoot&&(e.relativeTarget=p,e.relativeTargetOrigin=x,e.relativeParent=f)}}}e.notifyListeners("didUpdate",{layout:a,snapshot:t,delta:c,layoutDelta:o,hasLayoutChanged:d,hasRelativeLayoutChanged:u})}else if(e.isLead()){const{onExitComplete:a}=e.options;a&&a()}e.options.transition=void 0}function iP(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function lP(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function oP(e){e.clearSnapshot()}function Sg(e){e.clearMeasurements()}function Tg(e){e.isLayoutDirty=!1}function cP(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function Ag(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function dP(e){e.resolveTargetDelta()}function uP(e){e.calcProjection()}function fP(e){e.resetSkewAndRotation()}function hP(e){e.removeLeadSnapshot()}function _g(e,t,r){e.translate=lr(t.translate,0,r),e.scale=lr(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function Cg(e,t,r,a){e.min=lr(t.min,r.min,a),e.max=lr(t.max,r.max,a)}function mP(e,t,r,a){Cg(e.x,t.x,r.x,a),Cg(e.y,t.y,r.y,a)}function xP(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const pP={duration:.45,ease:[.4,0,.1,1]},Fg=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),Dg=Fg("applewebkit/")&&!Fg("chrome/")?Math.round:Ka;function Rg(e){e.min=Dg(e.min),e.max=Dg(e.max)}function gP(e){Rg(e.x),Rg(e.y)}function Xk(e,t,r){return e==="position"||e==="preserve-aspect"&&!z3(wg(t),wg(r),.2)}function vP(e){var t;return e!==e.root&&((t=e.scroll)==null?void 0:t.wasRoot)}const yP=Yk({attachResizeListener:(e,t)=>Do(e,"resize",t),measureScroll:()=>{var e,t;return{x:document.documentElement.scrollLeft||((e=document.body)==null?void 0:e.scrollLeft)||0,y:document.documentElement.scrollTop||((t=document.body)==null?void 0:t.scrollTop)||0}},checkIsScrollRoot:()=>!0}),sf={current:void 0},qk=Yk({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!sf.current){const e=new yP({});e.mount(window),e.setOptions({layoutScroll:!0}),sf.current=e}return sf.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),Fm=b.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});function Mg(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function bP(...e){return t=>{let r=!1;const a=e.map(s=>{const i=Mg(s,t);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let s=0;s<a.length;s++){const i=a[s];typeof i=="function"?i():Mg(e[s],null)}}}}function wP(...e){return b.useCallback(bP(...e),e)}class kP extends b.Component{getSnapshotBeforeUpdate(t){const r=this.props.childRef.current;if(r&&t.isPresent&&!this.props.isPresent&&this.props.pop!==!1){const a=r.offsetParent,s=R0(a)&&a.offsetWidth||0,i=R0(a)&&a.offsetHeight||0,l=this.props.sizeRef.current;l.height=r.offsetHeight||0,l.width=r.offsetWidth||0,l.top=r.offsetTop,l.left=r.offsetLeft,l.right=s-l.width-l.left,l.bottom=i-l.height-l.top}return null}componentDidUpdate(){}render(){return this.props.children}}function NP({children:e,isPresent:t,anchorX:r,anchorY:a,root:s,pop:i}){var h;const l=b.useId(),o=b.useRef(null),c=b.useRef({width:0,height:0,top:0,left:0,right:0,bottom:0}),{nonce:d}=b.useContext(Fm),u=((h=e.props)==null?void 0:h.ref)??(e==null?void 0:e.ref),f=wP(o,u);return b.useInsertionEffect(()=>{const{width:m,height:x,top:p,left:g,right:y,bottom:N}=c.current;if(t||i===!1||!o.current||!m||!x)return;const v=r==="left"?`left: ${g}`:`right: ${y}`,S=a==="bottom"?`bottom: ${N}`:`top: ${p}`;o.current.dataset.motionPopId=l;const _=document.createElement("style");d&&(_.nonce=d);const F=s??document.head;return F.appendChild(_),_.sheet&&_.sheet.insertRule(`
          [data-motion-pop-id="${l}"] {
            position: absolute !important;
            width: ${m}px !important;
            height: ${x}px !important;
            ${v}px !important;
            ${S}px !important;
          }
        `),()=>{F.contains(_)&&F.removeChild(_)}},[t]),n.jsx(kP,{isPresent:t,childRef:o,sizeRef:c,pop:i,children:i===!1?e:b.cloneElement(e,{ref:f})})}const jP=({children:e,initial:t,isPresent:r,onExitComplete:a,custom:s,presenceAffectsLayout:i,mode:l,anchorX:o,anchorY:c,root:d})=>{const u=am(EP),f=b.useId();let h=!0,m=b.useMemo(()=>(h=!1,{id:f,initial:t,isPresent:r,custom:s,onExitComplete:x=>{u.set(x,!0);for(const p of u.values())if(!p)return;a&&a()},register:x=>(u.set(x,!1),()=>u.delete(x))}),[r,u,a]);return i&&h&&(m={...m}),b.useMemo(()=>{u.forEach((x,p)=>u.set(p,!1))},[r]),b.useEffect(()=>{!r&&!u.size&&a&&a()},[r]),e=n.jsx(NP,{pop:l==="popLayout",isPresent:r,anchorX:o,anchorY:c,root:d,children:e}),n.jsx(wu.Provider,{value:m,children:e})};function EP(){return new Map}function Zk(e=!0){const t=b.useContext(wu);if(t===null)return[!0,null];const{isPresent:r,onExitComplete:a,register:s}=t,i=b.useId();b.useEffect(()=>{if(e)return s(i)},[e]);const l=b.useCallback(()=>e&&a&&a(i),[i,a,e]);return!r&&a?[!1,l]:[!0]}const Ac=e=>e.key||"";function Pg(e){const t=[];return b.Children.forEach(e,r=>{b.isValidElement(r)&&t.push(r)}),t}const Og=({children:e,custom:t,initial:r=!0,onExitComplete:a,presenceAffectsLayout:s=!0,mode:i="sync",propagate:l=!1,anchorX:o="left",anchorY:c="top",root:d})=>{const[u,f]=Zk(l),h=b.useMemo(()=>Pg(e),[e]),m=l&&!u?[]:h.map(Ac),x=b.useRef(!0),p=b.useRef(h),g=am(()=>new Map),y=b.useRef(new Set),[N,v]=b.useState(h),[S,_]=b.useState(h);Tw(()=>{x.current=!1,p.current=h;for(let j=0;j<S.length;j++){const w=Ac(S[j]);m.includes(w)?(g.delete(w),y.current.delete(w)):g.get(w)!==!0&&g.set(w,!1)}},[S,m.length,m.join("-")]);const F=[];if(h!==N){let j=[...h];for(let w=0;w<S.length;w++){const E=S[w],A=Ac(E);m.includes(A)||(j.splice(w,0,E),F.push(E))}return i==="wait"&&F.length&&(j=F),_(Pg(j)),v(h),null}const{forceRender:k}=b.useContext(rm);return n.jsx(n.Fragment,{children:S.map(j=>{const w=Ac(j),E=l&&!u?!1:h===S||m.includes(w),A=()=>{if(y.current.has(w))return;if(y.current.add(w),g.has(w))g.set(w,!0);else return;let D=!0;g.forEach(W=>{W||(D=!1)}),D&&(k==null||k(),_(p.current),l&&(f==null||f()),a&&a())};return n.jsx(jP,{isPresent:E,initial:!x.current||r?void 0:!1,custom:t,presenceAffectsLayout:s,mode:i,root:d,onExitComplete:E?void 0:A,anchorX:o,anchorY:c,children:j},w)})})},Jk=b.createContext({strict:!1}),Ig={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]};let Lg=!1;function SP(){if(Lg)return;const e={};for(const t in Ig)e[t]={isEnabled:r=>Ig[t].some(a=>!!r[a])};Tk(e),Lg=!0}function Qk(){return SP(),f3()}function TP(e){const t=Qk();for(const r in e)t[r]={...t[r],...e[r]};Tk(t)}const AP=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","propagate","ignoreStrict","viewport"]);function Dd(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||AP.has(e)}let e2=e=>!Dd(e);function _P(e){typeof e=="function"&&(e2=t=>t.startsWith("on")?!Dd(t):e(t))}try{_P(require("@emotion/is-prop-valid").default)}catch{}function CP(e,t,r){const a={};for(const s in e)s==="values"&&typeof e.values=="object"||(e2(s)||r===!0&&Dd(s)||!t&&!Dd(s)||e.draggable&&s.startsWith("onDrag"))&&(a[s]=e[s]);return a}const ju=b.createContext({});function FP(e,t){if(Nu(e)){const{initial:r,animate:a}=e;return{initial:r===!1||Fo(r)?r:void 0,animate:Fo(a)?a:void 0}}return e.inherit!==!1?t:{}}function DP(e){const{initial:t,animate:r}=FP(e,b.useContext(ju));return b.useMemo(()=>({initial:t,animate:r}),[Bg(t),Bg(r)])}function Bg(e){return Array.isArray(e)?e.join(" "):e}const Dm=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function t2(e,t,r){for(const a in t)!Qr(t[a])&&!Mk(a,r)&&(e[a]=t[a])}function RP({transformTemplate:e},t){return b.useMemo(()=>{const r=Dm();return _m(r,t,e),Object.assign({},r.vars,r.style)},[t])}function MP(e,t){const r=e.style||{},a={};return t2(a,r,e),Object.assign(a,RP(e,t)),a}function PP(e,t){const r={},a=MP(e,t);return e.drag&&e.dragListener!==!1&&(r.draggable=!1,a.userSelect=a.WebkitUserSelect=a.WebkitTouchCallout="none",a.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(r.tabIndex=0),r.style=a,r}const r2=()=>({...Dm(),attrs:{}});function OP(e,t,r,a){const s=b.useMemo(()=>{const i=r2();return Pk(i,t,Ik(a),e.transformTemplate,e.style),{...i.attrs,style:{...i.style}}},[t]);if(e.style){const i={};t2(i,e.style,e),s.style={...i,...s.style}}return s}const IP=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Rm(e){return typeof e!="string"||e.includes("-")?!1:!!(IP.indexOf(e)>-1||/[A-Z]/u.test(e))}function LP(e,t,r,{latestValues:a},s,i=!1,l){const c=(l??Rm(e)?OP:PP)(t,a,s,e),d=CP(t,typeof e=="string",i),u=e!==b.Fragment?{...d,...c,ref:r}:{},{children:f}=t,h=b.useMemo(()=>Qr(f)?f.get():f,[f]);return b.createElement(e,{...u,children:h})}function BP({scrapeMotionValuesFromProps:e,createRenderState:t},r,a,s){return{latestValues:zP(r,a,s,e),renderState:t()}}function zP(e,t,r,a){const s={},i=a(e,{});for(const h in i)s[h]=id(i[h]);let{initial:l,animate:o}=e;const c=Nu(e),d=Ek(e);t&&d&&!c&&e.inherit!==!1&&(l===void 0&&(l=t.initial),o===void 0&&(o=t.animate));let u=r?r.initial===!1:!1;u=u||l===!1;const f=u?o:l;if(f&&typeof f!="boolean"&&!ku(f)){const h=Array.isArray(f)?f:[f];for(let m=0;m<h.length;m++){const x=wm(e,h[m]);if(x){const{transitionEnd:p,transition:g,...y}=x;for(const N in y){let v=y[N];if(Array.isArray(v)){const S=u?v.length-1:0;v=v[S]}v!==null&&(s[N]=v)}for(const N in p)s[N]=p[N]}}}return s}const a2=e=>(t,r)=>{const a=b.useContext(ju),s=b.useContext(wu),i=()=>BP(e,t,a,s);return r?i():am(i)},UP=a2({scrapeMotionValuesFromProps:Cm,createRenderState:Dm}),VP=a2({scrapeMotionValuesFromProps:Lk,createRenderState:r2}),HP=Symbol.for("motionComponentSymbol");function $P(e,t,r){const a=b.useRef(r);b.useInsertionEffect(()=>{a.current=r});const s=b.useRef(null);return b.useCallback(i=>{var o;i&&((o=e.onMount)==null||o.call(e,i)),t&&(i?t.mount(i):t.unmount());const l=a.current;if(typeof l=="function")if(i){const c=l(i);typeof c=="function"&&(s.current=c)}else s.current?(s.current(),s.current=null):l(i);else l&&(l.current=i)},[t])}const n2=b.createContext({});function Ci(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function KP(e,t,r,a,s,i){var v,S;const{visualElement:l}=b.useContext(ju),o=b.useContext(Jk),c=b.useContext(wu),d=b.useContext(Fm),u=d.reducedMotion,f=d.skipAnimations,h=b.useRef(null),m=b.useRef(!1);a=a||o.renderer,!h.current&&a&&(h.current=a(e,{visualState:t,parent:l,props:r,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:u,skipAnimations:f,isSVG:i}),m.current&&h.current&&(h.current.manuallyAnimateOnMount=!0));const x=h.current,p=b.useContext(n2);x&&!x.projection&&s&&(x.type==="html"||x.type==="svg")&&WP(h.current,r,s,p);const g=b.useRef(!1);b.useInsertionEffect(()=>{x&&g.current&&x.update(r,c)});const y=r[fk],N=b.useRef(!!y&&!((v=window.MotionHandoffIsComplete)!=null&&v.call(window,y))&&((S=window.MotionHasOptimisedAnimation)==null?void 0:S.call(window,y)));return Tw(()=>{m.current=!0,x&&(g.current=!0,window.MotionIsMounted=!0,x.updateFeatures(),x.scheduleRenderMicrotask(),N.current&&x.animationState&&x.animationState.animateChanges())}),b.useEffect(()=>{x&&(!N.current&&x.animationState&&x.animationState.animateChanges(),N.current&&(queueMicrotask(()=>{var _;(_=window.MotionHandoffMarkAsComplete)==null||_.call(window,y)}),N.current=!1),x.enteringChildren=void 0)}),x}function WP(e,t,r,a){const{layoutId:s,layout:i,drag:l,dragConstraints:o,layoutScroll:c,layoutRoot:d,layoutCrossfade:u}=t;e.projection=new r(e.latestValues,t["data-framer-portal-id"]?void 0:s2(e.parent)),e.projection.setOptions({layoutId:s,layout:i,alwaysMeasureLayout:!!l||o&&Ci(o),visualElement:e,animationType:typeof i=="string"?i:"both",initialPromotionConfig:a,crossfade:u,layoutScroll:c,layoutRoot:d})}function s2(e){if(e)return e.options.allowProjection!==!1?e.projection:s2(e.parent)}function lf(e,{forwardMotionProps:t=!1,type:r}={},a,s){a&&TP(a);const i=r?r==="svg":Rm(e),l=i?VP:UP;function o(d,u){let f;const h={...b.useContext(Fm),...d,layoutId:GP(d)},{isStatic:m}=h,x=DP(d),p=l(d,m);if(!m&&Sw){YP();const g=XP(h);f=g.MeasureLayout,x.visualElement=KP(e,p,h,s,g.ProjectionNode,i)}return n.jsxs(ju.Provider,{value:x,children:[f&&x.visualElement?n.jsx(f,{visualElement:x.visualElement,...h}):null,LP(e,d,$P(p,x.visualElement,u),p,m,t,i)]})}o.displayName=`motion.${typeof e=="string"?e:`create(${e.displayName??e.name??""})`}`;const c=b.forwardRef(o);return c[HP]=e,c}function GP({layoutId:e}){const t=b.useContext(rm).id;return t&&e!==void 0?t+"-"+e:e}function YP(e,t){b.useContext(Jk).strict}function XP(e){const t=Qk(),{drag:r,layout:a}=t;if(!r&&!a)return{};const s={...r,...a};return{MeasureLayout:r!=null&&r.isEnabled(e)||a!=null&&a.isEnabled(e)?s.MeasureLayout:void 0,ProjectionNode:s.ProjectionNode}}function qP(e,t){if(typeof Proxy>"u")return lf;const r=new Map,a=(i,l)=>lf(i,l,e,t),s=(i,l)=>a(i,l);return new Proxy(s,{get:(i,l)=>l==="create"?a:(r.has(l)||r.set(l,lf(l,void 0,e,t)),r.get(l))})}const ZP=(e,t)=>t.isSVG??Rm(e)?new _3(t):new N3(t,{allowProjection:e!==b.Fragment});class JP extends As{constructor(t){super(t),t.animationState||(t.animationState=M3(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();ku(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)==null||t.call(this)}}let QP=0;class e8 extends As{constructor(){super(...arguments),this.id=QP++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r}=this.node.presenceContext,{isPresent:a}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===a)return;const s=this.node.animationState.setActive("exit",!t);r&&!t&&s.then(()=>{r(this.id)})}mount(){const{register:t,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const t8={animation:{Feature:JP},exit:{Feature:e8}};function lc(e){return{point:{x:e.pageX,y:e.pageY}}}const r8=e=>t=>Em(t)&&e(t,lc(t));function Jl(e,t,r,a){return Do(e,t,r8(r),a)}const i2=({current:e})=>e?e.ownerDocument.defaultView:null,zg=(e,t)=>Math.abs(e-t);function a8(e,t){const r=zg(e.x,t.x),a=zg(e.y,t.y);return Math.sqrt(r**2+a**2)}const Ug=new Set(["auto","scroll"]);class l2{constructor(t,r,{transformPagePoint:a,contextWindow:s=window,dragSnapToOrigin:i=!1,distanceThreshold:l=3,element:o}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.scrollPositions=new Map,this.removeScrollListeners=null,this.onElementScroll=m=>{this.handleScroll(m.target)},this.onWindowScroll=()=>{this.handleScroll(window)},this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const m=cf(this.lastMoveEventInfo,this.history),x=this.startEvent!==null,p=a8(m.offset,{x:0,y:0})>=this.distanceThreshold;if(!x&&!p)return;const{point:g}=m,{timestamp:y}=zr;this.history.push({...g,timestamp:y});const{onStart:N,onMove:v}=this.handlers;x||(N&&N(this.lastMoveEvent,m),this.startEvent=this.lastMoveEvent),v&&v(this.lastMoveEvent,m)},this.handlePointerMove=(m,x)=>{this.lastMoveEvent=m,this.lastMoveEventInfo=of(x,this.transformPagePoint),qt.update(this.updatePoint,!0)},this.handlePointerUp=(m,x)=>{this.end();const{onEnd:p,onSessionEnd:g,resumeAnimation:y}=this.handlers;if((this.dragSnapToOrigin||!this.startEvent)&&y&&y(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const N=cf(m.type==="pointercancel"?this.lastMoveEventInfo:of(x,this.transformPagePoint),this.history);this.startEvent&&p&&p(m,N),g&&g(m,N)},!Em(t))return;this.dragSnapToOrigin=i,this.handlers=r,this.transformPagePoint=a,this.distanceThreshold=l,this.contextWindow=s||window;const c=lc(t),d=of(c,this.transformPagePoint),{point:u}=d,{timestamp:f}=zr;this.history=[{...u,timestamp:f}];const{onSessionStart:h}=r;h&&h(t,cf(d,this.history)),this.removeListeners=nc(Jl(this.contextWindow,"pointermove",this.handlePointerMove),Jl(this.contextWindow,"pointerup",this.handlePointerUp),Jl(this.contextWindow,"pointercancel",this.handlePointerUp)),o&&this.startScrollTracking(o)}startScrollTracking(t){let r=t.parentElement;for(;r;){const a=getComputedStyle(r);(Ug.has(a.overflowX)||Ug.has(a.overflowY))&&this.scrollPositions.set(r,{x:r.scrollLeft,y:r.scrollTop}),r=r.parentElement}this.scrollPositions.set(window,{x:window.scrollX,y:window.scrollY}),window.addEventListener("scroll",this.onElementScroll,{capture:!0,passive:!0}),window.addEventListener("scroll",this.onWindowScroll,{passive:!0}),this.removeScrollListeners=()=>{window.removeEventListener("scroll",this.onElementScroll,{capture:!0}),window.removeEventListener("scroll",this.onWindowScroll)}}handleScroll(t){const r=this.scrollPositions.get(t);if(!r)return;const a=t===window,s=a?{x:window.scrollX,y:window.scrollY}:{x:t.scrollLeft,y:t.scrollTop},i={x:s.x-r.x,y:s.y-r.y};i.x===0&&i.y===0||(a?this.lastMoveEventInfo&&(this.lastMoveEventInfo.point.x+=i.x,this.lastMoveEventInfo.point.y+=i.y):this.history.length>0&&(this.history[0].x-=i.x,this.history[0].y-=i.y),this.scrollPositions.set(t,s),qt.update(this.updatePoint,!0))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),this.removeScrollListeners&&this.removeScrollListeners(),this.scrollPositions.clear(),ys(this.updatePoint)}}function of(e,t){return t?{point:t(e.point)}:e}function Vg(e,t){return{x:e.x-t.x,y:e.y-t.y}}function cf({point:e},t){return{point:e,delta:Vg(e,o2(t)),offset:Vg(e,n8(t)),velocity:s8(t,.1)}}function n8(e){return e[0]}function o2(e){return e[e.length-1]}function s8(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,a=null;const s=o2(e);for(;r>=0&&(a=e[r],!(s.timestamp-a.timestamp>dn(t)));)r--;if(!a)return{x:0,y:0};a===e[0]&&e.length>2&&s.timestamp-a.timestamp>dn(t)*2&&(a=e[1]);const i=Va(s.timestamp-a.timestamp);if(i===0)return{x:0,y:0};const l={x:(s.x-a.x)/i,y:(s.y-a.y)/i};return l.x===1/0&&(l.x=0),l.y===1/0&&(l.y=0),l}function i8(e,{min:t,max:r},a){return t!==void 0&&e<t?e=a?lr(t,e,a.min):Math.max(e,t):r!==void 0&&e>r&&(e=a?lr(r,e,a.max):Math.min(e,r)),e}function Hg(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function l8(e,{top:t,left:r,bottom:a,right:s}){return{x:Hg(e.x,r,s),y:Hg(e.y,t,a)}}function $g(e,t){let r=t.min-e.min,a=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,a]=[a,r]),{min:r,max:a}}function o8(e,t){return{x:$g(e.x,t.x),y:$g(e.y,t.y)}}function c8(e,t){let r=.5;const a=la(e),s=la(t);return s>a?r=Ao(t.min,t.max-a,e.min):a>s&&(r=Ao(e.min,e.max-s,t.min)),On(0,1,r)}function d8(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const L0=.35;function u8(e=L0){return e===!1?e=0:e===!0&&(e=L0),{x:Kg(e,"left","right"),y:Kg(e,"top","bottom")}}function Kg(e,t,r){return{min:Wg(e,t),max:Wg(e,r)}}function Wg(e,t){return typeof e=="number"?e:e[t]||0}const f8=new WeakMap;class h8{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Cr(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:r=!1,distanceThreshold:a}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const i=f=>{r&&this.snapToCursor(lc(f).point),this.stopAnimation()},l=(f,h)=>{const{drag:m,dragPropagation:x,onDragStart:p}=this.getProps();if(m&&!x&&(this.openDragLock&&this.openDragLock(),this.openDragLock=VM(m),!this.openDragLock))return;this.latestPointerEvent=f,this.latestPanInfo=h,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Sn(y=>{let N=this.getAxisMotionValue(y).get()||0;if(Rn.test(N)){const{projection:v}=this.visualElement;if(v&&v.layout){const S=v.layout.layoutBox[y];S&&(N=la(S)*(parseFloat(N)/100))}}this.originPoint[y]=N}),p&&qt.update(()=>p(f,h),!1,!0),C0(this.visualElement,"transform");const{animationState:g}=this.visualElement;g&&g.setActive("whileDrag",!0)},o=(f,h)=>{this.latestPointerEvent=f,this.latestPanInfo=h;const{dragPropagation:m,dragDirectionLock:x,onDirectionLock:p,onDrag:g}=this.getProps();if(!m&&!this.openDragLock)return;const{offset:y}=h;if(x&&this.currentDirection===null){this.currentDirection=x8(y),this.currentDirection!==null&&p&&p(this.currentDirection);return}this.updateAxis("x",h.point,y),this.updateAxis("y",h.point,y),this.visualElement.render(),g&&qt.update(()=>g(f,h),!1,!0)},c=(f,h)=>{this.latestPointerEvent=f,this.latestPanInfo=h,this.stop(f,h),this.latestPointerEvent=null,this.latestPanInfo=null},d=()=>{const{dragSnapToOrigin:f}=this.getProps();(f||this.constraints)&&this.startAnimation({x:0,y:0})},{dragSnapToOrigin:u}=this.getProps();this.panSession=new l2(t,{onSessionStart:i,onStart:l,onMove:o,onSessionEnd:c,resumeAnimation:d},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,distanceThreshold:a,contextWindow:i2(this.visualElement),element:this.visualElement.current})}stop(t,r){const a=t||this.latestPointerEvent,s=r||this.latestPanInfo,i=this.isDragging;if(this.cancel(),!i||!s||!a)return;const{velocity:l}=s;this.startAnimation(l);const{onDragEnd:o}=this.getProps();o&&qt.postRender(()=>o(a,s))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.endPanSession();const{dragPropagation:a}=this.getProps();!a&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}endPanSession(){this.panSession&&this.panSession.end(),this.panSession=void 0}updateAxis(t,r,a){const{drag:s}=this.getProps();if(!a||!_c(t,s,this.currentDirection))return;const i=this.getAxisMotionValue(t);let l=this.originPoint[t]+a[t];this.constraints&&this.constraints[t]&&(l=i8(l,this.constraints[t],this.elastic[t])),i.set(l)}resolveConstraints(){var i;const{dragConstraints:t,dragElastic:r}=this.getProps(),a=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(i=this.visualElement.projection)==null?void 0:i.layout,s=this.constraints;t&&Ci(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&a?this.constraints=l8(a.layoutBox,t):this.constraints=!1,this.elastic=u8(r),s!==this.constraints&&!Ci(t)&&a&&this.constraints&&!this.hasMutatedConstraints&&Sn(l=>{this.constraints!==!1&&this.getAxisMotionValue(l)&&(this.constraints[l]=d8(a.layoutBox[l],this.constraints[l]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!Ci(t))return!1;const a=t.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const i=g3(a,s.root,this.visualElement.getTransformPagePoint());let l=o8(s.layout.layoutBox,i);if(r){const o=r(m3(l));this.hasMutatedConstraints=!!o,o&&(l=_k(o))}return l}startAnimation(t){const{drag:r,dragMomentum:a,dragElastic:s,dragTransition:i,dragSnapToOrigin:l,onDragTransitionEnd:o}=this.getProps(),c=this.constraints||{},d=Sn(u=>{if(!_c(u,r,this.currentDirection))return;let f=c&&c[u]||{};l&&(f={min:0,max:0});const h=s?200:1e6,m=s?40:1e7,x={type:"inertia",velocity:a?t[u]:0,bounceStiffness:h,bounceDamping:m,timeConstant:750,restDelta:1,restSpeed:10,...i,...f};return this.startAxisValueAnimation(u,x)});return Promise.all(d).then(o)}startAxisValueAnimation(t,r){const a=this.getAxisMotionValue(t);return C0(this.visualElement,t),a.start(bm(t,a,0,r,this.visualElement,!1))}stopAnimation(){Sn(t=>this.getAxisMotionValue(t).stop())}getAxisMotionValue(t){const r=`_drag${t.toUpperCase()}`,a=this.visualElement.getProps(),s=a[r];return s||this.visualElement.getValue(t,(a.initial?a.initial[t]:void 0)||0)}snapToCursor(t){Sn(r=>{const{drag:a}=this.getProps();if(!_c(r,a,this.currentDirection))return;const{projection:s}=this.visualElement,i=this.getAxisMotionValue(r);if(s&&s.layout){const{min:l,max:o}=s.layout.layoutBox[r],c=i.get()||0;i.set(t[r]-lr(l,o,.5)+c)}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:a}=this.visualElement;if(!Ci(r)||!a||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};Sn(l=>{const o=this.getAxisMotionValue(l);if(o&&this.constraints!==!1){const c=o.get();s[l]=c8({min:c,max:c},this.constraints[l])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",a.root&&a.root.updateScroll(),a.updateLayout(),this.constraints=!1,this.resolveConstraints(),Sn(l=>{if(!_c(l,t,null))return;const o=this.getAxisMotionValue(l),{min:c,max:d}=this.constraints[l];o.set(lr(c,d,s[l]))}),this.visualElement.render()}addListeners(){if(!this.visualElement.current)return;f8.set(this.visualElement,this);const t=this.visualElement.current,r=Jl(t,"pointerdown",d=>{const{drag:u,dragListener:f=!0}=this.getProps(),h=d.target,m=h!==t&&YM(h);u&&f&&!m&&this.start(d)});let a;const s=()=>{const{dragConstraints:d}=this.getProps();Ci(d)&&d.current&&(this.constraints=this.resolveRefConstraints(),a||(a=m8(t,d.current,()=>this.scalePositionWithinConstraints())))},{projection:i}=this.visualElement,l=i.addEventListener("measure",s);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),qt.read(s);const o=Do(window,"resize",()=>this.scalePositionWithinConstraints()),c=i.addEventListener("didUpdate",(({delta:d,hasLayoutChanged:u})=>{this.isDragging&&u&&(Sn(f=>{const h=this.getAxisMotionValue(f);h&&(this.originPoint[f]+=d[f].translate,h.set(h.get()+d[f].translate))}),this.visualElement.render())}));return()=>{o(),r(),l(),c&&c(),a&&a()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:a=!1,dragPropagation:s=!1,dragConstraints:i=!1,dragElastic:l=L0,dragMomentum:o=!0}=t;return{...t,drag:r,dragDirectionLock:a,dragPropagation:s,dragConstraints:i,dragElastic:l,dragMomentum:o}}}function Gg(e){let t=!0;return()=>{if(t){t=!1;return}e()}}function m8(e,t,r){const a=Qp(e,Gg(r)),s=Qp(t,Gg(r));return()=>{a(),s()}}function _c(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function x8(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class p8 extends As{constructor(t){super(t),this.removeGroupControls=Ka,this.removeListeners=Ka,this.controls=new h8(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Ka}update(){const{dragControls:t}=this.node.getProps(),{dragControls:r}=this.node.prevProps||{};t!==r&&(this.removeGroupControls(),t&&(this.removeGroupControls=t.subscribe(this.controls)))}unmount(){this.removeGroupControls(),this.removeListeners(),this.controls.isDragging||this.controls.endPanSession()}}const df=e=>(t,r)=>{e&&qt.update(()=>e(t,r),!1,!0)};class g8 extends As{constructor(){super(...arguments),this.removePointerDownListener=Ka}onPointerDown(t){this.session=new l2(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:i2(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:a,onPanEnd:s}=this.node.getProps();return{onSessionStart:df(t),onStart:df(r),onMove:df(a),onEnd:(i,l)=>{delete this.session,s&&qt.postRender(()=>s(i,l))}}}mount(){this.removePointerDownListener=Jl(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}let uf=!1;class v8 extends b.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:a,layoutId:s}=this.props,{projection:i}=t;i&&(r.group&&r.group.add(i),a&&a.register&&s&&a.register(i),uf&&i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,layoutDependency:this.props.layoutDependency,onExitComplete:()=>this.safeToRemove()})),ld.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:a,drag:s,isPresent:i}=this.props,{projection:l}=a;return l&&(l.isPresent=i,t.layoutDependency!==r&&l.setOptions({...l.options,layoutDependency:r}),uf=!0,s||t.layoutDependency!==r||r===void 0||t.isPresent!==i?l.willUpdate():this.safeToRemove(),t.isPresent!==i&&(i?l.promote():l.relegate()||qt.postRender(()=>{const o=l.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),jm.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:a}=this.props,{projection:s}=t;uf=!0,s&&(s.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(s),a&&a.deregister&&a.deregister(s))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function c2(e){const[t,r]=Zk(),a=b.useContext(rm);return n.jsx(v8,{...e,layoutGroup:a,switchLayoutGroup:b.useContext(n2),isPresent:t,safeToRemove:r})}const y8={pan:{Feature:g8},drag:{Feature:p8,ProjectionNode:qk,MeasureLayout:c2}};function Yg(e,t,r){const{props:a}=e;e.animationState&&a.whileHover&&e.animationState.setActive("whileHover",r==="Start");const s="onHover"+r,i=a[s];i&&qt.postRender(()=>i(t,lc(t)))}class b8 extends As{mount(){const{current:t}=this.node;t&&(this.unmount=$M(t,(r,a)=>(Yg(this.node,a,"Start"),s=>Yg(this.node,s,"End"))))}unmount(){}}class w8 extends As{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=nc(Do(this.node.current,"focus",()=>this.onFocus()),Do(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function Xg(e,t,r){const{props:a}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&a.whileTap&&e.animationState.setActive("whileTap",r==="Start");const s="onTap"+(r==="End"?"":r),i=a[s];i&&qt.postRender(()=>i(t,lc(t)))}class k8 extends As{mount(){const{current:t}=this.node;if(!t)return;const{globalTapTarget:r,propagate:a}=this.node.props;this.unmount=qM(t,(s,i)=>(Xg(this.node,i,"Start"),(l,{success:o})=>Xg(this.node,l,o?"End":"Cancel")),{useGlobalTarget:r,stopPropagation:(a==null?void 0:a.tap)===!1})}unmount(){}}const B0=new WeakMap,ff=new WeakMap,N8=e=>{const t=B0.get(e.target);t&&t(e)},j8=e=>{e.forEach(N8)};function E8({root:e,...t}){const r=e||document;ff.has(r)||ff.set(r,{});const a=ff.get(r),s=JSON.stringify(t);return a[s]||(a[s]=new IntersectionObserver(j8,{root:e,...t})),a[s]}function S8(e,t,r){const a=E8(t);return B0.set(e,r),a.observe(e),()=>{B0.delete(e),a.unobserve(e)}}const T8={some:0,all:1};class A8 extends As{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:a,amount:s="some",once:i}=t,l={root:r?r.current:void 0,rootMargin:a,threshold:typeof s=="number"?s:T8[s]},o=c=>{const{isIntersecting:d}=c;if(this.isInView===d||(this.isInView=d,i&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:u,onViewportLeave:f}=this.node.getProps(),h=d?u:f;h&&h(c)};return S8(this.node.current,l,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(_8(t,r))&&this.startObserver()}unmount(){}}function _8({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const C8={inView:{Feature:A8},tap:{Feature:k8},focus:{Feature:w8},hover:{Feature:b8}},F8={layout:{ProjectionNode:qk,MeasureLayout:c2}},D8={...t8,...C8,...y8,...F8},hf=qP(D8,ZP),tr={dimensionMm:{min:50,max:3e3},phaseTotalWidthMm:{max:6e3},quantity:{min:1,max:1e5},maxMagnitude:1e12};function Hl(e){if(e==null)return null;if(typeof e=="number")return Number.isFinite(e)?e:null;const t=String(e).trim();if(!t)return null;const r=Number(t.replace(",","."));return Number.isFinite(r)?r:null}function R8(e){const t=Hl(e);if(t===null)return null;const r=Math.trunc(t);return Number.isFinite(r)?r:null}function Dr(e){return typeof e=="number"&&Number.isFinite(e)&&Math.abs(e)<=tr.maxMagnitude}function Ni({label:e,min:t,max:r}){return`${e} ${t}${r} mm aralnda olmal.`}function Mm(e){const t=Hl(e.lengthMm),r=Hl(e.widthMm),a=Hl(e.heightMm),s=R8(e.quantity),i=Hl(e.pricePerM2),l=!!e.isDoublePiece,o={},c=e.boxType??"standard";if(c!=="standard"&&c!=="fullFlap")return{ok:!1,message:"Geersiz koli tipi.",fieldErrors:{}};if(Dr(t)||(o.lengthMm=Ni({label:"Boy",...tr.dimensionMm})),Dr(r)||(o.widthMm=Ni({label:"En",...tr.dimensionMm})),Dr(a)||(o.heightMm=Ni({label:"Ykseklik",...tr.dimensionMm})),(!Dr(i)||i<=0)&&(o.pricePerM2="m fiyat sfrdan byk olmal."),(!Dr(s)||s<tr.quantity.min||s>tr.quantity.max)&&(o.quantity=`Adet ${tr.quantity.min}${tr.quantity.max} aralnda olmal.`),Dr(t)&&(t<tr.dimensionMm.min||t>tr.dimensionMm.max)&&(o.lengthMm=Ni({label:"Boy",...tr.dimensionMm})),Dr(r)&&(r<tr.dimensionMm.min||r>tr.dimensionMm.max)&&(o.widthMm=Ni({label:"En",...tr.dimensionMm})),Dr(a)&&(a<tr.dimensionMm.min||a>tr.dimensionMm.max)&&(o.heightMm=Ni({label:"Ykseklik",...tr.dimensionMm})),Object.keys(o).length>0)return{ok:!1,message:o.phaseTotalWidthMm||o.lengthMm||o.widthMm||o.heightMm||o.quantity||o.pricePerM2||"Geersiz giri.",fieldErrors:o};const d=l?30:0,u=typeof e.flap=="number"&&Number.isFinite(e.flap)?e.flap:30,f=2*t+2*r+u+d;return!Number.isFinite(f)||Math.abs(f)>tr.maxMagnitude?{ok:!1,message:"Geersiz safha ls.",fieldErrors:{phaseTotalWidthMm:"Geersiz safha ls."}}:f>tr.phaseTotalWidthMm.max?{ok:!1,message:`Safha toplam genilii ${tr.phaseTotalWidthMm.max} mm stne kamaz.`,fieldErrors:{phaseTotalWidthMm:`Safha toplam genilii ${tr.phaseTotalWidthMm.max} mm stne kamaz.`}}:{ok:!0,message:"",fieldErrors:{},values:{lengthMm:t,widthMm:r,heightMm:a,quantity:s,pricePerM2:i}}}function Dl(e,t){if(!Number.isFinite(e))return NaN;const r=10**t;return Math.round(e*r)/r}function Eu(e){const{lengthMm:t,widthMm:r,heightMm:a,quantity:s,pricePerM2:i,boxType:l,isDoublePiece:o,flap:c,rillMm:d}=e;if(!Dr(t)||!Dr(r)||!Dr(a)||!Dr(s)||s<tr.quantity.min||s>tr.quantity.max||!Dr(i)||i<=0||l!=="standard"&&l!=="fullFlap")return null;const u=typeof c=="number"&&Number.isFinite(c)?c:30,f=typeof d=="number"&&Number.isFinite(d)?d:4,h=o?30:0,m=t,x=r,p=t,g=r,y=u,N=a,v=l==="fullFlap"?r:r/2+f/2,S=l==="fullFlap"?r:r/2+f/2,_=m+x+p+g+y+h,F=l==="fullFlap"?v+N+S:r+a+f;if(!Dr(_)||!Dr(F)||_<=0||F<=0||_>tr.phaseTotalWidthMm.max)return null;const k=Dl(_*F/1e6,4);if(!Dr(k)||k<=0)return null;const j=Dl(k*i,2),w=Dl(k*s,4),E=Dl(w*i,2);if(!Dr(j)||!Dr(w)||!Dr(E))return null;const A=F,D=_,W=A*D/1e6;return{lengthMm:t,widthMm:r,heightMm:a,quantity:s,boxType:l,isDoublePiece:!!o,yapistirmaPayiMm:h,birimFiyat:Dl(i,2),selectedQualityName:String(e.qualityName||"").trim()||"Kalite",boy1:m,en1:x,boy2:p,en2:g,kulak:y,ustKapak:v,govde:N,altKapak:S,safihaBoy:_,safihaEn:F,safihaEnMm:A,safihaBoyMm:D,safihaAlanM2:W,birimAlanM2:k,birimHamMaliyet:j,toplamAlan:w,toplamHamMaliyet:E,calculatedEn:F,calculatedBoy:_,kulakPayi:y,chosenRil:f,enRilleri:`${v} / ${N} / ${S}`,boyRilleri:`${m} / ${x} / ${p} / ${g} / ${y}`}}function d2(e){const t=[],r={};(!e.customerName||e.customerName.trim().length===0)&&(t.push("Mteri Ad bo."),r.customerName="Mteri Ad zorunludur.");const a=Mm({lengthMm:e.lengthMm,widthMm:e.widthMm,heightMm:e.heightMm,quantity:e.quantity,pricePerM2:e.pricePerM2,boxType:e.boxType,isDoublePiece:e.isDoublePiece,flap:e.flap,rillMm:e.rillMm});return a.ok||(Object.assign(r,a.fieldErrors),a.fieldErrors.lengthMm&&t.push("Boy (mm) girilmemi veya hatal."),a.fieldErrors.widthMm&&t.push("En (mm) girilmemi veya hatal."),a.fieldErrors.heightMm&&t.push("Ykseklik (mm) girilmemi veya hatal."),a.fieldErrors.quantity&&t.push("Adet girilmemi veya hatal."),a.fieldErrors.pricePerM2&&t.push("Kat kalitesi/fiyat seilmemi."),a.fieldErrors.phaseTotalWidthMm&&t.push(a.fieldErrors.phaseTotalWidthMm),t.length===0&&a.message&&t.push(a.message)),t.length>0?{ok:!1,message:"Hesaplama yaplamad",errors:t,fieldErrors:r}:{ok:!0,message:"",errors:[],fieldErrors:{}}}function Rd({enRilleri:e,boyRilleri:t,widthMm:r,heightMm:a,flapMm:s,kulakMm:i}){if(r===void 0||a===void 0)return null;const l=u=>u?u.split("/").map(f=>f.trim()):[],o=l(e);let c=l(t),d=null;return c.length>0&&i!==void 0&&c[c.length-1]===i.toString()&&(d=c.pop()||null),n.jsxs("div",{className:"bg-white p-4 sm:p-5 rounded-xl border border-slate-200 shadow-sm mt-4 w-full",children:[n.jsxs("div",{className:"flex flex-col items-center justify-center mb-6",children:[n.jsxs("div",{className:"text-lg md:text-xl font-black text-slate-800 tracking-tight flex items-center",children:[r,n.jsx("span",{className:"text-slate-400 mx-2 font-medium",children:""}),a,n.jsx("span",{className:"text-slate-500 text-sm ml-1.5 font-bold",children:"mm"})]}),n.jsx("div",{className:"text-[10px] text-slate-400 font-bold uppercase tracking-wider mt-1",children:"Safiha boyutu"})]}),n.jsxs("div",{className:"flex flex-col gap-6 md:gap-8",children:[n.jsxs("div",{className:"flex flex-col gap-3",children:[n.jsx("span",{className:"text-[10px] text-slate-400 font-bold uppercase tracking-widest border-b border-slate-100 pb-2",children:"EN"}),o.length>0?n.jsxs("div",{className:"flex flex-col gap-3",children:[n.jsxs("div",{className:"flex items-center gap-1.5 overflow-x-auto pb-2 scrollbar-none flex-nowrap md:flex-wrap w-full",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:[o.map((u,f)=>n.jsxs("div",{className:"flex items-center shrink-0",children:[n.jsx("span",{className:"bg-slate-100 text-slate-700 font-mono text-xs font-bold px-2.5 py-1 rounded-md border border-slate-200",children:u}),f<o.length-1&&n.jsx("span",{className:"text-slate-300 font-bold mx-1 shrink-0",children:"+"})]},`en-${f}`)),n.jsx("span",{className:"text-slate-400 font-bold mx-1 shrink-0",children:"="}),n.jsxs("span",{className:"font-mono text-sm font-black text-emerald-700 shrink-0 ml-auto whitespace-nowrap",children:[r," mm"]})]}),n.jsxs("div",{className:"flex items-center gap-4 text-[11px] mt-1",children:[s!==void 0&&n.jsxs("div",{className:"flex items-center text-slate-600",children:[n.jsx("span",{className:"text-slate-400 mr-2",children:"Flap:"}),n.jsxs("span",{className:"font-mono font-bold text-slate-700",children:[s," mm"]})]}),i!==void 0&&n.jsxs("div",{className:"flex items-center text-slate-600 border-l border-slate-200 pl-4",children:[n.jsx("span",{className:"text-slate-400 mr-2",children:"Kulak:"}),n.jsxs("span",{className:"font-mono font-bold text-slate-700",children:[i," mm"]})]})]})]}):n.jsxs("div",{className:"text-sm flex items-center",children:[n.jsx("span",{className:"text-slate-400 mr-2 text-[11px] uppercase tracking-wider font-bold",children:"En:"}),n.jsxs("span",{className:"font-mono text-sm font-black text-slate-800",children:[r," mm"]})]})]}),n.jsxs("div",{className:"flex flex-col gap-3",children:[n.jsx("span",{className:"text-[10px] text-slate-400 font-bold uppercase tracking-widest border-b border-slate-100 pb-2",children:"BOY"}),c.length>0?n.jsx("div",{className:"flex flex-col gap-3",children:n.jsxs("div",{className:"flex items-center gap-1.5 overflow-x-auto pb-2 scrollbar-none flex-nowrap md:flex-wrap w-full",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:[c.map((u,f)=>n.jsxs("div",{className:"flex items-center shrink-0",children:[n.jsx("span",{className:"bg-slate-100 text-slate-700 font-mono text-xs font-bold px-2.5 py-1 rounded-md border border-slate-200",children:u}),f<c.length-1&&n.jsx("span",{className:"text-slate-300 font-bold mx-1 shrink-0",children:"+"})]},`boy-${f}`)),d&&n.jsxs("div",{className:"flex items-center shrink-0",children:[n.jsx("span",{className:"text-slate-300 font-bold mx-1 shrink-0",children:"+"}),n.jsxs("span",{className:"bg-amber-50 text-amber-700 font-mono text-xs font-bold px-2.5 py-1 rounded-md border border-amber-200/50",children:["Ek pay: +",d," mm"]})]}),n.jsx("span",{className:"text-slate-400 font-bold mx-1 shrink-0",children:"="}),n.jsxs("span",{className:"font-mono text-sm font-black text-emerald-700 shrink-0 ml-auto whitespace-nowrap",children:[a," mm"]})]})}):n.jsxs("div",{className:"text-sm flex items-center",children:[n.jsx("span",{className:"text-slate-400 mr-2 text-[11px] uppercase tracking-wider font-bold",children:"Boy:"}),n.jsxs("span",{className:"font-mono text-sm font-black text-slate-800",children:[a," mm"]})]})]})]}),n.jsx("style",{children:`
                .scrollbar-none::-webkit-scrollbar {
                    display: none;
                }
                `})]})}const ji="offer_calculations",Tn={logCalculation:async e=>{try{return(await Nh(ir(ke,ji),{...e,isDeleted:!1,createdAt:Ke()})).id}catch(t){return console.error("Error logging calculation:",t),null}},linkOfferToCalculation:async(e,t)=>{try{const r=Be(ke,ji,e);await Ut(r,{convertedToOfferId:t})}catch(r){console.error("Error linking offer to calculation:",r)}},getCalculationLogs:async(e={})=>{try{const t=ir(ke,ji),r=[];e.includeDeleted||r.push(wt("isDeleted","==",!1)),r.push(nn("createdAt","desc")),e.companyCode&&e.companyCode!=="all"&&r.push(wt("companyCode","==",e.companyCode)),e.userUid&&e.userUid!=="all"&&r.push(wt("userUid","==",e.userUid)),e.startDate&&r.push(wt("createdAt",">=",e.startDate)),e.endDate&&r.push(wt("createdAt","<=",e.endDate));const a=e.limit||100;r.push(Xc(a));let s=Ir(t,...r),i=await mr(s);if(i.empty&&!e.includeDeleted){const l=[];l.push(nn("createdAt","desc")),e.companyCode&&e.companyCode!=="all"&&l.push(wt("companyCode","==",e.companyCode)),e.userUid&&e.userUid!=="all"&&l.push(wt("userUid","==",e.userUid)),e.startDate&&l.push(wt("createdAt",">=",e.startDate)),e.endDate&&l.push(wt("createdAt","<=",e.endDate)),l.push(Xc(a));const o=Ir(t,...l);i=await mr(o)}return i.docs.map(l=>{var c;const o=l.data();return{id:l.id,...o,createdAt:(c=o.createdAt)!=null&&c.toDate?o.createdAt.toDate():new Date}}).filter(l=>e.includeDeleted?!0:l.isDeleted!==!0)}catch(t){throw console.error("Error fetching calculation logs:",t),t}},bulkSoftDeleteLogs:async(e,t)=>{if(!e.length)return;const r=450,a=[];for(let s=0;s<e.length;s+=r)a.push(e.slice(s,s+r));for(const s of a){const i=hd(ke);s.forEach(l=>{const o=Be(ke,ji,l);i.update(o,{isDeleted:!0,deletedAt:Ke(),deletedByUid:t})}),await i.commit()}},bulkHardDeleteLogs:async e=>{if(!e.length)return;const t=450,r=[];for(let a=0;a<e.length;a+=t)r.push(e.slice(a,a+t));for(const a of r){const s=hd(ke);a.forEach(i=>{const l=Be(ke,ji,i);s.delete(l)}),await s.commit()}},getOldLogs:async e=>{const t=new Date;t.setDate(t.getDate()-e);const r=Ir(ir(ke,ji),wt("createdAt","<",t),nn("createdAt","desc"),Xc(1e3));return(await mr(r)).docs.filter(s=>s.data().isDeleted!==!0).map(s=>s.id)}};var u2=["PageUp","PageDown"],f2=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],h2={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},wl="Slider",[z0,M8,P8]=iu(wl),[m2]=In(wl,[P8]),[O8,Su]=m2(wl),x2=b.forwardRef((e,t)=>{const{name:r,min:a=0,max:s=100,step:i=1,orientation:l="horizontal",disabled:o=!1,minStepsBetweenThumbs:c=0,defaultValue:d=[a],value:u,onValueChange:f=()=>{},onValueCommit:h=()=>{},inverted:m=!1,form:x,...p}=e,g=b.useRef(new Set),y=b.useRef(0),v=l==="horizontal"?I8:L8,[S=[],_]=xs({prop:u,defaultProp:d,onChange:A=>{var W;(W=[...g.current][y.current])==null||W.focus(),f(A)}}),F=b.useRef(S);function k(A){const D=H8(S,A);E(A,D)}function j(A){E(A,y.current)}function w(){const A=F.current[y.current];S[y.current]!==A&&h(S)}function E(A,D,{commit:W}={commit:!1}){const re=G8(i),U=Y8(Math.round((A-a)/i)*i+a,re),M=Nd(U,[a,s]);_((Y=[])=>{const Q=U8(Y,M,D);if(W8(Q,c*i)){y.current=Q.indexOf(M);const B=String(Q)!==String(Y);return B&&W&&h(Q),B?Q:Y}else return Y})}return n.jsx(O8,{scope:e.__scopeSlider,name:r,disabled:o,min:a,max:s,valueIndexToChangeRef:y,thumbs:g.current,values:S,orientation:l,form:x,children:n.jsx(z0.Provider,{scope:e.__scopeSlider,children:n.jsx(z0.Slot,{scope:e.__scopeSlider,children:n.jsx(v,{"aria-disabled":o,"data-disabled":o?"":void 0,...p,ref:t,onPointerDown:Je(p.onPointerDown,()=>{o||(F.current=S)}),min:a,max:s,inverted:m,onSlideStart:o?void 0:k,onSlideMove:o?void 0:j,onSlideEnd:o?void 0:w,onHomeKeyDown:()=>!o&&E(a,0,{commit:!0}),onEndKeyDown:()=>!o&&E(s,S.length-1,{commit:!0}),onStepKeyDown:({event:A,direction:D})=>{if(!o){const U=u2.includes(A.key)||A.shiftKey&&f2.includes(A.key)?10:1,M=y.current,Y=S[M],Q=i*U*D;E(Y+Q,M,{commit:!0})}}})})})})});x2.displayName=wl;var[p2,g2]=m2(wl,{startEdge:"left",endEdge:"right",size:"width",direction:1}),I8=b.forwardRef((e,t)=>{const{min:r,max:a,dir:s,inverted:i,onSlideStart:l,onSlideMove:o,onSlideEnd:c,onStepKeyDown:d,...u}=e,[f,h]=b.useState(null),m=Yt(t,v=>h(v)),x=b.useRef(void 0),p=Qo(s),g=p==="ltr",y=g&&!i||!g&&i;function N(v){const S=x.current||f.getBoundingClientRect(),_=[0,S.width],k=Pm(_,y?[r,a]:[a,r]);return x.current=S,k(v-S.left)}return n.jsx(p2,{scope:e.__scopeSlider,startEdge:y?"left":"right",endEdge:y?"right":"left",direction:y?1:-1,size:"width",children:n.jsx(v2,{dir:p,"data-orientation":"horizontal",...u,ref:m,style:{...u.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:v=>{const S=N(v.clientX);l==null||l(S)},onSlideMove:v=>{const S=N(v.clientX);o==null||o(S)},onSlideEnd:()=>{x.current=void 0,c==null||c()},onStepKeyDown:v=>{const _=h2[y?"from-left":"from-right"].includes(v.key);d==null||d({event:v,direction:_?-1:1})}})})}),L8=b.forwardRef((e,t)=>{const{min:r,max:a,inverted:s,onSlideStart:i,onSlideMove:l,onSlideEnd:o,onStepKeyDown:c,...d}=e,u=b.useRef(null),f=Yt(t,u),h=b.useRef(void 0),m=!s;function x(p){const g=h.current||u.current.getBoundingClientRect(),y=[0,g.height],v=Pm(y,m?[a,r]:[r,a]);return h.current=g,v(p-g.top)}return n.jsx(p2,{scope:e.__scopeSlider,startEdge:m?"bottom":"top",endEdge:m?"top":"bottom",size:"height",direction:m?1:-1,children:n.jsx(v2,{"data-orientation":"vertical",...d,ref:f,style:{...d.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:p=>{const g=x(p.clientY);i==null||i(g)},onSlideMove:p=>{const g=x(p.clientY);l==null||l(g)},onSlideEnd:()=>{h.current=void 0,o==null||o()},onStepKeyDown:p=>{const y=h2[m?"from-bottom":"from-top"].includes(p.key);c==null||c({event:p,direction:y?-1:1})}})})}),v2=b.forwardRef((e,t)=>{const{__scopeSlider:r,onSlideStart:a,onSlideMove:s,onSlideEnd:i,onHomeKeyDown:l,onEndKeyDown:o,onStepKeyDown:c,...d}=e,u=Su(wl,r);return n.jsx(_t.span,{...d,ref:t,onKeyDown:Je(e.onKeyDown,f=>{f.key==="Home"?(l(f),f.preventDefault()):f.key==="End"?(o(f),f.preventDefault()):u2.concat(f2).includes(f.key)&&(c(f),f.preventDefault())}),onPointerDown:Je(e.onPointerDown,f=>{const h=f.target;h.setPointerCapture(f.pointerId),f.preventDefault(),u.thumbs.has(h)?h.focus():a(f)}),onPointerMove:Je(e.onPointerMove,f=>{f.target.hasPointerCapture(f.pointerId)&&s(f)}),onPointerUp:Je(e.onPointerUp,f=>{const h=f.target;h.hasPointerCapture(f.pointerId)&&(h.releasePointerCapture(f.pointerId),i(f))})})}),y2="SliderTrack",b2=b.forwardRef((e,t)=>{const{__scopeSlider:r,...a}=e,s=Su(y2,r);return n.jsx(_t.span,{"data-disabled":s.disabled?"":void 0,"data-orientation":s.orientation,...a,ref:t})});b2.displayName=y2;var U0="SliderRange",w2=b.forwardRef((e,t)=>{const{__scopeSlider:r,...a}=e,s=Su(U0,r),i=g2(U0,r),l=b.useRef(null),o=Yt(t,l),c=s.values.length,d=s.values.map(h=>N2(h,s.min,s.max)),u=c>1?Math.min(...d):0,f=100-Math.max(...d);return n.jsx(_t.span,{"data-orientation":s.orientation,"data-disabled":s.disabled?"":void 0,...a,ref:o,style:{...e.style,[i.startEdge]:u+"%",[i.endEdge]:f+"%"}})});w2.displayName=U0;var V0="SliderThumb",k2=b.forwardRef((e,t)=>{const r=M8(e.__scopeSlider),[a,s]=b.useState(null),i=Yt(t,o=>s(o)),l=b.useMemo(()=>a?r().findIndex(o=>o.ref.current===a):-1,[r,a]);return n.jsx(B8,{...e,ref:i,index:l})}),B8=b.forwardRef((e,t)=>{const{__scopeSlider:r,index:a,name:s,...i}=e,l=Su(V0,r),o=g2(V0,r),[c,d]=b.useState(null),u=Yt(t,N=>d(N)),f=c?l.form||!!c.closest("form"):!0,h=uu(c),m=l.values[a],x=m===void 0?0:N2(m,l.min,l.max),p=V8(a,l.values.length),g=h==null?void 0:h[o.size],y=g?$8(g,x,o.direction):0;return b.useEffect(()=>{if(c)return l.thumbs.add(c),()=>{l.thumbs.delete(c)}},[c,l.thumbs]),n.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[o.startEdge]:`calc(${x}% + ${y}px)`},children:[n.jsx(z0.ItemSlot,{scope:e.__scopeSlider,children:n.jsx(_t.span,{role:"slider","aria-label":e["aria-label"]||p,"aria-valuemin":l.min,"aria-valuenow":m,"aria-valuemax":l.max,"aria-orientation":l.orientation,"data-orientation":l.orientation,"data-disabled":l.disabled?"":void 0,tabIndex:l.disabled?void 0:0,...i,ref:u,style:m===void 0?{display:"none"}:e.style,onFocus:Je(e.onFocus,()=>{l.valueIndexToChangeRef.current=a})})}),f&&n.jsx(z8,{name:s??(l.name?l.name+(l.values.length>1?"[]":""):void 0),form:l.form,value:m},a)]})});k2.displayName=V0;var z8=e=>{const{value:t,...r}=e,a=b.useRef(null),s=gu(t);return b.useEffect(()=>{const i=a.current,l=window.HTMLInputElement.prototype,c=Object.getOwnPropertyDescriptor(l,"value").set;if(s!==t&&c){const d=new Event("input",{bubbles:!0});c.call(i,t),i.dispatchEvent(d)}},[s,t]),n.jsx("input",{style:{display:"none"},...r,ref:a,defaultValue:t})};function U8(e=[],t,r){const a=[...e];return a[r]=t,a.sort((s,i)=>s-i)}function N2(e,t,r){const i=100/(r-t)*(e-t);return Nd(i,[0,100])}function V8(e,t){return t>2?`Value ${e+1} of ${t}`:t===2?["Minimum","Maximum"][e]:void 0}function H8(e,t){if(e.length===1)return 0;const r=e.map(s=>Math.abs(s-t)),a=Math.min(...r);return r.indexOf(a)}function $8(e,t,r){const a=e/2,i=Pm([0,50],[0,a]);return(a-i(t)*r)*r}function K8(e){return e.slice(0,-1).map((t,r)=>e[r+1]-t)}function W8(e,t){if(t>0){const r=K8(e);return Math.min(...r)>=t}return!0}function Pm(e,t){return r=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const a=(t[1]-t[0])/(e[1]-e[0]);return t[0]+a*(r-e[0])}}function G8(e){return(String(e).split(".")[1]||"").length}function Y8(e,t){const r=Math.pow(10,t);return Math.round(e*r)/r}var X8=x2,q8=b2,Z8=w2,J8=k2;function j2({className:e,defaultValue:t,value:r,min:a=0,max:s=100,...i}){const l=b.useMemo(()=>Array.isArray(r)?r:Array.isArray(t)?t:[a,s],[r,t,a,s]);return n.jsxs(X8,{"data-slot":"slider",defaultValue:t,value:r,min:a,max:s,className:We("relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",e),...i,children:[n.jsx(q8,{"data-slot":"slider-track",className:We("bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-4 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5"),children:n.jsx(Z8,{"data-slot":"slider-range",className:We("bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full")})}),Array.from({length:l.length},(o,c)=>n.jsx(J8,{"data-slot":"slider-thumb",className:"border-primary bg-background ring-ring/50 block size-4 shrink-0 rounded-full border shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"},c))]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Md={};Md.version="0.18.5";var E2=1252,Q8=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Om={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Im=function(e){Q8.indexOf(e)!=-1&&(E2=Om[0]=e)};function eO(){Im(1252)}var sn=function(e){Im(e)};function Lm(){sn(1200),eO()}function qg(e){for(var t=[],r=0,a=e.length;r<a;++r)t[r]=e.charCodeAt(r);return t}function tO(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function S2(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var $l=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?tO(e.slice(2)):t==254&&r==255?S2(e.slice(2)):t==65279?e.slice(1):e},Cc=function(t){return String.fromCharCode(t)},Zg=function(t){return String.fromCharCode(t)},Ro,cs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Mo(e){for(var t="",r=0,a=0,s=0,i=0,l=0,o=0,c=0,d=0;d<e.length;)r=e.charCodeAt(d++),i=r>>2,a=e.charCodeAt(d++),l=(r&3)<<4|a>>4,s=e.charCodeAt(d++),o=(a&15)<<2|s>>6,c=s&63,isNaN(a)?o=c=64:isNaN(s)&&(c=64),t+=cs.charAt(i)+cs.charAt(l)+cs.charAt(o)+cs.charAt(c);return t}function _a(e){var t="",r=0,a=0,s=0,i=0,l=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<e.length;)i=cs.indexOf(e.charAt(d++)),l=cs.indexOf(e.charAt(d++)),r=i<<2|l>>4,t+=String.fromCharCode(r),o=cs.indexOf(e.charAt(d++)),a=(l&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(a)),c=cs.indexOf(e.charAt(d++)),s=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(s));return t}var Nt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Zn=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function ws(e){return Nt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Jg(e){return Nt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Ea=function(t){return Nt?Zn(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Tu(e){if(typeof ArrayBuffer>"u")return Ea(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a!=e.length;++a)r[a]=e.charCodeAt(a)&255;return t}function _s(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function rO(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Bm(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Bm(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Or=Nt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Zn(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";a.set(new Uint8Array(e[t]),r)}return a}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function aO(e){for(var t=[],r=0,a=e.length+250,s=ws(e.length+255),i=0;i<e.length;++i){var l=e.charCodeAt(i);if(l<128)s[r++]=l;else if(l<2048)s[r++]=192|l>>6&31,s[r++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var o=e.charCodeAt(++i)&1023;s[r++]=240|l>>8&7,s[r++]=128|l>>2&63,s[r++]=128|o>>6&15|(l&3)<<4,s[r++]=128|o&63}else s[r++]=224|l>>12&15,s[r++]=128|l>>6&63,s[r++]=128|l&63;r>a&&(t.push(s.slice(0,r)),r=0,s=ws(65535),a=65530)}return t.push(s.slice(0,r)),Or(t)}var oa=/\u0000/g,Kl=/[\u0001-\u0006]/g;function Xi(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function ln(e,t){var r=""+e;return r.length>=t?r:fr("0",t-r.length)+r}function zm(e,t){var r=""+e;return r.length>=t?r:fr(" ",t-r.length)+r}function Pd(e,t){var r=""+e;return r.length>=t?r:r+fr(" ",t-r.length)}function nO(e,t){var r=""+Math.round(e);return r.length>=t?r:fr("0",t-r.length)+r}function sO(e,t){var r=""+e;return r.length>=t?r:fr("0",t-r.length)+r}var Qg=Math.pow(2,32);function Ei(e,t){if(e>Qg||e<-Qg)return nO(e,t);var r=Math.round(e);return sO(r,t)}function Od(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var ev=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],mf=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function iO(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var it={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},tv={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},lO={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Id(e,t,r){for(var a=e<0?-1:1,s=e*a,i=0,l=1,o=0,c=1,d=0,u=0,f=Math.floor(s);d<t&&(f=Math.floor(s),o=f*l+i,u=f*d+c,!(s-f<5e-8));)s=1/(s-f),i=l,l=o,c=d,d=u;if(u>t&&(d>t?(u=c,o=i):(u=d,o=l)),!r)return[0,a*o,u];var h=Math.floor(a*o/u);return[h,a*o-h*u,u]}function $s(e,t,r){if(e>2958465||e<0)return null;var a=e|0,s=Math.floor(86400*(e-a)),i=0,l=[],o={D:a,T:s,u:86400*(e-a)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(a+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++a,++o.D)),a===60)l=r?[1317,10,29]:[1900,2,29],i=3;else if(a===0)l=r?[1317,8,29]:[1900,1,0],i=6;else{a>60&&--a;var c=new Date(1900,0,1);c.setDate(c.getDate()+a-1),l=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),a<60&&(i=(i+6)%7),r&&(i=hO(c,l))}return o.y=l[0],o.m=l[1],o.d=l[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=i,o}var T2=new Date(1899,11,31,0,0,0),oO=T2.getTime(),cO=new Date(1900,2,1,0,0,0);function A2(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=cO&&(r+=1440*60*1e3),(r-(oO+(e.getTimezoneOffset()-T2.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Um(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function dO(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function uO(e){var t=e<0?12:11,r=Um(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function fO(e){var t=Um(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Po(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=uO(e):t===10?r=e.toFixed(10).substr(0,12):r=fO(e),Um(dO(r.toUpperCase()))}function si(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Po(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Ya(14,A2(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function hO(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function mO(e,t,r,a){var s="",i=0,l=0,o=r.y,c,d=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,d=2;break;default:c=o%1e4,d=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,d=t.length;break;case 3:return mf[r.m-1][1];case 5:return mf[r.m-1][0];default:return mf[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,d=t.length;break;case 3:return ev[r.q][0];default:return ev[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?ln(r.S,t.length):(a>=2?l=a===3?1e3:100:l=a===1?10:1,i=Math.round(l*(r.S+r.u)),i>=60*l&&(i=0),t==="s"?i===0?"0":""+i/l:(s=ln(i,2+a),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}d=t.length===3?1:2;break;case 101:c=o,d=1;break}var u=d>0?ln(c,d):"";return u}function ds(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,a=e.substr(0,r);r!=e.length;r+=t)a+=(a.length>0?",":"")+e.substr(r,t);return a}var _2=/%/g;function xO(e,t,r){var a=t.replace(_2,""),s=t.length-a.length;return $n(e,a,r*Math.pow(10,2*s))+fr("%",s)}function pO(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return $n(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function C2(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+C2(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(t/Math.pow(10,i)).toPrecision(a+1+(s+i)%s),r.indexOf("e")===-1){var l=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+i):r+="E+"+(l-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,d,u){return c+d+u.substr(0,(s+i)%s)+"."+u.substr(i)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var F2=/# (\?+)( ?)\/( ?)(\d+)/;function gO(e,t,r){var a=parseInt(e[4],10),s=Math.round(t*a),i=Math.floor(s/a),l=s-i*a,o=a;return r+(i===0?"":""+i)+" "+(l===0?fr(" ",e[1].length+1+e[4].length):zm(l,e[1].length)+e[2]+"/"+e[3]+ln(o,e[4].length))}function vO(e,t,r){return r+(t===0?"":""+t)+fr(" ",e[1].length+2+e[4].length)}var D2=/^#*0*\.([0#]+)/,R2=/\).*[0#]/,M2=/\(###\) ###\\?-####/;function aa(e){for(var t="",r,a=0;a!=e.length;++a)switch(r=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function rv(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function av(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function yO(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function bO(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Ma(e,t,r){if(e.charCodeAt(0)===40&&!t.match(R2)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ma("n",a,r):"("+Ma("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return pO(e,t,r);if(t.indexOf("%")!==-1)return xO(e,t,r);if(t.indexOf("E")!==-1)return C2(t,r);if(t.charCodeAt(0)===36)return"$"+Ma(e,t.substr(t.charAt(1)==" "?2:1),r);var s,i,l,o,c=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+Ei(c,t.length);if(t.match(/^[#?]+$/))return s=Ei(r,0),s==="0"&&(s=""),s.length>t.length?s:aa(t.substr(0,t.length-s.length))+s;if(i=t.match(F2))return gO(i,c,d);if(t.match(/^#+0+$/))return d+Ei(c,t.length-t.indexOf("0"));if(i=t.match(D2))return s=rv(r,i[1].length).replace(/^([^\.]+)$/,"$1."+aa(i[1])).replace(/\.$/,"."+aa(i[1])).replace(/\.(\d*)$/,function(x,p){return"."+p+fr("0",aa(i[1]).length-p.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+rv(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+ds(Ei(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ma(e,t,-r):ds(""+(Math.floor(r)+yO(r,i[1].length)))+"."+ln(av(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return Ma(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Xi(Ma(e,t.replace(/[\\-]/g,""),r)),l=0,Xi(Xi(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return l<s.length?s.charAt(l++):x==="0"?"0":""}));if(t.match(M2))return s=Ma(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),o=Id(c,Math.pow(10,l)-1,!1),s=""+d,u=$n("n",i[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+i[2]+"/"+i[3],u=Pd(o[2],l),u.length<i[4].length&&(u=aa(i[4].substr(i[4].length-u.length))+u),s+=u,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),o=Id(c,Math.pow(10,l)-1,!0),d+(o[0]||(o[1]?"":"0"))+" "+(o[1]?zm(o[1],l)+i[2]+"/"+i[3]+Pd(o[2],l):fr(" ",2*l+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=Ei(r,0),t.length<=s.length?s:aa(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=s.indexOf(".");var f=t.indexOf(".")-l,h=t.length-s.length-f;return aa(t.substr(0,f)+s+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return l=av(r,i[1].length),r<0?"-"+Ma(e,t,-r):ds(bO(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?ln(0,3-x.length):"")+x})+"."+ln(l,i[1].length);switch(t){case"###,##0.00":return Ma(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=ds(Ei(c,0));return m!=="0"?d+m:"";case"###,###.00":return Ma(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Ma(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function wO(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return $n(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function kO(e,t,r){var a=t.replace(_2,""),s=t.length-a.length;return $n(e,a,r*Math.pow(10,2*s))+fr("%",s)}function P2(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+P2(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(t/Math.pow(10,i)).toPrecision(a+1+(s+i)%s),!r.match(/[Ee]/)){var l=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+i):r+="E+"+(l-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,d,u){return c+d+u.substr(0,(s+i)%s)+"."+u.substr(i)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function jn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(R2)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?jn("n",a,r):"("+jn("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return wO(e,t,r);if(t.indexOf("%")!==-1)return kO(e,t,r);if(t.indexOf("E")!==-1)return P2(t,r);if(t.charCodeAt(0)===36)return"$"+jn(e,t.substr(t.charAt(1)==" "?2:1),r);var s,i,l,o,c=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+ln(c,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:aa(t.substr(0,t.length-s.length))+s;if(i=t.match(F2))return vO(i,c,d);if(t.match(/^#+0+$/))return d+ln(c,t.length-t.indexOf("0"));if(i=t.match(D2))return s=(""+r).replace(/^([^\.]+)$/,"$1."+aa(i[1])).replace(/\.$/,"."+aa(i[1])),s=s.replace(/\.(\d*)$/,function(x,p){return"."+p+fr("0",aa(i[1]).length-p.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+ds(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+jn(e,t,-r):ds(""+r)+"."+fr("0",i[1].length);if(i=t.match(/^#,#*,#0/))return jn(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Xi(jn(e,t.replace(/[\\-]/g,""),r)),l=0,Xi(Xi(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return l<s.length?s.charAt(l++):x==="0"?"0":""}));if(t.match(M2))return s=jn(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),o=Id(c,Math.pow(10,l)-1,!1),s=""+d,u=$n("n",i[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+i[2]+"/"+i[3],u=Pd(o[2],l),u.length<i[4].length&&(u=aa(i[4].substr(i[4].length-u.length))+u),s+=u,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),o=Id(c,Math.pow(10,l)-1,!0),d+(o[0]||(o[1]?"":"0"))+" "+(o[1]?zm(o[1],l)+i[2]+"/"+i[3]+Pd(o[2],l):fr(" ",2*l+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:aa(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=s.indexOf(".");var f=t.indexOf(".")-l,h=t.length-s.length-f;return aa(t.substr(0,f)+s+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+jn(e,t,-r):ds(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?ln(0,3-x.length):"")+x})+"."+ln(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var m=ds(""+c);return m!=="0"?d+m:"";default:if(t.match(/\.[0#?]*$/))return jn(e,t.slice(0,t.lastIndexOf(".")),r)+aa(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function $n(e,t,r){return(r|0)===r?jn(e,t,r):Ma(e,t,r)}function NO(e){for(var t=[],r=!1,a=0,s=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(s,a-s),s=a+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var O2=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function kl(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":Od(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(a=r;e.charAt(t++)!=="]"&&t<e.length;)a+=e.charAt(t);if(a.match(O2))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function jO(e,t,r,a){for(var s=[],i="",l=0,o="",c="t",d,u,f,h="H";l<e.length;)switch(o=e.charAt(l)){case"G":if(!Od(e,l))throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"G",v:"General"},l+=7;break;case'"':for(i="";(f=e.charCodeAt(++l))!==34&&l<e.length;)i+=String.fromCharCode(f);s[s.length]={t:"t",v:i},++l;break;case"\\":var m=e.charAt(++l),x=m==="("||m===")"?m:"t";s[s.length]={t:x,v:m},++l;break;case"_":s[s.length]={t:"t",v:" "},l+=2;break;case"@":s[s.length]={t:"T",v:t},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(d==null&&(d=$s(t,r,e.charAt(l+1)==="2"),d==null))return"";s[s.length]={t:"X",v:e.substr(l,2)},c=o,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||d==null&&(d=$s(t,r),d==null))return"";for(i=o;++l<e.length&&e.charAt(l).toLowerCase()===o;)i+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),s[s.length]={t:o,v:i},c=o;break;case"A":case"a":case"":var p={t:o,v:o};if(d==null&&(d=$s(t,r)),e.substr(l,3).toUpperCase()==="A/P"?(d!=null&&(p.v=d.H>=12?"P":"A"),p.t="T",h="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(d!=null&&(p.v=d.H>=12?"PM":"AM"),p.t="T",l+=5,h="h"):e.substr(l,5).toUpperCase()==="/"?(d!=null&&(p.v=d.H>=12?"":""),p.t="T",l+=5,h="h"):(p.t="t",++l),d==null&&p.t==="T")return"";s[s.length]=p,c=o;break;case"[":for(i=o;e.charAt(l++)!=="]"&&l<e.length;)i+=e.charAt(l);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(O2)){if(d==null&&(d=$s(t,r),d==null))return"";s[s.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",kl(e)||(s[s.length]={t:"t",v:i}));break;case".":if(d!=null){for(i=o;++l<e.length&&(o=e.charAt(l))==="0";)i+=o;s[s.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++l<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(l))>-1;)i+=o;s[s.length]={t:"n",v:i};break;case"?":for(i=o;e.charAt(++l)===o;)i+=o;s[s.length]={t:o,v:i},c=o;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":s[s.length]={t:a===1?"t":o,v:o},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)i+=e.charAt(l);s[s.length]={t:"D",v:i};break;case" ":s[s.length]={t:o,v:o},++l;break;case"$":s[s.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"t",v:o},++l;break}var g=0,y=0,N;for(l=s.length-1,c="t";l>=0;--l)switch(s[l].t){case"h":case"H":s[l].t=h,c="h",g<1&&(g=1);break;case"s":(N=s[l].v.match(/\.0+$/))&&(y=Math.max(y,N[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":c=s[l].t;break;case"m":c==="s"&&(s[l].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&s[l].v.match(/[Hh]/)&&(g=1),g<2&&s[l].v.match(/[Mm]/)&&(g=2),g<3&&s[l].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var v="",S;for(l=0;l<s.length;++l)switch(s[l].t){case"t":case"T":case" ":case"D":break;case"X":s[l].v="",s[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[l].v=mO(s[l].t.charCodeAt(0),s[l].v,d,y),s[l].t="t";break;case"n":case"?":for(S=l+1;s[S]!=null&&((o=s[S].t)==="?"||o==="D"||(o===" "||o==="t")&&s[S+1]!=null&&(s[S+1].t==="?"||s[S+1].t==="t"&&s[S+1].v==="/")||s[l].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[S].v==="/"||s[S].v===" "&&s[S+1]!=null&&s[S+1].t=="?"));)s[l].v+=s[S].v,s[S]={v:"",t:";"},++S;v+=s[l].v,l=S-1;break;case"G":s[l].t="t",s[l].v=si(t,r);break}var _="",F,k;if(v.length>0){v.charCodeAt(0)==40?(F=t<0&&v.charCodeAt(0)===45?-t:t,k=$n("n",v,F)):(F=t<0&&a>1?-t:t,k=$n("n",v,F),F<0&&s[0]&&s[0].t=="t"&&(k=k.substr(1),s[0].v="-"+s[0].v)),S=k.length-1;var j=s.length;for(l=0;l<s.length;++l)if(s[l]!=null&&s[l].t!="t"&&s[l].v.indexOf(".")>-1){j=l;break}var w=s.length;if(j===s.length&&k.indexOf("E")===-1){for(l=s.length-1;l>=0;--l)s[l]==null||"n?".indexOf(s[l].t)===-1||(S>=s[l].v.length-1?(S-=s[l].v.length,s[l].v=k.substr(S+1,s[l].v.length)):S<0?s[l].v="":(s[l].v=k.substr(0,S+1),S=-1),s[l].t="t",w=l);S>=0&&w<s.length&&(s[w].v=k.substr(0,S+1)+s[w].v)}else if(j!==s.length&&k.indexOf("E")===-1){for(S=k.indexOf(".")-1,l=j;l>=0;--l)if(!(s[l]==null||"n?".indexOf(s[l].t)===-1)){for(u=s[l].v.indexOf(".")>-1&&l===j?s[l].v.indexOf(".")-1:s[l].v.length-1,_=s[l].v.substr(u+1);u>=0;--u)S>=0&&(s[l].v.charAt(u)==="0"||s[l].v.charAt(u)==="#")&&(_=k.charAt(S--)+_);s[l].v=_,s[l].t="t",w=l}for(S>=0&&w<s.length&&(s[w].v=k.substr(0,S+1)+s[w].v),S=k.indexOf(".")+1,l=j;l<s.length;++l)if(!(s[l]==null||"n?(".indexOf(s[l].t)===-1&&l!==j)){for(u=s[l].v.indexOf(".")>-1&&l===j?s[l].v.indexOf(".")+1:0,_=s[l].v.substr(0,u);u<s[l].v.length;++u)S<k.length&&(_+=k.charAt(S++));s[l].v=_,s[l].t="t",w=l}}}for(l=0;l<s.length;++l)s[l]!=null&&"n?".indexOf(s[l].t)>-1&&(F=a>1&&t<0&&l>0&&s[l-1].v==="-"?-t:t,s[l].v=$n(s[l].t,s[l].v,F),s[l].t="t");var E="";for(l=0;l!==s.length;++l)s[l]!=null&&(E+=s[l].v);return E}var nv=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function sv(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function EO(e,t){var r=NO(e),a=r.length,s=r[a-1].indexOf("@");if(a<4&&s>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var l=r[0].match(nv),o=r[1].match(nv);return sv(t,l)?[a,r[0]]:sv(t,o)?[a,r[1]]:[a,r[l!=null&&o!=null?2:1]]}return[a,i]}function Ya(e,t,r){r==null&&(r={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?a=r.dateNF:a=e;break;case"number":e==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:it)[e],a==null&&(a=r.table&&r.table[tv[e]]||it[tv[e]]),a==null&&(a=lO[e]||"General");break}if(Od(a,0))return si(t,r);t instanceof Date&&(t=A2(t,r.date1904));var s=EO(a,t);if(Od(s[1]))return si(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return jO(s[1],t,r,s[0])}function Kn(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(it[r]==null){t<0&&(t=r);continue}if(it[r]==e){t=r;break}}t<0&&(t=391)}return it[t]=e,t}function Au(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Kn(e[t],t)}function Nl(){it=iO()}var SO={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},I2=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function TO(e){var t=typeof e=="number"?it[e]:e;return t=t.replace(I2,"(\\d+)"),new RegExp("^"+t+"$")}function AO(e,t,r){var a=-1,s=-1,i=-1,l=-1,o=-1,c=-1;(t.match(I2)||[]).forEach(function(f,h){var m=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":a=m;break;case"d":i=m;break;case"h":l=m;break;case"s":c=m;break;case"m":l>=0?o=m:s=m;break}}),c>=0&&o==-1&&s>=0&&(o=s,s=-1);var d=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var u=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return l==-1&&o==-1&&c==-1?d:a==-1&&s==-1&&i==-1?u:d+"T"+u}var _O=(function(){var e={};e.version="1.2.0";function t(){for(var k=0,j=new Array(256),w=0;w!=256;++w)k=w,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,j[w]=k;return typeof Int32Array<"u"?new Int32Array(j):j}var r=t();function a(k){var j=0,w=0,E=0,A=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(E=0;E!=256;++E)A[E]=k[E];for(E=0;E!=256;++E)for(w=k[E],j=256+E;j<4096;j+=256)w=A[j]=w>>>8^k[w&255];var D=[];for(E=1;E!=16;++E)D[E-1]=typeof Int32Array<"u"?A.subarray(E*256,E*256+256):A.slice(E*256,E*256+256);return D}var s=a(r),i=s[0],l=s[1],o=s[2],c=s[3],d=s[4],u=s[5],f=s[6],h=s[7],m=s[8],x=s[9],p=s[10],g=s[11],y=s[12],N=s[13],v=s[14];function S(k,j){for(var w=j^-1,E=0,A=k.length;E<A;)w=w>>>8^r[(w^k.charCodeAt(E++))&255];return~w}function _(k,j){for(var w=j^-1,E=k.length-15,A=0;A<E;)w=v[k[A++]^w&255]^N[k[A++]^w>>8&255]^y[k[A++]^w>>16&255]^g[k[A++]^w>>>24]^p[k[A++]]^x[k[A++]]^m[k[A++]]^h[k[A++]]^f[k[A++]]^u[k[A++]]^d[k[A++]]^c[k[A++]]^o[k[A++]]^l[k[A++]]^i[k[A++]]^r[k[A++]];for(E+=15;A<E;)w=w>>>8^r[(w^k[A++])&255];return~w}function F(k,j){for(var w=j^-1,E=0,A=k.length,D=0,W=0;E<A;)D=k.charCodeAt(E++),D<128?w=w>>>8^r[(w^D)&255]:D<2048?(w=w>>>8^r[(w^(192|D>>6&31))&255],w=w>>>8^r[(w^(128|D&63))&255]):D>=55296&&D<57344?(D=(D&1023)+64,W=k.charCodeAt(E++)&1023,w=w>>>8^r[(w^(240|D>>8&7))&255],w=w>>>8^r[(w^(128|D>>2&63))&255],w=w>>>8^r[(w^(128|W>>6&15|(D&3)<<4))&255],w=w>>>8^r[(w^(128|W&63))&255]):(w=w>>>8^r[(w^(224|D>>12&15))&255],w=w>>>8^r[(w^(128|D>>6&63))&255],w=w>>>8^r[(w^(128|D&63))&255]);return~w}return e.table=r,e.bstr=S,e.buf=_,e.str=F,e})(),rt=(function(){var t={};t.version="1.2.1";function r(C,K){for(var O=C.split("/"),I=K.split("/"),H=0,q=0,le=Math.min(O.length,I.length);H<le;++H){if(q=O[H].length-I[H].length)return q;if(O[H]!=I[H])return O[H]<I[H]?-1:1}return O.length-I.length}function a(C){if(C.charAt(C.length-1)=="/")return C.slice(0,-1).indexOf("/")===-1?C:a(C.slice(0,-1));var K=C.lastIndexOf("/");return K===-1?C:C.slice(0,K+1)}function s(C){if(C.charAt(C.length-1)=="/")return s(C.slice(0,-1));var K=C.lastIndexOf("/");return K===-1?C:C.slice(K+1)}function i(C,K){typeof K=="string"&&(K=new Date(K));var O=K.getHours();O=O<<6|K.getMinutes(),O=O<<5|K.getSeconds()>>>1,C.write_shift(2,O);var I=K.getFullYear()-1980;I=I<<4|K.getMonth()+1,I=I<<5|K.getDate(),C.write_shift(2,I)}function l(C){var K=C.read_shift(2)&65535,O=C.read_shift(2)&65535,I=new Date,H=O&31;O>>>=5;var q=O&15;O>>>=4,I.setMilliseconds(0),I.setFullYear(O+1980),I.setMonth(q-1),I.setDate(H);var le=K&31;K>>>=5;var ce=K&63;return K>>>=6,I.setHours(K),I.setMinutes(ce),I.setSeconds(le<<1),I}function o(C){Ur(C,0);for(var K={},O=0;C.l<=C.length-4;){var I=C.read_shift(2),H=C.read_shift(2),q=C.l+H,le={};switch(I){case 21589:O=C.read_shift(1),O&1&&(le.mtime=C.read_shift(4)),H>5&&(O&2&&(le.atime=C.read_shift(4)),O&4&&(le.ctime=C.read_shift(4))),le.mtime&&(le.mt=new Date(le.mtime*1e3));break}C.l=q,K[I]=le}return K}var c;function d(){return c||(c={})}function u(C,K){if(C[0]==80&&C[1]==75)return gt(C,K);if((C[0]|32)==109&&(C[1]|32)==105)return xt(C,K);if(C.length<512)throw new Error("CFB file size "+C.length+" < 512");var O=3,I=512,H=0,q=0,le=0,ce=0,ie=0,oe=[],fe=C.slice(0,512);Ur(fe,0);var be=f(fe);switch(O=be[0],O){case 3:I=512;break;case 4:I=4096;break;case 0:if(be[1]==0)return gt(C,K);default:throw new Error("Major Version: Expected 3 or 4 saw "+O)}I!==512&&(fe=C.slice(0,I),Ur(fe,28));var Se=C.slice(0,I);h(fe,O);var je=fe.read_shift(4,"i");if(O===3&&je!==0)throw new Error("# Directory Sectors: Expected 0 saw "+je);fe.l+=4,le=fe.read_shift(4,"i"),fe.l+=4,fe.chk("00100000","Mini Stream Cutoff Size: "),ce=fe.read_shift(4,"i"),H=fe.read_shift(4,"i"),ie=fe.read_shift(4,"i"),q=fe.read_shift(4,"i");for(var Te=-1,Le=0;Le<109&&(Te=fe.read_shift(4,"i"),!(Te<0));++Le)oe[Le]=Te;var ot=m(C,I);g(ie,q,ot,I,oe);var Lt=N(ot,le,oe,I);Lt[le].name="!Directory",H>0&&ce!==W&&(Lt[ce].name="!MiniFAT"),Lt[oe[0]].name="!FAT",Lt.fat_addrs=oe,Lt.ssz=I;var Mt={},kr=[],Za=[],va=[];v(le,Lt,ot,kr,H,Mt,Za,ce),x(Za,va,kr),kr.shift();var bn={FileIndex:Za,FullPaths:va};return K&&K.raw&&(bn.raw={header:Se,sectors:ot}),bn}function f(C){if(C[C.l]==80&&C[C.l+1]==75)return[0,0];C.chk(re,"Header Signature: "),C.l+=16;var K=C.read_shift(2,"u");return[C.read_shift(2,"u"),K]}function h(C,K){var O=9;switch(C.l+=2,O=C.read_shift(2)){case 9:if(K!=3)throw new Error("Sector Shift: Expected 9 saw "+O);break;case 12:if(K!=4)throw new Error("Sector Shift: Expected 12 saw "+O);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+O)}C.chk("0600","Mini Sector Shift: "),C.chk("000000000000","Reserved: ")}function m(C,K){for(var O=Math.ceil(C.length/K)-1,I=[],H=1;H<O;++H)I[H-1]=C.slice(H*K,(H+1)*K);return I[O-1]=C.slice(O*K),I}function x(C,K,O){for(var I=0,H=0,q=0,le=0,ce=0,ie=O.length,oe=[],fe=[];I<ie;++I)oe[I]=fe[I]=I,K[I]=O[I];for(;ce<fe.length;++ce)I=fe[ce],H=C[I].L,q=C[I].R,le=C[I].C,oe[I]===I&&(H!==-1&&oe[H]!==H&&(oe[I]=oe[H]),q!==-1&&oe[q]!==q&&(oe[I]=oe[q])),le!==-1&&(oe[le]=I),H!==-1&&I!=oe[I]&&(oe[H]=oe[I],fe.lastIndexOf(H)<ce&&fe.push(H)),q!==-1&&I!=oe[I]&&(oe[q]=oe[I],fe.lastIndexOf(q)<ce&&fe.push(q));for(I=1;I<ie;++I)oe[I]===I&&(q!==-1&&oe[q]!==q?oe[I]=oe[q]:H!==-1&&oe[H]!==H&&(oe[I]=oe[H]));for(I=1;I<ie;++I)if(C[I].type!==0){if(ce=I,ce!=oe[ce])do ce=oe[ce],K[I]=K[ce]+"/"+K[I];while(ce!==0&&oe[ce]!==-1&&ce!=oe[ce]);oe[I]=-1}for(K[0]+="/",I=1;I<ie;++I)C[I].type!==2&&(K[I]+="/")}function p(C,K,O){for(var I=C.start,H=C.size,q=[],le=I;O&&H>0&&le>=0;)q.push(K.slice(le*D,le*D+D)),H-=D,le=Bs(O,le*4);return q.length===0?pe(0):Or(q).slice(0,C.size)}function g(C,K,O,I,H){var q=W;if(C===W){if(K!==0)throw new Error("DIFAT chain shorter than expected")}else if(C!==-1){var le=O[C],ce=(I>>>2)-1;if(!le)return;for(var ie=0;ie<ce&&(q=Bs(le,ie*4))!==W;++ie)H.push(q);g(Bs(le,I-4),K-1,O,I,H)}}function y(C,K,O,I,H){var q=[],le=[];H||(H=[]);var ce=I-1,ie=0,oe=0;for(ie=K;ie>=0;){H[ie]=!0,q[q.length]=ie,le.push(C[ie]);var fe=O[Math.floor(ie*4/I)];if(oe=ie*4&ce,I<4+oe)throw new Error("FAT boundary crossed: "+ie+" 4 "+I);if(!C[fe])break;ie=Bs(C[fe],oe)}return{nodes:q,data:gv([le])}}function N(C,K,O,I){var H=C.length,q=[],le=[],ce=[],ie=[],oe=I-1,fe=0,be=0,Se=0,je=0;for(fe=0;fe<H;++fe)if(ce=[],Se=fe+K,Se>=H&&(Se-=H),!le[Se]){ie=[];var Te=[];for(be=Se;be>=0;){Te[be]=!0,le[be]=!0,ce[ce.length]=be,ie.push(C[be]);var Le=O[Math.floor(be*4/I)];if(je=be*4&oe,I<4+je)throw new Error("FAT boundary crossed: "+be+" 4 "+I);if(!C[Le]||(be=Bs(C[Le],je),Te[be]))break}q[Se]={nodes:ce,data:gv([ie])}}return q}function v(C,K,O,I,H,q,le,ce){for(var ie=0,oe=I.length?2:0,fe=K[C].data,be=0,Se=0,je;be<fe.length;be+=128){var Te=fe.slice(be,be+128);Ur(Te,64),Se=Te.read_shift(2),je=Ym(Te,0,Se-oe),I.push(je);var Le={name:je,type:Te.read_shift(1),color:Te.read_shift(1),L:Te.read_shift(4,"i"),R:Te.read_shift(4,"i"),C:Te.read_shift(4,"i"),clsid:Te.read_shift(16),state:Te.read_shift(4,"i"),start:0,size:0},ot=Te.read_shift(2)+Te.read_shift(2)+Te.read_shift(2)+Te.read_shift(2);ot!==0&&(Le.ct=S(Te,Te.l-8));var Lt=Te.read_shift(2)+Te.read_shift(2)+Te.read_shift(2)+Te.read_shift(2);Lt!==0&&(Le.mt=S(Te,Te.l-8)),Le.start=Te.read_shift(4,"i"),Le.size=Te.read_shift(4,"i"),Le.size<0&&Le.start<0&&(Le.size=Le.type=0,Le.start=W,Le.name=""),Le.type===5?(ie=Le.start,H>0&&ie!==W&&(K[ie].name="!StreamData")):Le.size>=4096?(Le.storage="fat",K[Le.start]===void 0&&(K[Le.start]=y(O,Le.start,K.fat_addrs,K.ssz)),K[Le.start].name=Le.name,Le.content=K[Le.start].data.slice(0,Le.size)):(Le.storage="minifat",Le.size<0?Le.size=0:ie!==W&&Le.start!==W&&K[ie]&&(Le.content=p(Le,K[ie].data,(K[ce]||{}).data))),Le.content&&Ur(Le.content,0),q[je]=Le,le.push(Le)}}function S(C,K){return new Date((ja(C,K+4)/1e7*Math.pow(2,32)+ja(C,K)/1e7-11644473600)*1e3)}function _(C,K){return d(),u(c.readFileSync(C),K)}function F(C,K){var O=K&&K.type;switch(O||Nt&&Buffer.isBuffer(C)&&(O="buffer"),O||"base64"){case"file":return _(C,K);case"base64":return u(Ea(_a(C)),K);case"binary":return u(Ea(C),K)}return u(C,K)}function k(C,K){var O=K||{},I=O.root||"Root Entry";if(C.FullPaths||(C.FullPaths=[]),C.FileIndex||(C.FileIndex=[]),C.FullPaths.length!==C.FileIndex.length)throw new Error("inconsistent CFB structure");C.FullPaths.length===0&&(C.FullPaths[0]=I+"/",C.FileIndex[0]={name:I,type:5}),O.CLSID&&(C.FileIndex[0].clsid=O.CLSID),j(C)}function j(C){var K="Sh33tJ5";if(!rt.find(C,"/"+K)){var O=pe(4);O[0]=55,O[1]=O[3]=50,O[2]=54,C.FileIndex.push({name:K,type:2,content:O,size:4,L:69,R:69,C:69}),C.FullPaths.push(C.FullPaths[0]+K),w(C)}}function w(C,K){k(C);for(var O=!1,I=!1,H=C.FullPaths.length-1;H>=0;--H){var q=C.FileIndex[H];switch(q.type){case 0:I?O=!0:(C.FileIndex.pop(),C.FullPaths.pop());break;case 1:case 2:case 5:I=!0,isNaN(q.R*q.L*q.C)&&(O=!0),q.R>-1&&q.L>-1&&q.R==q.L&&(O=!0);break;default:O=!0;break}}if(!(!O&&!K)){var le=new Date(1987,1,19),ce=0,ie=Object.create?Object.create(null):{},oe=[];for(H=0;H<C.FullPaths.length;++H)ie[C.FullPaths[H]]=!0,C.FileIndex[H].type!==0&&oe.push([C.FullPaths[H],C.FileIndex[H]]);for(H=0;H<oe.length;++H){var fe=a(oe[H][0]);I=ie[fe],I||(oe.push([fe,{name:s(fe).replace("/",""),type:1,clsid:M,ct:le,mt:le,content:null}]),ie[fe]=!0)}for(oe.sort(function(je,Te){return r(je[0],Te[0])}),C.FullPaths=[],C.FileIndex=[],H=0;H<oe.length;++H)C.FullPaths[H]=oe[H][0],C.FileIndex[H]=oe[H][1];for(H=0;H<oe.length;++H){var be=C.FileIndex[H],Se=C.FullPaths[H];if(be.name=s(Se).replace("/",""),be.L=be.R=be.C=-(be.color=1),be.size=be.content?be.content.length:0,be.start=0,be.clsid=be.clsid||M,H===0)be.C=oe.length>1?1:-1,be.size=0,be.type=5;else if(Se.slice(-1)=="/"){for(ce=H+1;ce<oe.length&&a(C.FullPaths[ce])!=Se;++ce);for(be.C=ce>=oe.length?-1:ce,ce=H+1;ce<oe.length&&a(C.FullPaths[ce])!=a(Se);++ce);be.R=ce>=oe.length?-1:ce,be.type=1}else a(C.FullPaths[H+1]||"")==a(Se)&&(be.R=H+1),be.type=2}}}function E(C,K){var O=K||{};if(O.fileType=="mad")return nt(C,O);switch(w(C),O.fileType){case"zip":return mt(C,O)}var I=(function(je){for(var Te=0,Le=0,ot=0;ot<je.FileIndex.length;++ot){var Lt=je.FileIndex[ot];if(Lt.content){var Mt=Lt.content.length;Mt>0&&(Mt<4096?Te+=Mt+63>>6:Le+=Mt+511>>9)}}for(var kr=je.FullPaths.length+3>>2,Za=Te+7>>3,va=Te+127>>7,bn=Za+Le+kr+va,Da=bn+127>>7,Tt=Da<=109?0:Math.ceil((Da-109)/127);bn+Da+Tt+127>>7>Da;)Tt=++Da<=109?0:Math.ceil((Da-109)/127);var Xt=[1,Tt,Da,va,kr,Le,Te,0];return je.FileIndex[0].size=Te<<6,Xt[7]=(je.FileIndex[0].start=Xt[0]+Xt[1]+Xt[2]+Xt[3]+Xt[4]+Xt[5])+(Xt[6]+7>>3),Xt})(C),H=pe(I[7]<<9),q=0,le=0;{for(q=0;q<8;++q)H.write_shift(1,U[q]);for(q=0;q<8;++q)H.write_shift(2,0);for(H.write_shift(2,62),H.write_shift(2,3),H.write_shift(2,65534),H.write_shift(2,9),H.write_shift(2,6),q=0;q<3;++q)H.write_shift(2,0);for(H.write_shift(4,0),H.write_shift(4,I[2]),H.write_shift(4,I[0]+I[1]+I[2]+I[3]-1),H.write_shift(4,0),H.write_shift(4,4096),H.write_shift(4,I[3]?I[0]+I[1]+I[2]-1:W),H.write_shift(4,I[3]),H.write_shift(-4,I[1]?I[0]-1:W),H.write_shift(4,I[1]),q=0;q<109;++q)H.write_shift(-4,q<I[2]?I[1]+q:-1)}if(I[1])for(le=0;le<I[1];++le){for(;q<236+le*127;++q)H.write_shift(-4,q<I[2]?I[1]+q:-1);H.write_shift(-4,le===I[1]-1?W:le+1)}var ce=function(je){for(le+=je;q<le-1;++q)H.write_shift(-4,q+1);je&&(++q,H.write_shift(-4,W))};for(le=q=0,le+=I[1];q<le;++q)H.write_shift(-4,Y.DIFSECT);for(le+=I[2];q<le;++q)H.write_shift(-4,Y.FATSECT);ce(I[3]),ce(I[4]);for(var ie=0,oe=0,fe=C.FileIndex[0];ie<C.FileIndex.length;++ie)fe=C.FileIndex[ie],fe.content&&(oe=fe.content.length,!(oe<4096)&&(fe.start=le,ce(oe+511>>9)));for(ce(I[6]+7>>3);H.l&511;)H.write_shift(-4,Y.ENDOFCHAIN);for(le=q=0,ie=0;ie<C.FileIndex.length;++ie)fe=C.FileIndex[ie],fe.content&&(oe=fe.content.length,!(!oe||oe>=4096)&&(fe.start=le,ce(oe+63>>6)));for(;H.l&511;)H.write_shift(-4,Y.ENDOFCHAIN);for(q=0;q<I[4]<<2;++q){var be=C.FullPaths[q];if(!be||be.length===0){for(ie=0;ie<17;++ie)H.write_shift(4,0);for(ie=0;ie<3;++ie)H.write_shift(4,-1);for(ie=0;ie<12;++ie)H.write_shift(4,0);continue}fe=C.FileIndex[q],q===0&&(fe.start=fe.size?fe.start-1:W);var Se=q===0&&O.root||fe.name;if(oe=2*(Se.length+1),H.write_shift(64,Se,"utf16le"),H.write_shift(2,oe),H.write_shift(1,fe.type),H.write_shift(1,fe.color),H.write_shift(-4,fe.L),H.write_shift(-4,fe.R),H.write_shift(-4,fe.C),fe.clsid)H.write_shift(16,fe.clsid,"hex");else for(ie=0;ie<4;++ie)H.write_shift(4,0);H.write_shift(4,fe.state||0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,fe.start),H.write_shift(4,fe.size),H.write_shift(4,0)}for(q=1;q<C.FileIndex.length;++q)if(fe=C.FileIndex[q],fe.size>=4096)if(H.l=fe.start+1<<9,Nt&&Buffer.isBuffer(fe.content))fe.content.copy(H,H.l,0,fe.size),H.l+=fe.size+511&-512;else{for(ie=0;ie<fe.size;++ie)H.write_shift(1,fe.content[ie]);for(;ie&511;++ie)H.write_shift(1,0)}for(q=1;q<C.FileIndex.length;++q)if(fe=C.FileIndex[q],fe.size>0&&fe.size<4096)if(Nt&&Buffer.isBuffer(fe.content))fe.content.copy(H,H.l,0,fe.size),H.l+=fe.size+63&-64;else{for(ie=0;ie<fe.size;++ie)H.write_shift(1,fe.content[ie]);for(;ie&63;++ie)H.write_shift(1,0)}if(Nt)H.l=H.length;else for(;H.l<H.length;)H.write_shift(1,0);return H}function A(C,K){var O=C.FullPaths.map(function(ie){return ie.toUpperCase()}),I=O.map(function(ie){var oe=ie.split("/");return oe[oe.length-(ie.slice(-1)=="/"?2:1)]}),H=!1;K.charCodeAt(0)===47?(H=!0,K=O[0].slice(0,-1)+K):H=K.indexOf("/")!==-1;var q=K.toUpperCase(),le=H===!0?O.indexOf(q):I.indexOf(q);if(le!==-1)return C.FileIndex[le];var ce=!q.match(Kl);for(q=q.replace(oa,""),ce&&(q=q.replace(Kl,"!")),le=0;le<O.length;++le)if((ce?O[le].replace(Kl,"!"):O[le]).replace(oa,"")==q||(ce?I[le].replace(Kl,"!"):I[le]).replace(oa,"")==q)return C.FileIndex[le];return null}var D=64,W=-2,re="d0cf11e0a1b11ae1",U=[208,207,17,224,161,177,26,225],M="00000000000000000000000000000000",Y={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:W,FREESECT:-1,HEADER_SIGNATURE:re,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:M,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Q(C,K,O){d();var I=E(C,O);c.writeFileSync(K,I)}function B(C){for(var K=new Array(C.length),O=0;O<C.length;++O)K[O]=String.fromCharCode(C[O]);return K.join("")}function V(C,K){var O=E(C,K);switch(K&&K.type||"buffer"){case"file":return d(),c.writeFileSync(K.filename,O),O;case"binary":return typeof O=="string"?O:B(O);case"base64":return Mo(typeof O=="string"?O:B(O));case"buffer":if(Nt)return Buffer.isBuffer(O)?O:Zn(O);case"array":return typeof O=="string"?Ea(O):O}return O}var P;function T(C){try{var K=C.InflateRaw,O=new K;if(O._processChunk(new Uint8Array([3,0]),O._finishFlushFlag),O.bytesRead)P=C;else throw new Error("zlib does not expose bytesRead")}catch(I){console.error("cannot use native zlib: "+(I.message||I))}}function R(C,K){if(!P)return Fa(C,K);var O=P.InflateRaw,I=new O,H=I._processChunk(C.slice(C.l),I._finishFlushFlag);return C.l+=I.bytesRead,H}function L(C){return P?P.deflateRawSync(C):se(C)}var X=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],J=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],te=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function G(C){var K=(C<<1|C<<11)&139536|(C<<5|C<<15)&558144;return(K>>16|K>>8|K)&255}for(var Z=typeof Uint8Array<"u",ae=Z?new Uint8Array(256):[],de=0;de<256;++de)ae[de]=G(de);function z(C,K){var O=ae[C&255];return K<=8?O>>>8-K:(O=O<<8|ae[C>>8&255],K<=16?O>>>16-K:(O=O<<8|ae[C>>16&255],O>>>24-K))}function Ee(C,K){var O=K&7,I=K>>>3;return(C[I]|(O<=6?0:C[I+1]<<8))>>>O&3}function ue(C,K){var O=K&7,I=K>>>3;return(C[I]|(O<=5?0:C[I+1]<<8))>>>O&7}function Ce(C,K){var O=K&7,I=K>>>3;return(C[I]|(O<=4?0:C[I+1]<<8))>>>O&15}function ve(C,K){var O=K&7,I=K>>>3;return(C[I]|(O<=3?0:C[I+1]<<8))>>>O&31}function ge(C,K){var O=K&7,I=K>>>3;return(C[I]|(O<=1?0:C[I+1]<<8))>>>O&127}function Fe(C,K,O){var I=K&7,H=K>>>3,q=(1<<O)-1,le=C[H]>>>I;return O<8-I||(le|=C[H+1]<<8-I,O<16-I)||(le|=C[H+2]<<16-I,O<24-I)||(le|=C[H+3]<<24-I),le&q}function Ie(C,K,O){var I=K&7,H=K>>>3;return I<=5?C[H]|=(O&7)<<I:(C[H]|=O<<I&255,C[H+1]=(O&7)>>8-I),K+3}function Ze(C,K,O){var I=K&7,H=K>>>3;return O=(O&1)<<I,C[H]|=O,K+1}function yt(C,K,O){var I=K&7,H=K>>>3;return O<<=I,C[H]|=O&255,O>>>=8,C[H+1]=O,K+8}function ht(C,K,O){var I=K&7,H=K>>>3;return O<<=I,C[H]|=O&255,O>>>=8,C[H+1]=O&255,C[H+2]=O>>>8,K+16}function Ct(C,K){var O=C.length,I=2*O>K?2*O:K+5,H=0;if(O>=K)return C;if(Nt){var q=Jg(I);if(C.copy)C.copy(q);else for(;H<C.length;++H)q[H]=C[H];return q}else if(Z){var le=new Uint8Array(I);if(le.set)le.set(C);else for(;H<O;++H)le[H]=C[H];return le}return C.length=I,C}function Ue(C){for(var K=new Array(C),O=0;O<C;++O)K[O]=0;return K}function kt(C,K,O){var I=1,H=0,q=0,le=0,ce=0,ie=C.length,oe=Z?new Uint16Array(32):Ue(32);for(q=0;q<32;++q)oe[q]=0;for(q=ie;q<O;++q)C[q]=0;ie=C.length;var fe=Z?new Uint16Array(ie):Ue(ie);for(q=0;q<ie;++q)oe[H=C[q]]++,I<H&&(I=H),fe[q]=0;for(oe[0]=0,q=1;q<=I;++q)oe[q+16]=ce=ce+oe[q-1]<<1;for(q=0;q<ie;++q)ce=C[q],ce!=0&&(fe[q]=oe[ce+16]++);var be=0;for(q=0;q<ie;++q)if(be=C[q],be!=0)for(ce=z(fe[q],I)>>I-be,le=(1<<I+4-be)-1;le>=0;--le)K[ce|le<<be]=be&15|q<<4;return I}var qe=Z?new Uint16Array(512):Ue(512),Ft=Z?new Uint16Array(32):Ue(32);if(!Z){for(var Qe=0;Qe<512;++Qe)qe[Qe]=0;for(Qe=0;Qe<32;++Qe)Ft[Qe]=0}(function(){for(var C=[],K=0;K<32;K++)C.push(5);kt(C,Ft,32);var O=[];for(K=0;K<=143;K++)O.push(8);for(;K<=255;K++)O.push(9);for(;K<=279;K++)O.push(7);for(;K<=287;K++)O.push(8);kt(O,qe,288)})();var bt=(function(){for(var K=Z?new Uint8Array(32768):[],O=0,I=0;O<te.length-1;++O)for(;I<te[O+1];++I)K[I]=O;for(;I<32768;++I)K[I]=29;var H=Z?new Uint8Array(259):[];for(O=0,I=0;O<J.length-1;++O)for(;I<J[O+1];++I)H[I]=O;function q(ce,ie){for(var oe=0;oe<ce.length;){var fe=Math.min(65535,ce.length-oe),be=oe+fe==ce.length;for(ie.write_shift(1,+be),ie.write_shift(2,fe),ie.write_shift(2,~fe&65535);fe-- >0;)ie[ie.l++]=ce[oe++]}return ie.l}function le(ce,ie){for(var oe=0,fe=0,be=Z?new Uint16Array(32768):[];fe<ce.length;){var Se=Math.min(65535,ce.length-fe);if(Se<10){for(oe=Ie(ie,oe,+(fe+Se==ce.length)),oe&7&&(oe+=8-(oe&7)),ie.l=oe/8|0,ie.write_shift(2,Se),ie.write_shift(2,~Se&65535);Se-- >0;)ie[ie.l++]=ce[fe++];oe=ie.l*8;continue}oe=Ie(ie,oe,+(fe+Se==ce.length)+2);for(var je=0;Se-- >0;){var Te=ce[fe];je=(je<<5^Te)&32767;var Le=-1,ot=0;if((Le=be[je])&&(Le|=fe&-32768,Le>fe&&(Le-=32768),Le<fe))for(;ce[Le+ot]==ce[fe+ot]&&ot<250;)++ot;if(ot>2){Te=H[ot],Te<=22?oe=yt(ie,oe,ae[Te+1]>>1)-1:(yt(ie,oe,3),oe+=5,yt(ie,oe,ae[Te-23]>>5),oe+=3);var Lt=Te<8?0:Te-4>>2;Lt>0&&(ht(ie,oe,ot-J[Te]),oe+=Lt),Te=K[fe-Le],oe=yt(ie,oe,ae[Te]>>3),oe-=3;var Mt=Te<4?0:Te-2>>1;Mt>0&&(ht(ie,oe,fe-Le-te[Te]),oe+=Mt);for(var kr=0;kr<ot;++kr)be[je]=fe&32767,je=(je<<5^ce[fe])&32767,++fe;Se-=ot-1}else Te<=143?Te=Te+48:oe=Ze(ie,oe,1),oe=yt(ie,oe,ae[Te]),be[je]=fe&32767,++fe}oe=yt(ie,oe,0)-1}return ie.l=(oe+7)/8|0,ie.l}return function(ie,oe){return ie.length<8?q(ie,oe):le(ie,oe)}})();function se(C){var K=pe(50+Math.floor(C.length*1.1)),O=bt(C,K);return K.slice(0,O)}var Ne=Z?new Uint16Array(32768):Ue(32768),De=Z?new Uint16Array(32768):Ue(32768),lt=Z?new Uint16Array(128):Ue(128),Rt=1,_r=1;function Hr(C,K){var O=ve(C,K)+257;K+=5;var I=ve(C,K)+1;K+=5;var H=Ce(C,K)+4;K+=4;for(var q=0,le=Z?new Uint8Array(19):Ue(19),ce=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ie=1,oe=Z?new Uint8Array(8):Ue(8),fe=Z?new Uint8Array(8):Ue(8),be=le.length,Se=0;Se<H;++Se)le[X[Se]]=q=ue(C,K),ie<q&&(ie=q),oe[q]++,K+=3;var je=0;for(oe[0]=0,Se=1;Se<=ie;++Se)fe[Se]=je=je+oe[Se-1]<<1;for(Se=0;Se<be;++Se)(je=le[Se])!=0&&(ce[Se]=fe[je]++);var Te=0;for(Se=0;Se<be;++Se)if(Te=le[Se],Te!=0){je=ae[ce[Se]]>>8-Te;for(var Le=(1<<7-Te)-1;Le>=0;--Le)lt[je|Le<<Te]=Te&7|Se<<3}var ot=[];for(ie=1;ot.length<O+I;)switch(je=lt[ge(C,K)],K+=je&7,je>>>=3){case 16:for(q=3+Ee(C,K),K+=2,je=ot[ot.length-1];q-- >0;)ot.push(je);break;case 17:for(q=3+ue(C,K),K+=3;q-- >0;)ot.push(0);break;case 18:for(q=11+ge(C,K),K+=7;q-- >0;)ot.push(0);break;default:ot.push(je),ie<je&&(ie=je);break}var Lt=ot.slice(0,O),Mt=ot.slice(O);for(Se=O;Se<286;++Se)Lt[Se]=0;for(Se=I;Se<30;++Se)Mt[Se]=0;return Rt=kt(Lt,Ne,286),_r=kt(Mt,De,30),K}function Et(C,K){if(C[0]==3&&!(C[1]&3))return[ws(K),2];for(var O=0,I=0,H=Jg(K||1<<18),q=0,le=H.length>>>0,ce=0,ie=0;(I&1)==0;){if(I=ue(C,O),O+=3,I>>>1)I>>1==1?(ce=9,ie=5):(O=Hr(C,O),ce=Rt,ie=_r);else{O&7&&(O+=8-(O&7));var oe=C[O>>>3]|C[(O>>>3)+1]<<8;if(O+=32,oe>0)for(!K&&le<q+oe&&(H=Ct(H,q+oe),le=H.length);oe-- >0;)H[q++]=C[O>>>3],O+=8;continue}for(;;){!K&&le<q+32767&&(H=Ct(H,q+32767),le=H.length);var fe=Fe(C,O,ce),be=I>>>1==1?qe[fe]:Ne[fe];if(O+=be&15,be>>>=4,(be>>>8&255)===0)H[q++]=be;else{if(be==256)break;be-=257;var Se=be<8?0:be-4>>2;Se>5&&(Se=0);var je=q+J[be];Se>0&&(je+=Fe(C,O,Se),O+=Se),fe=Fe(C,O,ie),be=I>>>1==1?Ft[fe]:De[fe],O+=be&15,be>>>=4;var Te=be<4?0:be-2>>1,Le=te[be];for(Te>0&&(Le+=Fe(C,O,Te),O+=Te),!K&&le<je&&(H=Ct(H,je+100),le=H.length);q<je;)H[q]=H[q-Le],++q}}}return K?[H,O+7>>>3]:[H.slice(0,q),O+7>>>3]}function Fa(C,K){var O=C.slice(C.l||0),I=Et(O,K);return C.l+=I[1],I[0]}function He(C,K){if(C)typeof console<"u"&&console.error(K);else throw new Error(K)}function gt(C,K){var O=C;Ur(O,0);var I=[],H=[],q={FileIndex:I,FullPaths:H};k(q,{root:K.root});for(var le=O.length-4;(O[le]!=80||O[le+1]!=75||O[le+2]!=5||O[le+3]!=6)&&le>=0;)--le;O.l=le+4,O.l+=4;var ce=O.read_shift(2);O.l+=6;var ie=O.read_shift(4);for(O.l=ie,le=0;le<ce;++le){O.l+=20;var oe=O.read_shift(4),fe=O.read_shift(4),be=O.read_shift(2),Se=O.read_shift(2),je=O.read_shift(2);O.l+=8;var Te=O.read_shift(4),Le=o(O.slice(O.l+be,O.l+be+Se));O.l+=be+Se+je;var ot=O.l;O.l=Te+4,Dt(O,oe,fe,q,Le),O.l=ot}return q}function Dt(C,K,O,I,H){C.l+=2;var q=C.read_shift(2),le=C.read_shift(2),ce=l(C);if(q&8257)throw new Error("Unsupported ZIP encryption");for(var ie=C.read_shift(4),oe=C.read_shift(4),fe=C.read_shift(4),be=C.read_shift(2),Se=C.read_shift(2),je="",Te=0;Te<be;++Te)je+=String.fromCharCode(C[C.l++]);if(Se){var Le=o(C.slice(C.l,C.l+Se));(Le[21589]||{}).mt&&(ce=Le[21589].mt),((H||{})[21589]||{}).mt&&(ce=H[21589].mt)}C.l+=Se;var ot=C.slice(C.l,C.l+oe);switch(le){case 8:ot=R(C,fe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+le)}var Lt=!1;q&8&&(ie=C.read_shift(4),ie==134695760&&(ie=C.read_shift(4),Lt=!0),oe=C.read_shift(4),fe=C.read_shift(4)),oe!=K&&He(Lt,"Bad compressed size: "+K+" != "+oe),fe!=O&&He(Lt,"Bad uncompressed size: "+O+" != "+fe),ee(I,je,ot,{unsafe:!0,mt:ce})}function mt(C,K){var O=K||{},I=[],H=[],q=pe(1),le=O.compression?8:0,ce=0,ie=0,oe=0,fe=0,be=0,Se=C.FullPaths[0],je=Se,Te=C.FileIndex[0],Le=[],ot=0;for(ie=1;ie<C.FullPaths.length;++ie)if(je=C.FullPaths[ie].slice(Se.length),Te=C.FileIndex[ie],!(!Te.size||!Te.content||je=="Sh33tJ5")){var Lt=fe,Mt=pe(je.length);for(oe=0;oe<je.length;++oe)Mt.write_shift(1,je.charCodeAt(oe)&127);Mt=Mt.slice(0,Mt.l),Le[be]=_O.buf(Te.content,0);var kr=Te.content;le==8&&(kr=L(kr)),q=pe(30),q.write_shift(4,67324752),q.write_shift(2,20),q.write_shift(2,ce),q.write_shift(2,le),Te.mt?i(q,Te.mt):q.write_shift(4,0),q.write_shift(-4,Le[be]),q.write_shift(4,kr.length),q.write_shift(4,Te.content.length),q.write_shift(2,Mt.length),q.write_shift(2,0),fe+=q.length,I.push(q),fe+=Mt.length,I.push(Mt),fe+=kr.length,I.push(kr),q=pe(46),q.write_shift(4,33639248),q.write_shift(2,0),q.write_shift(2,20),q.write_shift(2,ce),q.write_shift(2,le),q.write_shift(4,0),q.write_shift(-4,Le[be]),q.write_shift(4,kr.length),q.write_shift(4,Te.content.length),q.write_shift(2,Mt.length),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(4,0),q.write_shift(4,Lt),ot+=q.l,H.push(q),ot+=Mt.length,H.push(Mt),++be}return q=pe(22),q.write_shift(4,101010256),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,be),q.write_shift(2,be),q.write_shift(4,ot),q.write_shift(4,fe),q.write_shift(2,0),Or([Or(I),Or(H),q])}var Pt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ye(C,K){if(C.ctype)return C.ctype;var O=C.name||"",I=O.match(/\.([^\.]+)$/);return I&&Pt[I[1]]||K&&(I=(O=K).match(/[\.\\]([^\.\\])+$/),I&&Pt[I[1]])?Pt[I[1]]:"application/octet-stream"}function Ae(C){for(var K=Mo(C),O=[],I=0;I<K.length;I+=76)O.push(K.slice(I,I+76));return O.join(`\r
`)+`\r
`}function _e(C){var K=C.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(oe){var fe=oe.charCodeAt(0).toString(16).toUpperCase();return"="+(fe.length==1?"0"+fe:fe)});K=K.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),K.charAt(0)==`
`&&(K="=0D"+K.slice(1)),K=K.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var O=[],I=K.split(`\r
`),H=0;H<I.length;++H){var q=I[H];if(q.length==0){O.push("");continue}for(var le=0;le<q.length;){var ce=76,ie=q.slice(le,le+ce);ie.charAt(ce-1)=="="?ce--:ie.charAt(ce-2)=="="?ce-=2:ie.charAt(ce-3)=="="&&(ce-=3),ie=q.slice(le,le+ce),le+=ce,le<q.length&&(ie+="="),O.push(ie)}}return O.join(`\r
`)}function $e(C){for(var K=[],O=0;O<C.length;++O){for(var I=C[O];O<=C.length&&I.charAt(I.length-1)=="=";)I=I.slice(0,I.length-1)+C[++O];K.push(I)}for(var H=0;H<K.length;++H)K[H]=K[H].replace(/[=][0-9A-Fa-f]{2}/g,function(q){return String.fromCharCode(parseInt(q.slice(1),16))});return Ea(K.join(`\r
`))}function Ge(C,K,O){for(var I="",H="",q="",le,ce=0;ce<10;++ce){var ie=K[ce];if(!ie||ie.match(/^\s*$/))break;var oe=ie.match(/^(.*?):\s*([^\s].*)$/);if(oe)switch(oe[1].toLowerCase()){case"content-location":I=oe[2].trim();break;case"content-type":q=oe[2].trim();break;case"content-transfer-encoding":H=oe[2].trim();break}}switch(++ce,H.toLowerCase()){case"base64":le=Ea(_a(K.slice(ce).join("")));break;case"quoted-printable":le=$e(K.slice(ce));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+H)}var fe=ee(C,I.slice(O.length),le,{unsafe:!0});q&&(fe.ctype=q)}function xt(C,K){if(B(C.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var O=K&&K.root||"",I=(Nt&&Buffer.isBuffer(C)?C.toString("binary"):B(C)).split(`\r
`),H=0,q="";for(H=0;H<I.length;++H)if(q=I[H],!!/^Content-Location:/i.test(q)&&(q=q.slice(q.indexOf("file")),O||(O=q.slice(0,q.lastIndexOf("/")+1)),q.slice(0,O.length)!=O))for(;O.length>0&&(O=O.slice(0,O.length-1),O=O.slice(0,O.lastIndexOf("/")+1),q.slice(0,O.length)!=O););var le=(I[1]||"").match(/boundary="(.*?)"/);if(!le)throw new Error("MAD cannot find boundary");var ce="--"+(le[1]||""),ie=[],oe=[],fe={FileIndex:ie,FullPaths:oe};k(fe);var be,Se=0;for(H=0;H<I.length;++H){var je=I[H];je!==ce&&je!==ce+"--"||(Se++&&Ge(fe,I.slice(be,H),O),be=H)}return fe}function nt(C,K){var O=K||{},I=O.boundary||"SheetJS";I="------="+I;for(var H=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+I.slice(2)+'"',"","",""],q=C.FullPaths[0],le=q,ce=C.FileIndex[0],ie=1;ie<C.FullPaths.length;++ie)if(le=C.FullPaths[ie].slice(q.length),ce=C.FileIndex[ie],!(!ce.size||!ce.content||le=="Sh33tJ5")){le=le.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ot){return"_x"+ot.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ot){return"_u"+ot.charCodeAt(0).toString(16)+"_"});for(var oe=ce.content,fe=Nt&&Buffer.isBuffer(oe)?oe.toString("binary"):B(oe),be=0,Se=Math.min(1024,fe.length),je=0,Te=0;Te<=Se;++Te)(je=fe.charCodeAt(Te))>=32&&je<128&&++be;var Le=be>=Se*4/5;H.push(I),H.push("Content-Location: "+(O.root||"file:///C:/SheetJS/")+le),H.push("Content-Transfer-Encoding: "+(Le?"quoted-printable":"base64")),H.push("Content-Type: "+Ye(ce,le)),H.push(""),H.push(Le?_e(fe):Ae(fe))}return H.push(I+`--\r
`),H.join(`\r
`)}function rr(C){var K={};return k(K,C),K}function ee(C,K,O,I){var H=I&&I.unsafe;H||k(C);var q=!H&&rt.find(C,K);if(!q){var le=C.FullPaths[0];K.slice(0,le.length)==le?le=K:(le.slice(-1)!="/"&&(le+="/"),le=(le+K).replace("//","/")),q={name:s(K),type:2},C.FileIndex.push(q),C.FullPaths.push(le),H||rt.utils.cfb_gc(C)}return q.content=O,q.size=O?O.length:0,I&&(I.CLSID&&(q.clsid=I.CLSID),I.mt&&(q.mt=I.mt),I.ct&&(q.ct=I.ct)),q}function ne(C,K){k(C);var O=rt.find(C,K);if(O){for(var I=0;I<C.FileIndex.length;++I)if(C.FileIndex[I]==O)return C.FileIndex.splice(I,1),C.FullPaths.splice(I,1),!0}return!1}function he(C,K,O){k(C);var I=rt.find(C,K);if(I){for(var H=0;H<C.FileIndex.length;++H)if(C.FileIndex[H]==I)return C.FileIndex[H].name=s(O),C.FullPaths[H]=O,!0}return!1}function ye(C){w(C,!0)}return t.find=A,t.read=F,t.parse=u,t.write=V,t.writeFile=Q,t.utils={cfb_new:rr,cfb_add:ee,cfb_del:ne,cfb_mov:he,cfb_gc:ye,ReadShift:Ql,CheckField:sN,prep_blob:Ur,bconcat:Or,use_zlib:T,_deflateRaw:se,_inflateRaw:Fa,consts:Y},t})();function CO(e){return typeof e=="string"?Tu(e):Array.isArray(e)?rO(e):e}function oc(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Tu(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var a=r=="utf8"?Cn(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,e);if(typeof Blob<"u"){var s=new Blob([CO(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=e,l.href=i,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=_s(t)),o.write(t),o.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function FO(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function gr(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function iv(e,t){for(var r=[],a=gr(e),s=0;s!==a.length;++s)r[e[a[s]][t]]==null&&(r[e[a[s]][t]]=a[s]);return r}function _u(e){for(var t=[],r=gr(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}function Cu(e){for(var t=[],r=gr(e),a=0;a!==r.length;++a)t[e[r[a]]]=parseInt(r[a],10);return t}function DO(e){for(var t=[],r=gr(e),a=0;a!==r.length;++a)t[e[r[a]]]==null&&(t[e[r[a]]]=[]),t[e[r[a]]].push(r[a]);return t}var Ld=new Date(1899,11,30,0,0,0);function Mr(e,t){var r=e.getTime(),a=Ld.getTime()+(e.getTimezoneOffset()-Ld.getTimezoneOffset())*6e4;return(r-a)/(1440*60*1e3)}var L2=new Date,RO=Ld.getTime()+(L2.getTimezoneOffset()-Ld.getTimezoneOffset())*6e4,lv=L2.getTimezoneOffset();function Fu(e){var t=new Date;return t.setTime(e*24*60*60*1e3+RO),t.getTimezoneOffset()!==lv&&t.setTime(t.getTime()+(t.getTimezoneOffset()-lv)*6e4),t}function MO(e){var t=0,r=0,a=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=s.length;++i)if(s[i]){switch(r=1,i>3&&(a=!0),s[i].slice(s[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[i].slice(s[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(a)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[i],10)}return t}var ov=new Date("2017-02-19T19:06:09.000Z"),B2=isNaN(ov.getFullYear())?new Date("2/19/17"):ov,PO=B2.getFullYear()==2017;function Qt(e,t){var r=new Date(e);if(PO)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(B2.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function ii(e,t){if(Nt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Cn(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Cn(S2(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Cn(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Cn(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var a=[],s=0;s!=e.length;++s)a.push(String.fromCharCode(e[s]));return a.join("")}function er(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=er(e[r]));return t}function fr(e,t){for(var r="";r.length<t;)r+=e;return r}function un(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(s,i){return r=-r,i}),!isNaN(t=Number(a)))?t/r:t}var OO=["january","february","march","april","may","june","july","august","september","october","november","december"];function ol(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),s=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&OO.indexOf(l)==-1)return r}else if(l.match(/[a-z]/))return r;return a<0||a>8099?r:(s>0||i>1)&&a!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var IO=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,a,s){if(e||typeof a=="string")return r.split(a);for(var i=r.split(a),l=[i[0]],o=1;o<i.length;++o)l.push(s),l.push(i[o]);return l}})();function z2(e){return e?e.content&&e.type?ii(e.content,!0):e.data?$l(e.data):e.asNodeBuffer&&Nt?$l(e.asNodeBuffer().toString("binary")):e.asBinary?$l(e.asBinary()):e._data&&e._data.getContent?$l(ii(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function U2(e){if(!e)return null;if(e.data)return qg(e.data);if(e.asNodeBuffer&&Nt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?qg(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function LO(e){return e&&e.name.slice(-4)===".bin"?U2(e):z2(e)}function Ia(e,t){for(var r=e.FullPaths||gr(e.files),a=t.toLowerCase().replace(/[\/]/g,"\\"),s=a.replace(/\\/g,"/"),i=0;i<r.length;++i){var l=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==l||s==l)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function Vm(e,t){var r=Ia(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function jr(e,t,r){if(!r)return LO(Vm(e,t));if(!t)return null;try{return jr(e,t)}catch{return null}}function Sa(e,t,r){if(!r)return z2(Vm(e,t));if(!t)return null;try{return Sa(e,t)}catch{return null}}function BO(e,t,r){return U2(Vm(e,t))}function cv(e){for(var t=e.FullPaths||gr(e.files),r=[],a=0;a<t.length;++a)t[a].slice(-1)!="/"&&r.push(t[a].replace(/^Root Entry[\/]/,""));return r.sort()}function vt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var a;return Nt?a=Zn(r):a=aO(r),rt.utils.cfb_add(e,t,a)}rt.utils.cfb_add(e,t,r)}else e.file(t,r)}function Hm(){return rt.utils.cfb_new()}function V2(e,t){switch(t.type){case"base64":return rt.read(e,{type:"base64"});case"binary":return rt.read(e,{type:"binary"});case"buffer":case"array":return rt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Wl(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var a=e.split("/");a.length!==0;){var s=a.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var wr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,zO=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,dv=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,UO=/<[^>]*>/g,ra=wr.match(dv)?dv:UO,VO=/<\w*:/,HO=/<(\/?)\w+:/;function dt(e,t,r){for(var a={},s=0,i=0;s!==e.length&&!((i=e.charCodeAt(s))===32||i===10||i===13);++s);if(t||(a[0]=e.slice(0,s)),s===e.length)return a;var l=e.match(zO),o=0,c="",d=0,u="",f="",h=1;if(l)for(d=0;d!=l.length;++d){for(f=l[d],i=0;i!=f.length&&f.charCodeAt(i)!==61;++i);for(u=f.slice(0,i).trim();f.charCodeAt(i+1)==32;)++i;for(h=(s=f.charCodeAt(i+1))==34||s==39?1:0,c=f.slice(i+1+h,f.length-h),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),a[u]=c,a[u.toLowerCase()]=c;else{var m=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(a[m]&&u.slice(o-3,o)=="ext")continue;a[m]=c,a[m.toLowerCase()]=c}}return a}function Bn(e){return e.replace(HO,"<$1")}var H2={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},$m=_u(H2),Ot=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(a){var s=a+"",i=s.indexOf("<![CDATA[");if(i==-1)return s.replace(e,function(o,c){return H2[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,c){return String.fromCharCode(parseInt(c,16))});var l=s.indexOf("]]>");return r(s.slice(0,i))+s.slice(i+9,l)+r(s.slice(l+3))}})(),Km=/[&<>'"]/g,$O=/[\u0000-\u0008\u000b-\u001f]/g;function Kt(e){var t=e+"";return t.replace(Km,function(r){return $m[r]}).replace($O,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function uv(e){return Kt(e).replace(/ /g,"_x0020_")}var $2=/[\u0000-\u001f]/g;function Wm(e){var t=e+"";return t.replace(Km,function(r){return $m[r]}).replace(/\n/g,"<br/>").replace($2,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function KO(e){var t=e+"";return t.replace(Km,function(r){return $m[r]}).replace($2,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var fv=(function(){var e=/&#(\d+);/g;function t(r,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,t)}})();function WO(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Zt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function xf(e){for(var t="",r=0,a=0,s=0,i=0,l=0,o=0;r<e.length;){if(a=e.charCodeAt(r++),a<128){t+=String.fromCharCode(a);continue}if(s=e.charCodeAt(r++),a>191&&a<224){l=(a&31)<<6,l|=s&63,t+=String.fromCharCode(l);continue}if(i=e.charCodeAt(r++),a<240){t+=String.fromCharCode((a&15)<<12|(s&63)<<6|i&63);continue}l=e.charCodeAt(r++),o=((a&7)<<18|(s&63)<<12|(i&63)<<6|l&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function hv(e){var t=ws(2*e.length),r,a,s=1,i=0,l=0,o;for(a=0;a<e.length;a+=s)s=1,(o=e.charCodeAt(a))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(a+1)&63),s=2):o<240?(r=(o&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),s=3):(s=4,r=(o&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),r-=65536,l=55296+(r>>>10&1023),r=56320+(r&1023)),l!==0&&(t[i++]=l&255,t[i++]=l>>>8,l=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function mv(e){return Zn(e,"binary").toString("utf8")}var Fc="foo bar baz",Gt=Nt&&(mv(Fc)==xf(Fc)&&mv||hv(Fc)==xf(Fc)&&hv)||xf,Cn=Nt?function(e){return Zn(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,s=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,s=e.charCodeAt(r++)-56320+(a<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")},Oo=(function(){var e={};return function(r,a){var s=r+"|"+(a||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",a||"")}})(),K2=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)a=a.replace(e[s][0],e[s][1]);return a}})(),GO=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),YO=/<\/?(?:vt:)?variant>/g,XO=/<(?:vt:)([^>]*)>([\s\S]*)</;function xv(e,t){var r=dt(e),a=e.match(GO(r.baseType))||[],s=[];if(a.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return s}return a.forEach(function(i){var l=i.replace(YO,"").match(XO);l&&s.push({v:Gt(l[2]),t:l[1]})}),s}var W2=/(^\s|\s$|\n)/;function Vr(e,t){return"<"+e+(t.match(W2)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Io(e){return gr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Me(e,t,r){return"<"+e+(r!=null?Io(r):"")+(t!=null?(t.match(W2)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function H0(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function qO(e,t){switch(typeof e){case"string":var r=Me("vt:lpwstr",Kt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Me((e|0)==e?"vt:i4":"vt:r8",Kt(String(e)));case"boolean":return Me("vt:bool",e?"true":"false")}if(e instanceof Date)return Me("vt:filetime",H0(e));throw new Error("Unable to serialize "+e)}function Gm(e){if(Nt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Gt(_s(Bm(e)));throw new Error("Bad input format: expected Buffer or string")}var Lo=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Rr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},mi=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Na={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function ZO(e,t){for(var r=1-2*(e[t+7]>>>7),a=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,i=5;i>=0;--i)s=s*256+e[t+i];return a==2047?s==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,s+=Math.pow(2,52)),r*Math.pow(2,a-52)*s)}function JO(e,t,r){var a=(t<0||1/t==-1/0?1:0)<<7,s=0,i=0,l=a?-t:t;isFinite(l)?l==0?s=i=0:(s=Math.floor(Math.log(l)/Math.LN2),i=l*Math.pow(2,52-s),s<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?s=-1022:(i-=Math.pow(2,52),s+=1023)):(s=2047,i=isNaN(t)?26985:0);for(var o=0;o<=5;++o,i/=256)e[r+o]=i&255;e[r+6]=(s&15)<<4|i&15,e[r+7]=s>>4|a}var pv=function(e){for(var t=[],r=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var s=0,i=e[0][a].length;s<i;s+=r)t.push.apply(t,e[0][a].slice(s,s+r));return t},gv=Nt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Zn(t)})):pv(e)}:pv,vv=function(e,t,r){for(var a=[],s=t;s<r;s+=2)a.push(String.fromCharCode(Hn(e,s)));return a.join("").replace(oa,"")},Ym=Nt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(oa,""):vv(e,t,r)}:vv,yv=function(e,t,r){for(var a=[],s=t;s<t+r;++s)a.push(("0"+e[s].toString(16)).slice(-2));return a.join("")},G2=Nt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):yv(e,t,r)}:yv,bv=function(e,t,r){for(var a=[],s=t;s<r;s++)a.push(String.fromCharCode(Fi(e,s)));return a.join("")},cc=Nt?function(t,r,a){return Buffer.isBuffer(t)?t.toString("utf8",r,a):bv(t,r,a)}:bv,Y2=function(e,t){var r=ja(e,t);return r>0?cc(e,t+4,t+4+r-1):""},X2=Y2,q2=function(e,t){var r=ja(e,t);return r>0?cc(e,t+4,t+4+r-1):""},Z2=q2,J2=function(e,t){var r=2*ja(e,t);return r>0?cc(e,t+4,t+4+r-1):""},Q2=J2,eN=function(t,r){var a=ja(t,r);return a>0?Ym(t,r+4,r+4+a):""},tN=eN,rN=function(e,t){var r=ja(e,t);return r>0?cc(e,t+4,t+4+r):""},aN=rN,nN=function(e,t){return ZO(e,t)},Bd=nN,Xm=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Nt&&(X2=function(t,r){if(!Buffer.isBuffer(t))return Y2(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},Z2=function(t,r){if(!Buffer.isBuffer(t))return q2(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},Q2=function(t,r){if(!Buffer.isBuffer(t))return J2(t,r);var a=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a-1)},tN=function(t,r){if(!Buffer.isBuffer(t))return eN(t,r);var a=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a)},aN=function(t,r){if(!Buffer.isBuffer(t))return rN(t,r);var a=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+a)},Bd=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):nN(t,r)},Xm=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Fi=function(e,t){return e[t]},Hn=function(e,t){return e[t+1]*256+e[t]},QO=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},ja=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Bs=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},e5=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Ql(e,t){var r="",a,s,i=[],l,o,c,d;switch(t){case"dbcs":if(d=this.l,Nt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(Hn(this,d)),d+=2;e*=2;break;case"utf8":r=cc(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Ym(this,this.l,this.l+e);break;case"wstr":return Ql.call(this,e,"dbcs");case"lpstr-ansi":r=X2(this,this.l),e=4+ja(this,this.l);break;case"lpstr-cp":r=Z2(this,this.l),e=4+ja(this,this.l);break;case"lpwstr":r=Q2(this,this.l),e=4+2*ja(this,this.l);break;case"lpp4":e=4+ja(this,this.l),r=tN(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+ja(this,this.l),r=aN(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(l=Fi(this,this.l+e++))!==0;)i.push(Cc(l));r=i.join("");break;case"_wstr":for(e=0,r="";(l=Hn(this,this.l+e))!==0;)i.push(Cc(l)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",d=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return l=Fi(this,d),this.l=d+1,o=Ql.call(this,e-c,l?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(Cc(Hn(this,d))),d+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return l=Fi(this,d),this.l=d+1,o=Ql.call(this,e-c,l?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(Cc(Fi(this,d))),d+=1}r=i.join("");break;default:switch(e){case 1:return a=Fi(this,this.l),this.l++,a;case 2:return a=(t==="i"?QO:Hn)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(a=(e>0?Bs:e5)(this,this.l),this.l+=4,a):(s=ja(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=Bd(this,this.l):s=Bd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=G2(this,this.l,e);break}}return this.l+=e,r}var t5=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},r5=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},a5=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function n5(e,t,r){var a=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)a5(this,t.charCodeAt(s),this.l+2*s);a=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;a=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var l=t.charCodeAt(s);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,t5(this,t,this.l);break;case 8:if(a=8,r==="f"){JO(this,t,this.l);break}case 16:break;case-4:a=4,r5(this,t,this.l);break}return this.l+=a,this}function sN(e,t){var r=G2(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Ur(e,t){e.l=t,e.read_shift=Ql,e.chk=sN,e.write_shift=n5}function ta(e,t){e.l+=t}function pe(e){var t=ws(e);return Ur(t,0),t}function Jn(e,t,r){if(e){var a,s,i;Ur(e,e.l||0);for(var l=e.length,o=0,c=0;e.l<l;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var d=$o[o]||$o[65535];for(a=e.read_shift(1),i=a&127,s=1;s<4&&a&128;++s)i+=((a=e.read_shift(1))&127)<<7*s;c=e.l+i;var u=d.f&&d.f(e,i,r);if(e.l=c,t(u,d,o))return}}}function xa(){var e=[],t=Nt?256:2048,r=function(d){var u=pe(d);return Ur(u,0),u},a=r(t),s=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},i=function(d){return a&&d<a.length-a.l?a:(s(),a=r(Math.max(d+1,t)))},l=function(){return s(),Or(e)},o=function(d){s(),a=d,a.l==null&&(a.l=a.length),i(t)};return{next:i,push:o,end:l,_bufs:e}}function we(e,t,r,a){var s=+t,i;if(!isNaN(s)){a||(a=$o[s].p||(r||[]).length||0),i=1+(s>=128?1:0)+1,a>=128&&++i,a>=16384&&++i,a>=2097152&&++i;var l=e.next(i);s<=127?l.write_shift(1,s):(l.write_shift(1,(s&127)+128),l.write_shift(1,s>>7));for(var o=0;o!=4;++o)if(a>=128)l.write_shift(1,(a&127)+128),a>>=7;else{l.write_shift(1,a);break}a>0&&Xm(r)&&e.push(r)}}function eo(e,t,r){var a=er(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function wv(e,t,r){var a=er(e);return a.s=eo(a.s,t.s,r),a.e=eo(a.e,t.s,r),a}function to(e,t){if(e.cRel&&e.c<0)for(e=er(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=er(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=ct(e);return!e.cRel&&e.cRel!=null&&(r=l5(r)),!e.rRel&&e.rRel!=null&&(r=s5(r)),r}function pf(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+or(e.s.c)+":"+(e.e.cRel?"":"$")+or(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+br(e.s.r)+":"+(e.e.rRel?"":"$")+br(e.e.r):to(e.s,t.biff)+":"+to(e.e,t.biff)}function qm(e){return parseInt(i5(e),10)-1}function br(e){return""+(e+1)}function s5(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function i5(e){return e.replace(/\$(\d+)$/,"$1")}function Zm(e){for(var t=o5(e),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function or(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function l5(e){return e.replace(/^([A-Z])/,"$$$1")}function o5(e){return e.replace(/^\$([A-Z])/,"$1")}function c5(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function cr(e){for(var t=0,r=0,a=0;a<e.length;++a){var s=e.charCodeAt(a);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function ct(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function pa(e){var t=e.indexOf(":");return t==-1?{s:cr(e),e:cr(e)}:{s:cr(e.slice(0,t)),e:cr(e.slice(t+1))}}function pt(e,t){return typeof t>"u"||typeof t=="number"?pt(e.s,e.e):(typeof e!="string"&&(e=ct(e)),typeof t!="string"&&(t=ct(t)),e==t?e:e+":"+t)}function It(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,s=0,i=e.length;for(r=0;a<i&&!((s=e.charCodeAt(a)-64)<1||s>26);++a)r=26*r+s;for(t.s.c=--r,r=0;a<i&&!((s=e.charCodeAt(a)-48)<0||s>9);++a)r=10*r+s;if(t.s.r=--r,a===i||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=i&&!((s=e.charCodeAt(a)-64)<1||s>26);++a)r=26*r+s;for(t.e.c=--r,r=0;a!=i&&!((s=e.charCodeAt(a)-48)<0||s>9);++a)r=10*r+s;return t.e.r=--r,t}function kv(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Ya(e.z,r?Mr(t):t)}catch{}try{return e.w=Ya((e.XF||{}).numFmtId||(r?14:0),r?Mr(t):t)}catch{return""+t}}function qn(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Qn[e.v]||e.v:t==null?kv(e,e.v):kv(e,t))}function Cs(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function iN(e,t,r){var a=r||{},s=e?Array.isArray(e):a.dense,i=e||(s?[]:{}),l=0,o=0;if(i&&a.origin!=null){if(typeof a.origin=="number")l=a.origin;else{var c=typeof a.origin=="string"?cr(a.origin):a.origin;l=c.r,o=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=It(i["!ref"]);d.s.c=u.s.c,d.s.r=u.s.r,d.e.c=Math.max(d.e.c,u.e.c),d.e.r=Math.max(d.e.r,u.e.r),l==-1&&(d.e.r=l=u.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[f].length;++h)if(!(typeof t[f][h]>"u")){var m={v:t[f][h]},x=l+f,p=o+h;if(d.s.r>x&&(d.s.r=x),d.s.c>p&&(d.s.c=p),d.e.r<x&&(d.e.r=x),d.e.c<p&&(d.e.c=p),t[f][h]&&typeof t[f][h]=="object"&&!Array.isArray(t[f][h])&&!(t[f][h]instanceof Date))m=t[f][h];else if(Array.isArray(m.v)&&(m.f=t[f][h][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(a.nullError)m.t="e",m.v=0;else if(a.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=a.dateNF||it[14],a.cellDates?(m.t="d",m.w=Ya(m.z,Mr(m.v))):(m.t="n",m.v=Mr(m.v),m.w=Ya(m.z,m.v))):m.t="s";if(s)i[x]||(i[x]=[]),i[x][p]&&i[x][p].z&&(m.z=i[x][p].z),i[x][p]=m;else{var g=ct({c:p,r:x});i[g]&&i[g].z&&(m.z=i[g].z),i[g]=m}}}return d.s.c<1e7&&(i["!ref"]=pt(d)),i}function jl(e,t){return iN(null,e,t)}function d5(e){return e.read_shift(4,"i")}function fn(e,t){return t||(t=pe(4)),t.write_shift(4,e),t}function ea(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Lr(e,t){var r=!1;return t==null&&(r=!0,t=pe(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function u5(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function f5(e,t){return t||(t=pe(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Jm(e,t){var r=e.l,a=e.read_shift(1),s=ea(e),i=[],l={t:s,h:s};if((a&1)!==0){for(var o=e.read_shift(4),c=0;c!=o;++c)i.push(u5(e));l.r=i}else l.r=[{ich:0,ifnt:0}];return e.l=r+t,l}function h5(e,t){var r=!1;return t==null&&(r=!0,t=pe(15+4*e.t.length)),t.write_shift(1,0),Lr(e.t,t),r?t.slice(0,t.l):t}var m5=Jm;function x5(e,t){var r=!1;return t==null&&(r=!0,t=pe(23+4*e.t.length)),t.write_shift(1,1),Lr(e.t,t),t.write_shift(4,1),f5({},t),r?t.slice(0,t.l):t}function qa(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function xi(e,t){return t==null&&(t=pe(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function pi(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function gi(e,t){return t==null&&(t=pe(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var p5=ea,lN=Lr;function Qm(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function zd(e,t){var r=!1;return t==null&&(r=!0,t=pe(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var g5=ea,$0=Qm,ex=zd;function tx(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,a=t[0]&2;e.l+=4;var s=a===0?Bd([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Bs(t,0)>>2;return r?s/100:s}function oN(e,t){t==null&&(t=pe(4));var r=0,a=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?a=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(a=1,r=1),a)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function cN(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function v5(e,t){return t||(t=pe(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var vi=cN,El=v5;function Zr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function li(e,t){return(t||pe(8)).write_shift(8,e,"f")}function y5(e){var t={},r=e.read_shift(1),a=r>>>1,s=e.read_shift(1),i=e.read_shift(2,"i"),l=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=s;var d=Xs[s];d&&(t.rgb=zo(d));break;case 2:t.rgb=zo([l,o,c]);break;case 3:t.theme=s;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function Ud(e,t){if(t||(t=pe(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),t.write_shift(1,parseInt(a.slice(0,2),16)),t.write_shift(1,parseInt(a.slice(2,4),16)),t.write_shift(1,parseInt(a.slice(4,6),16)),t.write_shift(1,255)}return t}function b5(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function w5(e,t){t||(t=pe(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function dN(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function k5(e){return dN(e,1)}function N5(e){return dN(e,2)}var rx=2,fa=3,Dc=11,Nv=12,Vd=19,Rc=64,j5=65,E5=71,S5=4108,T5=4126,Pr=80,uN=81,A5=[Pr,uN],K0={1:{n:"CodePage",t:rx},2:{n:"Category",t:Pr},3:{n:"PresentationFormat",t:Pr},4:{n:"ByteCount",t:fa},5:{n:"LineCount",t:fa},6:{n:"ParagraphCount",t:fa},7:{n:"SlideCount",t:fa},8:{n:"NoteCount",t:fa},9:{n:"HiddenCount",t:fa},10:{n:"MultimediaClipCount",t:fa},11:{n:"ScaleCrop",t:Dc},12:{n:"HeadingPairs",t:S5},13:{n:"TitlesOfParts",t:T5},14:{n:"Manager",t:Pr},15:{n:"Company",t:Pr},16:{n:"LinksUpToDate",t:Dc},17:{n:"CharacterCount",t:fa},19:{n:"SharedDoc",t:Dc},22:{n:"HyperlinksChanged",t:Dc},23:{n:"AppVersion",t:fa,p:"version"},24:{n:"DigSig",t:j5},26:{n:"ContentType",t:Pr},27:{n:"ContentStatus",t:Pr},28:{n:"Language",t:Pr},29:{n:"Version",t:Pr},255:{},2147483648:{n:"Locale",t:Vd},2147483651:{n:"Behavior",t:Vd},1919054434:{}},W0={1:{n:"CodePage",t:rx},2:{n:"Title",t:Pr},3:{n:"Subject",t:Pr},4:{n:"Author",t:Pr},5:{n:"Keywords",t:Pr},6:{n:"Comments",t:Pr},7:{n:"Template",t:Pr},8:{n:"LastAuthor",t:Pr},9:{n:"RevNumber",t:Pr},10:{n:"EditTime",t:Rc},11:{n:"LastPrinted",t:Rc},12:{n:"CreatedDate",t:Rc},13:{n:"ModifiedDate",t:Rc},14:{n:"PageCount",t:fa},15:{n:"WordCount",t:fa},16:{n:"CharCount",t:fa},17:{n:"Thumbnail",t:E5},18:{n:"Application",t:Pr},19:{n:"DocSecurity",t:fa},255:{},2147483648:{n:"Locale",t:Vd},2147483651:{n:"Behavior",t:Vd},1919054434:{}},jv={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},_5=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function C5(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var F5=C5([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Xs=er(F5),Qn={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},fN={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},G0={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Mc={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function ax(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function D5(e){var t=ax();if(!e||!e.match)return t;var r={};if((e.match(ra)||[]).forEach(function(a){var s=dt(a);switch(s[0].replace(VO,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[G0[s.ContentType]]!==void 0&&t[G0[s.ContentType]].push(s.PartName);break}}),t.xmlns!==Rr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function hN(e,t){var r=DO(G0),a=[],s;a[a.length]=wr,a[a.length]=Me("Types",null,{xmlns:Rr.CT,"xmlns:xsd":Rr.xsd,"xmlns:xsi":Rr.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Me("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){e[c]&&e[c].length>0&&(s=e[c][0],a[a.length]=Me("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:Mc[c][t.bookType]||Mc[c].xlsx}))},l=function(c){(e[c]||[]).forEach(function(d){a[a.length]=Me("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:Mc[c][t.bookType]||Mc[c].xlsx})})},o=function(c){(e[c]||[]).forEach(function(d){a[a.length]=Me("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[c][0]})})};return i("workbooks"),l("sheets"),l("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),l("metadata"),o("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var St={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Bo(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function ro(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var a={};return(e.match(ra)||[]).forEach(function(s){var i=dt(s);if(i[0]==="<Relationship"){var l={};l.Type=i.Type,l.Target=i.Target,l.Id=i.Id,i.TargetMode&&(l.TargetMode=i.TargetMode);var o=i.TargetMode==="External"?i.Target:Wl(i.Target,t);r[o]=l,a[i.Id]=l}}),r["!id"]=a,r}function qi(e){var t=[wr,Me("Relationships",null,{xmlns:Rr.RELS})];return gr(e["!id"]).forEach(function(r){t[t.length]=Me("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function $t(e,t,r,a,s,i){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=a,s.Target=r,[St.HLINK,St.XPATH,St.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}var R5="application/vnd.oasis.opendocument.spreadsheet";function M5(e,t){for(var r=Gm(e),a,s;a=Lo.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if(s=dt(a[0],!1),s.path=="/"&&s.type!==R5)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw a}}function P5(e){var t=[wr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Ev(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function O5(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function I5(e){var t=[wr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Ev(e[r][0],e[r][1])),t.push(O5("",e[r][0]));return t.push(Ev("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function mN(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Md.version+"</meta:generator></office:meta></office:document-meta>"}var Wa=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],L5=(function(){for(var e=new Array(Wa.length),t=0;t<Wa.length;++t){var r=Wa[t],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e})();function xN(e){var t={};e=Gt(e);for(var r=0;r<Wa.length;++r){var a=Wa[r],s=e.match(L5[r]);s!=null&&s.length>0&&(t[a[1]]=Ot(s[1])),a[2]==="date"&&t[a[1]]&&(t[a[1]]=Qt(t[a[1]]))}return t}function gf(e,t,r,a,s){s[e]!=null||t==null||t===""||(s[e]=t,t=Kt(t),a[a.length]=r?Me(e,t,r):Vr(e,t))}function pN(e,t){var r=t||{},a=[wr,Me("cp:coreProperties",null,{"xmlns:cp":Rr.CORE_PROPS,"xmlns:dc":Rr.dc,"xmlns:dcterms":Rr.dcterms,"xmlns:dcmitype":Rr.dcmitype,"xmlns:xsi":Rr.xsi})],s={};if(!e&&!r.Props)return a.join("");e&&(e.CreatedDate!=null&&gf("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:H0(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,s),e.ModifiedDate!=null&&gf("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:H0(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,s));for(var i=0;i!=Wa.length;++i){var l=Wa[i],o=r.Props&&r.Props[l[1]]!=null?r.Props[l[1]]:e?e[l[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&gf(l[0],o,null,a,s)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var qs=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],gN=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function vN(e,t,r,a){var s=[];if(typeof e=="string")s=xv(e,a);else for(var i=0;i<e.length;++i)s=s.concat(e[i].map(function(u){return{v:u}}));var l=typeof t=="string"?xv(t,a).map(function(u){return u.v}):t,o=0,c=0;if(l.length>0)for(var d=0;d!==s.length;d+=2){switch(c=+s[d+1].v,s[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=l.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=l.slice(o,o+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=l.slice(o,o+c);break}o+=c}}function B5(e,t,r){var a={};return t||(t={}),e=Gt(e),qs.forEach(function(s){var i=(e.match(Oo(s[0]))||[])[1];switch(s[2]){case"string":i&&(t[s[1]]=Ot(i));break;case"bool":t[s[1]]=i==="true";break;case"raw":var l=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));l&&l.length>0&&(a[s[1]]=l[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&vN(a.HeadingPairs,a.TitlesOfParts,t,r),t}function yN(e){var t=[],r=Me;return e||(e={}),e.Application="SheetJS",t[t.length]=wr,t[t.length]=Me("Properties",null,{xmlns:Rr.EXT_PROPS,"xmlns:vt":Rr.vt}),qs.forEach(function(a){if(e[a[1]]!==void 0){var s;switch(a[2]){case"string":s=Kt(String(e[a[1]]));break;case"bool":s=e[a[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(a[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+Kt(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var z5=/<[^>]+>[^<]*/g;function U5(e,t){var r={},a="",s=e.match(z5);if(s)for(var i=0;i!=s.length;++i){var l=s[i],o=dt(l);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":a=Ot(o.name);break;case"</property>":a=null;break;default:if(l.indexOf("<vt:")===0){var c=l.split(">"),d=c[0].slice(4),u=c[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[a]=Ot(u);break;case"bool":r[a]=Zt(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(u);break;case"filetime":case"date":r[a]=Qt(u);break;case"cy":case"error":r[a]=Ot(u);break;default:if(d.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",l,d,c)}}else if(l.slice(0,2)!=="</"){if(t.WTF)throw new Error(l)}}}return r}function bN(e){var t=[wr,Me("Properties",null,{xmlns:Rr.CUST_PROPS,"xmlns:vt":Rr.vt})];if(!e)return t.join("");var r=1;return gr(e).forEach(function(s){++r,t[t.length]=Me("property",qO(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Kt(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Y0={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},vf;function V5(e,t,r){vf||(vf=_u(Y0)),t=vf[t]||t,e[t]=r}function H5(e,t){var r=[];return gr(Y0).map(function(a){for(var s=0;s<Wa.length;++s)if(Wa[s][1]==a)return Wa[s];for(s=0;s<qs.length;++s)if(qs[s][1]==a)return qs[s];throw a}).forEach(function(a){if(e[a[1]]!=null){var s=t&&t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:e[a[1]];switch(a[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(Vr(Y0[a[1]]||a[1],s))}}),Me("DocumentProperties",r.join(""),{xmlns:Na.o})}function $5(e,t){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",s=[];return e&&gr(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var l=0;l<Wa.length;++l)if(i==Wa[l][1])return;for(l=0;l<qs.length;++l)if(i==qs[l][1])return;for(l=0;l<r.length;++l)if(i==r[l])return;var o=e[i],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),s.push(Me(uv(i),o,{"dt:dt":c}))}}),t&&gr(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var l=t[i],o="string";typeof l=="number"?(o="float",l=String(l)):l===!0||l===!1?(o="boolean",l=l?"1":"0"):l instanceof Date?(o="dateTime.tz",l=l.toISOString()):l=String(l),s.push(Me(uv(i),l,{"dt:dt":o}))}}),"<"+a+' xmlns="'+Na.o+'">'+s.join("")+"</"+a+">"}function nx(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function K5(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,a=r%Math.pow(2,32),s=(r-a)/Math.pow(2,32);a*=1e7,s*=1e7;var i=a/Math.pow(2,32)|0;i>0&&(a=a%Math.pow(2,32),s+=i);var l=pe(8);return l.write_shift(4,a),l.write_shift(4,s),l}function wN(e,t,r){var a=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-a&3;)++e.l;return s}function kN(e,t,r){var a=e.read_shift(0,"lpwstr");return a}function NN(e,t,r){return t===31?kN(e):wN(e,t,r)}function X0(e,t,r){return NN(e,t,r===!1?0:4)}function W5(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return NN(e,t,0)}function G5(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a){var s=e.l;r[a]=e.read_shift(0,"lpwstr").replace(oa,""),e.l-s&2&&(e.l+=2)}return r}function Y5(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a)r[a]=e.read_shift(0,"lpstr-cp").replace(oa,"");return r}function X5(e){var t=e.l,r=Hd(e,uN);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var a=Hd(e,fa);return[r,a]}function q5(e){for(var t=e.read_shift(4),r=[],a=0;a<t/2;++a)r.push(X5(e));return r}function Sv(e,t){for(var r=e.read_shift(4),a={},s=0;s!=r;++s){var i=e.read_shift(4),l=e.read_shift(4);a[i]=e.read_shift(l,t===1200?"utf16le":"utf8").replace(oa,"").replace(Kl,"!"),t===1200&&l%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),a}function jN(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function Z5(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Hd(e,t,r){var a=e.read_shift(2),s,i=r||{};if(e.l+=2,t!==Nv&&a!==t&&A5.indexOf(t)===-1&&!((t&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+t+" saw "+a);switch(t===Nv?a:t){case 2:return s=e.read_shift(2,"i"),i.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return wN(e,a,4).replace(oa,"");case 31:return kN(e);case 64:return nx(e);case 65:return jN(e);case 71:return Z5(e);case 80:return X0(e,a,!i.raw).replace(oa,"");case 81:return W5(e,a).replace(oa,"");case 4108:return q5(e);case 4126:case 4127:return a==4127?G5(e):Y5(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function Tv(e,t){var r=pe(4),a=pe(4);switch(r.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,t);break;case 5:a=pe(8),a.write_shift(8,t,"f");break;case 11:a.write_shift(4,t?1:0);break;case 64:a=K5(t);break;case 31:case 80:for(a=pe(4+2*(t.length+1)+(t.length%2?0:2)),a.write_shift(4,t.length+1),a.write_shift(0,t,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Or([r,a])}function Av(e,t){var r=e.l,a=e.read_shift(4),s=e.read_shift(4),i=[],l=0,o=0,c=-1,d={};for(l=0;l!=s;++l){var u=e.read_shift(4),f=e.read_shift(4);i[l]=[u,f+r]}i.sort(function(N,v){return N[1]-v[1]});var h={};for(l=0;l!=s;++l){if(e.l!==i[l][1]){var m=!0;if(l>0&&t)switch(t[i[l-1][0]].t){case 2:e.l+2===i[l][1]&&(e.l+=2,m=!1);break;case 80:e.l<=i[l][1]&&(e.l=i[l][1],m=!1);break;case 4108:e.l<=i[l][1]&&(e.l=i[l][1],m=!1);break}if((!t||l==0)&&e.l<=i[l][1]&&(m=!1,e.l=i[l][1]),m)throw new Error("Read Error: Expected address "+i[l][1]+" at "+e.l+" :"+l)}if(t){var x=t[i[l][0]];if(h[x.n]=Hd(e,x.t,{raw:!0}),x.p==="version"&&(h[x.n]=String(h[x.n]>>16)+"."+("0000"+String(h[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(h[x.n]){case 0:h[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:sn(o=h[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[x.n])}}else if(i[l][0]===1){if(o=h.CodePage=Hd(e,rx),sn(o),c!==-1){var p=e.l;e.l=i[c][1],d=Sv(e,o),e.l=p}}else if(i[l][0]===0){if(o===0){c=l,e.l=i[l+1][1];continue}d=Sv(e,o)}else{var g=d[i[l][0]],y;switch(e[e.l]){case 65:e.l+=4,y=jN(e);break;case 30:e.l+=4,y=X0(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,y=X0(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,y=e.read_shift(4,"i");break;case 19:e.l+=4,y=e.read_shift(4);break;case 5:e.l+=4,y=e.read_shift(8,"f");break;case 11:e.l+=4,y=yr(e,4);break;case 64:e.l+=4,y=Qt(nx(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[g]=y}}return e.l=r+a,h}var EN=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function J5(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function _v(e,t,r){var a=pe(8),s=[],i=[],l=8,o=0,c=pe(8),d=pe(8);if(c.write_shift(4,2),c.write_shift(4,1200),d.write_shift(4,1),i.push(c),s.push(d),l+=8+c.length,!t){d=pe(8),d.write_shift(4,0),s.unshift(d);var u=[pe(4)];for(u[0].write_shift(4,e.length),o=0;o<e.length;++o){var f=e[o][0];for(c=pe(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);u.push(c)}c=Or(u),i.unshift(c),l+=8+c.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(EN.indexOf(e[o][0])>-1||gN.indexOf(e[o][0])>-1)&&e[o][1]!=null){var h=e[o][1],m=0;if(t){m=+t[e[o][0]];var x=r[m];if(x.p=="version"&&typeof h=="string"){var p=h.split(".");h=(+p[0]<<16)+(+p[1]||0)}c=Tv(x.t,h)}else{var g=J5(h);g==-1&&(g=31,h=String(h)),c=Tv(g,h)}i.push(c),d=pe(8),d.write_shift(4,t?m:2+o),s.push(d),l+=8+c.length}var y=8*(i.length+1);for(o=0;o<i.length;++o)s[o].write_shift(4,y),y+=i[o].length;return a.write_shift(4,l),a.write_shift(4,i.length),Or([a].concat(s).concat(i))}function Cv(e,t,r){var a=e.content;if(!a)return{};Ur(a,0);var s,i,l,o,c=0;a.chk("feff","Byte Order: "),a.read_shift(2);var d=a.read_shift(4),u=a.read_shift(16);if(u!==rt.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(s=a.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(i=a.read_shift(16),o=a.read_shift(4),s===1&&o!==a.l)throw new Error("Length mismatch: "+o+" !== "+a.l);s===2&&(l=a.read_shift(16),c=a.read_shift(4));var f=Av(a,t),h={SystemIdentifier:d};for(var m in f)h[m]=f[m];if(h.FMTID=i,s===1)return h;if(c-a.l==2&&(a.l+=2),a.l!==c)throw new Error("Length mismatch 2: "+a.l+" !== "+c);var x;try{x=Av(a,null)}catch{}for(m in x)h[m]=x[m];return h.FMTID=[i,l],h}function Fv(e,t,r,a,s,i){var l=pe(s?68:48),o=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,rt.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,s?2:1),l.write_shift(16,t,"hex"),l.write_shift(4,s?68:48);var c=_v(e,r,a);if(o.push(c),s){var d=_v(s,null,null);l.write_shift(16,i,"hex"),l.write_shift(4,68+c.length),o.push(d)}return Or(o)}function es(e,t){return e.read_shift(t),null}function Q5(e,t){t||(t=pe(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function eI(e,t,r){for(var a=[],s=e.l+t;e.l<s;)a.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return a}function yr(e,t){return e.read_shift(t)===1}function na(e,t){return t||(t=pe(2)),t.write_shift(2,+!!e),t}function Er(e){return e.read_shift(2,"u")}function za(e,t){return t||(t=pe(2)),t.write_shift(2,e),t}function SN(e,t){return eI(e,t,Er)}function tI(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function TN(e,t,r){return r||(r=pe(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function dc(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var l=a?e.read_shift(a,s):"";return l}function rI(e){var t=e.read_shift(2),r=e.read_shift(1),a=r&4,s=r&8,i=1+(r&1),l=0,o,c={};s&&(l=e.read_shift(2)),a&&(o=e.read_shift(4));var d=i==2?"dbcs-cont":"sbcs-cont",u=t===0?"":e.read_shift(t,d);return s&&(e.l+=4*l),a&&(e.l+=o),c.t=u,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function aI(e){var t=e.t||"",r=pe(3);r.write_shift(2,t.length),r.write_shift(1,1);var a=pe(2*t.length);a.write_shift(2*t.length,t,"utf16le");var s=[r,a];return Or(s)}function oi(e,t,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?a=e.read_shift(t,"sbcs-cont"):a=e.read_shift(t,"dbcs-cont"),a}function uc(e,t,r){var a=e.read_shift(r&&r.biff==2?1:2);return a===0?(e.l++,""):oi(e,a,r)}function yi(e,t,r){if(r.biff>5)return uc(e,t,r);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function AN(e,t,r){return r||(r=pe(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function nI(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function sI(e){var t=e.read_shift(4),r=e.l,a=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=r);var s=e.read_shift((a?t-24:t)>>1,"utf16le").replace(oa,"");return a&&(e.l+=24),s}function iI(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+a.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=e.read_shift(i>>1,"utf16le").replace(oa,"");return r+l}function lI(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return sI(e);case"0303000000000000c000000000000046":return iI(e);default:throw new Error("Unsupported Moniker "+r)}}function Pc(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(oa,""):"";return r}function Dv(e,t){t||(t=pe(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function oI(e,t){var r=e.l+t,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var s=e.read_shift(2);e.l+=2;var i,l,o,c,d="",u,f;s&16&&(i=Pc(e,r-e.l)),s&128&&(l=Pc(e,r-e.l)),(s&257)===257&&(o=Pc(e,r-e.l)),(s&257)===1&&(c=lI(e,r-e.l)),s&8&&(d=Pc(e,r-e.l)),s&32&&(u=e.read_shift(16)),s&64&&(f=nx(e)),e.l=r;var h=l||o||c||"";h&&d&&(h+="#"+d),h||(h="#"+d),s&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var m={Target:h};return u&&(m.guid=u),f&&(m.time=f),i&&(m.Tooltip=i),m}function cI(e){var t=pe(512),r=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var s=a.indexOf("#"),i=s>-1?31:23;switch(a.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var l=[8,6815827,6619237,4849780,83];for(r=0;r<l.length;++r)t.write_shift(4,l[r]);if(i==28)a=a.slice(1),Dv(a,t);else if(i&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));var o=s>-1?a.slice(0,s):a;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),i&8&&Dv(s>-1?a.slice(s+1):"",t)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));for(var c=0;a.slice(c*3,c*3+3)=="../"||a.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,a.length-3*c+1),r=0;r<a.length-3*c;++r)t.write_shift(1,a.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function _N(e){var t=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1),s=e.read_shift(1);return[t,r,a,s]}function CN(e,t){var r=_N(e);return r[3]=0,r}function zn(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{r:t,c:r,ixfe:a}}function ci(e,t,r,a){return a||(a=pe(6)),a.write_shift(2,e),a.write_shift(2,t),a.write_shift(2,r||0),a}function dI(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function uI(e,t,r){return t===0?"":yi(e,t,r)}function fI(e,t,r){var a=r.biff>8?4:2,s=e.read_shift(a),i=e.read_shift(a,"i"),l=e.read_shift(a,"i");return[s,i,l]}function FN(e){var t=e.read_shift(2),r=tx(e);return[t,r]}function hI(e,t,r){e.l+=4,t-=4;var a=e.l+t,s=dc(e,t,r),i=e.read_shift(2);if(a-=e.l,i!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+i);return e.l+=i,s}function Du(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);return{s:{c:a,r:t},e:{c:s,r}}}function DN(e,t){return t||(t=pe(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function RN(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(1),s=e.read_shift(1);return{s:{c:a,r:t},e:{c:s,r}}}var mI=RN;function MN(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[r,t,a]}function xI(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function pI(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Kr(e){e.l+=2,e.l+=e.read_shift(2)}var gI={0:Kr,4:Kr,5:Kr,6:Kr,7:pI,8:Kr,9:Kr,10:Kr,11:Kr,12:Kr,13:xI,14:Kr,15:Kr,16:Kr,17:Kr,18:Kr,19:Kr,20:Kr,21:MN};function vI(e,t){for(var r=e.l+t,a=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{a.push(gI[s](e,r-e.l))}catch{return e.l=r,a}}return e.l!=r&&(e.l=r),a}function Oc(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function sx(e,t,r){var a=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":a=1280,s=8;break;case"biff4":a=4,s=6;break;case"biff3":a=3,s=6;break;case"biff2":a=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=pe(s);return i.write_shift(2,a),i.write_shift(2,t),s>4&&i.write_shift(2,29282),s>6&&i.write_shift(2,1997),s>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function yI(e,t){return t===0||e.read_shift(2),1200}function bI(e,t,r){if(r.enc)return e.l+=t,"";var a=e.l,s=yi(e,0,r);return e.read_shift(t+a-e.l),s}function wI(e,t){var r=!t||t.biff==8,a=pe(r?112:54);for(a.write_shift(t.biff==8?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}function kI(e,t,r){var a=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function NI(e,t,r){var a=e.read_shift(4),s=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var l=dc(e,0,r);return l.length===0&&(l="Sheet1"),{pos:a,hs:s,dt:i,name:l}}function jI(e,t){var r=!t||t.biff>=8?2:1,a=pe(8+r*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),t.biff>=8&&a.write_shift(1,1),a.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=a.slice(0,a.l);return s.l=a.l,s}function EI(e,t){for(var r=e.l+t,a=e.read_shift(4),s=e.read_shift(4),i=[],l=0;l!=s&&e.l<r;++l)i.push(rI(e));return i.Count=a,i.Unique=s,i}function SI(e,t){var r=pe(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var a=[],s=0;s<e.length;++s)a[s]=aI(e[s]);var i=Or([r].concat(a));return i.parts=[r.length].concat(a.map(function(l){return l.length})),i}function TI(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function AI(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(t.level=a&7),a&32&&(t.hidden=!0),a&64&&(t.hpt=r/20),t}function _I(e){var t=dI(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function CI(e){return e.read_shift(2),e.read_shift(4)}function Rv(e,t,r){var a=0;r&&r.biff==2||(a=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(a=1-(s>>15),s&=32767);var i={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[i,s]}function FI(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),d=e.read_shift(2);return{Pos:[t,r],Dim:[a,s],Flags:i,CurTab:l,FirstTab:o,Selected:c,TabRatio:d}}function DI(){var e=pe(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function RI(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function MI(e){var t=pe(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function PI(){}function OI(e,t,r){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=dc(e,0,r),a}function II(e,t){var r=e.name||"Arial",a=t&&t.biff==5,s=a?15+r.length:16+2*r.length,i=pe(s);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),a||i.write_shift(1,1),i.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),i}function LI(e){var t=zn(e);return t.isst=e.read_shift(4),t}function BI(e,t,r,a){var s=pe(10);return ci(e,t,a,s),s.write_shift(4,r),s}function zI(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=e.l+t,s=zn(e);r.biff==2&&e.l++;var i=uc(e,a-e.l,r);return s.val=i,s}function UI(e,t,r,a,s){var i=!s||s.biff==8,l=pe(8+ +i+(1+i)*r.length);return ci(e,t,a,l),l.write_shift(2,r.length),i&&l.write_shift(1,1),l.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),l}function VI(e,t,r){var a=e.read_shift(2),s=yi(e,0,r);return[a,s]}function HI(e,t,r,a){var s=r&&r.biff==5;a||(a=pe(s?3+t.length:5+2*t.length)),a.write_shift(2,e),a.write_shift(s?1:2,t.length),s||a.write_shift(1,1),a.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var i=a.length>a.l?a.slice(0,a.l):a;return i.l==null&&(i.l=i.length),i}var $I=yi;function Mv(e,t,r){var a=e.l+t,s=r.biff==8||!r.biff?4:2,i=e.read_shift(s),l=e.read_shift(s),o=e.read_shift(2),c=e.read_shift(2);return e.l=a,{s:{r:i,c:o},e:{r:l,c}}}function KI(e,t){var r=t.biff==8||!t.biff?4:2,a=pe(2*r+6);return a.write_shift(r,e.s.r),a.write_shift(r,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function WI(e){var t=e.read_shift(2),r=e.read_shift(2),a=FN(e);return{r:t,c:r,ixfe:a[0],rknum:a[1]}}function GI(e,t){for(var r=e.l+t-2,a=e.read_shift(2),s=e.read_shift(2),i=[];e.l<r;)i.push(FN(e));if(e.l!==r)throw new Error("MulRK read error");var l=e.read_shift(2);if(i.length!=l-s+1)throw new Error("MulRK length mismatch");return{r:a,c:s,C:l,rkrec:i}}function YI(e,t){for(var r=e.l+t-2,a=e.read_shift(2),s=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var l=e.read_shift(2);if(i.length!=l-s+1)throw new Error("MulBlank length mismatch");return{r:a,c:s,C:l,ixfe:i}}function XI(e,t,r,a){var s={},i=e.read_shift(4),l=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return s.patternType=_5[o>>26],a.cellStyles&&(s.alc=i&7,s.fWrap=i>>3&1,s.alcV=i>>4&7,s.fJustLast=i>>7&1,s.trot=i>>8&255,s.cIndent=i>>16&15,s.fShrinkToFit=i>>20&1,s.iReadOrder=i>>22&2,s.fAtrNum=i>>26&1,s.fAtrFnt=i>>27&1,s.fAtrAlc=i>>28&1,s.fAtrBdr=i>>29&1,s.fAtrPat=i>>30&1,s.fAtrProt=i>>31&1,s.dgLeft=l&15,s.dgRight=l>>4&15,s.dgTop=l>>8&15,s.dgBottom=l>>12&15,s.icvLeft=l>>16&127,s.icvRight=l>>23&127,s.grbitDiag=l>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=c&127,s.icvBack=c>>7&127,s.fsxButton=c>>14&1),s}function qI(e,t,r){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,t-=6,a.data=XI(e,t,a.fStyle,r),a}function Pv(e,t,r,a){var s=r&&r.biff==5;a||(a=pe(s?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&s&&(i|=1024),a.write_shift(4,i),a.write_shift(4,0),s||a.write_shift(4,0),a.write_shift(2,0),a}function ZI(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function JI(e){var t=pe(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Ov(e,t,r){var a=zn(e);(r.biff==2||t==9)&&++e.l;var s=tI(e);return a.val=s,a.t=s===!0||s===!1?"b":"e",a}function QI(e,t,r,a,s,i){var l=pe(8);return ci(e,t,a,l),TN(r,i,l),l}function eL(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=zn(e),s=Zr(e);return a.val=s,a}function tL(e,t,r,a){var s=pe(14);return ci(e,t,a,s),li(r,s),s}var Iv=uI;function rL(e,t,r){var a=e.l+t,s=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,s];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var l=oi(e,i),o=[];a>e.l;)o.push(uc(e));return[i,s,l,o]}function Lv(e,t,r){var a=e.read_shift(2),s,i={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return r.sbcch===14849&&(s=hI(e,t-2,r)),i.body=s||e.read_shift(t-2),typeof s=="string"&&(i.Name=s),i}var aL=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Bv(e,t,r){var a=e.l+t,s=e.read_shift(2),i=e.read_shift(1),l=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var d=oi(e,l,r);s&32&&(d=aL[d.charCodeAt(0)]);var u=a-e.l;r&&r.biff==2&&--u;var f=a==e.l||o===0||!(u>0)?[]:v7(e,u,r,o);return{chKey:i,Name:d,itab:c,rgce:f}}function PN(e,t,r){if(r.biff<8)return nL(e,t,r);for(var a=[],s=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)a.push(fI(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return a}function nL(e,t,r){e[e.l+1]==3&&e[e.l]++;var a=dc(e,t,r);return a.charCodeAt(0)==3?a.slice(1):a}function sL(e,t,r){if(r.biff<8){e.l+=t;return}var a=e.read_shift(2),s=e.read_shift(2),i=oi(e,a,r),l=oi(e,s,r);return[i,l]}function iL(e,t,r){var a=RN(e);e.l++;var s=e.read_shift(1);return t-=8,[y7(e,t,r),s,a]}function zv(e,t,r){var a=mI(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[a,p7(e,t,r)]}function lL(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,a=e.read_shift(4);return[t,r,a]}function oL(e,t,r){if(!(r.biff<8)){var a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2),o=yi(e,0,r);return r.biff<8&&e.read_shift(1),[{r:a,c:s},o,l,i]}}function cL(e,t,r){return oL(e,t,r)}function dL(e,t){for(var r=[],a=e.read_shift(2);a--;)r.push(Du(e));return r}function uL(e){var t=pe(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)DN(e[r],t);return t}function fL(e,t,r){if(r&&r.biff<8)return mL(e,t,r);var a=MN(e),s=vI(e,t-22,a[1]);return{cmo:a,ft:s}}var hL={8:function(e,t){var r=e.l+t;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:a}}};function mL(e,t,r){e.l+=4;var a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var l=[];return l.push((hL[a]||ta)(e,t,r)),{cmo:[s,a,i],ft:l}}function xL(e,t,r){var a=e.l,s="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:l=nI(e,6,r);var o=e.read_shift(2);e.read_shift(2),Er(e,2);var c=e.read_shift(2);e.l+=c;for(var d=1;d<e.lens.length-1;++d){if(e.l-a!=e.lens[d])throw new Error("TxO: bad continue record");var u=e[e.l],f=oi(e,e.lens[d+1]-e.lens[d]-1);if(s+=f,s.length>=(u?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return e.l=a+t,{t:s}}catch{return e.l=a+t,{t:s}}}function pL(e,t){var r=Du(e);e.l+=16;var a=oI(e,t-24);return[r,a]}function gL(e){var t=pe(24),r=cr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(a[s],16));return Or([t,cI(e[1])])}function vL(e,t){e.read_shift(2);var r=Du(e),a=e.read_shift((t-10)/2,"dbcs-cont");return a=a.replace(oa,""),[r,a]}function yL(e){var t=e[1].Tooltip,r=pe(10+2*(t.length+1));r.write_shift(2,2048);var a=cr(e[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function bL(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=jv[r]||r,r=e.read_shift(2),t[1]=jv[r]||r,t}function wL(e){return e||(e=pe(4)),e.write_shift(2,1),e.write_shift(2,1),e}function kL(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(CN(e));return r}function NL(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(CN(e));return r}function jL(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function ON(e,t,r){if(!r.cellStyles)return ta(e,t);var a=r&&r.biff>=12?4:2,s=e.read_shift(a),i=e.read_shift(a),l=e.read_shift(a),o=e.read_shift(a),c=e.read_shift(2);a==2&&(e.l+=2);var d={s,e:i,w:l,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(d.level=c>>8&7),d}function EL(e,t){var r=pe(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var a=0;return e.hidden&&(a|=1),r.write_shift(1,a),a=e.level||0,r.write_shift(1,a),r.write_shift(2,0),r}function SL(e,t){var r={};return t<32||(e.l+=16,r.header=Zr(e),r.footer=Zr(e),e.l+=2),r}function TL(e,t,r){var a={area:!1};if(r.biff!=5)return e.l+=t,a;var s=e.read_shift(1);return e.l+=3,s&16&&(a.area=!0),a}function AL(e){for(var t=pe(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var _L=zn,CL=SN,FL=uc;function DL(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),s={fmt:t,env:r,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,s}function RL(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var a=zn(e);++e.l;var s=yi(e,t-7,r);return a.t="str",a.val=s,a}function ML(e){var t=zn(e);++e.l;var r=Zr(e);return t.t="n",t.val=r,t}function PL(e,t,r){var a=pe(15);return xc(a,e,t),a.write_shift(8,r,"f"),a}function OL(e){var t=zn(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function IL(e,t,r){var a=pe(9);return xc(a,e,t),a.write_shift(2,r),a}function LL(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function BL(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function zL(e,t,r){var a=e.l+t,s=zn(e),i=e.read_shift(2),l=oi(e,i,r);return e.l=a,s.t="str",s.val=l,s}var UL=[2,3,48,49,131,139,140,245],q0=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=_u({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var d=[],u=ws(1);switch(c.type){case"base64":u=Ea(_a(o));break;case"binary":u=Ea(o);break;case"buffer":case"array":u=o;break}Ur(u,0);var f=u.read_shift(1),h=!!(f&136),m=!1,x=!1;switch(f){case 2:break;case 3:break;case 48:m=!0,h=!0;break;case 49:m=!0,h=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var p=0,g=521;f==2&&(p=u.read_shift(2)),u.l+=3,f!=2&&(p=u.read_shift(4)),p>1048576&&(p=1e6),f!=2&&(g=u.read_shift(2));var y=u.read_shift(2),N=c.codepage||1252;f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(N=e[u[u.l]]),u.l+=1,u.l+=2),x&&(u.l+=36);for(var v=[],S={},_=Math.min(u.length,f==2?521:g-10-(m?264:0)),F=x?32:11;u.l<_&&u[u.l]!=13;)switch(S={},S.name=Ro.utils.decode(N,u.slice(u.l,u.l+F)).replace(/[\u0000\r\n].*$/g,""),u.l+=F,S.type=String.fromCharCode(u.read_shift(1)),f!=2&&!x&&(S.offset=u.read_shift(4)),S.len=u.read_shift(1),f==2&&(S.offset=u.read_shift(2)),S.dec=u.read_shift(1),S.name.length&&v.push(S),f!=2&&(u.l+=x?13:14),S.type){case"B":(!m||S.len!=8)&&c.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+S.type)}if(u[u.l]!==13&&(u.l=g-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=g;var k=0,j=0;for(d[0]=[],j=0;j!=v.length;++j)d[0][j]=v[j].name;for(;p-- >0;){if(u[u.l]===42){u.l+=y;continue}for(++u.l,d[++k]=[],j=0,j=0;j!=v.length;++j){var w=u.slice(u.l,u.l+v[j].len);u.l+=v[j].len,Ur(w,0);var E=Ro.utils.decode(N,w);switch(v[j].type){case"C":E.trim().length&&(d[k][j]=E.replace(/\s+$/,""));break;case"D":E.length===8?d[k][j]=new Date(+E.slice(0,4),+E.slice(4,6)-1,+E.slice(6,8)):d[k][j]=E;break;case"F":d[k][j]=parseFloat(E.trim());break;case"+":case"I":d[k][j]=x?w.read_shift(-4,"i")^2147483648:w.read_shift(4,"i");break;case"L":switch(E.trim().toUpperCase()){case"Y":case"T":d[k][j]=!0;break;case"N":case"F":d[k][j]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+E+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));d[k][j]="##MEMO##"+(x?parseInt(E.trim(),10):w.read_shift(4));break;case"N":E=E.replace(/\u0000/g,"").trim(),E&&E!="."&&(d[k][j]=+E||0);break;case"@":d[k][j]=new Date(w.read_shift(-8,"f")-621356832e5);break;case"T":d[k][j]=new Date((w.read_shift(4)-2440588)*864e5+w.read_shift(4));break;case"Y":d[k][j]=w.read_shift(4,"i")/1e4+w.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[k][j]=-w.read_shift(-8,"f");break;case"B":if(m&&v[j].len==8){d[k][j]=w.read_shift(8,"f");break}case"G":case"P":w.l+=v[j].len;break;case"0":if(v[j].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+v[j].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return c&&c.sheetRows&&(d=d.slice(0,c.sheetRows)),c.DBF=v,d}function a(o,c){var d=c||{};d.dateNF||(d.dateNF="yyyymmdd");var u=jl(r(o,d),d);return u["!cols"]=d.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete d.DBF,u}function s(o,c){try{return Cs(a(o,c),c)}catch(d){if(c&&c.WTF)throw d}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function l(o,c){var d=c||{};if(+d.codepage>=0&&sn(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var u=xa(),f=Wd(o,{header:1,raw:!0,cellDates:!0}),h=f[0],m=f.slice(1),x=o["!cols"]||[],p=0,g=0,y=0,N=1;for(p=0;p<h.length;++p){if(((x[p]||{}).DBF||{}).name){h[p]=x[p].DBF.name,++y;continue}if(h[p]!=null){if(++y,typeof h[p]=="number"&&(h[p]=h[p].toString(10)),typeof h[p]!="string")throw new Error("DBF Invalid column name "+h[p]+" |"+typeof h[p]+"|");if(h.indexOf(h[p])!==p){for(g=0;g<1024;++g)if(h.indexOf(h[p]+"_"+g)==-1){h[p]+="_"+g;break}}}}var v=It(o["!ref"]),S=[],_=[],F=[];for(p=0;p<=v.e.c-v.s.c;++p){var k="",j="",w=0,E=[];for(g=0;g<m.length;++g)m[g][p]!=null&&E.push(m[g][p]);if(E.length==0||h[p]==null){S[p]="?";continue}for(g=0;g<E.length;++g){switch(typeof E[g]){case"number":j="B";break;case"string":j="C";break;case"boolean":j="L";break;case"object":j=E[g]instanceof Date?"D":"C";break;default:j="C"}w=Math.max(w,String(E[g]).length),k=k&&k!=j?"C":j}w>250&&(w=250),j=((x[p]||{}).DBF||{}).type,j=="C"&&x[p].DBF.len>w&&(w=x[p].DBF.len),k=="B"&&j=="N"&&(k="N",F[p]=x[p].DBF.dec,w=x[p].DBF.len),_[p]=k=="C"||j=="N"?w:i[k]||0,N+=_[p],S[p]=k}var A=u.next(32);for(A.write_shift(4,318902576),A.write_shift(4,m.length),A.write_shift(2,296+32*y),A.write_shift(2,N),p=0;p<4;++p)A.write_shift(4,0);for(A.write_shift(4,0|(+t[E2]||3)<<8),p=0,g=0;p<h.length;++p)if(h[p]!=null){var D=u.next(32),W=(h[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);D.write_shift(1,W,"sbcs"),D.write_shift(1,S[p]=="?"?"C":S[p],"sbcs"),D.write_shift(4,g),D.write_shift(1,_[p]||i[S[p]]||0),D.write_shift(1,F[p]||0),D.write_shift(1,2),D.write_shift(4,0),D.write_shift(1,0),D.write_shift(4,0),D.write_shift(4,0),g+=_[p]||i[S[p]]||0}var re=u.next(264);for(re.write_shift(4,13),p=0;p<65;++p)re.write_shift(4,0);for(p=0;p<m.length;++p){var U=u.next(N);for(U.write_shift(1,0),g=0;g<h.length;++g)if(h[g]!=null)switch(S[g]){case"L":U.write_shift(1,m[p][g]==null?63:m[p][g]?84:70);break;case"B":U.write_shift(8,m[p][g]||0,"f");break;case"N":var M="0";for(typeof m[p][g]=="number"&&(M=m[p][g].toFixed(F[g]||0)),y=0;y<_[g]-M.length;++y)U.write_shift(1,32);U.write_shift(1,M,"sbcs");break;case"D":m[p][g]?(U.write_shift(4,("0000"+m[p][g].getFullYear()).slice(-4),"sbcs"),U.write_shift(2,("00"+(m[p][g].getMonth()+1)).slice(-2),"sbcs"),U.write_shift(2,("00"+m[p][g].getDate()).slice(-2),"sbcs")):U.write_shift(8,"00000000","sbcs");break;case"C":var Y=String(m[p][g]!=null?m[p][g]:"").slice(0,_[g]);for(U.write_shift(1,Y,"sbcs"),y=0;y<_[g]-Y.length;++y)U.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:s,to_sheet:a,from_sheet:l}})(),IN=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+gr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,m){var x=e[m];return typeof x=="number"?Zg(x):x},a=function(h,m,x){var p=m.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return p==59?h:Zg(p)};e["|"]=254;function s(h,m){switch(m.type){case"base64":return i(_a(h),m);case"binary":return i(h,m);case"buffer":return i(Nt&&Buffer.isBuffer(h)?h.toString("binary"):_s(h),m);case"array":return i(ii(h),m)}throw new Error("Unrecognized type "+m.type)}function i(h,m){var x=h.split(/[\n\r]+/),p=-1,g=-1,y=0,N=0,v=[],S=[],_=null,F={},k=[],j=[],w=[],E=0,A;for(+m.codepage>=0&&sn(+m.codepage);y!==x.length;++y){E=0;var D=x[y].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),W=D.replace(/;;/g,"\0").split(";").map(function(X){return X.replace(/\u0000/g,";")}),re=W[0],U;if(D.length>0)switch(re){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":W[1].charAt(0)=="P"&&S.push(D.slice(3).replace(/;;/g,";"));break;case"C":var M=!1,Y=!1,Q=!1,B=!1,V=-1,P=-1;for(N=1;N<W.length;++N)switch(W[N].charAt(0)){case"A":break;case"X":g=parseInt(W[N].slice(1))-1,Y=!0;break;case"Y":for(p=parseInt(W[N].slice(1))-1,Y||(g=0),A=v.length;A<=p;++A)v[A]=[];break;case"K":U=W[N].slice(1),U.charAt(0)==='"'?U=U.slice(1,U.length-1):U==="TRUE"?U=!0:U==="FALSE"?U=!1:isNaN(un(U))?isNaN(ol(U).getDate())||(U=Qt(U)):(U=un(U),_!==null&&kl(_)&&(U=Fu(U))),M=!0;break;case"E":B=!0;var T=Zi(W[N].slice(1),{r:p,c:g});v[p][g]=[v[p][g],T];break;case"S":Q=!0,v[p][g]=[v[p][g],"S5S"];break;case"G":break;case"R":V=parseInt(W[N].slice(1))-1;break;case"C":P=parseInt(W[N].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+D)}if(M&&(v[p][g]&&v[p][g].length==2?v[p][g][0]=U:v[p][g]=U,_=null),Q){if(B)throw new Error("SYLK shared formula cannot have own formula");var R=V>-1&&v[V][P];if(!R||!R[1])throw new Error("SYLK shared formula cannot find base");v[p][g][1]=tj(R[1],{r:p-V,c:g-P})}break;case"F":var L=0;for(N=1;N<W.length;++N)switch(W[N].charAt(0)){case"X":g=parseInt(W[N].slice(1))-1,++L;break;case"Y":for(p=parseInt(W[N].slice(1))-1,A=v.length;A<=p;++A)v[A]=[];break;case"M":E=parseInt(W[N].slice(1))/20;break;case"F":break;case"G":break;case"P":_=S[parseInt(W[N].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(w=W[N].slice(1).split(" "),A=parseInt(w[0],10);A<=parseInt(w[1],10);++A)E=parseInt(w[2],10),j[A-1]=E===0?{hidden:!0}:{wch:E},ks(j[A-1]);break;case"C":g=parseInt(W[N].slice(1))-1,j[g]||(j[g]={});break;case"R":p=parseInt(W[N].slice(1))-1,k[p]||(k[p]={}),E>0?(k[p].hpt=E,k[p].hpx=dl(E)):E===0&&(k[p].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+D)}L<1&&(_=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+D)}}return k.length>0&&(F["!rows"]=k),j.length>0&&(F["!cols"]=j),m&&m.sheetRows&&(v=v.slice(0,m.sheetRows)),[v,F]}function l(h,m){var x=s(h,m),p=x[0],g=x[1],y=jl(p,m);return gr(g).forEach(function(N){y[N]=g[N]}),y}function o(h,m){return Cs(l(h,m),m)}function c(h,m,x,p){var g="C;Y"+(x+1)+";X"+(p+1)+";K";switch(h.t){case"n":g+=h.v||0,h.f&&!h.F&&(g+=";E"+ux(h.f,{r:x,c:p}));break;case"b":g+=h.v?"TRUE":"FALSE";break;case"e":g+=h.w||h.v;break;case"d":g+='"'+(h.w||h.v)+'"';break;case"s":g+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function d(h,m){m.forEach(function(x,p){var g="F;W"+(p+1)+" "+(p+1)+" ";x.hidden?g+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=Uo(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=Vo(x.wpx)),typeof x.wch=="number"&&(g+=Math.round(x.wch))),g.charAt(g.length-1)!=" "&&h.push(g)})}function u(h,m){m.forEach(function(x,p){var g="F;";x.hidden?g+="M0;":x.hpt?g+="M"+20*x.hpt+";":x.hpx&&(g+="M"+20*Ho(x.hpx)+";"),g.length>2&&h.push(g+"R"+(p+1))})}function f(h,m){var x=["ID;PWXL;N;E"],p=[],g=It(h["!ref"]),y,N=Array.isArray(h),v=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),h["!cols"]&&d(x,h["!cols"]),h["!rows"]&&u(x,h["!rows"]),x.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var S=g.s.r;S<=g.e.r;++S)for(var _=g.s.c;_<=g.e.c;++_){var F=ct({r:S,c:_});y=N?(h[S]||[])[_]:h[F],!(!y||y.v==null&&(!y.f||y.F))&&p.push(c(y,h,S,_))}return x.join(v)+v+p.join(v)+v+"E"+v}return{to_workbook:o,to_sheet:l,from_sheet:f}})(),LN=(function(){function e(i,l){switch(l.type){case"base64":return t(_a(i),l);case"binary":return t(i,l);case"buffer":return t(Nt&&Buffer.isBuffer(i)?i.toString("binary"):_s(i),l);case"array":return t(ii(i),l)}throw new Error("Unrecognized type "+l.type)}function t(i,l){for(var o=i.split(`
`),c=-1,d=-1,u=0,f=[];u!==o.length;++u){if(o[u].trim()==="BOT"){f[++c]=[],d=0;continue}if(!(c<0)){var h=o[u].trim().split(","),m=h[0],x=h[1];++u;for(var p=o[u]||"";(p.match(/["]/g)||[]).length&1&&u<o.length-1;)p+=`
`+o[++u];switch(p=p.trim(),+m){case-1:if(p==="BOT"){f[++c]=[],d=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?f[c][d]=!0:p==="FALSE"?f[c][d]=!1:isNaN(un(x))?isNaN(ol(x).getDate())?f[c][d]=x:f[c][d]=Qt(x):f[c][d]=un(x),++d;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),f[c][d++]=p!==""?p:null;break}if(p==="EOD")break}}return l&&l.sheetRows&&(f=f.slice(0,l.sheetRows)),f}function r(i,l){return jl(e(i,l),l)}function a(i,l){return Cs(r(i,l),l)}var s=(function(){var i=function(c,d,u,f,h){c.push(d),c.push(u+","+f),c.push('"'+h.replace(/"/g,'""')+'"')},l=function(c,d,u,f){c.push(d+","+u),c.push(d==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var d=[],u=It(c["!ref"]),f,h=Array.isArray(c);i(d,"TABLE",0,1,"sheetjs"),i(d,"VECTORS",0,u.e.r-u.s.r+1,""),i(d,"TUPLES",0,u.e.c-u.s.c+1,""),i(d,"DATA",0,0,"");for(var m=u.s.r;m<=u.e.r;++m){l(d,-1,0,"BOT");for(var x=u.s.c;x<=u.e.c;++x){var p=ct({r:m,c:x});if(f=h?(c[m]||[])[x]:c[p],!f){l(d,1,0,"");continue}switch(f.t){case"n":var g=f.w;!g&&f.v!=null&&(g=f.v),g==null?f.f&&!f.F?l(d,1,0,"="+f.f):l(d,1,0,""):l(d,0,g,"V");break;case"b":l(d,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":l(d,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Ya(f.z||it[14],Mr(Qt(f.v)))),l(d,0,f.w,"V");break;default:l(d,1,0,"")}}}l(d,-1,0,"EOD");var y=`\r
`,N=d.join(y);return N}})();return{to_workbook:a,to_sheet:r,from_sheet:s}})(),BN=(function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var m=f.split(`
`),x=-1,p=-1,g=0,y=[];g!==m.length;++g){var N=m[g].trim().split(":");if(N[0]==="cell"){var v=cr(N[1]);if(y.length<=v.r)for(x=y.length;x<=v.r;++x)y[x]||(y[x]=[]);switch(x=v.r,p=v.c,N[2]){case"t":y[x][p]=e(N[3]);break;case"v":y[x][p]=+N[3];break;case"vtf":var S=N[N.length-1];case"vtc":switch(N[3]){case"nl":y[x][p]=!!+N[4];break;default:y[x][p]=+N[4];break}N[2]=="vtf"&&(y[x][p]=[y[x][p],S])}}}return h&&h.sheetRows&&(y=y.slice(0,h.sheetRows)),y}function a(f,h){return jl(r(f,h),h)}function s(f,h){return Cs(a(f,h),h)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function d(f){if(!f||!f["!ref"])return"";for(var h=[],m=[],x,p="",g=pa(f["!ref"]),y=Array.isArray(f),N=g.s.r;N<=g.e.r;++N)for(var v=g.s.c;v<=g.e.c;++v)if(p=ct({r:N,c:v}),x=y?(f[N]||[])[v]:f[p],!(!x||x.v==null||x.t==="z")){switch(m=["cell",p,"t"],x.t){case"s":case"str":m.push(t(x.v));break;case"n":x.f?(m[2]="vtf",m[3]="n",m[4]=x.v,m[5]=t(x.f)):(m[2]="v",m[3]=x.v);break;case"b":m[2]="vt"+(x.f?"f":"c"),m[3]="nl",m[4]=x.v?"1":"0",m[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var S=Mr(Qt(x.v));m[2]="vtc",m[3]="nd",m[4]=""+S,m[5]=x.w||Ya(x.z||it[14],S);break;case"e":continue}h.push(m.join(":"))}return h.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function u(f){return[i,l,o,l,d(f),c].join(`
`)}return{to_workbook:s,to_sheet:a,from_sheet:u}})(),cl=(function(){function e(u,f,h,m,x){x.raw?f[h][m]=u:u===""||(u==="TRUE"?f[h][m]=!0:u==="FALSE"?f[h][m]=!1:isNaN(un(u))?isNaN(ol(u).getDate())?f[h][m]=u:f[h][m]=Qt(u):f[h][m]=un(u))}function t(u,f){var h=f||{},m=[];if(!u||u.length===0)return m;for(var x=u.split(/[\r\n]/),p=x.length-1;p>=0&&x[p].length===0;)--p;for(var g=10,y=0,N=0;N<=p;++N)y=x[N].indexOf(" "),y==-1?y=x[N].length:y++,g=Math.max(g,y);for(N=0;N<=p;++N){m[N]=[];var v=0;for(e(x[N].slice(0,g).trim(),m,N,v,h),v=1;v<=(x[N].length-g)/10+1;++v)e(x[N].slice(g+(v-1)*10,g+v*10).trim(),m,N,v,h)}return h.sheetRows&&(m=m.slice(0,h.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function s(u){for(var f={},h=!1,m=0,x=0;m<u.length;++m)(x=u.charCodeAt(m))==34?h=!h:!h&&x in r&&(f[x]=(f[x]||0)+1);x=[];for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&x.push([f[m],m]);if(!x.length){f=a;for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&x.push([f[m],m])}return x.sort(function(p,g){return p[0]-g[0]||a[p[1]]-a[g[1]]}),r[x.pop()[1]]||44}function i(u,f){var h=f||{},m="",x=h.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(m=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(m=u.charAt(4),u=u.slice(6)):m=s(u.slice(0,1024)):h&&h.FS?m=h.FS:m=s(u.slice(0,1024));var g=0,y=0,N=0,v=0,S=0,_=m.charCodeAt(0),F=!1,k=0,j=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var w=h.dateNF!=null?TO(h.dateNF):null;function E(){var A=u.slice(v,S),D={};if(A.charAt(0)=='"'&&A.charAt(A.length-1)=='"'&&(A=A.slice(1,-1).replace(/""/g,'"')),A.length===0)D.t="z";else if(h.raw)D.t="s",D.v=A;else if(A.trim().length===0)D.t="s",D.v=A;else if(A.charCodeAt(0)==61)A.charCodeAt(1)==34&&A.charCodeAt(A.length-1)==34?(D.t="s",D.v=A.slice(2,-1).replace(/""/g,'"')):rz(A)?(D.t="n",D.f=A.slice(1)):(D.t="s",D.v=A);else if(A=="TRUE")D.t="b",D.v=!0;else if(A=="FALSE")D.t="b",D.v=!1;else if(!isNaN(N=un(A)))D.t="n",h.cellText!==!1&&(D.w=A),D.v=N;else if(!isNaN(ol(A).getDate())||w&&A.match(w)){D.z=h.dateNF||it[14];var W=0;w&&A.match(w)&&(A=AO(A,h.dateNF,A.match(w)||[]),W=1),h.cellDates?(D.t="d",D.v=Qt(A,W)):(D.t="n",D.v=Mr(Qt(A,W))),h.cellText!==!1&&(D.w=Ya(D.z,D.v instanceof Date?Mr(D.v):D.v)),h.cellNF||delete D.z}else D.t="s",D.v=A;if(D.t=="z"||(h.dense?(x[g]||(x[g]=[]),x[g][y]=D):x[ct({c:y,r:g})]=D),v=S+1,j=u.charCodeAt(v),p.e.c<y&&(p.e.c=y),p.e.r<g&&(p.e.r=g),k==_)++y;else if(y=0,++g,h.sheetRows&&h.sheetRows<=g)return!0}e:for(;S<u.length;++S)switch(k=u.charCodeAt(S)){case 34:j===34&&(F=!F);break;case _:case 10:case 13:if(!F&&E())break e;break}return S-v>0&&E(),x["!ref"]=pt(p),x}function l(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?i(u,f):jl(t(u,f),f)}function o(u,f){var h="",m=f.type=="string"?[0,0,0,0]:yx(u,f);switch(f.type){case"base64":h=_a(u);break;case"binary":h=u;break;case"buffer":f.codepage==65001?h=u.toString("utf8"):f.codepage&&typeof Ro<"u"||(h=Nt&&Buffer.isBuffer(u)?u.toString("binary"):_s(u));break;case"array":h=ii(u);break;case"string":h=u;break;default:throw new Error("Unrecognized type "+f.type)}return m[0]==239&&m[1]==187&&m[2]==191?h=Gt(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=Gt(h):f.type=="binary"&&typeof Ro<"u",h.slice(0,19)=="socialcalc:version:"?BN.to_sheet(f.type=="string"?h:Gt(h),f):l(h,f)}function c(u,f){return Cs(o(u,f),f)}function d(u){for(var f=[],h=It(u["!ref"]),m,x=Array.isArray(u),p=h.s.r;p<=h.e.r;++p){for(var g=[],y=h.s.c;y<=h.e.c;++y){var N=ct({r:p,c:y});if(m=x?(u[p]||[])[y]:u[N],!m||m.v==null){g.push("          ");continue}for(var v=(m.w||(qn(m),m.w)||"").slice(0,10);v.length<10;)v+=" ";g.push(v+(y===0?" ":""))}f.push(g.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:d}})();function VL(e,t){var r=t||{},a=!!r.WTF;r.WTF=!0;try{var s=IN.to_workbook(e,r);return r.WTF=a,s}catch(i){if(r.WTF=a,!i.message.match(/SYLK bad record ID/)&&a)throw i;return cl.to_workbook(e,t)}}var Zs=(function(){function e(T,R,L){if(T){Ur(T,T.l||0);for(var X=L.Enum||V;T.l<T.length;){var J=T.read_shift(2),te=X[J]||X[65535],G=T.read_shift(2),Z=T.l+G,ae=te.f&&te.f(T,G,L);if(T.l=Z,R(ae,te,J))return}}}function t(T,R){switch(R.type){case"base64":return r(Ea(_a(T)),R);case"binary":return r(Ea(T),R);case"buffer":case"array":return r(T,R)}throw"Unsupported type "+R.type}function r(T,R){if(!T)return T;var L=R||{},X=L.dense?[]:{},J="Sheet1",te="",G=0,Z={},ae=[],de=[],z={s:{r:0,c:0},e:{r:0,c:0}},Ee=L.sheetRows||0;if(T[2]==0&&(T[3]==8||T[3]==9)&&T.length>=16&&T[14]==5&&T[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(T[2]==2)L.Enum=V,e(T,function(ge,Fe,Ie){switch(Ie){case 0:L.vers=ge,ge>=4096&&(L.qpro=!0);break;case 6:z=ge;break;case 204:ge&&(te=ge);break;case 222:te=ge;break;case 15:case 51:L.qpro||(ge[1].v=ge[1].v.slice(1));case 13:case 14:case 16:Ie==14&&(ge[2]&112)==112&&(ge[2]&15)>1&&(ge[2]&15)<15&&(ge[1].z=L.dateNF||it[14],L.cellDates&&(ge[1].t="d",ge[1].v=Fu(ge[1].v))),L.qpro&&ge[3]>G&&(X["!ref"]=pt(z),Z[J]=X,ae.push(J),X=L.dense?[]:{},z={s:{r:0,c:0},e:{r:0,c:0}},G=ge[3],J=te||"Sheet"+(G+1),te="");var Ze=L.dense?(X[ge[0].r]||[])[ge[0].c]:X[ct(ge[0])];if(Ze){Ze.t=ge[1].t,Ze.v=ge[1].v,ge[1].z!=null&&(Ze.z=ge[1].z),ge[1].f!=null&&(Ze.f=ge[1].f);break}L.dense?(X[ge[0].r]||(X[ge[0].r]=[]),X[ge[0].r][ge[0].c]=ge[1]):X[ct(ge[0])]=ge[1];break}},L);else if(T[2]==26||T[2]==14)L.Enum=P,T[2]==14&&(L.qpro=!0,T.l=0),e(T,function(ge,Fe,Ie){switch(Ie){case 204:J=ge;break;case 22:ge[1].v=ge[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ge[3]>G&&(X["!ref"]=pt(z),Z[J]=X,ae.push(J),X=L.dense?[]:{},z={s:{r:0,c:0},e:{r:0,c:0}},G=ge[3],J="Sheet"+(G+1)),Ee>0&&ge[0].r>=Ee)break;L.dense?(X[ge[0].r]||(X[ge[0].r]=[]),X[ge[0].r][ge[0].c]=ge[1]):X[ct(ge[0])]=ge[1],z.e.c<ge[0].c&&(z.e.c=ge[0].c),z.e.r<ge[0].r&&(z.e.r=ge[0].r);break;case 27:ge[14e3]&&(de[ge[14e3][0]]=ge[14e3][1]);break;case 1537:de[ge[0]]=ge[1],ge[0]==G&&(J=ge[1]);break}},L);else throw new Error("Unrecognized LOTUS BOF "+T[2]);if(X["!ref"]=pt(z),Z[te||J]=X,ae.push(te||J),!de.length)return{SheetNames:ae,Sheets:Z};for(var ue={},Ce=[],ve=0;ve<de.length;++ve)Z[ae[ve]]?(Ce.push(de[ve]||ae[ve]),ue[de[ve]]=Z[de[ve]]||Z[ae[ve]]):(Ce.push(de[ve]),ue[de[ve]]={"!ref":"A1"});return{SheetNames:Ce,Sheets:ue}}function a(T,R){var L=R||{};if(+L.codepage>=0&&sn(+L.codepage),L.type=="string")throw new Error("Cannot write WK1 to JS string");var X=xa(),J=It(T["!ref"]),te=Array.isArray(T),G=[];Pe(X,0,i(1030)),Pe(X,6,c(J));for(var Z=Math.min(J.e.r,8191),ae=J.s.r;ae<=Z;++ae)for(var de=br(ae),z=J.s.c;z<=J.e.c;++z){ae===J.s.r&&(G[z]=or(z));var Ee=G[z]+de,ue=te?(T[ae]||[])[z]:T[Ee];if(!(!ue||ue.t=="z"))if(ue.t=="n")(ue.v|0)==ue.v&&ue.v>=-32768&&ue.v<=32767?Pe(X,13,m(ae,z,ue.v)):Pe(X,14,p(ae,z,ue.v));else{var Ce=qn(ue);Pe(X,15,f(ae,z,Ce.slice(0,239)))}}return Pe(X,1),X.end()}function s(T,R){var L=R||{};if(+L.codepage>=0&&sn(+L.codepage),L.type=="string")throw new Error("Cannot write WK3 to JS string");var X=xa();Pe(X,0,l(T));for(var J=0,te=0;J<T.SheetNames.length;++J)(T.Sheets[T.SheetNames[J]]||{})["!ref"]&&Pe(X,27,B(T.SheetNames[J],te++));var G=0;for(J=0;J<T.SheetNames.length;++J){var Z=T.Sheets[T.SheetNames[J]];if(!(!Z||!Z["!ref"])){for(var ae=It(Z["!ref"]),de=Array.isArray(Z),z=[],Ee=Math.min(ae.e.r,8191),ue=ae.s.r;ue<=Ee;++ue)for(var Ce=br(ue),ve=ae.s.c;ve<=ae.e.c;++ve){ue===ae.s.r&&(z[ve]=or(ve));var ge=z[ve]+Ce,Fe=de?(Z[ue]||[])[ve]:Z[ge];if(!(!Fe||Fe.t=="z"))if(Fe.t=="n")Pe(X,23,E(ue,ve,G,Fe.v));else{var Ie=qn(Fe);Pe(X,22,k(ue,ve,G,Ie.slice(0,239)))}}++G}}return Pe(X,1),X.end()}function i(T){var R=pe(2);return R.write_shift(2,T),R}function l(T){var R=pe(26);R.write_shift(2,4096),R.write_shift(2,4),R.write_shift(4,0);for(var L=0,X=0,J=0,te=0;te<T.SheetNames.length;++te){var G=T.SheetNames[te],Z=T.Sheets[G];if(!(!Z||!Z["!ref"])){++J;var ae=pa(Z["!ref"]);L<ae.e.r&&(L=ae.e.r),X<ae.e.c&&(X=ae.e.c)}}return L>8191&&(L=8191),R.write_shift(2,L),R.write_shift(1,J),R.write_shift(1,X),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(1,1),R.write_shift(1,2),R.write_shift(4,0),R.write_shift(4,0),R}function o(T,R,L){var X={s:{c:0,r:0},e:{c:0,r:0}};return R==8&&L.qpro?(X.s.c=T.read_shift(1),T.l++,X.s.r=T.read_shift(2),X.e.c=T.read_shift(1),T.l++,X.e.r=T.read_shift(2),X):(X.s.c=T.read_shift(2),X.s.r=T.read_shift(2),R==12&&L.qpro&&(T.l+=2),X.e.c=T.read_shift(2),X.e.r=T.read_shift(2),R==12&&L.qpro&&(T.l+=2),X.s.c==65535&&(X.s.c=X.e.c=X.s.r=X.e.r=0),X)}function c(T){var R=pe(8);return R.write_shift(2,T.s.c),R.write_shift(2,T.s.r),R.write_shift(2,T.e.c),R.write_shift(2,T.e.r),R}function d(T,R,L){var X=[{c:0,r:0},{t:"n",v:0},0,0];return L.qpro&&L.vers!=20768?(X[0].c=T.read_shift(1),X[3]=T.read_shift(1),X[0].r=T.read_shift(2),T.l+=2):(X[2]=T.read_shift(1),X[0].c=T.read_shift(2),X[0].r=T.read_shift(2)),X}function u(T,R,L){var X=T.l+R,J=d(T,R,L);if(J[1].t="s",L.vers==20768){T.l++;var te=T.read_shift(1);return J[1].v=T.read_shift(te,"utf8"),J}return L.qpro&&T.l++,J[1].v=T.read_shift(X-T.l,"cstr"),J}function f(T,R,L){var X=pe(7+L.length);X.write_shift(1,255),X.write_shift(2,R),X.write_shift(2,T),X.write_shift(1,39);for(var J=0;J<X.length;++J){var te=L.charCodeAt(J);X.write_shift(1,te>=128?95:te)}return X.write_shift(1,0),X}function h(T,R,L){var X=d(T,R,L);return X[1].v=T.read_shift(2,"i"),X}function m(T,R,L){var X=pe(7);return X.write_shift(1,255),X.write_shift(2,R),X.write_shift(2,T),X.write_shift(2,L,"i"),X}function x(T,R,L){var X=d(T,R,L);return X[1].v=T.read_shift(8,"f"),X}function p(T,R,L){var X=pe(13);return X.write_shift(1,255),X.write_shift(2,R),X.write_shift(2,T),X.write_shift(8,L,"f"),X}function g(T,R,L){var X=T.l+R,J=d(T,R,L);if(J[1].v=T.read_shift(8,"f"),L.qpro)T.l=X;else{var te=T.read_shift(2);S(T.slice(T.l,T.l+te),J),T.l+=te}return J}function y(T,R,L){var X=R&32768;return R&=-32769,R=(X?T:0)+(R>=8192?R-16384:R),(X?"":"$")+(L?or(R):br(R))}var N={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},v=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function S(T,R){Ur(T,0);for(var L=[],X=0,J="",te="",G="",Z="";T.l<T.length;){var ae=T[T.l++];switch(ae){case 0:L.push(T.read_shift(8,"f"));break;case 1:te=y(R[0].c,T.read_shift(2),!0),J=y(R[0].r,T.read_shift(2),!1),L.push(te+J);break;case 2:{var de=y(R[0].c,T.read_shift(2),!0),z=y(R[0].r,T.read_shift(2),!1);te=y(R[0].c,T.read_shift(2),!0),J=y(R[0].r,T.read_shift(2),!1),L.push(de+z+":"+te+J)}break;case 3:if(T.l<T.length){console.error("WK1 premature formula end");return}break;case 4:L.push("("+L.pop()+")");break;case 5:L.push(T.read_shift(2));break;case 6:{for(var Ee="";ae=T[T.l++];)Ee+=String.fromCharCode(ae);L.push('"'+Ee.replace(/"/g,'""')+'"')}break;case 8:L.push("-"+L.pop());break;case 23:L.push("+"+L.pop());break;case 22:L.push("NOT("+L.pop()+")");break;case 20:case 21:Z=L.pop(),G=L.pop(),L.push(["AND","OR"][ae-20]+"("+G+","+Z+")");break;default:if(ae<32&&v[ae])Z=L.pop(),G=L.pop(),L.push(G+v[ae]+Z);else if(N[ae]){if(X=N[ae][1],X==69&&(X=T[T.l++]),X>L.length){console.error("WK1 bad formula parse 0x"+ae.toString(16)+":|"+L.join("|")+"|");return}var ue=L.slice(-X);L.length-=X,L.push(N[ae][0]+"("+ue.join(",")+")")}else return ae<=7?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=24?console.error("WK1 unsupported op "+ae.toString(16)):ae<=30?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=115?console.error("WK1 unsupported function opcode "+ae.toString(16)):console.error("WK1 unrecognized opcode "+ae.toString(16))}}L.length==1?R[1].f=""+L[0]:console.error("WK1 bad formula parse |"+L.join("|")+"|")}function _(T){var R=[{c:0,r:0},{t:"n",v:0},0];return R[0].r=T.read_shift(2),R[3]=T[T.l++],R[0].c=T[T.l++],R}function F(T,R){var L=_(T);return L[1].t="s",L[1].v=T.read_shift(R-4,"cstr"),L}function k(T,R,L,X){var J=pe(6+X.length);J.write_shift(2,T),J.write_shift(1,L),J.write_shift(1,R),J.write_shift(1,39);for(var te=0;te<X.length;++te){var G=X.charCodeAt(te);J.write_shift(1,G>=128?95:G)}return J.write_shift(1,0),J}function j(T,R){var L=_(T);L[1].v=T.read_shift(2);var X=L[1].v>>1;if(L[1].v&1)switch(X&7){case 0:X=(X>>3)*5e3;break;case 1:X=(X>>3)*500;break;case 2:X=(X>>3)/20;break;case 3:X=(X>>3)/200;break;case 4:X=(X>>3)/2e3;break;case 5:X=(X>>3)/2e4;break;case 6:X=(X>>3)/16;break;case 7:X=(X>>3)/64;break}return L[1].v=X,L}function w(T,R){var L=_(T),X=T.read_shift(4),J=T.read_shift(4),te=T.read_shift(2);if(te==65535)return X===0&&J===3221225472?(L[1].t="e",L[1].v=15):X===0&&J===3489660928?(L[1].t="e",L[1].v=42):L[1].v=0,L;var G=te&32768;return te=(te&32767)-16446,L[1].v=(1-G*2)*(J*Math.pow(2,te+32)+X*Math.pow(2,te)),L}function E(T,R,L,X){var J=pe(14);if(J.write_shift(2,T),J.write_shift(1,L),J.write_shift(1,R),X==0)return J.write_shift(4,0),J.write_shift(4,0),J.write_shift(2,65535),J;var te=0,G=0,Z=0,ae=0;return X<0&&(te=1,X=-X),G=Math.log2(X)|0,X/=Math.pow(2,G-31),ae=X>>>0,(ae&2147483648)==0&&(X/=2,++G,ae=X>>>0),X-=ae,ae|=2147483648,ae>>>=0,X*=Math.pow(2,32),Z=X>>>0,J.write_shift(4,Z),J.write_shift(4,ae),G+=16383+(te?32768:0),J.write_shift(2,G),J}function A(T,R){var L=w(T);return T.l+=R-14,L}function D(T,R){var L=_(T),X=T.read_shift(4);return L[1].v=X>>6,L}function W(T,R){var L=_(T),X=T.read_shift(8,"f");return L[1].v=X,L}function re(T,R){var L=W(T);return T.l+=R-10,L}function U(T,R){return T[T.l+R-1]==0?T.read_shift(R,"cstr"):""}function M(T,R){var L=T[T.l++];L>R-1&&(L=R-1);for(var X="";X.length<L;)X+=String.fromCharCode(T[T.l++]);return X}function Y(T,R,L){if(!(!L.qpro||R<21)){var X=T.read_shift(1);T.l+=17,T.l+=1,T.l+=2;var J=T.read_shift(R-21,"cstr");return[X,J]}}function Q(T,R){for(var L={},X=T.l+R;T.l<X;){var J=T.read_shift(2);if(J==14e3){for(L[J]=[0,""],L[J][0]=T.read_shift(2);T[T.l];)L[J][1]+=String.fromCharCode(T[T.l]),T.l++;T.l++}}return L}function B(T,R){var L=pe(5+T.length);L.write_shift(2,14e3),L.write_shift(2,R);for(var X=0;X<T.length;++X){var J=T.charCodeAt(X);L[L.l++]=J>127?95:J}return L[L.l++]=0,L}var V={0:{n:"BOF",f:Er},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:U},222:{n:"SHEETNAMELP",f:M},65535:{n:""}},P={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:F},23:{n:"NUMBER17",f:w},24:{n:"NUMBER18",f:j},25:{n:"FORMULA19",f:A},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Q},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:D},38:{n:"??"},39:{n:"NUMBER27",f:W},40:{n:"FORMULA28",f:re},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:U},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Y},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:s,to_workbook:t}})();function HL(e){var t={},r=e.match(ra),a=0,s=!1;if(r)for(;a!=r.length;++a){var i=dt(r[a]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=Om[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(i[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+i[0])}}return t}var $L=(function(){var e=Oo("t"),t=Oo("rPr");function r(i){var l=i.match(e);if(!l)return{t:"s",v:""};var o={t:"s",v:Ot(l[1])},c=i.match(t);return c&&(o.s=HL(c[1])),o}var a=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(l){return l.replace(a,"").split(s).map(r).filter(function(o){return o.v})}})(),KL=(function(){var t=/(\r\n|\n)/g;function r(s,i,l){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),i.push('<span style="'+o.join("")+'">'),s.b&&(i.push("<b>"),l.push("</b>")),s.i&&(i.push("<i>"),l.push("</i>")),s.strike&&(i.push("<s>"),l.push("</s>"));var c=s.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(i.push("<"+c+">"),l.push("</"+c+">")),l.push("</span>"),s}function a(s){var i=[[],s.v,[]];return s.v?(s.s&&r(s.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(a).join("")}})(),WL=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,GL=/<(?:\w+:)?r>/,YL=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function ix(e,t){var r=t?t.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=Ot(Gt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=Gt(e),r&&(a.h=Wm(a.t))):e.match(GL)&&(a.r=Gt(e),a.t=Ot(Gt((e.replace(YL,"").match(WL)||[]).join("").replace(ra,""))),r&&(a.h=KL($L(a.r)))),a):{t:""}}var XL=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,qL=/<(?:\w+:)?(?:si|sstItem)>/g,ZL=/<\/(?:\w+:)?(?:si|sstItem)>/;function JL(e,t){var r=[],a="";if(!e)return r;var s=e.match(XL);if(s){a=s[2].replace(qL,"").split(ZL);for(var i=0;i!=a.length;++i){var l=ix(a[i].trim(),t);l!=null&&(r[r.length]=l)}s=dt(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var QL=/^\s|\s$|[\t\n\r]/;function zN(e,t){if(!t.bookSST)return"";var r=[wr];r[r.length]=Me("sst",null,{xmlns:mi[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var s=e[a],i="<si>";s.r?i+=s.r:(i+="<t",s.t||(s.t=""),s.t.match(QL)&&(i+=' xml:space="preserve"'),i+=">"+Kt(s.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function e6(e){return[e.read_shift(4),e.read_shift(4)]}function t6(e,t){var r=[],a=!1;return Jn(e,function(i,l,o){switch(o){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(l.T,!a||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function r6(e,t){return t||(t=pe(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var a6=h5;function n6(e){var t=xa();we(t,159,r6(e));for(var r=0;r<e.length;++r)we(t,19,a6(e[r]));return we(t,160),t.end()}function UN(e){for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function Wn(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function s6(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Wn(e,4),t.U=Wn(e,4),t.W=Wn(e,4),t}function i6(e){for(var t=e.read_shift(4),r=e.l+t-4,a={},s=e.read_shift(4),i=[];s-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return a}function l6(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(i6(e));return t}function o6(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function c6(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Wn(e,4),t.U=Wn(e,4),t.W=Wn(e,4),t}function d6(e){var t=c6(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function VN(e,t){var r=e.l+t,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var s=!1;switch(a.AlgID){case 26126:case 26127:case 26128:s=a.Flags==36;break;case 26625:s=a.Flags==4;break;case 0:s=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,a}function HN(e,t){var r={},a=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,a),e.l=a,r}function u6(e){var t=Wn(e);switch(t.Minor){case 2:return[t.Minor,f6(e)];case 3:return[t.Minor,h6()];case 4:return[t.Minor,m6(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function f6(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),a=VN(e,r),s=HN(e,e.length-e.l);return{t:"Std",h:a,v:s}}function h6(){throw new Error("File is password-protected: ECMA-376 Extensible")}function m6(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),a={};return r.replace(ra,function(i){var l=dt(i);switch(Bn(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){a[o]=l[o]});break;case"<dataIntegrity":a.encryptedHmacKey=l.encryptedHmacKey,a.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(l);break;default:throw l[0]}}),a}function x6(e,t){var r={},a=r.EncryptionVersionInfo=Wn(e,4);if(t-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=VN(e,s),t-=s,r.EncryptionVerifier=HN(e,t),r}function p6(e){var t={},r=t.EncryptionVersionInfo=Wn(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function lx(e){var t=0,r,a=UN(e),s=a.length+1,i,l,o,c,d;for(r=ws(s),r[0]=a.length,i=1;i!=s;++i)r[i]=a[i-1];for(i=s-1;i>=0;--i)l=r[i],o=(t&16384)===0?0:1,c=t<<1&32767,d=o|c,t=d^l;return t^52811}var $N=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(l){return(l/2|l*128)&255},s=function(l,o){return a(l^o)},i=function(l){for(var o=t[l.length-1],c=104,d=l.length-1;d>=0;--d)for(var u=l[d],f=0;f!=7;++f)u&64&&(o^=r[c]),u*=2,--c;return o};return function(l){for(var o=UN(l),c=i(o),d=o.length,u=ws(16),f=0;f!=16;++f)u[f]=0;var h,m,x;for((d&1)===1&&(h=c>>8,u[d]=s(e[0],h),--d,h=c&255,m=o[o.length-1],u[d]=s(m,h));d>0;)--d,h=c>>8,u[d]=s(o[d],h),--d,h=c&255,u[d]=s(o[d],h);for(d=15,x=15-o.length;x>0;)h=c>>8,u[d]=s(e[x],h),--d,--x,h=c&255,u[d]=s(o[d],h),--d,--x;return u}})(),g6=function(e,t,r,a,s){s||(s=t),a||(a=$N(e));var i,l;for(i=0;i!=t.length;++i)l=t[i],l^=a[r],l=(l>>5|l<<3)&255,s[i]=l,++r;return[s,r,a]},v6=function(e){var t=0,r=$N(e);return function(a){var s=g6("",a,t,r);return t=s[1],s[0]}};function y6(e,t,r,a){var s={key:Er(e),verificationBytes:Er(e)};return r.password&&(s.verifier=lx(r.password)),a.valid=s.verificationBytes===s.verifier,a.valid&&(a.insitu=v6(r.password)),s}function b6(e,t,r){var a=r||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=p6(e):a.Data=x6(e,t),a}function w6(e,t,r){var a={Type:r.biff>=8?e.read_shift(2):0};return a.Type?b6(e,t-2,a):y6(e,r.biff>=8?t:t-2,r,a),a}var KN=(function(){function e(s,i){switch(i.type){case"base64":return t(_a(s),i);case"binary":return t(s,i);case"buffer":return t(Nt&&Buffer.isBuffer(s)?s.toString("binary"):_s(s),i);case"array":return t(ii(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){var l=i||{},o=l.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(u,f){Array.isArray(o)&&(o[f]=[]);for(var h=/\\\w+\b/g,m=0,x,p=-1;x=h.exec(u);){switch(x[0]){case"\\cell":var g=u.slice(m,h.lastIndex-x[0].length);if(g[0]==" "&&(g=g.slice(1)),++p,g.length){var y={v:g,t:"s"};Array.isArray(o)?o[f][p]=y:o[ct({r:f,c:p})]=y}break}m=h.lastIndex}p>d.e.c&&(d.e.c=p)}),o["!ref"]=pt(d),o}function r(s,i){return Cs(e(s,i),i)}function a(s){for(var i=["{\\rtf1\\ansi"],l=It(s["!ref"]),o,c=Array.isArray(s),d=l.s.r;d<=l.e.r;++d){i.push("\\trowd\\trautofit1");for(var u=l.s.c;u<=l.e.c;++u)i.push("\\cellx"+(u+1));for(i.push("\\pard\\intbl"),u=l.s.c;u<=l.e.c;++u){var f=ct({r:d,c:u});o=c?(s[d]||[])[u]:s[f],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(qn(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:a}})();function k6(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function zo(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function N6(e){var t=e[0]/255,r=e[1]/255,a=e[2]/255,s=Math.max(t,r,a),i=Math.min(t,r,a),l=s-i;if(l===0)return[0,0,t];var o=0,c=0,d=s+i;switch(c=l/(d>1?2-d:d),s){case t:o=((r-a)/l+6)%6;break;case r:o=(a-t)/l+2;break;case a:o=(t-r)/l+4;break}return[o/6,c,d/2]}function j6(e){var t=e[0],r=e[1],a=e[2],s=r*2*(a<.5?a:1-a),i=a-s/2,l=[i,i,i],o=6*t,c;if(r!==0)switch(o|0){case 0:case 6:c=s*o,l[0]+=s,l[1]+=c;break;case 1:c=s*(2-o),l[0]+=c,l[1]+=s;break;case 2:c=s*(o-2),l[1]+=s,l[2]+=c;break;case 3:c=s*(4-o),l[1]+=c,l[2]+=s;break;case 4:c=s*(o-4),l[2]+=s,l[0]+=c;break;case 5:c=s*(6-o),l[2]+=c,l[0]+=s;break}for(var d=0;d!=3;++d)l[d]=Math.round(l[d]*255);return l}function $d(e,t){if(t===0)return e;var r=N6(k6(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),zo(j6(r))}var WN=6,E6=15,S6=1,qr=WN;function Uo(e){return Math.floor((e+Math.round(128/qr)/256)*qr)}function Vo(e){return Math.floor((e-5)/qr*100+.5)/100}function Kd(e){return Math.round((e*qr+5)/qr*256)/256}function yf(e){return Kd(Vo(Uo(e)))}function ox(e){var t=Math.abs(e-yf(e)),r=qr;if(t>.005)for(qr=S6;qr<E6;++qr)Math.abs(e-yf(e))<=t&&(t=Math.abs(e-yf(e)),r=qr);qr=r}function ks(e){e.width?(e.wpx=Uo(e.width),e.wch=Vo(e.wpx),e.MDW=qr):e.wpx?(e.wch=Vo(e.wpx),e.width=Kd(e.wch),e.MDW=qr):typeof e.wch=="number"&&(e.width=Kd(e.wch),e.wpx=Uo(e.width),e.MDW=qr),e.customWidth&&delete e.customWidth}var T6=96,GN=T6;function Ho(e){return e*96/GN}function dl(e){return e*GN/96}var A6={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function _6(e,t,r,a){t.Borders=[];var s={},i=!1;(e[0].match(ra)||[]).forEach(function(l){var o=dt(l);switch(Bn(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=Zt(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=Zt(o.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+o[0]+" in borders")}})}function C6(e,t,r,a){t.Fills=[];var s={},i=!1;(e[0].match(ra)||[]).forEach(function(l){var o=dt(l);switch(Bn(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fills")}})}function F6(e,t,r,a){t.Fonts=[];var s={},i=!1;(e[0].match(ra)||[]).forEach(function(l){var o=dt(l);switch(Bn(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=Gt(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?Zt(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?Zt(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?Zt(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?Zt(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?Zt(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?Zt(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?Zt(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=Om[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=Zt(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var c=Xs[s.color.index];s.color.index==81&&(c=Xs[1]),c||(c=Xs[1]),s.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=$d(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}function D6(e,t,r){t.NumberFmt=[];for(var a=gr(it),s=0;s<a.length;++s)t.NumberFmt[a[s]]=it[a[s]];var i=e[0].match(ra);if(i)for(s=0;s<i.length;++s){var l=dt(i[s]);switch(Bn(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Ot(Gt(l.formatCode)),c=parseInt(l.numFmtId,10);if(t.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=o}Kn(o,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function R6(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&(t[t.length]=Me("numFmt",null,{numFmtId:a,formatCode:Kt(e[a])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Me("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Ic=["numFmtId","fillId","fontId","borderId","xfId"],Lc=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function M6(e,t,r){t.CellXf=[];var a,s=!1;(e[0].match(ra)||[]).forEach(function(i){var l=dt(i),o=0;switch(Bn(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=l,delete a[0],o=0;o<Ic.length;++o)a[Ic[o]]&&(a[Ic[o]]=parseInt(a[Ic[o]],10));for(o=0;o<Lc.length;++o)a[Lc[o]]&&(a[Lc[o]]=Zt(a[Lc[o]]));if(t.NumberFmt&&a.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[a.numFmtId]==t.NumberFmt[o]){a.numFmtId=o;break}}t.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};l.vertical&&(c.vertical=l.vertical),l.horizontal&&(c.horizontal=l.horizontal),l.textRotation!=null&&(c.textRotation=l.textRotation),l.indent&&(c.indent=l.indent),l.wrapText&&(c.wrapText=Zt(l.wrapText)),a.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function P6(e){var t=[];return t[t.length]=Me("cellXfs",null),e.forEach(function(r){t[t.length]=Me("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Me("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var O6=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,d){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=o.match(t))&&D6(f,u,d),(f=o.match(s))&&F6(f,u,c,d),(f=o.match(a))&&C6(f,u,c,d),(f=o.match(i))&&_6(f,u,c,d),(f=o.match(r))&&M6(f,u,d),u}})();function YN(e,t){var r=[wr,Me("styleSheet",null,{xmlns:mi[0],"xmlns:vt":Rr.vt})],a;return e.SSF&&(a=R6(e.SSF))!=null&&(r[r.length]=a),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=P6(t.cellXfs))&&(r[r.length]=a),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function I6(e,t){var r=e.read_shift(2),a=ea(e);return[r,a]}function L6(e,t,r){r||(r=pe(6+4*t.length)),r.write_shift(2,e),Lr(t,r);var a=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),a}function B6(e,t,r){var a={};a.sz=e.read_shift(2)/20;var s=b5(e);s.fItalic&&(a.italic=1),s.fCondense&&(a.condense=1),s.fExtend&&(a.extend=1),s.fShadow&&(a.shadow=1),s.fOutline&&(a.outline=1),s.fStrikeout&&(a.strike=1);var i=e.read_shift(2);switch(i===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(a.underline=l);var o=e.read_shift(1);o>0&&(a.family=o);var c=e.read_shift(1);switch(c>0&&(a.charset=c),e.l++,a.color=y5(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=ea(e),a}function z6(e,t){t||(t=pe(153)),t.write_shift(2,e.sz*20),w5(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Ud(e.color,t);var a=0;return a=2,t.write_shift(1,a),Lr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var U6=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],bf,V6=ta;function Uv(e,t){t||(t=pe(84)),bf||(bf=_u(U6));var r=bf[e.patternType];r==null&&(r=40),t.write_shift(4,r);var a=0;if(r!=40)for(Ud({auto:1},t),Ud({auto:1},t);a<12;++a)t.write_shift(4,0);else{for(;a<4;++a)t.write_shift(4,0);for(;a<12;++a)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function H6(e,t){var r=e.l+t,a=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:s}}function XN(e,t,r){r||(r=pe(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var a=0;return r.write_shift(1,a),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Rl(e,t){return t||(t=pe(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var $6=ta;function K6(e,t){return t||(t=pe(51)),t.write_shift(1,0),Rl(null,t),Rl(null,t),Rl(null,t),Rl(null,t),Rl(null,t),t.length>t.l?t.slice(0,t.l):t}function W6(e,t){return t||(t=pe(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),zd(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function G6(e,t,r){var a=pe(2052);return a.write_shift(4,e),zd(t,a),zd(r,a),a.length>a.l?a.slice(0,a.l):a}function Y6(e,t,r){var a={};a.NumberFmt=[];for(var s in it)a.NumberFmt[s]=it[s];a.CellXf=[],a.Fonts=[];var i=[],l=!1;return Jn(e,function(c,d,u){switch(u){case 44:a.NumberFmt[c[0]]=c[1],Kn(c[1],c[0]);break;case 43:a.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=$d(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&a.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:i.push(u),l=!0;break;case 38:i.pop(),l=!1;break;default:if(d.T>0)i.push(u);else if(d.T<0)i.pop();else if(!l||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),a}function X6(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&++r}),r!=0&&(we(e,615,fn(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&we(e,44,L6(s,t[s]))}),we(e,616))}}function q6(e){var t=1;we(e,611,fn(t)),we(e,43,z6({sz:12,color:{theme:1},name:"Calibri",family:2})),we(e,612)}function Z6(e){var t=2;we(e,603,fn(t)),we(e,45,Uv({patternType:"none"})),we(e,45,Uv({patternType:"gray125"})),we(e,604)}function J6(e){var t=1;we(e,613,fn(t)),we(e,46,K6()),we(e,614)}function Q6(e){var t=1;we(e,626,fn(t)),we(e,47,XN({numFmtId:0},65535)),we(e,627)}function eB(e,t){we(e,617,fn(t.length)),t.forEach(function(r){we(e,47,XN(r,0))}),we(e,618)}function tB(e){var t=1;we(e,619,fn(t)),we(e,48,W6({xfId:0,name:"Normal"})),we(e,620)}function rB(e){var t=0;we(e,505,fn(t)),we(e,506)}function aB(e){var t=0;we(e,508,G6(t,"TableStyleMedium9","PivotStyleMedium4")),we(e,509)}function nB(e,t){var r=xa();return we(r,278),X6(r,e.SSF),q6(r),Z6(r),J6(r),Q6(r),eB(r,t.cellXfs),tB(r),rB(r),aB(r),we(r,279),r.end()}var sB=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function iB(e,t,r){t.themeElements.clrScheme=[];var a={};(e[0].match(ra)||[]).forEach(function(s){var i=dt(s);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=i.val;break;case"<a:sysClr":a.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[sB.indexOf(i[0])]=a,a={}):a.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function lB(){}function oB(){}var cB=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,dB=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,uB=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function fB(e,t,r){t.themeElements={};var a;[["clrScheme",cB,iB],["fontScheme",dB,lB],["fmtScheme",uB,oB]].forEach(function(s){if(!(a=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](a,t,r)})}var hB=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function qN(e,t){(!e||e.length===0)&&(e=cx());var r,a={};if(!(r=e.match(hB)))throw new Error("themeElements not found in theme");return fB(r[0],a,t),a.raw=e,a}function cx(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[wr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function mB(e,t,r){var a=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=a;return}var i=e.slice(e.l);e.l=a;var l;try{l=V2(i,{type:"array"})}catch{return}var o=Sa(l,"theme/theme/theme1.xml",!0);if(o)return qN(o,r)}}function xB(e){return e.read_shift(4)}function pB(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=gB(e,4);break;case 2:t.xclrValue=_N(e);break;case 3:t.xclrValue=xB(e);break;case 4:e.l+=4;break}return e.l+=8,t}function gB(e,t){return ta(e,t)}function vB(e,t){return ta(e,t)}function yB(e){var t=e.read_shift(2),r=e.read_shift(2)-4,a=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=pB(e);break;case 6:a[1]=vB(e,r);break;case 14:case 15:a[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return a}function bB(e,t){var r=e.l+t;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),i=[];s-- >0;)i.push(yB(e,r-e.l));return{ixfe:a,ext:i}}function wB(e,t){t.forEach(function(r){r[0]})}function kB(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:ea(e)}}function NB(e){var t=pe(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Lr(e.name,t),t.slice(0,t.l)}function jB(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function EB(e){var t=pe(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function SB(e,t){var r=pe(8+2*t.length);return r.write_shift(4,e),Lr(t,r),r.slice(0,r.l)}function TB(e){return e.l+=4,e.read_shift(4)!=0}function AB(e,t){var r=pe(8);return r.write_shift(4,e),r.write_shift(4,1),r}function _B(e,t,r){var a={Types:[],Cell:[],Value:[]},s=r||{},i=[],l=!1,o=2;return Jn(e,function(c,d,u){switch(u){case 335:a.Types.push({name:c.name});break;case 51:c.forEach(function(f){o==1?a.Cell.push({type:a.Types[f[0]-1].name,index:f[1]}):o==0&&a.Value.push({type:a.Types[f[0]-1].name,index:f[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:i.push(u),l=!0;break;case 36:i.pop(),l=!1;break;default:if(!d.T){if(!l||s.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),a}function CB(){var e=xa();return we(e,332),we(e,334,fn(1)),we(e,335,NB({name:"XLDAPR",version:12e4,flags:3496657072})),we(e,336),we(e,339,SB(1,"XLDAPR")),we(e,52),we(e,35,fn(514)),we(e,4096,fn(0)),we(e,4097,za(1)),we(e,36),we(e,53),we(e,340),we(e,337,AB(1)),we(e,51,EB([[1,0]])),we(e,338),we(e,333),e.end()}function FB(e,t,r){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var s=!1,i=2,l;return e.replace(ra,function(o){var c=dt(o);switch(Bn(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<a.Types.length;++d)a.Types[d].name==c.name&&(l=a.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?a.Cell.push({type:a.Types[c.t-1].name,index:+c.v}):i==0&&a.Value.push({type:a.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+c.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),a}function ZN(){var e=[wr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function DB(e){var t=[];if(!e)return t;var r=1;return(e.match(ra)||[]).forEach(function(a){var s=dt(a);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function RB(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=ct(r);var a=e.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}function MB(e,t,r){var a=[];return Jn(e,function(i,l,o){switch(o){case 63:a.push(i);break;default:if(!l.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),a}function PB(e,t,r,a){if(!e)return e;var s=a||{},i=!1;Jn(e,function(o,c,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!c.T){if(!i||s.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},s)}function OB(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var zi=1024;function JN(e,t){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[Me("xml",null,{"xmlns:v":Na.v,"xmlns:o":Na.o,"xmlns:x":Na.x,"xmlns:mv":Na.mv}).replace(/\/>/,">"),Me("o:shapelayout",Me("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Me("v:shapetype",[Me("v:stroke",null,{joinstyle:"miter"}),Me("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];zi<e*1e3;)zi+=1e3;return t.forEach(function(i){var l=cr(i[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?Me("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=Me("v:fill",c,o),u={on:"t",obscured:"t"};++zi,s=s.concat(["<v:shape"+Io({id:"_x0000_s"+zi,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,Me("v:shadow",null,u),Me("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Vr("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),Vr("x:AutoFill","False"),Vr("x:Row",String(l.r)),Vr("x:Column",String(l.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function Vv(e,t,r,a){var s=Array.isArray(e),i;t.forEach(function(l){var o=cr(l.ref);if(s?(e[o.r]||(e[o.r]=[]),i=e[o.r][o.c]):i=e[l.ref],!i){i={t:"z"},s?e[o.r][o.c]=i:e[l.ref]=i;var c=It(e["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var d=pt(c);d!==e["!ref"]&&(e["!ref"]=d)}i.c||(i.c=[]);var u={a:l.author,t:l.t,r:l.r,T:r};l.h&&(u.h=l.h);for(var f=i.c.length-1;f>=0;--f){if(!r&&i.c[f].T)return;r&&!i.c[f].T&&i.c.splice(f,1)}if(r&&a){for(f=0;f<a.length;++f)if(u.a==a[f].id){u.a=a[f].name||u.a;break}}i.c.push(u)})}function IB(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var o=l.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var o=l.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=dt(o[0]),d={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},u=cr(c.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var f=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!f&&!!f[1]&&ix(f[1])||{r:"",t:"",h:""};d.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),d.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(d.h=h.h),a.push(d)}}}}),a}function QN(e){var t=[wr,Me("comments",null,{xmlns:mi[0]})],r=[];return t.push("<authors>"),e.forEach(function(a){a[1].forEach(function(s){var i=Kt(s.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(a){var s=0,i=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?s=r.indexOf("tc="+a[1][0].ID):a[1].forEach(function(c){c.a&&(s=r.indexOf(Kt(c.a))),i.push(c.t||"")}),t.push('<comment ref="'+a[0]+'" authorId="'+s+'"><text>'),i.length<=1)t.push(Vr("t",Kt(i[0]||"")));else{for(var l=`Comment:
    `+i[0]+`
`,o=1;o<i.length;++o)l+=`Reply:
    `+i[o]+`
`;t.push(Vr("t",Kt(l)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function LB(e,t){var r=[],a=!1,s={},i=0;return e.replace(ra,function(o,c){var d=dt(o);switch(Bn(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":i=c+o.length;break;case"</text>":s.t=e.slice(i,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return o}),r}function BB(e,t,r){var a=[wr,Me("ThreadedComments",null,{xmlns:Rr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var i="";(s[1]||[]).forEach(function(l,o){if(!l.T){delete l.ID;return}l.a&&t.indexOf(l.a)==-1&&t.push(l.a);var c={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?i=c.id:c.parentId=i,l.ID=c.id,l.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(l.a)).slice(-12)+"}"),a.push(Me("threadedComment",Vr("text",l.t||""),c))})}),a.push("</ThreadedComments>"),a.join("")}function zB(e,t){var r=[],a=!1;return e.replace(ra,function(i){var l=dt(i);switch(Bn(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return i}),r}function UB(e){var t=[wr,Me("personList",null,{xmlns:Rr.TCMNT,"xmlns:x":mi[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,a){t.push(Me("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function VB(e){var t={};t.iauthor=e.read_shift(4);var r=vi(e);return t.rfx=r.s,t.ref=ct(r.s),e.l+=16,t}function HB(e,t){return t==null&&(t=pe(36)),t.write_shift(4,e[1].iauthor),El(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var $B=ea;function KB(e){return Lr(e.slice(0,54))}function WB(e,t){var r=[],a=[],s={},i=!1;return Jn(e,function(o,c,d){switch(d){case 632:a.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=a[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function GB(e){var t=xa(),r=[];return we(t,628),we(t,630),e.forEach(function(a){a[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),we(t,632,KB(s.a)))})}),we(t,631),we(t,633),e.forEach(function(a){a[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var i={s:cr(a[0]),e:cr(a[0])};we(t,635,HB([i,s])),s.t&&s.t.length>0&&we(t,637,x5(s)),we(t,636),delete s.iauthor})}),we(t,634),we(t,629),t.end()}var YB="application/vnd.ms-office.vbaProject";function XB(e){var t=rt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,a){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");rt.utils.cfb_add(t,s,e.FileIndex[a].content)}}),rt.write(t)}function qB(e,t){t.FullPaths.forEach(function(r,a){if(a!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&rt.utils.cfb_add(e,s,t.FileIndex[a].content)}})}var ej=["xlsb","xlsm","xlam","biff8","xla"];function ZB(){return{"!type":"dialog"}}function JB(){return{"!type":"dialog"}}function QB(){return{"!type":"macro"}}function ez(){return{"!type":"macro"}}var Zi=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(a,s,i,l){var o=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),l.length==0?o=!0:l.charAt(0)=="["&&(o=!0,l=l.slice(1,-1));var d=i.length>0?parseInt(i,10)|0:0,u=l.length>0?parseInt(l,10)|0:0;return o?u+=t.c:--u,c?d+=t.r:--d,s+(o?"":"$")+or(u)+(c?"":"$")+br(d)}return function(s,i){return t=i,s.replace(e,r)}})(),dx=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,ux=(function(){return function(t,r){return t.replace(dx,function(a,s,i,l,o,c){var d=Zm(l)-(i?0:r.c),u=qm(c)-(o?0:r.r),f=u==0?"":o?u+1:"["+u+"]",h=d==0?"":i?d+1:"["+d+"]";return s+"R"+f+"C"+h})}})();function tj(e,t){return e.replace(dx,function(r,a,s,i,l,o){return a+(s=="$"?s+i:or(Zm(i)+t.c))+(l=="$"?l+o:br(qm(o)+t.r))})}function tz(e,t,r){var a=pa(t),s=a.s,i=cr(r),l={r:i.r-s.r,c:i.c-s.c};return tj(e,l)}function rz(e){return e.length!=1}function Hv(e){return e.replace(/_xlfn\./g,"")}function Nr(e){e.l+=1}function Ns(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function rj(e,t,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return aj(e);r.biff==12&&(a=4)}var s=e.read_shift(a),i=e.read_shift(a),l=Ns(e),o=Ns(e);return{s:{r:s,c:l[0],cRel:l[1],rRel:l[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function aj(e){var t=Ns(e),r=Ns(e),a=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function az(e,t,r){if(r.biff<8)return aj(e);var a=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),i=Ns(e),l=Ns(e);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:l[0],cRel:l[1],rRel:l[2]}}}function nj(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return nz(e);var a=e.read_shift(r&&r.biff==12?4:2),s=Ns(e);return{r:a,c:s[0],cRel:s[1],rRel:s[2]}}function nz(e){var t=Ns(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function sz(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function iz(e,t,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return lz(e);var s=e.read_shift(a>=12?4:2),i=e.read_shift(2),l=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;s>524287;)s-=1048576;if(l==1)for(;i>8191;)i=i-16384;return{r:s,c:i,cRel:l,rRel:o}}function lz(e){var t=e.read_shift(2),r=e.read_shift(1),a=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:a}}function oz(e,t,r){var a=(e[e.l++]&96)>>5,s=rj(e,r.biff>=2&&r.biff<=5?6:8,r);return[a,s]}function cz(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var l=rj(e,i,r);return[a,s,l]}function dz(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function uz(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[a,s]}function fz(e,t,r){var a=(e[e.l++]&96)>>5,s=az(e,t-1,r);return[a,s]}function hz(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[a]}function $v(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function mz(e,t,r){e.l+=2;for(var a=e.read_shift(r&&r.biff==2?1:2),s=[],i=0;i<=a;++i)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function xz(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function pz(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function gz(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function vz(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[a]}function sj(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function yz(e){return e.read_shift(2),sj(e)}function bz(e){return e.read_shift(2),sj(e)}function wz(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=nj(e,0,r);return[a,s]}function kz(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=iz(e,0,r);return[a,s]}function Nz(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=nj(e,0,r);return[a,s,i]}function jz(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[T7[s],oj[s],a]}function Ez(e,t,r){var a=e[e.l++],s=e.read_shift(1),i=r&&r.biff<=3?[a==88?-1:0,e.read_shift(1)]:Sz(e);return[s,(i[0]===0?oj:S7)[i[1]]]}function Sz(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Tz(e,t,r){e.l+=r&&r.biff==2?3:4}function Az(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function _z(e){return e.l++,Qn[e.read_shift(1)]}function Cz(e){return e.l++,e.read_shift(2)}function Fz(e){return e.l++,e.read_shift(1)!==0}function Dz(e){return e.l++,Zr(e)}function Rz(e,t,r){return e.l++,dc(e,t-1,r)}function Mz(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=yr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Qn[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Zr(e);break;case 2:r[1]=yi(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Pz(e,t,r){for(var a=e.read_shift(r.biff==12?4:2),s=[],i=0;i!=a;++i)s.push((r.biff==12?vi:Du)(e));return s}function Oz(e,t,r){var a=0,s=0;r.biff==12?(a=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--s==0&&(s=256));for(var i=0,l=[];i!=a&&(l[i]=[]);++i)for(var o=0;o!=s;++o)l[i][o]=Mz(e,r.biff);return l}function Iz(e,t,r){var a=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,i=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,i]}function Lz(e,t,r){if(r.biff==5)return Bz(e);var a=e.read_shift(1)>>>5&3,s=e.read_shift(2),i=e.read_shift(4);return[a,s,i]}function Bz(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,r,a]}function zz(e,t,r){var a=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function Uz(e,t,r){var a=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function Vz(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[a]}function Hz(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[a,s]}var $z=ta,Kz=ta,Wz=ta;function fc(e,t,r){return e.l+=2,[sz(e)]}function fx(e){return e.l+=6,[]}var Gz=fc,Yz=fx,Xz=fx,qz=fc;function ij(e){return e.l+=2,[Er(e),e.read_shift(2)&1]}var Zz=fc,Jz=ij,Qz=fx,e7=fc,t7=fc,r7=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function a7(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),s=e.read_shift(2),i=e.read_shift(2),l=r7[r>>2&31];return{ixti:t,coltype:r&3,rt:l,idx:a,c:s,C:i}}function n7(e){return e.l+=2,[e.read_shift(4)]}function s7(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function i7(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function l7(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function o7(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function c7(e){return e.l+=4,[0,0]}var Kv={1:{n:"PtgExp",f:Az},2:{n:"PtgTbl",f:Wz},3:{n:"PtgAdd",f:Nr},4:{n:"PtgSub",f:Nr},5:{n:"PtgMul",f:Nr},6:{n:"PtgDiv",f:Nr},7:{n:"PtgPower",f:Nr},8:{n:"PtgConcat",f:Nr},9:{n:"PtgLt",f:Nr},10:{n:"PtgLe",f:Nr},11:{n:"PtgEq",f:Nr},12:{n:"PtgGe",f:Nr},13:{n:"PtgGt",f:Nr},14:{n:"PtgNe",f:Nr},15:{n:"PtgIsect",f:Nr},16:{n:"PtgUnion",f:Nr},17:{n:"PtgRange",f:Nr},18:{n:"PtgUplus",f:Nr},19:{n:"PtgUminus",f:Nr},20:{n:"PtgPercent",f:Nr},21:{n:"PtgParen",f:Nr},22:{n:"PtgMissArg",f:Nr},23:{n:"PtgStr",f:Rz},26:{n:"PtgSheet",f:s7},27:{n:"PtgEndSheet",f:i7},28:{n:"PtgErr",f:_z},29:{n:"PtgBool",f:Fz},30:{n:"PtgInt",f:Cz},31:{n:"PtgNum",f:Dz},32:{n:"PtgArray",f:hz},33:{n:"PtgFunc",f:jz},34:{n:"PtgFuncVar",f:Ez},35:{n:"PtgName",f:Iz},36:{n:"PtgRef",f:wz},37:{n:"PtgArea",f:oz},38:{n:"PtgMemArea",f:zz},39:{n:"PtgMemErr",f:$z},40:{n:"PtgMemNoMem",f:Kz},41:{n:"PtgMemFunc",f:Uz},42:{n:"PtgRefErr",f:Vz},43:{n:"PtgAreaErr",f:dz},44:{n:"PtgRefN",f:kz},45:{n:"PtgAreaN",f:fz},46:{n:"PtgMemAreaN",f:l7},47:{n:"PtgMemNoMemN",f:o7},57:{n:"PtgNameX",f:Lz},58:{n:"PtgRef3d",f:Nz},59:{n:"PtgArea3d",f:cz},60:{n:"PtgRefErr3d",f:Hz},61:{n:"PtgAreaErr3d",f:uz},255:{}},d7={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},u7={1:{n:"PtgElfLel",f:ij},2:{n:"PtgElfRw",f:e7},3:{n:"PtgElfCol",f:Gz},6:{n:"PtgElfRwV",f:t7},7:{n:"PtgElfColV",f:qz},10:{n:"PtgElfRadical",f:Zz},11:{n:"PtgElfRadicalS",f:Qz},13:{n:"PtgElfColS",f:Yz},15:{n:"PtgElfColSV",f:Xz},16:{n:"PtgElfRadicalLel",f:Jz},25:{n:"PtgList",f:a7},29:{n:"PtgSxName",f:n7},255:{}},f7={0:{n:"PtgAttrNoop",f:c7},1:{n:"PtgAttrSemi",f:vz},2:{n:"PtgAttrIf",f:pz},4:{n:"PtgAttrChoose",f:mz},8:{n:"PtgAttrGoto",f:xz},16:{n:"PtgAttrSum",f:Tz},32:{n:"PtgAttrBaxcel",f:$v},33:{n:"PtgAttrBaxcel",f:$v},64:{n:"PtgAttrSpace",f:yz},65:{n:"PtgAttrSpaceSemi",f:bz},128:{n:"PtgAttrIfError",f:gz},255:{}};function hc(e,t,r,a){if(a.biff<8)return ta(e,t);for(var s=e.l+t,i=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=Oz(e,0,a),i.push(r[l][1]);break;case"PtgMemArea":r[l][2]=Pz(e,r[l][1],a),i.push(r[l][2]);break;case"PtgExp":a&&a.biff==12&&(r[l][1][1]=e.read_shift(4),i.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return t=s-e.l,t!==0&&i.push(ta(e,t)),i}function mc(e,t,r){for(var a=e.l+t,s,i,l=[];a!=e.l;)t=a-e.l,i=e[e.l],s=Kv[i]||Kv[d7[i]],(i===24||i===25)&&(s=(i===24?u7:f7)[e[e.l+1]]),!s||!s.f?ta(e,t):l.push([s.n,s.f(e,t,r)]);return l}function h7(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],s=[],i=0;i<a.length;++i){var l=a[i];if(l)switch(l[0]){case 2:s.push('"'+l[1].replace(/"/g,'""')+'"');break;default:s.push(l[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var m7={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function x7(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function lj(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[a[0]][0]){case 357:return s=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?s:s+":"+e.SheetNames[a[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return s=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?s:s+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[a[0]][0][3]?(s=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?s:s+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function Wv(e,t,r){var a=lj(e,t,r);return a=="#REF"?a:x7(a,r)}function Yr(e,t,r,a,s){var i=s&&s.biff||8,l={s:{c:0,r:0}},o=[],c,d,u,f=0,h=0,m,x="";if(!e[0]||!e[0][0])return"";for(var p=-1,g="",y=0,N=e[0].length;y<N;++y){var v=e[0][y];switch(v[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),d=o.pop(),p>=0){switch(e[0][p][1][0]){case 0:g=fr(" ",e[0][p][1][1]);break;case 1:g=fr("\r",e[0][p][1][1]);break;default:if(g="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}d=d+g,p=-1}o.push(d+m7[v[0]]+c);break;case"PtgIsect":c=o.pop(),d=o.pop(),o.push(d+" "+c);break;case"PtgUnion":c=o.pop(),d=o.pop(),o.push(d+","+c);break;case"PtgRange":c=o.pop(),d=o.pop(),o.push(d+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=eo(v[1][1],l,s),o.push(to(u,i));break;case"PtgRefN":u=r?eo(v[1][1],r,s):v[1][1],o.push(to(u,i));break;case"PtgRef3d":f=v[1][1],u=eo(v[1][2],l,s),x=Wv(a,f,s),o.push(x+"!"+to(u,i));break;case"PtgFunc":case"PtgFuncVar":var S=v[1][0],_=v[1][1];S||(S=0),S&=127;var F=S==0?[]:o.slice(-S);o.length-=S,_==="User"&&(_=F.shift()),o.push(_+"("+F.join(",")+")");break;case"PtgBool":o.push(v[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(v[1]);break;case"PtgNum":o.push(String(v[1]));break;case"PtgStr":o.push('"'+v[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(v[1]);break;case"PtgAreaN":m=wv(v[1][1],r?{s:r}:l,s),o.push(pf(m,s));break;case"PtgArea":m=wv(v[1][1],l,s),o.push(pf(m,s));break;case"PtgArea3d":f=v[1][1],m=v[1][2],x=Wv(a,f,s),o.push(x+"!"+pf(m,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=v[1][2];var k=(a.names||[])[h-1]||(a[0]||[])[h],j=k?k.Name:"SH33TJSNAME"+String(h);j&&j.slice(0,6)=="_xlfn."&&!s.xlfn&&(j=j.slice(6)),o.push(j);break;case"PtgNameX":var w=v[1][1];h=v[1][2];var E;if(s.biff<=5)w<0&&(w=-w),a[w]&&(E=a[w][h]);else{var A="";if(((a[w]||[])[0]||[])[0]==14849||(((a[w]||[])[0]||[])[0]==1025?a[w][h]&&a[w][h].itab>0&&(A=a.SheetNames[a[w][h].itab-1]+"!"):A=a.SheetNames[h-1]+"!"),a[w]&&a[w][h])A+=a[w][h].Name;else if(a[0]&&a[0][h])A+=a[0][h].Name;else{var D=(lj(a,w,s)||"").split(";;");D[h-1]?A=D[h-1]:A+="SH33TJSERRX"}o.push(A);break}E||(E={Name:"SH33TJSERRY"}),o.push(E.Name);break;case"PtgParen":var W="(",re=")";if(p>=0){switch(g="",e[0][p][1][0]){case 2:W=fr(" ",e[0][p][1][1])+W;break;case 3:W=fr("\r",e[0][p][1][1])+W;break;case 4:re=fr(" ",e[0][p][1][1])+re;break;case 5:re=fr("\r",e[0][p][1][1])+re;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}o.push(W+o.pop()+re);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:v[1][1],r:v[1][0]};var U={c:r.c,r:r.r};if(a.sharedf[ct(u)]){var M=a.sharedf[ct(u)];o.push(Yr(M,l,U,a,s))}else{var Y=!1;for(c=0;c!=a.arrayf.length;++c)if(d=a.arrayf[c],!(u.c<d[0].s.c||u.c>d[0].e.c)&&!(u.r<d[0].s.r||u.r>d[0].e.r)){o.push(Yr(d[1],l,U,a,s)),Y=!0;break}Y||o.push(v[1])}break;case"PtgArray":o.push("{"+h7(v[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=y;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+v[1].idx+"[#"+v[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(v));default:throw new Error("Unrecognized Formula Token: "+String(v))}var Q=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&p>=0&&Q.indexOf(e[0][y][0])==-1){v=e[0][p];var B=!0;switch(v[1][0]){case 4:B=!1;case 0:g=fr(" ",v[1][1]);break;case 5:B=!1;case 1:g=fr("\r",v[1][1]);break;default:if(g="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+v[1][0])}o.push((B?g:"")+o.pop()+(B?"":g)),p=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function p7(e,t,r){var a=e.l+t,s=r.biff==2?1:2,i,l=e.read_shift(s);if(l==65535)return[[],ta(e,t-2)];var o=mc(e,l,r);return t!==l+s&&(i=hc(e,t-l-s,o,r)),e.l=a,[o,i]}function g7(e,t,r){var a=e.l+t,s=r.biff==2?1:2,i,l=e.read_shift(s);if(l==65535)return[[],ta(e,t-2)];var o=mc(e,l,r);return t!==l+s&&(i=hc(e,t-l-s,o,r)),e.l=a,[o,i]}function v7(e,t,r,a){var s=e.l+t,i=mc(e,a,r),l;return s!==e.l&&(l=hc(e,s-e.l,i,r)),[i,l]}function y7(e,t,r){var a=e.l+t,s,i=e.read_shift(2),l=mc(e,i,r);return i==65535?[[],ta(e,t-2)]:(t!==i+2&&(s=hc(e,a-i-2,l,r)),[l,s])}function b7(e){var t;if(Hn(e,e.l+6)!==65535)return[Zr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function w7(e){if(e==null){var t=pe(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return li(e);return li(0)}function wf(e,t,r){var a=e.l+t,s=zn(e);r.biff==2&&++e.l;var i=b7(e),l=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=g7(e,a-e.l,r);return{cell:s,val:i[0],formula:o,shared:l>>3&1,tt:i[1]}}function k7(e,t,r,a,s){var i=ci(t,r,s),l=w7(e.v),o=pe(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var d=pe(e.bf.length),u=0;u<e.bf.length;++u)d[u]=e.bf[u];var f=Or([i,l,o,d]);return f}function Ru(e,t,r){var a=e.read_shift(4),s=mc(e,a,r),i=e.read_shift(4),l=i>0?hc(e,i,s,r):null;return[s,l]}var N7=Ru,Mu=Ru,j7=Ru,E7=Ru,S7={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},oj={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},T7={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Gv(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function A7(e){var t="of:="+e.replace(dx,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function kf(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function _7(e){return e.replace(/\./,"!")}var ao={},Ji={},no=typeof Map<"u";function hx(e,t,r){var a=0,s=e.length;if(r){if(no?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=no?r.get(t):r[t];a<i.length;++a)if(e[i[a]].t===t)return e.Count++,i[a]}}else for(;a<s;++a)if(e[a].t===t)return e.Count++,a;return e[s]={t},e.Count++,e.Unique++,r&&(no?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function Pu(e,t){var r={min:e+1,max:e+1},a=-1;return t.MDW&&(qr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?a=Vo(t.wpx):t.wch!=null&&(a=t.wch),a>-1?(r.width=Kd(a),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Js(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Fs(e,t,r){var a=r.revssf[t.z!=null?t.z:"General"],s=60,i=e.length;if(a==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){Kn(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=a=s;break}}for(s=0;s!=i;++s)if(e[s].numFmtId===a)return s;return e[i]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function cj(e,t,r,a,s,i){try{a.cellNF&&(e.z=it[t])}catch(o){if(a.WTF)throw o}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Qt(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(it[t]==null&&Kn(SO[t]||"General",t),e.t==="e")e.w=e.w||Qn[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Po(e.v);else if(e.t==="d"){var l=Mr(e.v);(l|0)===l?e.w=l.toString(10):e.w=Po(l)}else{if(e.v===void 0)return"";e.w=si(e.v,Ji)}else e.t==="d"?e.w=Ya(t,Mr(e.v),Ji):e.w=Ya(t,e.v,Ji)}catch(o){if(a.WTF)throw o}if(a.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=$d(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=$d(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(a.WTF&&i.Fills)throw o}}}function C7(e,t,r){if(e&&e["!ref"]){var a=It(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function F7(e,t){var r=It(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=pt(r))}var D7=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,R7=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,M7=/<(?:\w:)?hyperlink [^>]*>/mg,P7=/"(\w*:\w*)"/,O7=/<(?:\w:)?col\b[^>]*[\/]?>/g,I7=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,L7=/<(?:\w:)?pageMargins[^>]*\/>/g,dj=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,B7=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,z7=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function U7(e,t,r,a,s,i,l){if(!e)return e;a||(a={"!id":{}});var o=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",u="",f=e.match(R7);f?(d=e.slice(0,f.index),u=e.slice(f.index+f[0].length)):d=u=e;var h=d.match(dj);h?mx(h[0],o,s,r):(h=d.match(B7))&&H7(h[0],h[1]||"",o,s,r);var m=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var x=d.slice(m,m+50).match(P7);x&&F7(o,x[1])}var p=d.match(z7);p&&p[1]&&r9(p[1],s);var g=[];if(t.cellStyles){var y=d.match(O7);y&&Z7(g,y)}f&&s9(f[1],o,t,c,i,l);var N=u.match(I7);N&&(o["!autofilter"]=Q7(N[0]));var v=[],S=u.match(D7);if(S)for(m=0;m!=S.length;++m)v[m]=It(S[m].slice(S[m].indexOf('"')+1));var _=u.match(M7);_&&Y7(o,_,a);var F=u.match(L7);if(F&&(o["!margins"]=X7(dt(F[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=pt(c)),t.sheetRows>0&&o["!ref"]){var k=It(o["!ref"]);t.sheetRows<=+k.e.r&&(k.e.r=t.sheetRows-1,k.e.r>c.e.r&&(k.e.r=c.e.r),k.e.r<k.s.r&&(k.s.r=k.e.r),k.e.c>c.e.c&&(k.e.c=c.e.c),k.e.c<k.s.c&&(k.s.c=k.e.c),o["!fullref"]=o["!ref"],o["!ref"]=pt(k))}return g.length>0&&(o["!cols"]=g),v.length>0&&(o["!merges"]=v),o}function V7(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+pt(e[r])+'"/>';return t+"</mergeCells>"}function mx(e,t,r,a){var s=dt(e);r.Sheets[a]||(r.Sheets[a]={}),s.codeName&&(r.Sheets[a].CodeName=Ot(Gt(s.codeName)))}function H7(e,t,r,a,s){mx(e.slice(0,e.indexOf(">")),r,a,s)}function $7(e,t,r,a,s){var i=!1,l={},o=null;if(a.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}i=!0,l.codeName=Cn(Kt(c))}if(e&&e["!outline"]){var d={summaryBelow:1,summaryRight:1};e["!outline"].above&&(d.summaryBelow=0),e["!outline"].left&&(d.summaryRight=0),o=(o||"")+Me("outlinePr",null,d)}!i&&!o||(s[s.length]=Me("sheetPr",o,l))}var K7=["objects","scenarios","selectLockedCells","selectUnlockedCells"],W7=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function G7(e){var t={sheet:1};return K7.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),W7.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=lx(e.password).toString(16).toUpperCase()),Me("sheetProtection",null,t)}function Y7(e,t,r){for(var a=Array.isArray(e),s=0;s!=t.length;++s){var i=dt(Gt(t[s]),!0);if(!i.ref)return;var l=((r||{})["!id"]||[])[i.id];l?(i.Target=l.Target,i.location&&(i.Target+="#"+Ot(i.location))):(i.Target="#"+Ot(i.location),l={Target:i.Target,TargetMode:"Internal"}),i.Rel=l,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=It(i.ref),c=o.s.r;c<=o.e.r;++c)for(var d=o.s.c;d<=o.e.c;++d){var u=ct({c:d,r:c});a?(e[c]||(e[c]=[]),e[c][d]||(e[c][d]={t:"z",v:void 0}),e[c][d].l=i):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=i)}}}function X7(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function q7(e){return Js(e),Me("pageMargins",null,e)}function Z7(e,t){for(var r=!1,a=0;a!=t.length;++a){var s=dt(t[a],!0);s.hidden&&(s.hidden=Zt(s.hidden));var i=parseInt(s.min,10)-1,l=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,ox(s.width)),ks(s);i<=l;)e[i++]=er(s)}}function J7(e,t){for(var r=["<cols>"],a,s=0;s!=t.length;++s)(a=t[s])&&(r[r.length]=Me("col",null,Pu(s,a)));return r[r.length]="</cols>",r.join("")}function Q7(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function e9(e,t,r,a){var s=typeof e.ref=="string"?e.ref:pt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,l=pa(s);l.s.r==l.e.r&&(l.e.r=pa(t["!ref"]).e.r,s=pt(l));for(var o=0;o<i.length;++o){var c=i[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==a){c.Ref="'"+r.SheetNames[a]+"'!"+s;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+s}),Me("autoFilter",null,{ref:s})}var t9=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function r9(e,t){t.Views||(t.Views=[{}]),(e.match(t9)||[]).forEach(function(r,a){var s=dt(r);t.Views[a]||(t.Views[a]={}),+s.zoomScale&&(t.Views[a].zoom=+s.zoomScale),Zt(s.rightToLeft)&&(t.Views[a].RTL=!0)})}function a9(e,t,r,a){var s={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),Me("sheetViews",Me("sheetView",null,s),{})}function n9(e,t,r,a){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",i=e.t,l=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=Qn[e.v];break;case"d":a&&a.cellDates?s=Qt(e.v,-1).toISOString():(e=er(e),e.t="n",s=""+(e.v=Mr(Qt(e.v)))),typeof e.z>"u"&&(e.z=it[14]);break;default:s=e.v;break}var o=Vr("v",Kt(s)),c={r:t},d=Fs(a.cellXfs,e,a);switch(d!==0&&(c.s=d),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){o=Vr("v",""+hx(a.Strings,e.v,a.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=i&&(e.t=i,e.v=l),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Me("f",Kt(e.f),u)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),Me("c",o,c)}var s9=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,i=Oo("v"),l=Oo("f");return function(c,d,u,f,h,m){for(var x=0,p="",g=[],y=[],N=0,v=0,S=0,_="",F,k,j=0,w=0,E,A,D=0,W=0,re=Array.isArray(m.CellXf),U,M=[],Y=[],Q=Array.isArray(d),B=[],V={},P=!1,T=!!u.sheetStubs,R=c.split(t),L=0,X=R.length;L!=X;++L){p=R[L].trim();var J=p.length;if(J!==0){var te=0;e:for(x=0;x<J;++x)switch(p[x]){case">":if(p[x-1]!="/"){++x;break e}if(u&&u.cellStyles){if(k=dt(p.slice(te,x),!0),j=k.r!=null?parseInt(k.r,10):j+1,w=-1,u.sheetRows&&u.sheetRows<j)continue;V={},P=!1,k.ht&&(P=!0,V.hpt=parseFloat(k.ht),V.hpx=dl(V.hpt)),k.hidden=="1"&&(P=!0,V.hidden=!0),k.outlineLevel!=null&&(P=!0,V.level=+k.outlineLevel),P&&(B[j-1]=V)}break;case"<":te=x;break}if(te>=x)break;if(k=dt(p.slice(te,x),!0),j=k.r!=null?parseInt(k.r,10):j+1,w=-1,!(u.sheetRows&&u.sheetRows<j)){f.s.r>j-1&&(f.s.r=j-1),f.e.r<j-1&&(f.e.r=j-1),u&&u.cellStyles&&(V={},P=!1,k.ht&&(P=!0,V.hpt=parseFloat(k.ht),V.hpx=dl(V.hpt)),k.hidden=="1"&&(P=!0,V.hidden=!0),k.outlineLevel!=null&&(P=!0,V.level=+k.outlineLevel),P&&(B[j-1]=V)),g=p.slice(x).split(e);for(var G=0;G!=g.length&&g[G].trim().charAt(0)=="<";++G);for(g=g.slice(G),x=0;x!=g.length;++x)if(p=g[x].trim(),p.length!==0){if(y=p.match(r),N=x,v=0,S=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,y!=null&&y.length===2){for(N=0,_=y[1],v=0;v!=_.length&&!((S=_.charCodeAt(v)-64)<1||S>26);++v)N=26*N+S;--N,w=N}else++w;for(v=0;v!=p.length&&p.charCodeAt(v)!==62;++v);if(++v,k=dt(p.slice(0,v),!0),k.r||(k.r=ct({r:j-1,c:w})),_=p.slice(v),F={t:""},(y=_.match(i))!=null&&y[1]!==""&&(F.v=Ot(y[1])),u.cellFormula){if((y=_.match(l))!=null&&y[1]!==""){if(F.f=Ot(Gt(y[1])).replace(/\r\n/g,`
`),u.xlfn||(F.f=Hv(F.f)),y[0].indexOf('t="array"')>-1)F.F=(_.match(s)||[])[1],F.F.indexOf(":")>-1&&M.push([It(F.F),F.F]);else if(y[0].indexOf('t="shared"')>-1){A=dt(y[0]);var Z=Ot(Gt(y[1]));u.xlfn||(Z=Hv(Z)),Y[parseInt(A.si,10)]=[A,Z,k.r]}}else(y=_.match(/<f[^>]*\/>/))&&(A=dt(y[0]),Y[A.si]&&(F.f=tz(Y[A.si][1],Y[A.si][2],k.r)));var ae=cr(k.r);for(v=0;v<M.length;++v)ae.r>=M[v][0].s.r&&ae.r<=M[v][0].e.r&&ae.c>=M[v][0].s.c&&ae.c<=M[v][0].e.c&&(F.F=M[v][1])}if(k.t==null&&F.v===void 0)if(F.f||F.F)F.v=0,F.t="n";else if(T)F.t="z";else continue;else F.t=k.t||"n";switch(f.s.c>w&&(f.s.c=w),f.e.c<w&&(f.e.c=w),F.t){case"n":if(F.v==""||F.v==null){if(!T)continue;F.t="z"}else F.v=parseFloat(F.v);break;case"s":if(typeof F.v>"u"){if(!T)continue;F.t="z"}else E=ao[parseInt(F.v,10)],F.v=E.t,F.r=E.r,u.cellHTML&&(F.h=E.h);break;case"str":F.t="s",F.v=F.v!=null?Gt(F.v):"",u.cellHTML&&(F.h=Wm(F.v));break;case"inlineStr":y=_.match(a),F.t="s",y!=null&&(E=ix(y[1]))?(F.v=E.t,u.cellHTML&&(F.h=E.h)):F.v="";break;case"b":F.v=Zt(F.v);break;case"d":u.cellDates?F.v=Qt(F.v,1):(F.v=Mr(Qt(F.v,1)),F.t="n");break;case"e":(!u||u.cellText!==!1)&&(F.w=F.v),F.v=fN[F.v];break}if(D=W=0,U=null,re&&k.s!==void 0&&(U=m.CellXf[k.s],U!=null&&(U.numFmtId!=null&&(D=U.numFmtId),u.cellStyles&&U.fillId!=null&&(W=U.fillId))),cj(F,D,W,u,h,m),u.cellDates&&re&&F.t=="n"&&kl(it[D])&&(F.t="d",F.v=Fu(F.v)),k.cm&&u.xlmeta){var de=(u.xlmeta.Cell||[])[+k.cm-1];de&&de.type=="XLDAPR"&&(F.D=!0)}if(Q){var z=cr(k.r);d[z.r]||(d[z.r]=[]),d[z.r][z.c]=F}else d[k.r]=F}}}}B.length>0&&(d["!rows"]=B)}})();function i9(e,t,r,a){var s=[],i=[],l=It(e["!ref"]),o="",c,d="",u=[],f=0,h=0,m=e["!rows"],x=Array.isArray(e),p={r:d},g,y=-1;for(h=l.s.c;h<=l.e.c;++h)u[h]=or(h);for(f=l.s.r;f<=l.e.r;++f){for(i=[],d=br(f),h=l.s.c;h<=l.e.c;++h){c=u[h]+d;var N=x?(e[f]||[])[h]:e[c];N!==void 0&&(o=n9(N,c,e,t))!=null&&i.push(o)}(i.length>0||m&&m[f])&&(p={r:d},m&&m[f]&&(g=m[f],g.hidden&&(p.hidden=1),y=-1,g.hpx?y=Ho(g.hpx):g.hpt&&(y=g.hpt),y>-1&&(p.ht=y,p.customHeight=1),g.level&&(p.outlineLevel=g.level)),s[s.length]=Me("row",i.join(""),p))}if(m)for(;f<m.length;++f)m&&m[f]&&(p={r:f+1},g=m[f],g.hidden&&(p.hidden=1),y=-1,g.hpx?y=Ho(g.hpx):g.hpt&&(y=g.hpt),y>-1&&(p.ht=y,p.customHeight=1),g.level&&(p.outlineLevel=g.level),s[s.length]=Me("row","",p));return s.join("")}function uj(e,t,r,a){var s=[wr,Me("worksheet",null,{xmlns:mi[0],"xmlns:r":Rr.r})],i=r.SheetNames[e],l=0,o="",c=r.Sheets[i];c==null&&(c={});var d=c["!ref"]||"A1",u=It(d);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),d=pt(u)}a||(a={}),c["!comments"]=[];var f=[];$7(c,r,e,t,s),s[s.length]=Me("dimension",null,{ref:d}),s[s.length]=a9(c,t,e,r),t.sheetFormat&&(s[s.length]=Me("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(s[s.length]=J7(c,c["!cols"])),s[l=s.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=i9(c,t),o.length>0&&(s[s.length]=o)),s.length>l+1&&(s[s.length]="</sheetData>",s[l]=s[l].replace("/>",">")),c["!protect"]&&(s[s.length]=G7(c["!protect"])),c["!autofilter"]!=null&&(s[s.length]=e9(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(s[s.length]=V7(c["!merges"]));var h=-1,m,x=-1;return c["!links"].length>0&&(s[s.length]="<hyperlinks>",c["!links"].forEach(function(p){p[1].Target&&(m={ref:p[0]},p[1].Target.charAt(0)!="#"&&(x=$t(a,-1,Kt(p[1].Target).replace(/#.*$/,""),St.HLINK),m["r:id"]="rId"+x),(h=p[1].Target.indexOf("#"))>-1&&(m.location=Kt(p[1].Target.slice(h+1))),p[1].Tooltip&&(m.tooltip=Kt(p[1].Tooltip)),s[s.length]=Me("hyperlink",null,m))}),s[s.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(s[s.length]=q7(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=Vr("ignoredErrors",Me("ignoredError",null,{numberStoredAsText:1,sqref:d}))),f.length>0&&(x=$t(a,-1,"../drawings/drawing"+(e+1)+".xml",St.DRAW),s[s.length]=Me("drawing",null,{"r:id":"rId"+x}),c["!drawing"]=f),c["!comments"].length>0&&(x=$t(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",St.VML),s[s.length]=Me("legacyDrawing",null,{"r:id":"rId"+x}),c["!legacy"]=x),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function l9(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=a,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=s/20),r}function o9(e,t,r){var a=pe(145),s=(r["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var i=320;s.hpx?i=Ho(s.hpx)*20:s.hpt&&(i=s.hpt*20),a.write_shift(2,i),a.write_shift(1,0);var l=0;s.level&&(l|=s.level),s.hidden&&(l|=16),(s.hpx||s.hpt)&&(l|=32),a.write_shift(1,l),a.write_shift(1,0);var o=0,c=a.l;a.l+=4;for(var d={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var f=-1,h=-1,m=u<<10;m<u+1<<10;++m){d.c=m;var x=Array.isArray(r)?(r[d.r]||[])[d.c]:r[ct(d)];x&&(f<0&&(f=m),h=m)}f<0||(++o,a.write_shift(4,f),a.write_shift(4,h))}var p=a.l;return a.l=c,a.write_shift(4,o),a.l=p,a.length>a.l?a.slice(0,a.l):a}function c9(e,t,r,a){var s=o9(a,r,t);(s.length>17||(t["!rows"]||[])[a])&&we(e,0,s)}var d9=vi,u9=El;function f9(){}function h9(e,t){var r={},a=e[e.l];return++e.l,r.above=!(a&64),r.left=!(a&128),e.l+=18,r.name=p5(e),r}function m9(e,t,r){r==null&&(r=pe(84+4*e.length));var a=192;t&&(t.above&&(a&=-65),t.left&&(a&=-129)),r.write_shift(1,a);for(var s=1;s<3;++s)r.write_shift(1,0);return Ud({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),lN(e,r),r.slice(0,r.l)}function x9(e){var t=qa(e);return[t]}function p9(e,t,r){return r==null&&(r=pe(8)),xi(t,r)}function g9(e){var t=pi(e);return[t]}function v9(e,t,r){return r==null&&(r=pe(4)),gi(t,r)}function y9(e){var t=qa(e),r=e.read_shift(1);return[t,r,"b"]}function b9(e,t,r){return r==null&&(r=pe(9)),xi(t,r),r.write_shift(1,e.v?1:0),r}function w9(e){var t=pi(e),r=e.read_shift(1);return[t,r,"b"]}function k9(e,t,r){return r==null&&(r=pe(5)),gi(t,r),r.write_shift(1,e.v?1:0),r}function N9(e){var t=qa(e),r=e.read_shift(1);return[t,r,"e"]}function j9(e,t,r){return r==null&&(r=pe(9)),xi(t,r),r.write_shift(1,e.v),r}function E9(e){var t=pi(e),r=e.read_shift(1);return[t,r,"e"]}function S9(e,t,r){return r==null&&(r=pe(8)),gi(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function T9(e){var t=qa(e),r=e.read_shift(4);return[t,r,"s"]}function A9(e,t,r){return r==null&&(r=pe(12)),xi(t,r),r.write_shift(4,t.v),r}function _9(e){var t=pi(e),r=e.read_shift(4);return[t,r,"s"]}function C9(e,t,r){return r==null&&(r=pe(8)),gi(t,r),r.write_shift(4,t.v),r}function F9(e){var t=qa(e),r=Zr(e);return[t,r,"n"]}function D9(e,t,r){return r==null&&(r=pe(16)),xi(t,r),li(e.v,r),r}function fj(e){var t=pi(e),r=Zr(e);return[t,r,"n"]}function R9(e,t,r){return r==null&&(r=pe(12)),gi(t,r),li(e.v,r),r}function M9(e){var t=qa(e),r=tx(e);return[t,r,"n"]}function P9(e,t,r){return r==null&&(r=pe(12)),xi(t,r),oN(e.v,r),r}function O9(e){var t=pi(e),r=tx(e);return[t,r,"n"]}function I9(e,t,r){return r==null&&(r=pe(8)),gi(t,r),oN(e.v,r),r}function L9(e){var t=qa(e),r=Jm(e);return[t,r,"is"]}function B9(e){var t=qa(e),r=ea(e);return[t,r,"str"]}function z9(e,t,r){return r==null&&(r=pe(12+4*e.v.length)),xi(t,r),Lr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function U9(e){var t=pi(e),r=ea(e);return[t,r,"str"]}function V9(e,t,r){return r==null&&(r=pe(8+4*e.v.length)),gi(t,r),Lr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function H9(e,t,r){var a=e.l+t,s=qa(e);s.r=r["!row"];var i=e.read_shift(1),l=[s,i,"b"];if(r.cellFormula){e.l+=2;var o=Mu(e,a-e.l,r);l[3]=Yr(o,null,s,r.supbooks,r)}else e.l=a;return l}function $9(e,t,r){var a=e.l+t,s=qa(e);s.r=r["!row"];var i=e.read_shift(1),l=[s,i,"e"];if(r.cellFormula){e.l+=2;var o=Mu(e,a-e.l,r);l[3]=Yr(o,null,s,r.supbooks,r)}else e.l=a;return l}function K9(e,t,r){var a=e.l+t,s=qa(e);s.r=r["!row"];var i=Zr(e),l=[s,i,"n"];if(r.cellFormula){e.l+=2;var o=Mu(e,a-e.l,r);l[3]=Yr(o,null,s,r.supbooks,r)}else e.l=a;return l}function W9(e,t,r){var a=e.l+t,s=qa(e);s.r=r["!row"];var i=ea(e),l=[s,i,"str"];if(r.cellFormula){e.l+=2;var o=Mu(e,a-e.l,r);l[3]=Yr(o,null,s,r.supbooks,r)}else e.l=a;return l}var G9=vi,Y9=El;function X9(e,t){return t==null&&(t=pe(4)),t.write_shift(4,e),t}function q9(e,t){var r=e.l+t,a=vi(e),s=Qm(e),i=ea(e),l=ea(e),o=ea(e);e.l=r;var c={rfx:a,relId:s,loc:i,display:o};return l&&(c.Tooltip=l),c}function Z9(e,t){var r=pe(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));El({s:cr(e[0]),e:cr(e[0])},r),ex("rId"+t,r);var a=e[1].Target.indexOf("#"),s=a==-1?"":e[1].Target.slice(a+1);return Lr(s||"",r),Lr(e[1].Tooltip||"",r),Lr("",r),r.slice(0,r.l)}function J9(){}function Q9(e,t,r){var a=e.l+t,s=cN(e),i=e.read_shift(1),l=[s];if(l[2]=i,r.cellFormula){var o=N7(e,a-e.l,r);l[1]=o}else e.l=a;return l}function eU(e,t,r){var a=e.l+t,s=vi(e),i=[s];if(r.cellFormula){var l=E7(e,a-e.l,r);i[1]=l,e.l=a}else e.l=a;return i}function tU(e,t,r){r==null&&(r=pe(18));var a=Pu(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(a.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof a.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var hj=["left","right","top","bottom","header","footer"];function rU(e){var t={};return hj.forEach(function(r){t[r]=Zr(e)}),t}function aU(e,t){return t==null&&(t=pe(48)),Js(e),hj.forEach(function(r){li(e[r],t)}),t}function nU(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function sU(e,t,r){r==null&&(r=pe(30));var a=924;return(((t||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function iU(e){var t=pe(24);return t.write_shift(4,4),t.write_shift(4,1),El(e,t),t}function lU(e,t){return t==null&&(t=pe(66)),t.write_shift(2,e.password?lx(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function oU(){}function cU(){}function dU(e,t,r,a,s,i,l){if(!e)return e;var o=t||{};a||(a={"!id":{}});var c=o.dense?[]:{},d,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,h=!1,m,x,p,g,y,N,v,S,_,F=[];o.biff=12,o["!row"]=0;var k=0,j=!1,w=[],E={},A=o.supbooks||s.supbooks||[[]];if(A.sharedf=E,A.arrayf=w,A.SheetNames=s.SheetNames||s.Sheets.map(function(Q){return Q.name}),!o.supbooks&&(o.supbooks=A,s.Names))for(var D=0;D<s.Names.length;++D)A[0][D+1]=s.Names[D];var W=[],re=[],U=!1;$o[16]={n:"BrtShortReal",f:fj};var M;if(Jn(e,function(B,V,P){if(!h)switch(P){case 148:d=B;break;case 0:m=B,o.sheetRows&&o.sheetRows<=m.r&&(h=!0),S=br(g=m.r),o["!row"]=m.r,(B.hidden||B.hpt||B.level!=null)&&(B.hpt&&(B.hpx=dl(B.hpt)),re[B.r]=B);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:B[2]},B[2]){case"n":x.v=B[1];break;case"s":v=ao[B[1]],x.v=v.t,x.r=v.r;break;case"b":x.v=!!B[1];break;case"e":x.v=B[1],o.cellText!==!1&&(x.w=Qn[x.v]);break;case"str":x.t="s",x.v=B[1];break;case"is":x.t="s",x.v=B[1].t;break}if((p=l.CellXf[B[0].iStyleRef])&&cj(x,p.numFmtId,null,o,i,l),y=B[0].c==-1?y+1:B[0].c,o.dense?(c[g]||(c[g]=[]),c[g][y]=x):c[or(y)+S]=x,o.cellFormula){for(j=!1,k=0;k<w.length;++k){var T=w[k];m.r>=T[0].s.r&&m.r<=T[0].e.r&&y>=T[0].s.c&&y<=T[0].e.c&&(x.F=pt(T[0]),j=!0)}!j&&B.length>3&&(x.f=B[3])}if(u.s.r>m.r&&(u.s.r=m.r),u.s.c>y&&(u.s.c=y),u.e.r<m.r&&(u.e.r=m.r),u.e.c<y&&(u.e.c=y),o.cellDates&&p&&x.t=="n"&&kl(it[p.numFmtId])){var R=$s(x.v);R&&(x.t="d",x.v=new Date(R.y,R.m-1,R.d,R.H,R.M,R.S,R.u))}M&&(M.type=="XLDAPR"&&(x.D=!0),M=void 0);break;case 1:case 12:if(!o.sheetStubs||f)break;x={t:"z",v:void 0},y=B[0].c==-1?y+1:B[0].c,o.dense?(c[g]||(c[g]=[]),c[g][y]=x):c[or(y)+S]=x,u.s.r>m.r&&(u.s.r=m.r),u.s.c>y&&(u.s.c=y),u.e.r<m.r&&(u.e.r=m.r),u.e.c<y&&(u.e.c=y),M&&(M.type=="XLDAPR"&&(x.D=!0),M=void 0);break;case 176:F.push(B);break;case 49:M=((o.xlmeta||{}).Cell||[])[B-1];break;case 494:var L=a["!id"][B.relId];for(L?(B.Target=L.Target,B.loc&&(B.Target+="#"+B.loc),B.Rel=L):B.relId==""&&(B.Target="#"+B.loc),g=B.rfx.s.r;g<=B.rfx.e.r;++g)for(y=B.rfx.s.c;y<=B.rfx.e.c;++y)o.dense?(c[g]||(c[g]=[]),c[g][y]||(c[g][y]={t:"z",v:void 0}),c[g][y].l=B):(N=ct({c:y,r:g}),c[N]||(c[N]={t:"z",v:void 0}),c[N].l=B);break;case 426:if(!o.cellFormula)break;w.push(B),_=o.dense?c[g][y]:c[or(y)+S],_.f=Yr(B[1],u,{r:m.r,c:y},A,o),_.F=pt(B[0]);break;case 427:if(!o.cellFormula)break;E[ct(B[0].s)]=B[1],_=o.dense?c[g][y]:c[or(y)+S],_.f=Yr(B[1],u,{r:m.r,c:y},A,o);break;case 60:if(!o.cellStyles)break;for(;B.e>=B.s;)W[B.e--]={width:B.w/256,hidden:!!(B.flags&1),level:B.level},U||(U=!0,ox(B.w/256)),ks(W[B.e+1]);break;case 161:c["!autofilter"]={ref:pt(B)};break;case 476:c["!margins"]=B;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),B.name&&(s.Sheets[r].CodeName=B.name),(B.above||B.left)&&(c["!outline"]={above:B.above,left:B.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),B.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!V.T){if(!f||o.WTF)throw new Error("Unexpected record 0x"+P.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(u.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(c["!ref"]=pt(d||u)),o.sheetRows&&c["!ref"]){var Y=It(c["!ref"]);o.sheetRows<=+Y.e.r&&(Y.e.r=o.sheetRows-1,Y.e.r>u.e.r&&(Y.e.r=u.e.r),Y.e.r<Y.s.r&&(Y.s.r=Y.e.r),Y.e.c>u.e.c&&(Y.e.c=u.e.c),Y.e.c<Y.s.c&&(Y.s.c=Y.e.c),c["!fullref"]=c["!ref"],c["!ref"]=pt(Y))}return F.length>0&&(c["!merges"]=F),W.length>0&&(c["!cols"]=W),re.length>0&&(c["!rows"]=re),c}function uU(e,t,r,a,s,i,l){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=er(t),t.z=t.z||it[14],t.v=Mr(Qt(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var c={r,c:a};switch(c.s=Fs(s.cellXfs,t,s),t.l&&i["!links"].push([ct(c),t.l]),t.c&&i["!comments"].push([ct(c),t.c]),t.t){case"s":case"str":return s.bookSST?(o=hx(s.Strings,t.v,s.revStrings),c.t="s",c.v=o,l?we(e,18,C9(t,c)):we(e,7,A9(t,c))):(c.t="str",l?we(e,17,V9(t,c)):we(e,6,z9(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?l?we(e,13,I9(t,c)):we(e,2,P9(t,c)):l?we(e,16,R9(t,c)):we(e,5,D9(t,c)),!0;case"b":return c.t="b",l?we(e,15,k9(t,c)):we(e,4,b9(t,c)),!0;case"e":return c.t="e",l?we(e,14,S9(t,c)):we(e,3,j9(t,c)),!0}return l?we(e,12,v9(t,c)):we(e,1,p9(t,c)),!0}function fU(e,t,r,a){var s=It(t["!ref"]||"A1"),i,l="",o=[];we(e,145);var c=Array.isArray(t),d=s.e.r;t["!rows"]&&(d=Math.max(s.e.r,t["!rows"].length-1));for(var u=s.s.r;u<=d;++u){l=br(u),c9(e,t,s,u);var f=!1;if(u<=s.e.r)for(var h=s.s.c;h<=s.e.c;++h){u===s.s.r&&(o[h]=or(h)),i=o[h]+l;var m=c?(t[u]||[])[h]:t[i];if(!m){f=!1;continue}f=uU(e,m,u,h,a,t,f)}}we(e,146)}function hU(e,t){!t||!t["!merges"]||(we(e,177,X9(t["!merges"].length)),t["!merges"].forEach(function(r){we(e,176,Y9(r))}),we(e,178))}function mU(e,t){!t||!t["!cols"]||(we(e,390),t["!cols"].forEach(function(r,a){r&&we(e,60,tU(a,r))}),we(e,391))}function xU(e,t){!t||!t["!ref"]||(we(e,648),we(e,649,iU(It(t["!ref"]))),we(e,650))}function pU(e,t,r){t["!links"].forEach(function(a){if(a[1].Target){var s=$t(r,-1,a[1].Target.replace(/#.*$/,""),St.HLINK);we(e,494,Z9(a,s))}}),delete t["!links"]}function gU(e,t,r,a){if(t["!comments"].length>0){var s=$t(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",St.VML);we(e,551,ex("rId"+s)),t["!legacy"]=s}}function vU(e,t,r,a){if(t["!autofilter"]){var s=t["!autofilter"],i=typeof s.ref=="string"?s.ref:pt(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,o=pa(i);o.s.r==o.e.r&&(o.e.r=pa(t["!ref"]).e.r,i=pt(o));for(var c=0;c<l.length;++c){var d=l[c];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==a){d.Ref="'"+r.SheetNames[a]+"'!"+i;break}}c==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+i}),we(e,161,El(It(i))),we(e,162)}}function yU(e,t,r){we(e,133),we(e,137,sU(t,r)),we(e,138),we(e,134)}function bU(e,t){t["!protect"]&&we(e,535,lU(t["!protect"]))}function wU(e,t,r,a){var s=xa(),i=r.SheetNames[e],l=r.Sheets[i]||{},o=i;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var c=It(l["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],we(s,129),(r.vbaraw||l["!outline"])&&we(s,147,m9(o,l["!outline"])),we(s,148,u9(c)),yU(s,l,r.Workbook),mU(s,l),fU(s,l,e,t),bU(s,l),vU(s,l,r,e),hU(s,l),pU(s,l,a),l["!margins"]&&we(s,476,aU(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&xU(s,l),gU(s,l,e,a),we(s,130),s.end()}function kU(e){var t=[],r=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var l=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(t[+l[1]]=r?+l[2]:l[2])});var s=Ot((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){a=i.replace(/<.*?>/g,"")}),[t,s,a]}function NU(e,t,r,a,s,i){var l=i||{"!type":"chart"};if(!e)return i;var o=0,c=0,d="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var h=kU(f);u.s.r=u.s.c=0,u.e.c=o,d=or(o),h[0].forEach(function(m,x){l[d+br(x)]={t:"n",v:m,z:h[1]},c=x}),u.e.r<c&&(u.e.r=c),++o}),o>0&&(l["!ref"]=pt(u)),l}function jU(e,t,r,a,s){if(!e)return e;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},l,o=e.match(dj);return o&&mx(o[0],i,s,r),(l=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=l[1]),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}function EU(e,t){e.l+=10;var r=ea(e);return{name:r}}function SU(e,t,r,a,s){if(!e)return e;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},l=!1;return Jn(e,function(c,d,u){switch(u){case 550:i["!rel"]=c;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),c.name&&(s.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!l||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}var xx=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],TU=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],AU=[],_U=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Yv(e,t){for(var r=0;r!=e.length;++r)for(var a=e[r],s=0;s!=t.length;++s){var i=t[s];if(a[i[0]]==null)a[i[0]]=i[1];else switch(i[2]){case"bool":typeof a[i[0]]=="string"&&(a[i[0]]=Zt(a[i[0]]));break;case"int":typeof a[i[0]]=="string"&&(a[i[0]]=parseInt(a[i[0]],10));break}}}function Xv(e,t){for(var r=0;r!=t.length;++r){var a=t[r];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=Zt(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function mj(e){Xv(e.WBProps,xx),Xv(e.CalcPr,_U),Yv(e.WBView,TU),Yv(e.Sheets,AU),Ji.date1904=Zt(e.WBProps.date1904)}function CU(e){return!e.Workbook||!e.Workbook.WBProps?"false":Zt(e.Workbook.WBProps.date1904)?"true":"false"}var FU="][*?/\\".split("");function xj(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return FU.forEach(function(a){if(e.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function DU(e,t,r){e.forEach(function(a,s){xj(a);for(var i=0;i<s;++i)if(a==e[i])throw new Error("Duplicate Sheet Name: "+a);if(r){var l=t&&t[s]&&t[s].CodeName||a;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function RU(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];DU(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)C7(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var MU=/<\w+:workbook/;function PU(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,s="xmlns",i={},l=0;if(e.replace(ra,function(c,d){var u=dt(c);switch(Bn(u[0])){case"<?xml":break;case"<workbook":c.match(MU)&&(s="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=u[s];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":xx.forEach(function(f){if(u[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=Zt(u[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(u[f[0]],10);break;default:r.WBProps[f[0]]=u[f[0]]}}),u.codeName&&(r.WBProps.CodeName=Gt(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=Ot(Gt(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":i={},i.Name=Gt(u.name),u.comment&&(i.Comment=u.comment),u.localSheetId&&(i.Sheet=+u.localSheetId),Zt(u.hidden||"0")&&(i.Hidden=!0),l=d+c.length;break;case"</definedName>":i.Ref=Ot(Gt(e.slice(l,d))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return c}),mi.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return mj(r),r}function pj(e){var t=[wr];t[t.length]=Me("workbook",null,{xmlns:mi[0],"xmlns:r":Rr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(xx.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(a[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),t[t.length]=Me("workbookPr",null,a);var s=e.Workbook&&e.Workbook.Sheets||[],i=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!s[i]||!s[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var l={name:Kt(e.SheetNames[i].slice(0,31))};if(l.sheetId=""+(i+1),l["r:id"]="rId"+(i+1),s[i])switch(s[i].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}t[t.length]=Me("sheet",null,l)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(t[t.length]=Me("definedName",Kt(o.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function OU(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=$0(e),r.name=ea(e),r}function IU(e,t){return t||(t=pe(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),ex(e.strRelID,t),Lr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function LU(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?ea(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function BU(e,t){t||(t=pe(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),lN(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function zU(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function UU(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),i=g5(e),l=j7(e,0,r),o=Qm(e);e.l=a;var c={Name:i,Ptg:l};return s<268435455&&(c.Sheet=s),o&&(c.Comment=o),c}function VU(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],s=!1;t||(t={}),t.biff=12;var i=[],l=[[]];return l.SheetNames=[],l.XTI=[],$o[16]={n:"BrtFRTArchID$",f:zU},Jn(e,function(c,d,u){switch(u){case 156:l.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=Yr(c.Ptg,null,null,l,t),delete t.SID,delete c.Ptg,i.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([u,c]):l[0]=[u,c],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(c),l.XTI=l.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(u),s=!0;break;case 36:a.pop(),s=!1;break;case 37:a.push(u),s=!0;break;case 38:a.pop(),s=!1;break;case 16:break;default:if(!d.T){if(!s||t.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),mj(r),r.Names=i,r.supbooks=l,r}function HU(e,t){we(e,143);for(var r=0;r!=t.SheetNames.length;++r){var a=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:a,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};we(e,156,IU(s))}we(e,144)}function $U(e,t){t||(t=pe(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Lr("SheetJS",t),Lr(Md.version,t),Lr(Md.version,t),Lr("7262",t),t.length>t.l?t.slice(0,t.l):t}function KU(e,t){t||(t=pe(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function WU(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,a=0,s=-1,i=-1;a<r.length;++a)!r[a]||!r[a].Hidden&&s==-1?s=a:r[a].Hidden==1&&i==-1&&(i=a);i>s||(we(e,135),we(e,158,KU(s)),we(e,136))}}function GU(e,t){var r=xa();return we(r,131),we(r,128,$U()),we(r,153,BU(e.Workbook&&e.Workbook.WBProps||null)),WU(r,e),HU(r,e),we(r,132),r.end()}function YU(e,t,r){return t.slice(-4)===".bin"?VU(e,r):PU(e,r)}function XU(e,t,r,a,s,i,l,o){return t.slice(-4)===".bin"?dU(e,a,r,s,i,l,o):U7(e,a,r,s,i,l,o)}function qU(e,t,r,a,s,i,l,o){return t.slice(-4)===".bin"?SU(e,a,r,s,i):jU(e,a,r,s,i)}function ZU(e,t,r,a,s,i,l,o){return t.slice(-4)===".bin"?QB():ez()}function JU(e,t,r,a,s,i,l,o){return t.slice(-4)===".bin"?ZB():JB()}function QU(e,t,r,a){return t.slice(-4)===".bin"?Y6(e,r,a):O6(e,r,a)}function eV(e,t,r){return qN(e,r)}function tV(e,t,r){return t.slice(-4)===".bin"?t6(e,r):JL(e,r)}function rV(e,t,r){return t.slice(-4)===".bin"?WB(e,r):IB(e,r)}function aV(e,t,r){return t.slice(-4)===".bin"?MB(e):DB(e)}function nV(e,t,r,a){return r.slice(-4)===".bin"?PB(e,t,r,a):void 0}function sV(e,t,r){return t.slice(-4)===".bin"?_B(e,t,r):FB(e,t,r)}function iV(e,t,r){return(t.slice(-4)===".bin"?GU:pj)(e)}function lV(e,t,r,a,s){return(t.slice(-4)===".bin"?wU:uj)(e,r,a,s)}function oV(e,t,r){return(t.slice(-4)===".bin"?nB:YN)(e,r)}function cV(e,t,r){return(t.slice(-4)===".bin"?n6:zN)(e,r)}function dV(e,t,r){return(t.slice(-4)===".bin"?GB:QN)(e)}function uV(e){return(e.slice(-4)===".bin"?CB:ZN)()}var gj=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,vj=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function en(e,t){var r=e.split(/\s+/),a=[];if(a[0]=r[0],r.length===1)return a;var s=e.match(gj),i,l,o,c;if(s)for(c=0;c!=s.length;++c)i=s[c].match(vj),(l=i[1].indexOf(":"))===-1?a[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(l+1),a[o]=i[2].slice(1,i[2].length-1));return a}function fV(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var a=e.match(gj),s,i,l,o;if(a)for(o=0;o!=a.length;++o)s=a[o].match(vj),(i=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?l="xmlns"+s[1].slice(6):l=s[1].slice(i+1),r[l]=s[2].slice(1,s[2].length-1));return r}var so;function hV(e,t){var r=so[e]||Ot(e);return r==="General"?si(t):Ya(r,t)}function mV(e,t,r,a){var s=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Zt(a);break;case"i2":case"int":s=parseInt(a,10);break;case"r4":case"float":s=parseFloat(a);break;case"date":case"dateTime.tz":s=Qt(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Ot(t)]=s}function xV(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Qn[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Po(e.v):e.w=si(e.v):e.w=hV(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var a=so[t]||t||"General";if(r.cellNF&&(e.z=a),r.cellDates&&e.t=="n"&&kl(a)){var s=$s(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(i){if(r.WTF)throw i}}}function pV(e,t,r){if(r.cellStyles&&t.Interior){var a=t.Interior;a.Pattern&&(a.patternType=A6[a.Pattern]||a.Pattern)}e[t.ID]=t}function gV(e,t,r,a,s,i,l,o,c,d){var u="General",f=a.StyleID,h={};d=d||{};var m=[],x=0;for(f===void 0&&o&&(f=o.StyleID),f===void 0&&l&&(f=l.StyleID);i[f]!==void 0&&(i[f].nf&&(u=i[f].nf),i[f].Interior&&m.push(i[f].Interior),!!i[f].Parent);)f=i[f].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=Zt(e);break;case"String":a.t="s",a.r=fv(Ot(e)),a.v=e.indexOf("<")>-1?Ot(t||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=(Qt(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),a.v!==a.v?a.v=Ot(e):a.v<60&&(a.v=a.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=fN[e],d.cellText!==!1&&(a.w=e);break;default:e==""&&t==""?a.t="z":(a.t="s",a.v=fv(t||e));break}if(xV(a,u,d),d.cellFormula!==!1)if(a.Formula){var p=Ot(a.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),a.f=Zi(p,s),delete a.Formula,a.ArrayRange=="RC"?a.F=Zi("RC:RC",s):a.ArrayRange&&(a.F=Zi(a.ArrayRange,s),c.push([It(a.F),a.F]))}else for(x=0;x<c.length;++x)s.r>=c[x][0].s.r&&s.r<=c[x][0].e.r&&s.c>=c[x][0].s.c&&s.c<=c[x][0].e.c&&(a.F=c[x][1]);d.cellStyles&&(m.forEach(function(g){!h.patternType&&g.patternType&&(h.patternType=g.patternType)}),a.s=h),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function vV(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Nf(e,t){var r=t||{};Nl();var a=$l(Gm(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(a=Gt(a));var s=a.slice(0,1024).toLowerCase(),i=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var l=er(r);return l.type="string",cl.to_workbook(a,l)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Fe){s.indexOf("<"+Fe)>=0&&(i=!0)}),i)return aH(a,r);so={"General Number":"General","General Date":it[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":it[15],"Short Date":it[14],"Long Time":it[19],"Medium Time":it[18],"Short Time":it[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:it[2],Standard:it[4],Percent:it[10],Scientific:it[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],d,u={},f=[],h=r.dense?[]:{},m="",x={},p={},g=en('<Data ss:Type="String">'),y=0,N=0,v=0,S={s:{r:2e6,c:2e6},e:{r:0,c:0}},_={},F={},k="",j=0,w=[],E={},A={},D=0,W=[],re=[],U={},M=[],Y,Q=!1,B=[],V=[],P={},T=0,R=0,L={Sheets:[],WBProps:{date1904:!1}},X={};Lo.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var J="";o=Lo.exec(a);)switch(o[3]=(J=o[3]).toLowerCase()){case"data":if(J=="data"){if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?gV(a.slice(y,o.index),k,g,c[c.length-1][0]=="comment"?U:x,{c:N,r:v},_,M[N],p,B,r):(k="",g=en(o[0]),y=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(re.length>0&&(x.c=re),(!r.sheetRows||r.sheetRows>v)&&x.v!==void 0&&(r.dense?(h[v]||(h[v]=[]),h[v][N]=x):h[or(N)+br(v)]=x),x.HRef&&(x.l={Target:Ot(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(T=N+(parseInt(x.MergeAcross,10)|0),R=v+(parseInt(x.MergeDown,10)|0),w.push({s:{c:N,r:v},e:{c:T,r:R}})),!r.sheetStubs)x.MergeAcross?N=T+1:++N;else if(x.MergeAcross||x.MergeDown){for(var te=N;te<=T;++te)for(var G=v;G<=R;++G)(te>N||G>v)&&(r.dense?(h[G]||(h[G]=[]),h[G][te]={t:"z"}):h[or(te)+br(G)]={t:"z"});N=T+1}else++N;else x=fV(o[0]),x.Index&&(N=+x.Index-1),N<S.s.c&&(S.s.c=N),N>S.e.c&&(S.e.c=N),o[0].slice(-2)==="/>"&&++N,re=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(v<S.s.r&&(S.s.r=v),v>S.e.r&&(S.e.r=v),o[0].slice(-2)==="/>"&&(p=en(o[0]),p.Index&&(v=+p.Index-1)),N=0,++v):(p=en(o[0]),p.Index&&(v=+p.Index-1),P={},(p.AutoFitHeight=="0"||p.Height)&&(P.hpx=parseInt(p.Height,10),P.hpt=Ho(P.hpx),V[v]=P),p.Hidden=="1"&&(P.hidden=!0,V[v]=P));break;case"worksheet":if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"));f.push(m),S.s.r<=S.e.r&&S.s.c<=S.e.c&&(h["!ref"]=pt(S),r.sheetRows&&r.sheetRows<=S.e.r&&(h["!fullref"]=h["!ref"],S.e.r=r.sheetRows-1,h["!ref"]=pt(S))),w.length&&(h["!merges"]=w),M.length>0&&(h["!cols"]=M),V.length>0&&(h["!rows"]=V),u[m]=h}else S={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=N=0,c.push([o[3],!1]),d=en(o[0]),m=Ot(d.Name),h=r.dense?[]:{},w=[],B=[],V=[],X={name:m,Hidden:0},L.Sheets.push(X);break;case"table":if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),M=[],Q=!1}break;case"style":o[1]==="/"?pV(_,F,r):F=en(o[0]);break;case"numberformat":F.nf=Ot(en(o[0]).Format||"General"),so[F.nf]&&(F.nf=so[F.nf]);for(var Z=0;Z!=392&&it[Z]!=F.nf;++Z);if(Z==392){for(Z=57;Z!=392;++Z)if(it[Z]==null){Kn(F.nf,Z);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(Y=en(o[0]),Y.Hidden&&(Y.hidden=!0,delete Y.Hidden),Y.Width&&(Y.wpx=parseInt(Y.Width,10)),!Q&&Y.wpx>10){Q=!0,qr=WN;for(var ae=0;ae<M.length;++ae)M[ae]&&ks(M[ae])}Q&&ks(Y),M[Y.Index-1||M.length]=Y;for(var de=0;de<+Y.Span;++de)M[M.length]=er(Y);break;case"namedrange":if(o[1]==="/")break;L.Names||(L.Names=[]);var z=dt(o[0]),Ee={Name:z.Name,Ref:Zi(z.RefersTo.slice(1),{r:0,c:0})};L.Sheets.length>0&&(Ee.Sheet=L.Sheets.length-1),L.Names.push(Ee);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?k+=a.slice(j,o.index):j=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;F.Interior=en(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?V5(E,J,a.slice(D,o.index)):D=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"));vV(U),re.push(U)}else c.push([o[3],!1]),d=en(o[0]),U={a:d.Author};break;case"autofilter":if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var ue=en(o[0]);h["!autofilter"]={ref:Zi(ue.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return e1(a,r);var Ce=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ce=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ce=!1}break;case"excelworkbook":switch(o[3]){case"date1904":L.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ce=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Ce=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(a.slice(D,o.index)){case"SheetHidden":X.Hidden=1;break;case"SheetVeryHidden":X.Hidden=2;break}else D=o.index+o[0].length;break;case"header":h["!margins"]||Js(h["!margins"]={},"xlml"),isNaN(+dt(o[0]).Margin)||(h["!margins"].header=+dt(o[0]).Margin);break;case"footer":h["!margins"]||Js(h["!margins"]={},"xlml"),isNaN(+dt(o[0]).Margin)||(h["!margins"].footer=+dt(o[0]).Margin);break;case"pagemargins":var ve=dt(o[0]);h["!margins"]||Js(h["!margins"]={},"xlml"),isNaN(+ve.Top)||(h["!margins"].top=+ve.Top),isNaN(+ve.Left)||(h["!margins"].left=+ve.Left),isNaN(+ve.Right)||(h["!margins"].right=+ve.Right),isNaN(+ve.Bottom)||(h["!margins"].bottom=+ve.Bottom);break;case"displayrighttoleft":L.Views||(L.Views=[]),L.Views[0]||(L.Views[0]={}),L.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ce=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ce=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ce=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ce=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ce=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ce=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ce=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ce=!1}break;case"smarttags":break;default:Ce=!1;break}if(Ce||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?mV(A,J,W,a.slice(D,o.index)):(W=o,D=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var ge={};return!r.bookSheets&&!r.bookProps&&(ge.Sheets=u),ge.SheetNames=f,ge.Workbook=L,ge.SSF=er(it),ge.Props=E,ge.Custprops=A,ge}function Z0(e,t){switch(gx(t=t||{}),t.type||"base64"){case"base64":return Nf(_a(e),t);case"binary":case"buffer":case"file":return Nf(e,t);case"array":return Nf(_s(e),t)}}function yV(e,t){var r=[];return e.Props&&r.push(H5(e.Props,t)),e.Custprops&&r.push($5(e.Props,e.Custprops)),r.join("")}function bV(){return""}function wV(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(a,s){var i=[];i.push(Me("NumberFormat",null,{"ss:Format":Kt(it[a.numFmtId])}));var l={"ss:ID":"s"+(21+s)};r.push(Me("Style",i.join(""),l))}),Me("Styles",r.join(""))}function yj(e){return Me("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+ux(e.Ref,{r:0,c:0})})}function kV(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],a=0;a<t.length;++a){var s=t[a];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(yj(s)))}return Me("Names",r.join(""))}function NV(e,t,r,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var s=a.Workbook.Names,i=[],l=0;l<s.length;++l){var o=s[l];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||i.push(yj(o)))}return i.join("")}function jV(e,t,r,a){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(Me("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(Me("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(Me("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)s.push(Me("Visible",a.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(a.Workbook.Sheets[i]&&!a.Workbook.Sheets[i].Hidden);++i);i==r&&s.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(Vr("ProtectContents","True")),e["!protect"].objects&&s.push(Vr("ProtectObjects","True")),e["!protect"].scenarios&&s.push(Vr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(Vr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(Vr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){e["!protect"][l[0]]&&s.push("<"+l[1]+"/>")})),s.length==0?"":Me("WorksheetOptions",s.join(""),{xmlns:Na.x})}function EV(e){return e.map(function(t){var r=WO(t.t||""),a=Me("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Me("Comment",a,{"ss:Author":t.a})}).join("")}function SV(e,t,r,a,s,i,l){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+Kt(ux(e.f,l))),e.F&&e.F.slice(0,t.length)==t){var c=cr(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==l.r?"":"["+(c.r-l.r)+"]")+"C"+(c.c==l.c?"":"["+(c.c-l.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=Kt(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=Kt(e.l.Tooltip))),r["!merges"])for(var d=r["!merges"],u=0;u!=d.length;++u)d[u].s.c!=l.c||d[u].s.r!=l.r||(d[u].e.c>d[u].s.c&&(o["ss:MergeAcross"]=d[u].e.c-d[u].s.c),d[u].e.r>d[u].s.r&&(o["ss:MergeDown"]=d[u].e.r-d[u].s.r));var f="",h="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":f="Number",h=String(e.v);break;case"b":f="Boolean",h=e.v?"1":"0";break;case"e":f="Error",h=Qn[e.v];break;case"d":f="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||it[14]);break;case"s":f="String",h=KO(e.v||"");break}var m=Fs(a.cellXfs,e,a);o["ss:StyleID"]="s"+(21+m),o["ss:Index"]=l.c+1;var x=e.v!=null?h:"",p=e.t=="z"?"":'<Data ss:Type="'+f+'">'+x+"</Data>";return(e.c||[]).length>0&&(p+=EV(e.c)),Me("Cell",p,o)}function TV(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=dl(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function AV(e,t,r,a){if(!e["!ref"])return"";var s=It(e["!ref"]),i=e["!merges"]||[],l=0,o=[];e["!cols"]&&e["!cols"].forEach(function(g,y){ks(g);var N=!!g.width,v=Pu(y,g),S={"ss:Index":y+1};N&&(S["ss:Width"]=Uo(v.width)),g.hidden&&(S["ss:Hidden"]="1"),o.push(Me("Column",null,S))});for(var c=Array.isArray(e),d=s.s.r;d<=s.e.r;++d){for(var u=[TV(d,(e["!rows"]||[])[d])],f=s.s.c;f<=s.e.c;++f){var h=!1;for(l=0;l!=i.length;++l)if(!(i[l].s.c>f)&&!(i[l].s.r>d)&&!(i[l].e.c<f)&&!(i[l].e.r<d)){(i[l].s.c!=f||i[l].s.r!=d)&&(h=!0);break}if(!h){var m={r:d,c:f},x=ct(m),p=c?(e[d]||[])[f]:e[x];u.push(SV(p,x,e,t,r,a,m))}}u.push("</Row>"),u.length>2&&o.push(u.join(""))}return o.join("")}function _V(e,t,r){var a=[],s=r.SheetNames[e],i=r.Sheets[s],l=i?NV(i,t,e,r):"";return l.length>0&&a.push("<Names>"+l+"</Names>"),l=i?AV(i,t,e,r):"",l.length>0&&a.push("<Table>"+l+"</Table>"),a.push(jV(i,t,e,r)),a.join("")}function CV(e,t){t||(t={}),e.SSF||(e.SSF=er(it)),e.SSF&&(Nl(),Au(e.SSF),t.revssf=Cu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Fs(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(yV(e,t)),r.push(bV()),r.push(""),r.push("");for(var a=0;a<e.SheetNames.length;++a)r.push(Me("Worksheet",_V(a,t,e),{"ss:Name":Kt(e.SheetNames[a])}));return r[2]=wV(e,t),r[3]=kV(e),wr+Me("Workbook",r.join(""),{xmlns:Na.ss,"xmlns:o":Na.o,"xmlns:x":Na.x,"xmlns:ss":Na.ss,"xmlns:dt":Na.dt,"xmlns:html":Na.html})}function FV(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=k5(r),r.length-r.l<=4)return t;var a=r.read_shift(4);if(a==0||a>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(a=r.read_shift(4),a!==1907505652)||(t.UnicodeClipboardFormat=N5(r),a=r.read_shift(4),a==0||a>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var DV=[60,1084,2066,2165,2175];function RV(e,t,r,a,s){var i=a,l=[],o=r.slice(r.l,r.l+i);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}l.push(o),r.l+=i;for(var c=Hn(r,r.l),d=J0[c],u=0;d!=null&&DV.indexOf(c)>-1;)i=Hn(r,r.l+2),u=r.l+4,c==2066?u+=4:(c==2165||c==2175)&&(u+=12),o=r.slice(u,r.l+4+i),l.push(o),r.l+=4+i,d=J0[c=Hn(r,r.l)];var f=Or(l);Ur(f,0);var h=0;f.lens=[];for(var m=0;m<l.length;++m)f.lens.push(h),h+=l[m].length;if(f.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+a;return t.f(f,f.length,s)}function Nn(e,t,r){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=it[a])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Qn[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Po(e.v):e.w=si(e.v):e.w=Ya(a,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&a&&e.t=="n"&&kl(it[a]||String(a))){var s=$s(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Bc(e,t,r){return{v:e,ixfe:t,t:r}}function MV(e,t){var r={opts:{}},a={},s=t.dense?[]:{},i={},l={},o=null,c=[],d="",u={},f,h="",m,x,p,g,y={},N=[],v,S,_=[],F=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},j={},w=function(se){return se<8?Xs[se]:se<64&&F[se-8]||Xs[se]},E=function(se,Ne,De){var lt=Ne.XF.data;if(!(!lt||!lt.patternType||!De||!De.cellStyles)){Ne.s={},Ne.s.patternType=lt.patternType;var Rt;(Rt=zo(w(lt.icvFore)))&&(Ne.s.fgColor={rgb:Rt}),(Rt=zo(w(lt.icvBack)))&&(Ne.s.bgColor={rgb:Rt})}},A=function(se,Ne,De){if(!(P>1)&&!(De.sheetRows&&se.r>=De.sheetRows)){if(De.cellStyles&&Ne.XF&&Ne.XF.data&&E(se,Ne,De),delete Ne.ixfe,delete Ne.XF,f=se,h=ct(se),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),se.r<l.s.r&&(l.s.r=se.r),se.c<l.s.c&&(l.s.c=se.c),se.r+1>l.e.r&&(l.e.r=se.r+1),se.c+1>l.e.c&&(l.e.c=se.c+1),De.cellFormula&&Ne.f){for(var lt=0;lt<N.length;++lt)if(!(N[lt][0].s.c>se.c||N[lt][0].s.r>se.r)&&!(N[lt][0].e.c<se.c||N[lt][0].e.r<se.r)){Ne.F=pt(N[lt][0]),(N[lt][0].s.c!=se.c||N[lt][0].s.r!=se.r)&&delete Ne.f,Ne.f&&(Ne.f=""+Yr(N[lt][1],l,se,B,D));break}}De.dense?(s[se.r]||(s[se.r]=[]),s[se.r][se.c]=Ne):s[h]=Ne}},D={enc:!1,sbcch:0,snames:[],sharedf:y,arrayf:N,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(D.password=t.password);var W,re=[],U=[],M=[],Y=[],Q=!1,B=[];B.SheetNames=D.snames,B.sharedf=D.sharedf,B.arrayf=D.arrayf,B.names=[],B.XTI=[];var V=0,P=0,T=0,R=[],L=[],X;D.codepage=1200,sn(1200);for(var J=!1;e.l<e.length-1;){var te=e.l,G=e.read_shift(2);if(G===0&&V===10)break;var Z=e.l===e.length?0:e.read_shift(2),ae=J0[G];if(ae&&ae.f){if(t.bookSheets&&V===133&&G!==133)break;if(V=G,ae.r===2||ae.r==12){var de=e.read_shift(2);if(Z-=2,!D.enc&&de!==G&&((de&255)<<8|de>>8)!==G)throw new Error("rt mismatch: "+de+"!="+G);ae.r==12&&(e.l+=10,Z-=10)}var z={};if(G===10?z=ae.f(e,Z,D):z=RV(G,ae,e,Z,D),P==0&&[9,521,1033,2057].indexOf(V)===-1)continue;switch(G){case 34:r.opts.Date1904=k.WBProps.date1904=z;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(D.enc||(e.l=0),D.enc=z,!t.password)throw new Error("File is password-protected");if(z.valid==null)throw new Error("Encryption scheme unsupported");if(!z.valid)throw new Error("Password is incorrect");break;case 92:D.lastuser=z;break;case 66:var Ee=Number(z);switch(Ee){case 21010:Ee=1200;break;case 32768:Ee=1e4;break;case 32769:Ee=1252;break}sn(D.codepage=Ee),J=!0;break;case 317:D.rrtabid=z;break;case 25:D.winlocked=z;break;case 439:r.opts.RefreshAll=z;break;case 12:r.opts.CalcCount=z;break;case 16:r.opts.CalcDelta=z;break;case 17:r.opts.CalcIter=z;break;case 13:r.opts.CalcMode=z;break;case 14:r.opts.CalcPrecision=z;break;case 95:r.opts.CalcSaveRecalc=z;break;case 15:D.CalcRefMode=z;break;case 2211:r.opts.FullCalc=z;break;case 129:z.fDialog&&(s["!type"]="dialog"),z.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),z.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:_.push(z);break;case 430:B.push([z]),B[B.length-1].XTI=[];break;case 35:case 547:B[B.length-1].push(z);break;case 24:case 536:X={Name:z.Name,Ref:Yr(z.rgce,l,null,B,D)},z.itab>0&&(X.Sheet=z.itab-1),B.names.push(X),B[0]||(B[0]=[],B[0].XTI=[]),B[B.length-1].push(z),z.Name=="_xlnm._FilterDatabase"&&z.itab>0&&z.rgce&&z.rgce[0]&&z.rgce[0][0]&&z.rgce[0][0][0]=="PtgArea3d"&&(L[z.itab-1]={ref:pt(z.rgce[0][0][1][2])});break;case 22:D.ExternCount=z;break;case 23:B.length==0&&(B[0]=[],B[0].XTI=[]),B[B.length-1].XTI=B[B.length-1].XTI.concat(z),B.XTI=B.XTI.concat(z);break;case 2196:if(D.biff<8)break;X!=null&&(X.Comment=z[1]);break;case 18:s["!protect"]=z;break;case 19:z!==0&&D.WTF&&console.error("Password verifier: "+z);break;case 133:i[z.pos]=z,D.snames.push(z.name);break;case 10:{if(--P)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,s["!ref"]=pt(l),t.sheetRows&&t.sheetRows<=l.e.r){var ue=l.e.r;l.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=pt(l),l.e.r=ue}l.e.r++,l.e.c++}re.length>0&&(s["!merges"]=re),U.length>0&&(s["!objects"]=U),M.length>0&&(s["!cols"]=M),Y.length>0&&(s["!rows"]=Y),k.Sheets.push(j)}d===""?u=s:a[d]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(D.biff===8&&(D.biff={9:2,521:3,1033:4}[G]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[z.BIFFVer]||8),D.biffguess=z.BIFFVer==0,z.BIFFVer==0&&z.dt==4096&&(D.biff=5,J=!0,sn(D.codepage=28591)),D.biff==8&&z.BIFFVer==0&&z.dt==16&&(D.biff=2),P++)break;if(s=t.dense?[]:{},D.biff<8&&!J&&(J=!0,sn(D.codepage=t.codepage||1252)),D.biff<5||z.BIFFVer==0&&z.dt==4096){d===""&&(d="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var Ce={pos:e.l-Z,name:d};i[Ce.pos]=Ce,D.snames.push(d)}else d=(i[te]||{name:""}).name;z.dt==32&&(s["!type"]="chart"),z.dt==64&&(s["!type"]="macro"),re=[],U=[],D.arrayf=N=[],M=[],Y=[],Q=!1,j={Hidden:(i[te]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[z.r]||[])[z.c]:s[ct({c:z.c,r:z.r})])&&++z.c,v={ixfe:z.ixfe,XF:_[z.ixfe]||{},v:z.val,t:"n"},T>0&&(v.z=R[v.ixfe>>8&63]),Nn(v,t,r.opts.Date1904),A({c:z.c,r:z.r},v,t);break;case 5:case 517:v={ixfe:z.ixfe,XF:_[z.ixfe],v:z.val,t:z.t},T>0&&(v.z=R[v.ixfe>>8&63]),Nn(v,t,r.opts.Date1904),A({c:z.c,r:z.r},v,t);break;case 638:v={ixfe:z.ixfe,XF:_[z.ixfe],v:z.rknum,t:"n"},T>0&&(v.z=R[v.ixfe>>8&63]),Nn(v,t,r.opts.Date1904),A({c:z.c,r:z.r},v,t);break;case 189:for(var ve=z.c;ve<=z.C;++ve){var ge=z.rkrec[ve-z.c][0];v={ixfe:ge,XF:_[ge],v:z.rkrec[ve-z.c][1],t:"n"},T>0&&(v.z=R[v.ixfe>>8&63]),Nn(v,t,r.opts.Date1904),A({c:ve,r:z.r},v,t)}break;case 6:case 518:case 1030:{if(z.val=="String"){o=z;break}if(v=Bc(z.val,z.cell.ixfe,z.tt),v.XF=_[v.ixfe],t.cellFormula){var Fe=z.formula;if(Fe&&Fe[0]&&Fe[0][0]&&Fe[0][0][0]=="PtgExp"){var Ie=Fe[0][0][1][0],Ze=Fe[0][0][1][1],yt=ct({r:Ie,c:Ze});y[yt]?v.f=""+Yr(z.formula,l,z.cell,B,D):v.F=((t.dense?(s[Ie]||[])[Ze]:s[yt])||{}).F}else v.f=""+Yr(z.formula,l,z.cell,B,D)}T>0&&(v.z=R[v.ixfe>>8&63]),Nn(v,t,r.opts.Date1904),A(z.cell,v,t),o=z}break;case 7:case 519:if(o)o.val=z,v=Bc(z,o.cell.ixfe,"s"),v.XF=_[v.ixfe],t.cellFormula&&(v.f=""+Yr(o.formula,l,o.cell,B,D)),T>0&&(v.z=R[v.ixfe>>8&63]),Nn(v,t,r.opts.Date1904),A(o.cell,v,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{N.push(z);var ht=ct(z[0].s);if(m=t.dense?(s[z[0].s.r]||[])[z[0].s.c]:s[ht],t.cellFormula&&m){if(!o||!ht||!m)break;m.f=""+Yr(z[1],l,z[0],B,D),m.F=pt(z[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!o)break;y[ct(o.cell)]=z[0],m=t.dense?(s[o.cell.r]||[])[o.cell.c]:s[ct(o.cell)],(m||{}).f=""+Yr(z[0],l,f,B,D)}}break;case 253:v=Bc(c[z.isst].t,z.ixfe,"s"),c[z.isst].h&&(v.h=c[z.isst].h),v.XF=_[v.ixfe],T>0&&(v.z=R[v.ixfe>>8&63]),Nn(v,t,r.opts.Date1904),A({c:z.c,r:z.r},v,t);break;case 513:t.sheetStubs&&(v={ixfe:z.ixfe,XF:_[z.ixfe],t:"z"},T>0&&(v.z=R[v.ixfe>>8&63]),Nn(v,t,r.opts.Date1904),A({c:z.c,r:z.r},v,t));break;case 190:if(t.sheetStubs)for(var Ct=z.c;Ct<=z.C;++Ct){var Ue=z.ixfe[Ct-z.c];v={ixfe:Ue,XF:_[Ue],t:"z"},T>0&&(v.z=R[v.ixfe>>8&63]),Nn(v,t,r.opts.Date1904),A({c:Ct,r:z.r},v,t)}break;case 214:case 516:case 4:v=Bc(z.val,z.ixfe,"s"),v.XF=_[v.ixfe],T>0&&(v.z=R[v.ixfe>>8&63]),Nn(v,t,r.opts.Date1904),A({c:z.c,r:z.r},v,t);break;case 0:case 512:P===1&&(l=z);break;case 252:c=z;break;case 1054:if(D.biff==4){R[T++]=z[1];for(var kt=0;kt<T+163&&it[kt]!=z[1];++kt);kt>=163&&Kn(z[1],T+163)}else Kn(z[1],z[0]);break;case 30:{R[T++]=z;for(var qe=0;qe<T+163&&it[qe]!=z;++qe);qe>=163&&Kn(z,T+163)}break;case 229:re=re.concat(z);break;case 93:U[z.cmo[0]]=D.lastobj=z;break;case 438:D.lastobj.TxO=z;break;case 127:D.lastobj.ImData=z;break;case 440:for(g=z[0].s.r;g<=z[0].e.r;++g)for(p=z[0].s.c;p<=z[0].e.c;++p)m=t.dense?(s[g]||[])[p]:s[ct({c:p,r:g})],m&&(m.l=z[1]);break;case 2048:for(g=z[0].s.r;g<=z[0].e.r;++g)for(p=z[0].s.c;p<=z[0].e.c;++p)m=t.dense?(s[g]||[])[p]:s[ct({c:p,r:g})],m&&m.l&&(m.l.Tooltip=z[1]);break;case 28:{if(D.biff<=5&&D.biff>=2)break;m=t.dense?(s[z[0].r]||[])[z[0].c]:s[ct(z[0])];var Ft=U[z[2]];m||(t.dense?(s[z[0].r]||(s[z[0].r]=[]),m=s[z[0].r][z[0].c]={t:"z"}):m=s[ct(z[0])]={t:"z"},l.e.r=Math.max(l.e.r,z[0].r),l.s.r=Math.min(l.s.r,z[0].r),l.e.c=Math.max(l.e.c,z[0].c),l.s.c=Math.min(l.s.c,z[0].c)),m.c||(m.c=[]),x={a:z[1],t:Ft.TxO.t},m.c.push(x)}break;case 2173:wB(_[z.ixfe],z.ext);break;case 125:{if(!D.cellStyles)break;for(;z.e>=z.s;)M[z.e--]={width:z.w/256,level:z.level||0,hidden:!!(z.flags&1)},Q||(Q=!0,ox(z.w/256)),ks(M[z.e+1])}break;case 520:{var Qe={};z.level!=null&&(Y[z.r]=Qe,Qe.level=z.level),z.hidden&&(Y[z.r]=Qe,Qe.hidden=!0),z.hpt&&(Y[z.r]=Qe,Qe.hpt=z.hpt,Qe.hpx=dl(z.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||Js(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[G]]=z;break;case 161:s["!margins"]||Js(s["!margins"]={}),s["!margins"].header=z.header,s["!margins"].footer=z.footer;break;case 574:z.RTL&&(k.Views[0].RTL=!0);break;case 146:F=z;break;case 2198:W=z;break;case 140:S=z;break;case 442:d?j.CodeName=z||j.name:k.WBProps.CodeName=z||"ThisWorkbook";break}}else ae||console.error("Missing Info for XLS Record 0x"+G.toString(16)),e.l+=Z}return r.SheetNames=gr(i).sort(function(bt,se){return Number(bt)-Number(se)}).map(function(bt){return i[bt].name}),t.bookSheets||(r.Sheets=a),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&L.forEach(function(bt,se){r.Sheets[r.SheetNames[se]]["!autofilter"]=bt}),r.Strings=c,r.SSF=er(it),D.enc&&(r.Encryption=D.enc),W&&(r.Themes=W),r.Metadata={},S!==void 0&&(r.Metadata.Country=S),B.names.length>0&&(k.Names=B.names),r.Workbook=k,r}var io={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function PV(e,t,r){var a=rt.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var s=Cv(a,K0,io.DSI);for(var i in s)t[i]=s[i]}catch(d){if(r.WTF)throw d}var l=rt.find(e,"/!SummaryInformation");if(l&&l.size>0)try{var o=Cv(l,W0,io.SI);for(var c in o)t[c]==null&&(t[c]=o[c])}catch(d){if(r.WTF)throw d}t.HeadingPairs&&t.TitlesOfParts&&(vN(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function OV(e,t){var r=[],a=[],s=[],i=0,l,o=iv(K0,"n"),c=iv(W0,"n");if(e.Props)for(l=gr(e.Props),i=0;i<l.length;++i)(Object.prototype.hasOwnProperty.call(o,l[i])?r:Object.prototype.hasOwnProperty.call(c,l[i])?a:s).push([l[i],e.Props[l[i]]]);if(e.Custprops)for(l=gr(e.Custprops),i=0;i<l.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},l[i])||(Object.prototype.hasOwnProperty.call(o,l[i])?r:Object.prototype.hasOwnProperty.call(c,l[i])?a:s).push([l[i],e.Custprops[l[i]]]);var d=[];for(i=0;i<s.length;++i)EN.indexOf(s[i][0])>-1||gN.indexOf(s[i][0])>-1||s[i][1]!=null&&d.push(s[i]);a.length&&rt.utils.cfb_add(t,"/SummaryInformation",Fv(a,io.SI,c,W0)),(r.length||d.length)&&rt.utils.cfb_add(t,"/DocumentSummaryInformation",Fv(r,io.DSI,o,K0,d.length?d:null,io.UDI))}function bj(e,t){t||(t={}),gx(t),Lm(),t.codepage&&Im(t.codepage);var r,a;if(e.FullPaths){if(rt.find(e,"/encryption"))throw new Error("File is password-protected");r=rt.find(e,"!CompObj"),a=rt.find(e,"/Workbook")||rt.find(e,"/Book")}else{switch(t.type){case"base64":e=Ea(_a(e));break;case"binary":e=Ea(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Ur(e,0),a={content:e}}var s,i;if(r&&FV(r),t.bookProps&&!t.bookSheets)s={};else{var l=Nt?"buffer":"array";if(a&&a.content)s=MV(a.content,t);else if((i=rt.find(e,"PerfectOffice_MAIN"))&&i.content)s=Zs.to_workbook(i.content,(t.type=l,t));else if((i=rt.find(e,"NativeContent_MAIN"))&&i.content)s=Zs.to_workbook(i.content,(t.type=l,t));else throw(i=rt.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&rt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=XB(e))}var o={};return e.FullPaths&&PV(e,o,t),s.Props=s.Custprops=o,t.bookFiles&&(s.cfb=e),s}function IV(e,t){var r=t||{},a=rt.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return rt.utils.cfb_add(a,s,wj(e,r)),r.biff==8&&(e.Props||e.Custprops)&&OV(e,a),r.biff==8&&e.vbaraw&&qB(a,rt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var $o={0:{f:l9},1:{f:x9},2:{f:M9},3:{f:N9},4:{f:y9},5:{f:F9},6:{f:B9},7:{f:T9},8:{f:W9},9:{f:K9},10:{f:H9},11:{f:$9},12:{f:g9},13:{f:O9},14:{f:E9},15:{f:w9},16:{f:fj},17:{f:U9},18:{f:_9},19:{f:Jm},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:UU},40:{},42:{},43:{f:B6},44:{f:I6},45:{f:V6},46:{f:$6},47:{f:H6},48:{},49:{f:d5},50:{},51:{f:jB},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:ON},62:{f:L9},63:{f:RB},64:{f:oU},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ta,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:nU},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:h9},148:{f:d9,p:16},151:{f:J9},152:{},153:{f:LU},154:{},155:{},156:{f:OU},157:{},158:{},159:{T:1,f:e6},160:{T:-1},161:{T:1,f:vi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:G9},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:kB},336:{T:-1},337:{f:TB,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:$0},357:{},358:{},359:{},360:{T:1},361:{},362:{f:PN},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Q9},427:{f:eU},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:rU},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:f9},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:q9},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:$0},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:$B},633:{T:1},634:{T:-1},635:{T:1,f:VB},636:{T:-1},637:{f:m5},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:EU},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:cU},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},J0={6:{f:wf},10:{f:es},12:{f:Er},13:{f:Er},14:{f:yr},15:{f:yr},16:{f:Zr},17:{f:yr},18:{f:yr},19:{f:Er},20:{f:Iv},21:{f:Iv},23:{f:PN},24:{f:Bv},25:{f:yr},26:{},27:{},28:{f:cL},29:{},34:{f:yr},35:{f:Lv},38:{f:Zr},39:{f:Zr},40:{f:Zr},41:{f:Zr},42:{f:yr},43:{f:yr},47:{f:w6},49:{f:OI},51:{f:Er},60:{},61:{f:FI},64:{f:yr},65:{f:PI},66:{f:Er},77:{},80:{},81:{},82:{},85:{f:Er},89:{},90:{},91:{},92:{f:bI},93:{f:fL},94:{},95:{f:yr},96:{},97:{},99:{f:yr},125:{f:ON},128:{f:ZI},129:{f:kI},130:{f:Er},131:{f:yr},132:{f:yr},133:{f:NI},134:{},140:{f:bL},141:{f:Er},144:{},146:{f:NL},151:{},152:{},153:{},154:{},155:{},156:{f:Er},157:{},158:{},160:{f:CL},161:{f:SL},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:GI},190:{f:YI},193:{f:es},197:{},198:{},199:{},200:{},201:{},202:{f:yr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Er},220:{},221:{f:yr},222:{},224:{f:qI},225:{f:yI},226:{f:es},227:{},229:{f:dL},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:EI},253:{f:LI},255:{f:TI},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:SN},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:yr},353:{f:es},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:rL},431:{f:yr},432:{},433:{},434:{},437:{},438:{f:xL},439:{f:yr},440:{f:pL},441:{},442:{f:uc},443:{},444:{f:Er},445:{},446:{},448:{f:es},449:{f:CI,r:2},450:{f:es},512:{f:Mv},513:{f:_L},515:{f:eL},516:{f:zI},517:{f:Ov},519:{f:FL},520:{f:AI},523:{},545:{f:zv},549:{f:Rv},566:{},574:{f:RI},638:{f:WI},659:{},1048:{},1054:{f:VI},1084:{},1212:{f:iL},2048:{f:vL},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Oc},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:es},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:jL,r:12},2173:{f:bB,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:yr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:sL,r:12},2197:{},2198:{f:mB,r:12},2199:{},2200:{},2201:{},2202:{f:lL,r:12},2203:{f:es},2204:{},2205:{},2206:{},2207:{},2211:{f:_I},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Er},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:TL},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:kL},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Mv},1:{},2:{f:OL},3:{f:ML},4:{f:RL},5:{f:Ov},7:{f:LL},8:{},9:{f:Oc},11:{},22:{f:Er},30:{f:$I},31:{},32:{},33:{f:zv},36:{},37:{f:Rv},50:{f:BL},62:{},52:{},67:{},68:{f:Er},69:{},86:{},126:{},127:{f:DL},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:zL},223:{},234:{},354:{},421:{},518:{f:wf},521:{f:Oc},536:{f:Bv},547:{f:Lv},561:{},579:{},1030:{f:wf},1033:{f:Oc},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Pe(e,t,r,a){var s=t;if(!isNaN(s)){var i=a||(r||[]).length||0,l=e.next(4);l.write_shift(2,s),l.write_shift(2,i),i>0&&Xm(r)&&e.push(r)}}function LV(e,t,r,a){var s=(r||[]).length||0;if(s<=8224)return Pe(e,t,r,s);var i=t;if(!isNaN(i)){for(var l=r.parts||[],o=0,c=0,d=0;d+(l[o]||8224)<=8224;)d+=l[o]||8224,o++;var u=e.next(4);for(u.write_shift(2,i),u.write_shift(2,d),e.push(r.slice(c,c+d)),c+=d;c<s;){for(u=e.next(4),u.write_shift(2,60),d=0;d+(l[o]||8224)<=8224;)d+=l[o]||8224,o++;u.write_shift(2,d),e.push(r.slice(c,c+d)),c+=d}}}function xc(e,t,r){return e||(e=pe(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function BV(e,t,r,a){var s=pe(9);return xc(s,e,t),TN(r,a||"b",s),s}function zV(e,t,r){var a=pe(8+2*r.length);return xc(a,e,t),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function UV(e,t,r,a){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?Mr(Qt(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?Pe(e,2,IL(r,a,s)):Pe(e,3,PL(r,a,s));return;case"b":case"e":Pe(e,5,BV(r,a,t.v,t.t));return;case"s":case"str":Pe(e,4,zV(r,a,(t.v||"").slice(0,255)));return}Pe(e,1,xc(null,r,a))}function VV(e,t,r,a){var s=Array.isArray(t),i=It(t["!ref"]||"A1"),l,o="",c=[];if(i.e.c>255||i.e.r>16383){if(a.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),l=pt(i)}for(var d=i.s.r;d<=i.e.r;++d){o=br(d);for(var u=i.s.c;u<=i.e.c;++u){d===i.s.r&&(c[u]=or(u)),l=c[u]+o;var f=s?(t[d]||[])[u]:t[l];f&&UV(e,f,d,u)}}}function HV(e,t){for(var r=t||{},a=xa(),s=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(s=i);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Pe(a,r.biff==4?1033:r.biff==3?521:9,sx(e,16,r)),VV(a,e.Sheets[e.SheetNames[s]],s,r),Pe(a,10),a.end()}function $V(e,t,r){Pe(e,49,II({sz:12,name:"Arial"},r))}function KV(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&Pe(e,1054,HI(s,t[s],r))})}function WV(e,t){var r=pe(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Pe(e,2151,r),r=pe(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),DN(It(t["!ref"]||"A1"),r),r.write_shift(4,4),Pe(e,2152,r)}function GV(e,t){for(var r=0;r<16;++r)Pe(e,224,Pv({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(a){Pe(e,224,Pv(a,0,t))})}function YV(e,t){for(var r=0;r<t["!links"].length;++r){var a=t["!links"][r];Pe(e,440,gL(a)),a[1].Tooltip&&Pe(e,2048,yL(a))}delete t["!links"]}function XV(e,t){if(t){var r=0;t.forEach(function(a,s){++r<=256&&a&&Pe(e,125,EL(Pu(s,a),s))})}}function qV(e,t,r,a,s){var i=16+Fs(s.cellXfs,t,s);if(t.v==null&&!t.bf){Pe(e,513,ci(r,a,i));return}if(t.bf)Pe(e,6,k7(t,r,a,s,i));else switch(t.t){case"d":case"n":var l=t.t=="d"?Mr(Qt(t.v)):t.v;Pe(e,515,tL(r,a,l,i));break;case"b":case"e":Pe(e,517,QI(r,a,t.v,i,s,t.t));break;case"s":case"str":if(s.bookSST){var o=hx(s.Strings,t.v,s.revStrings);Pe(e,253,BI(r,a,o,i))}else Pe(e,516,UI(r,a,(t.v||"").slice(0,255),i,s));break;default:Pe(e,513,ci(r,a,i))}}function ZV(e,t,r){var a=xa(),s=r.SheetNames[e],i=r.Sheets[s]||{},l=(r||{}).Workbook||{},o=(l.Sheets||[])[e]||{},c=Array.isArray(i),d=t.biff==8,u,f="",h=[],m=It(i["!ref"]||"A1"),x=d?65536:16384;if(m.e.c>255||m.e.r>=x){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,x-1)}Pe(a,2057,sx(r,16,t)),Pe(a,13,za(1)),Pe(a,12,za(100)),Pe(a,15,na(!0)),Pe(a,17,na(!1)),Pe(a,16,li(.001)),Pe(a,95,na(!0)),Pe(a,42,na(!1)),Pe(a,43,na(!1)),Pe(a,130,za(1)),Pe(a,128,JI()),Pe(a,131,na(!1)),Pe(a,132,na(!1)),d&&XV(a,i["!cols"]),Pe(a,512,KI(m,t)),d&&(i["!links"]=[]);for(var p=m.s.r;p<=m.e.r;++p){f=br(p);for(var g=m.s.c;g<=m.e.c;++g){p===m.s.r&&(h[g]=or(g)),u=h[g]+f;var y=c?(i[p]||[])[g]:i[u];y&&(qV(a,y,p,g,t),d&&y.l&&i["!links"].push([u,y.l]))}}var N=o.CodeName||o.name||s;return d&&Pe(a,574,MI((l.Views||[])[0])),d&&(i["!merges"]||[]).length&&Pe(a,229,uL(i["!merges"])),d&&YV(a,i),Pe(a,442,AN(N)),d&&WV(a,i),Pe(a,10),a.end()}function JV(e,t,r){var a=xa(),s=(e||{}).Workbook||{},i=s.Sheets||[],l=s.WBProps||{},o=r.biff==8,c=r.biff==5;if(Pe(a,2057,sx(e,5,r)),r.bookType=="xla"&&Pe(a,135),Pe(a,225,o?za(1200):null),Pe(a,193,Q5(2)),c&&Pe(a,191),c&&Pe(a,192),Pe(a,226),Pe(a,92,wI("SheetJS",r)),Pe(a,66,za(o?1200:1252)),o&&Pe(a,353,za(0)),o&&Pe(a,448),Pe(a,317,AL(e.SheetNames.length)),o&&e.vbaraw&&Pe(a,211),o&&e.vbaraw){var d=l.CodeName||"ThisWorkbook";Pe(a,442,AN(d))}Pe(a,156,za(17)),Pe(a,25,na(!1)),Pe(a,18,na(!1)),Pe(a,19,za(0)),o&&Pe(a,431,na(!1)),o&&Pe(a,444,za(0)),Pe(a,61,DI()),Pe(a,64,na(!1)),Pe(a,141,za(0)),Pe(a,34,na(CU(e)=="true")),Pe(a,14,na(!0)),o&&Pe(a,439,na(!1)),Pe(a,218,za(0)),$V(a,e,r),KV(a,e.SSF,r),GV(a,r),o&&Pe(a,352,na(!1));var u=a.end(),f=xa();o&&Pe(f,140,wL()),o&&r.Strings&&LV(f,252,SI(r.Strings)),Pe(f,10);var h=f.end(),m=xa(),x=0,p=0;for(p=0;p<e.SheetNames.length;++p)x+=(o?12:11)+(o?2:1)*e.SheetNames[p].length;var g=u.length+x+h.length;for(p=0;p<e.SheetNames.length;++p){var y=i[p]||{};Pe(m,133,jI({pos:g,hs:y.Hidden||0,dt:0,name:e.SheetNames[p]},r)),g+=t[p].length}var N=m.end();if(x!=N.length)throw new Error("BS8 "+x+" != "+N.length);var v=[];return u.length&&v.push(u),N.length&&v.push(N),h.length&&v.push(h),Or(v)}function QV(e,t){var r=t||{},a=[];e&&!e.SSF&&(e.SSF=er(it)),e&&e.SSF&&(Nl(),Au(e.SSF),r.revssf=Cu(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,vx(r),r.cellXfs=[],Fs(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)a[a.length]=ZV(s,r,e);return a.unshift(JV(e,a,r)),Or(a)}function wj(e,t){for(var r=0;r<=e.SheetNames.length;++r){var a=e.Sheets[e.SheetNames[r]];if(!(!a||!a["!ref"])){var s=pa(a["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return QV(e,t);case 4:case 3:case 2:return HV(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function qv(e,t){var r=t||{},a=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),l=s.index,o=i&&i.index||e.length,c=IO(e.slice(l,o),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,u=0,f=0,h=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(l=0;l<c.length;++l){var p=c[l].trim(),g=p.slice(0,3).toLowerCase();if(g=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}u=0;continue}if(!(g!="<td"&&g!="<th")){var y=p.split(/<\/t[dh]>/i);for(o=0;o<y.length;++o){var N=y[o].trim();if(N.match(/<t[dh]/i)){for(var v=N,S=0;v.charAt(0)=="<"&&(S=v.indexOf(">"))>-1;)v=v.slice(S+1);for(var _=0;_<x.length;++_){var F=x[_];F.s.c==u&&F.s.r<d&&d<=F.e.r&&(u=F.e.c+1,_=-1)}var k=dt(N.slice(0,N.indexOf(">")));h=k.colspan?+k.colspan:1,((f=+k.rowspan)>1||h>1)&&x.push({s:{r:d,c:u},e:{r:d+(f||1)-1,c:u+h-1}});var j=k.t||k["data-t"]||"";if(!v.length){u+=h;continue}if(v=K2(v),m.s.r>d&&(m.s.r=d),m.e.r<d&&(m.e.r=d),m.s.c>u&&(m.s.c=u),m.e.c<u&&(m.e.c=u),!v.length){u+=h;continue}var w={t:"s",v};r.raw||!v.trim().length||j=="s"||(v==="TRUE"?w={t:"b",v:!0}:v==="FALSE"?w={t:"b",v:!1}:isNaN(un(v))?isNaN(ol(v).getDate())||(w={t:"d",v:Qt(v)},r.cellDates||(w={t:"n",v:Mr(w.v)}),w.z=r.dateNF||it[14]):w={t:"n",v:un(v)}),r.dense?(a[d]||(a[d]=[]),a[d][u]=w):a[ct({r:d,c:u})]=w,u+=h}}}}return a["!ref"]=pt(m),x.length&&(a["!merges"]=x),a}function eH(e,t,r,a){for(var s=e["!merges"]||[],i=[],l=t.s.c;l<=t.e.c;++l){for(var o=0,c=0,d=0;d<s.length;++d)if(!(s[d].s.r>r||s[d].s.c>l)&&!(s[d].e.r<r||s[d].e.c<l)){if(s[d].s.r<r||s[d].s.c<l){o=-1;break}o=s[d].e.r-s[d].s.r+1,c=s[d].e.c-s[d].s.c+1;break}if(!(o<0)){var u=ct({r,c:l}),f=a.dense?(e[r]||[])[l]:e[u],h=f&&f.v!=null&&(f.h||Wm(f.w||(qn(f),f.w)||""))||"",m={};o>1&&(m.rowspan=o),c>1&&(m.colspan=c),a.editable?h='<span contenteditable="true">'+h+"</span>":f&&(m["data-t"]=f&&f.t||"z",f.v!=null&&(m["data-v"]=f.v),f.z!=null&&(m["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),m.id=(a.id||"sjs")+"-"+u,i.push(Me("td",h,m))}}var x="<tr>";return x+i.join("")+"</tr>"}var tH='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',rH="</body></html>";function aH(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Cs(qv(r[0],t),t);var a=kx();return r.forEach(function(s,i){Nx(a,qv(s,t),"Sheet"+(i+1))}),a}function nH(e,t,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function kj(e,t){var r=t||{},a=r.header!=null?r.header:tH,s=r.footer!=null?r.footer:rH,i=[a],l=pa(e["!ref"]);r.dense=Array.isArray(e),i.push(nH(e,l,r));for(var o=l.s.r;o<=l.e.r;++o)i.push(eH(e,l,o,r));return i.push("</table>"+s),i.join("")}function Nj(e,t,r){var a=r||{},s=0,i=0;if(a.origin!=null)if(typeof a.origin=="number")s=a.origin;else{var l=typeof a.origin=="string"?cr(a.origin):a.origin;s=l.r,i=l.c}var o=t.getElementsByTagName("tr"),c=Math.min(a.sheetRows||1e7,o.length),d={s:{r:0,c:0},e:{r:s,c:i}};if(e["!ref"]){var u=pa(e["!ref"]);d.s.r=Math.min(d.s.r,u.s.r),d.s.c=Math.min(d.s.c,u.s.c),d.e.r=Math.max(d.e.r,u.e.r),d.e.c=Math.max(d.e.c,u.e.c),s==-1&&(d.e.r=s=u.e.r+1)}var f=[],h=0,m=e["!rows"]||(e["!rows"]=[]),x=0,p=0,g=0,y=0,N=0,v=0;for(e["!cols"]||(e["!cols"]=[]);x<o.length&&p<c;++x){var S=o[x];if(Zv(S)){if(a.display)continue;m[p]={hidden:!0}}var _=S.children;for(g=y=0;g<_.length;++g){var F=_[g];if(!(a.display&&Zv(F))){var k=F.hasAttribute("data-v")?F.getAttribute("data-v"):F.hasAttribute("v")?F.getAttribute("v"):K2(F.innerHTML),j=F.getAttribute("data-z")||F.getAttribute("z");for(h=0;h<f.length;++h){var w=f[h];w.s.c==y+i&&w.s.r<p+s&&p+s<=w.e.r&&(y=w.e.c+1-i,h=-1)}v=+F.getAttribute("colspan")||1,((N=+F.getAttribute("rowspan")||1)>1||v>1)&&f.push({s:{r:p+s,c:y+i},e:{r:p+s+(N||1)-1,c:y+i+(v||1)-1}});var E={t:"s",v:k},A=F.getAttribute("data-t")||F.getAttribute("t")||"";k!=null&&(k.length==0?E.t=A||"z":a.raw||k.trim().length==0||A=="s"||(k==="TRUE"?E={t:"b",v:!0}:k==="FALSE"?E={t:"b",v:!1}:isNaN(un(k))?isNaN(ol(k).getDate())||(E={t:"d",v:Qt(k)},a.cellDates||(E={t:"n",v:Mr(E.v)}),E.z=a.dateNF||it[14]):E={t:"n",v:un(k)})),E.z===void 0&&j!=null&&(E.z=j);var D="",W=F.getElementsByTagName("A");if(W&&W.length)for(var re=0;re<W.length&&!(W[re].hasAttribute("href")&&(D=W[re].getAttribute("href"),D.charAt(0)!="#"));++re);D&&D.charAt(0)!="#"&&(E.l={Target:D}),a.dense?(e[p+s]||(e[p+s]=[]),e[p+s][y+i]=E):e[ct({c:y+i,r:p+s})]=E,d.e.c<y+i&&(d.e.c=y+i),y+=v}}++p}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),d.e.r=Math.max(d.e.r,p-1+s),e["!ref"]=pt(d),p>=c&&(e["!fullref"]=pt((d.e.r=o.length-x+p-1+s,d))),e}function jj(e,t){var r=t||{},a=r.dense?[]:{};return Nj(a,e,t)}function sH(e,t){return Cs(jj(e,t),t)}function Zv(e){var t="",r=iH(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function iH(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function lH(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ot(t.replace(/<[^>]*>/g,""));return[r]}var Jv={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Ej(e,t){var r=t||{},a=Gm(e),s=[],i,l,o={name:""},c="",d=0,u,f,h={},m=[],x=r.dense?[]:{},p,g,y={value:""},N="",v=0,S=[],_=-1,F=-1,k={s:{r:1e6,c:1e7},e:{r:0,c:0}},j=0,w={},E=[],A={},D=0,W=0,re=[],U=1,M=1,Y=[],Q={Names:[]},B={},V=["",""],P=[],T={},R="",L=0,X=!1,J=!1,te=0;for(Lo.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=Lo.exec(a);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"":p[1]==="/"?(k.e.c>=k.s.c&&k.e.r>=k.s.r?x["!ref"]=pt(k):x["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=k.e.r&&(x["!fullref"]=x["!ref"],k.e.r=r.sheetRows-1,x["!ref"]=pt(k)),E.length&&(x["!merges"]=E),re.length&&(x["!rows"]=re),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),m.push(u.name),h[u.name]=x,J=!1):p[0].charAt(p[0].length-2)!=="/"&&(u=dt(p[0],!1),_=F=-1,k.s.r=k.s.c=1e7,k.e.r=k.e.c=0,x=r.dense?[]:{},E=[],re=[],J=!0);break;case"table-row-group":p[1]==="/"?--j:++j;break;case"table-row":case"":if(p[1]==="/"){_+=U,U=1;break}if(f=dt(p[0],!1),f.?_=f.-1:_==-1&&(_=0),U=+f["number-rows-repeated"]||1,U<10)for(te=0;te<U;++te)j>0&&(re[_+te]={level:j});F=-1;break;case"covered-table-cell":p[1]!=="/"&&++F,r.sheetStubs&&(r.dense?(x[_]||(x[_]=[]),x[_][F]={t:"z"}):x[ct({r:_,c:F})]={t:"z"}),N="",S=[];break;case"table-cell":case"":if(p[0].charAt(p[0].length-2)==="/")++F,y=dt(p[0],!1),M=parseInt(y["number-columns-repeated"]||"1",10),g={t:"z",v:null},y.formula&&r.cellFormula!=!1&&(g.f=Gv(Ot(y.formula))),(y.||y["value-type"])=="string"&&(g.t="s",g.v=Ot(y["string-value"]||""),r.dense?(x[_]||(x[_]=[]),x[_][F]=g):x[ct({r:_,c:F})]=g),F+=M-1;else if(p[1]!=="/"){++F,N="",v=0,S=[],M=1;var G=U?_+U-1:_;if(F>k.e.c&&(k.e.c=F),F<k.s.c&&(k.s.c=F),_<k.s.r&&(k.s.r=_),G>k.e.r&&(k.e.r=G),y=dt(p[0],!1),P=[],T={},g={t:y.||y["value-type"],v:null},r.cellFormula)if(y.formula&&(y.formula=Ot(y.formula)),y["number-matrix-columns-spanned"]&&y["number-matrix-rows-spanned"]&&(D=parseInt(y["number-matrix-rows-spanned"],10)||0,W=parseInt(y["number-matrix-columns-spanned"],10)||0,A={s:{r:_,c:F},e:{r:_+D-1,c:F+W-1}},g.F=pt(A),Y.push([A,g.F])),y.formula)g.f=Gv(y.formula);else for(te=0;te<Y.length;++te)_>=Y[te][0].s.r&&_<=Y[te][0].e.r&&F>=Y[te][0].s.c&&F<=Y[te][0].e.c&&(g.F=Y[te][1]);switch((y["number-columns-spanned"]||y["number-rows-spanned"])&&(D=parseInt(y["number-rows-spanned"],10)||0,W=parseInt(y["number-columns-spanned"],10)||0,A={s:{r:_,c:F},e:{r:_+D-1,c:F+W-1}},E.push(A)),y["number-columns-repeated"]&&(M=parseInt(y["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=Zt(y["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(y.value);break;case"percentage":g.t="n",g.v=parseFloat(y.value);break;case"currency":g.t="n",g.v=parseFloat(y.value);break;case"date":g.t="d",g.v=Qt(y["date-value"]),r.cellDates||(g.t="n",g.v=Mr(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=MO(y["time-value"])/86400,r.cellDates&&(g.t="d",g.v=Fu(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(y.);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",y["string-value"]!=null&&(N=Ot(y["string-value"]),S=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(X=!1,g.t==="s"&&(g.v=N||"",S.length&&(g.R=S),X=v==0),B.Target&&(g.l=B),P.length>0&&(g.c=P,P=[]),N&&r.cellText!==!1&&(g.w=N),X&&(g.t="z",delete g.v),(!X||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=_))for(var Z=0;Z<U;++Z){if(M=parseInt(y["number-columns-repeated"]||"1",10),r.dense)for(x[_+Z]||(x[_+Z]=[]),x[_+Z][F]=Z==0?g:er(g);--M>0;)x[_+Z][F+M]=er(g);else for(x[ct({r:_+Z,c:F})]=g;--M>0;)x[ct({r:_+Z,c:F+M})]=er(g);k.e.c<=F&&(k.e.c=F)}M=parseInt(y["number-columns-repeated"]||"1",10),F+=M-1,M=0,g={},N="",S=[]}B={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((i=s.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&s.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((i=s.pop())[0]!==p[3])throw"Bad state: "+i;T.t=N,S.length&&(T.R=S),T.a=R,P.push(T)}else p[0].charAt(p[0].length-2)!=="/"&&s.push([p[3],!1]);R="",L=0,N="",v=0,S=[];break;case"creator":p[1]==="/"?R=a.slice(L,p.index):L=p.index+p[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((i=s.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&s.push([p[3],!1]);N="",v=0,S=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(w[o.name]=c,(i=s.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&(c="",o=dt(p[0],!1),s.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":l=dt(p[0],!1),c+=Jv[p[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":l=dt(p[0],!1),c+=Jv[p[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":c+=a.slice(d,p.index);break}else d=p.index+p[0].length;break;case"named-range":l=dt(p[0],!1),V=kf(l["cell-range-address"]);var ae={Name:l.name,Ref:V[0]+"!"+V[1]};J&&(ae.Sheet=m.length),Q.Names.push(ae);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(p[1]==="/"&&(!y||!y["string-value"])){var de=lH(a.slice(v,p.index));N=(N.length>0?N+`
`:"")+de[0]}else dt(p[0],!1),v=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{V=kf(dt(p[0])["target-range-address"]),h[V[0]]["!autofilter"]={ref:V[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(B=dt(p[0],!1),!B.href)break;B.Target=Ot(B.href),delete B.href,B.Target.charAt(0)=="#"&&B.Target.indexOf(".")>-1?(V=kf(B.Target.slice(1)),B.Target="#"+V[0]+"!"+V[1]):B.Target.match(/^\.\.[\\\/]/)&&(B.Target=B.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(p)}}var z={Sheets:h,SheetNames:m,Workbook:Q};return r.bookSheets&&delete z.Sheets,z}function Qv(e,t){t=t||{},Ia(e,"META-INF/manifest.xml")&&M5(jr(e,"META-INF/manifest.xml"),t);var r=Sa(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=Ej(Gt(r),t);return Ia(e,"meta.xml")&&(a.Props=xN(jr(e,"meta.xml"))),a}function e1(e,t){return Ej(e,t)}var oH=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Io({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return wr+t}})(),t1=(function(){var e=function(i){return Kt(i).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,a=function(i,l,o){var c=[];c.push('      <table:table table:name="'+Kt(l.SheetNames[o])+`" table:style-name="ta1">
`);var d=0,u=0,f=pa(i["!ref"]||"A1"),h=i["!merges"]||[],m=0,x=Array.isArray(i);if(i["!cols"])for(u=0;u<=f.e.c;++u)c.push("        <table:table-column"+(i["!cols"][u]?' table:style-name="co'+i["!cols"][u].ods+'"':"")+`></table:table-column>
`);var p="",g=i["!rows"]||[];for(d=0;d<f.s.r;++d)p=g[d]?' table:style-name="ro'+g[d].ods+'"':"",c.push("        <table:table-row"+p+`></table:table-row>
`);for(;d<=f.e.r;++d){for(p=g[d]?' table:style-name="ro'+g[d].ods+'"':"",c.push("        <table:table-row"+p+`>
`),u=0;u<f.s.c;++u)c.push(t);for(;u<=f.e.c;++u){var y=!1,N={},v="";for(m=0;m!=h.length;++m)if(!(h[m].s.c>u)&&!(h[m].s.r>d)&&!(h[m].e.c<u)&&!(h[m].e.r<d)){(h[m].s.c!=u||h[m].s.r!=d)&&(y=!0),N["table:number-columns-spanned"]=h[m].e.c-h[m].s.c+1,N["table:number-rows-spanned"]=h[m].e.r-h[m].s.r+1;break}if(y){c.push(r);continue}var S=ct({r:d,c:u}),_=x?(i[d]||[])[u]:i[S];if(_&&_.f&&(N["table:formula"]=Kt(A7(_.f)),_.F&&_.F.slice(0,S.length)==S)){var F=pa(_.F);N["table:number-matrix-columns-spanned"]=F.e.c-F.s.c+1,N["table:number-matrix-rows-spanned"]=F.e.r-F.s.r+1}if(!_){c.push(t);continue}switch(_.t){case"b":v=_.v?"TRUE":"FALSE",N["office:value-type"]="boolean",N["office:boolean-value"]=_.v?"true":"false";break;case"n":v=_.w||String(_.v||0),N["office:value-type"]="float",N["office:value"]=_.v||0;break;case"s":case"str":v=_.v==null?"":_.v,N["office:value-type"]="string";break;case"d":v=_.w||Qt(_.v).toISOString(),N["office:value-type"]="date",N["office:date-value"]=Qt(_.v).toISOString(),N["table:style-name"]="ce1";break;default:c.push(t);continue}var k=e(v);if(_.l&&_.l.Target){var j=_.l.Target;j=j.charAt(0)=="#"?"#"+_7(j.slice(1)):j,j.charAt(0)!="#"&&!j.match(/^\w+:/)&&(j="../"+j),k=Me("text:a",k,{"xlink:href":j.replace(/&/g,"&amp;")})}c.push("          "+Me("table:table-cell",Me("text:p",k,{}),N)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},s=function(i,l){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var o=0;l.SheetNames.map(function(d){return l.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var u=0;u<d["!cols"].length;++u)if(d["!cols"][u]){var f=d["!cols"][u];if(f.width==null&&f.wpx==null&&f.wch==null)continue;ks(f),f.ods=o;var h=d["!cols"][u].wpx+"px";i.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),i.push(`  </style:style>
`),++o}}});var c=0;l.SheetNames.map(function(d){return l.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var u=0;u<d["!rows"].length;++u)if(d["!rows"][u]){d["!rows"][u].ods=c;var f=d["!rows"][u].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(l,o){var c=[wr],d=Io({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=Io({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+d+u+`>
`),c.push(mN().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+d+`>
`),s(c,l),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=l.SheetNames.length;++f)c.push(a(l.Sheets[l.SheetNames[f]],l,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}})();function Sj(e,t){if(t.bookType=="fods")return t1(e,t);var r=Hm(),a="",s=[],i=[];return a="mimetype",vt(r,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",vt(r,a,t1(e,t)),s.push([a,"text/xml"]),i.push([a,"ContentFile"]),a="styles.xml",vt(r,a,oH(e,t)),s.push([a,"text/xml"]),i.push([a,"StylesFile"]),a="meta.xml",vt(r,a,wr+mN()),s.push([a,"text/xml"]),i.push([a,"MetadataFile"]),a="manifest.rdf",vt(r,a,I5(i)),s.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",vt(r,a,P5(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function di(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Q0(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Gt(_s(e))}function cH(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Ea(Cn(e))}function dH(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var a=0;a<t.length;++a)if(e[r+a]!=t[a])continue e;return!0}return!1}function js(e){var t=e.reduce(function(s,i){return s+i.length},0),r=new Uint8Array(t),a=0;return e.forEach(function(s){r.set(s,a),a+=s.length}),r}function r1(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function uH(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,a=e[t+14]&1,s=t+13;s>=t;--s)a=a*256+e[s];return(e[t+15]&128?-a:a)*Math.pow(10,r-6176)}function fH(e,t,r){var a=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,a-6176);e[t+15]|=a>>7,e[t+14]|=(a&127)<<1;for(var i=0;s>=1;++i,s/=256)e[t+i]=s&255;e[t+15]|=r>=0?0:128}function Ko(e,t){var r=t?t[0]:0,a=e[r]&127;e:if(e[r++]>=128&&(a|=(e[r]&127)<<7,e[r++]<128||(a|=(e[r]&127)<<14,e[r++]<128)||(a|=(e[r]&127)<<21,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),a}function Ht(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function pr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Bt(e){for(var t=[],r=[0];r[0]<e.length;){var a=r[0],s=Ko(e,r),i=s&7;s=Math.floor(s/8);var l=0,o;if(s==0)break;switch(i){case 0:{for(var c=r[0];e[r[0]++]>=128;);o=e.slice(c,r[0])}break;case 5:l=4,o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=Ko(e,r),o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(a))}var d={data:o,type:i};t[s]==null?t[s]=[d]:t[s].push(d)}return t}function Br(e){var t=[];return e.forEach(function(r,a){r.forEach(function(s){s.data&&(t.push(Ht(a*8+s.type)),s.type==2&&t.push(Ht(s.data.length)),t.push(s.data))})}),js(t)}function px(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Pa(e){for(var t,r=[],a=[0];a[0]<e.length;){var s=Ko(e,a),i=Bt(e.slice(a[0],a[0]+s));a[0]+=s;var l={id:pr(i[1][0].data),messages:[]};i[2].forEach(function(o){var c=Bt(o.data),d=pr(c[3][0].data);l.messages.push({meta:c,data:e.slice(a[0],a[0]+d)}),a[0]+=d}),(t=i[3])!=null&&t[0]&&(l.merge=pr(i[3][0].data)>>>0>0),r.push(l)}return r}function Si(e){var t=[];return e.forEach(function(r){var a=[];a[1]=[{data:Ht(r.id),type:0}],a[2]=[],r.merge!=null&&(a[3]=[{data:Ht(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(l){s.push(l.data),l.meta[3]=[{type:0,data:Ht(l.data.length)}],a[2].push({data:Br(l.meta),type:2})});var i=Br(a);t.push(Ht(i.length)),t.push(i),s.forEach(function(l){return t.push(l)})}),js(t)}function hH(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=Ko(t,r),s=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var l=t[r[0]++]>>2;if(l<60)++l;else{var o=l-59;l=t[r[0]],o>1&&(l|=t[r[0]+1]<<8),o>2&&(l|=t[r[0]+2]<<16),o>3&&(l|=t[r[0]+3]<<24),l>>>=0,l++,r[0]+=o}s.push(t.slice(r[0],r[0]+l)),r[0]+=l;continue}else{var c=0,d=0;if(i==1?(d=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(d=(t[r[0]++]>>2)+1,i==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[js(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(d>=c)for(s.push(s[0].slice(-c)),d-=c;d>=s[s.length-1].length;)s.push(s[s.length-1]),d-=s[s.length-1].length;s.push(s[0].slice(-c,-c+d))}}var u=js(s);if(u.length!=a)throw new Error("Unexpected length: ".concat(u.length," != ").concat(a));return u}function Oa(e){for(var t=[],r=0;r<e.length;){var a=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(hH(a,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return js(t)}function Ti(e){for(var t=[],r=0;r<e.length;){var a=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var i=Ht(a),l=i.length;t.push(i),a<=60?(l++,t.push(new Uint8Array([a-1<<2]))):a<=256?(l+=2,t.push(new Uint8Array([240,a-1&255]))):a<=65536?(l+=3,t.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(l+=4,t.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(l+=5,t.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),t.push(e.slice(r,r+a)),l+=a,s[0]=0,s[1]=l&255,s[2]=l>>8&255,s[3]=l>>16&255,r+=a}return js(t)}function mH(e,t,r,a){var s=di(e),i=s.getUint32(4,!0),l=(a>1?12:8)+r1(i&(a>1?3470:398))*4,o=-1,c=-1,d=NaN,u=new Date(2001,0,1);i&512&&(o=s.getUint32(l,!0),l+=4),l+=r1(i&(a>1?12288:4096))*4,i&16&&(c=s.getUint32(l,!0),l+=4),i&32&&(d=s.getFloat64(l,!0),l+=8),i&64&&(u.setTime(u.getTime()+s.getFloat64(l,!0)*1e3),l+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:d};break;case 3:f={t:"s",v:t[c]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:d>0};break;case 7:f={t:"n",v:d/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else if(c>-1)f={t:"s",v:t[c]};else if(!isNaN(d))f={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function xH(e,t,r){var a=di(e),s=a.getUint32(8,!0),i=12,l=-1,o=-1,c=NaN,d=NaN,u=new Date(2001,0,1);s&1&&(c=uH(e,i),i+=16),s&2&&(d=a.getFloat64(i,!0),i+=8),s&4&&(u.setTime(u.getTime()+a.getFloat64(i,!0)*1e3),i+=8),s&8&&(o=a.getUint32(i,!0),i+=4),s&16&&(l=a.getUint32(i,!0),i+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[o]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:d>0};break;case 7:f={t:"n",v:d/86400};break;case 8:f={t:"e",v:0};break;case 9:if(l>-1)f={t:"s",v:r[l]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return f}function jf(e,t){var r=new Uint8Array(32),a=di(r),s=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,fH(r,s,e.v),i|=1,s+=16;break;case"b":r[1]=6,a.setFloat64(s,e.v?1:0,!0),i|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,a.setUint32(s,t.indexOf(e.v),!0),i|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,i,!0),r.slice(0,s)}function Ef(e,t){var r=new Uint8Array(32),a=di(r),s=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,a.setFloat64(s,e.v,!0),i|=32,s+=8;break;case"b":r[2]=6,a.setFloat64(s,e.v?1:0,!0),i|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,a.setUint32(s,t.indexOf(e.v),!0),i|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,i,!0),r.slice(0,s)}function pH(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return mH(e,t,r,e[0]);case 5:return xH(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Gr(e){var t=Bt(e);return Ko(t[1][0].data)}function a1(e,t){var r=Bt(t.data),a=pr(r[1][0].data),s=r[3],i=[];return(s||[]).forEach(function(l){var o=Bt(l.data),c=pr(o[1][0].data)>>>0;switch(a){case 1:i[c]=Q0(o[3][0].data);break;case 8:{var d=e[Gr(o[9][0].data)][0],u=Bt(d.data),f=e[Gr(u[1][0].data)][0],h=pr(f.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var m=Bt(f.data);i[c]=m[3].map(function(x){return Q0(x.data)}).join("")}break}}),i}function gH(e,t){var r,a,s,i,l,o,c,d,u,f,h,m,x,p,g=Bt(e),y=pr(g[1][0].data)>>>0,N=pr(g[2][0].data)>>>0,v=((a=(r=g[8])==null?void 0:r[0])==null?void 0:a.data)&&pr(g[8][0].data)>0||!1,S,_;if((i=(s=g[7])==null?void 0:s[0])!=null&&i.data&&t!=0)S=(o=(l=g[7])==null?void 0:l[0])==null?void 0:o.data,_=(d=(c=g[6])==null?void 0:c[0])==null?void 0:d.data;else if((f=(u=g[4])==null?void 0:u[0])!=null&&f.data&&t!=1)S=(m=(h=g[4])==null?void 0:h[0])==null?void 0:m.data,_=(p=(x=g[3])==null?void 0:x[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var F=v?4:1,k=di(S),j=[],w=0;w<S.length/2;++w){var E=k.getUint16(w*2,!0);E<65535&&j.push([w,E])}if(j.length!=N)throw"Expected ".concat(N," cells, found ").concat(j.length);var A=[];for(w=0;w<j.length-1;++w)A[j[w][0]]=_.subarray(j[w][1]*F,j[w+1][1]*F);return j.length>=1&&(A[j[j.length-1][0]]=_.subarray(j[j.length-1][1]*F)),{R:y,cells:A}}function vH(e,t){var r,a=Bt(t.data),s=(r=a==null?void 0:a[7])!=null&&r[0]?pr(a[7][0].data)>>>0>0?1:0:-1,i=px(a[5],function(l){return gH(l,s)});return{nrows:pr(a[4][0].data)>>>0,data:i.reduce(function(l,o){return l[o.R]||(l[o.R]=[]),o.cells.forEach(function(c,d){if(l[o.R][d])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(d));l[o.R][d]=c}),l},[])}}function yH(e,t,r){var a,s=Bt(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(pr(s[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(i.e.c=(pr(s[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=pt(i);var l=Bt(s[4][0].data),o=a1(e,e[Gr(l[4][0].data)][0]),c=(a=l[17])!=null&&a[0]?a1(e,e[Gr(l[17][0].data)][0]):[],d=Bt(l[3][0].data),u=0;d[1].forEach(function(f){var h=Bt(f.data),m=e[Gr(h[2][0].data)][0],x=pr(m.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var p=vH(e,m);p.data.forEach(function(g,y){g.forEach(function(N,v){var S=ct({r:u+y,c:v}),_=pH(N,o,c);_&&(r[S]=_)})}),u+=p.nrows})}function bH(e,t){var r=Bt(t.data),a={"!ref":"A1"},s=e[Gr(r[2][0].data)],i=pr(s[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return yH(e,s[0],a),a}function wH(e,t){var r,a=Bt(t.data),s={name:(r=a[1])!=null&&r[0]?Q0(a[1][0].data):"",sheets:[]},i=px(a[2],Gr);return i.forEach(function(l){e[l].forEach(function(o){var c=pr(o.meta[1][0].data);c==6e3&&s.sheets.push(bH(e,o))})}),s}function kH(e,t){var r=kx(),a=Bt(t.data),s=px(a[1],Gr);if(s.forEach(function(i){e[i].forEach(function(l){var o=pr(l.meta[1][0].data);if(o==2){var c=wH(e,l);c.sheets.forEach(function(d,u){Nx(r,d,u==0?c.name:c.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Sf(e){var t,r,a,s,i={},l=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var d;try{d=Oa(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var u;try{u=Pa(d)}catch(f){return console.log("## "+(f.message||f))}u.forEach(function(f){i[f.id]=f.messages,l.push(f.id)})}}),!l.length)throw new Error("File has no messages");var o=((s=(a=(r=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:a[1])==null?void 0:s[0].data)&&pr(i[1][0].meta[1][0].data)==1&&i[1][0];if(o||l.forEach(function(c){i[c].forEach(function(d){var u=pr(d.meta[1][0].data)>>>0;if(u==1)if(!o)o=d;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return kH(i,o)}function NH(e,t,r){var a,s,i,l;if(!((a=e[6])!=null&&a[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var o=((l=(i=e[8])==null?void 0:i[0])==null?void 0:l.data)&&pr(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,d=di(e[7][0].data),u=0,f=[],h=di(e[4][0].data),m=0,x=[],p=0;p<t.length;++p){if(t[p]==null){d.setUint16(p*2,65535,!0),h.setUint16(p*2,65535);continue}d.setUint16(p*2,u,!0),h.setUint16(p*2,m,!0);var g,y;switch(typeof t[p]){case"string":g=jf({t:"s",v:t[p]},r),y=Ef({t:"s",v:t[p]},r);break;case"number":g=jf({t:"n",v:t[p]},r),y=Ef({t:"n",v:t[p]},r);break;case"boolean":g=jf({t:"b",v:t[p]},r),y=Ef({t:"b",v:t[p]},r);break;default:throw new Error("Unsupported value "+t[p])}f.push(g),u+=g.length,x.push(y),m+=y.length,++c}for(e[2][0].data=Ht(c);p<e[7][0].data.length/2;++p)d.setUint16(p*2,65535,!0),h.setUint16(p*2,65535,!0);return e[6][0].data=js(f),e[3][0].data=js(x),c}function jH(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=pa(r["!ref"]);a.s.r=a.s.c=0;var s=!1;a.e.c>9&&(s=!0,a.e.c=9),a.e.r>49&&(s=!0,a.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(pt(a)));var i=Wd(r,{range:a,header:1}),l=["~Sh33tJ5~"];i.forEach(function(R){return R.forEach(function(L){typeof L=="string"&&l.push(L)})});var o={},c=[],d=rt.read(t.numbers,{type:"base64"});d.FileIndex.map(function(R,L){return[R,d.FullPaths[L]]}).forEach(function(R){var L=R[0],X=R[1];if(L.type==2&&L.name.match(/\.iwa/)){var J=L.content,te=Oa(J),G=Pa(te);G.forEach(function(Z){c.push(Z.id),o[Z.id]={deps:[],location:X,type:pr(Z.messages[0].meta[1][0].data)}})}}),c.sort(function(R,L){return R-L});var u=c.filter(function(R){return R>1}).map(function(R){return[R,Ht(R)]});d.FileIndex.map(function(R,L){return[R,d.FullPaths[L]]}).forEach(function(R){var L=R[0];if(R[1],!!L.name.match(/\.iwa/)){var X=Pa(Oa(L.content));X.forEach(function(J){J.messages.forEach(function(te){u.forEach(function(G){J.messages.some(function(Z){return pr(Z.meta[1][0].data)!=11006&&dH(Z.data,G[1])})&&o[G[0]].deps.push(J.id)})})})}});for(var f=rt.find(d,o[1].location),h=Pa(Oa(f.content)),m,x=0;x<h.length;++x){var p=h[x];p.id==1&&(m=p)}var g=Gr(Bt(m.messages[0].data)[1][0].data);for(f=rt.find(d,o[g].location),h=Pa(Oa(f.content)),x=0;x<h.length;++x)p=h[x],p.id==g&&(m=p);for(g=Gr(Bt(m.messages[0].data)[2][0].data),f=rt.find(d,o[g].location),h=Pa(Oa(f.content)),x=0;x<h.length;++x)p=h[x],p.id==g&&(m=p);for(g=Gr(Bt(m.messages[0].data)[2][0].data),f=rt.find(d,o[g].location),h=Pa(Oa(f.content)),x=0;x<h.length;++x)p=h[x],p.id==g&&(m=p);var y=Bt(m.messages[0].data);{y[6][0].data=Ht(a.e.r+1),y[7][0].data=Ht(a.e.c+1);var N=Gr(y[46][0].data),v=rt.find(d,o[N].location),S=Pa(Oa(v.content));{for(var _=0;_<S.length&&S[_].id!=N;++_);if(S[_].id!=N)throw"Bad ColumnRowUIDMapArchive";var F=Bt(S[_].messages[0].data);F[1]=[],F[2]=[],F[3]=[];for(var k=0;k<=a.e.c;++k){var j=[];j[1]=j[2]=[{type:0,data:Ht(k+420690)}],F[1].push({type:2,data:Br(j)}),F[2].push({type:0,data:Ht(k)}),F[3].push({type:0,data:Ht(k)})}F[4]=[],F[5]=[],F[6]=[];for(var w=0;w<=a.e.r;++w)j=[],j[1]=j[2]=[{type:0,data:Ht(w+726270)}],F[4].push({type:2,data:Br(j)}),F[5].push({type:0,data:Ht(w)}),F[6].push({type:0,data:Ht(w)});S[_].messages[0].data=Br(F)}v.content=Ti(Si(S)),v.size=v.content.length,delete y[46];var E=Bt(y[4][0].data);{E[7][0].data=Ht(a.e.r+1);var A=Bt(E[1][0].data),D=Gr(A[2][0].data);v=rt.find(d,o[D].location),S=Pa(Oa(v.content));{if(S[0].id!=D)throw"Bad HeaderStorageBucket";var W=Bt(S[0].messages[0].data);for(w=0;w<i.length;++w){var re=Bt(W[2][0].data);re[1][0].data=Ht(w),re[4][0].data=Ht(i[w].length),W[2][w]={type:W[2][0].type,data:Br(re)}}S[0].messages[0].data=Br(W)}v.content=Ti(Si(S)),v.size=v.content.length;var U=Gr(E[2][0].data);v=rt.find(d,o[U].location),S=Pa(Oa(v.content));{if(S[0].id!=U)throw"Bad HeaderStorageBucket";for(W=Bt(S[0].messages[0].data),k=0;k<=a.e.c;++k)re=Bt(W[2][0].data),re[1][0].data=Ht(k),re[4][0].data=Ht(a.e.r+1),W[2][k]={type:W[2][0].type,data:Br(re)};S[0].messages[0].data=Br(W)}v.content=Ti(Si(S)),v.size=v.content.length;var M=Gr(E[4][0].data);(function(){for(var R=rt.find(d,o[M].location),L=Pa(Oa(R.content)),X,J=0;J<L.length;++J){var te=L[J];te.id==M&&(X=te)}var G=Bt(X.messages[0].data);{G[3]=[];var Z=[];l.forEach(function(z,Ee){Z[1]=[{type:0,data:Ht(Ee)}],Z[2]=[{type:0,data:Ht(1)}],Z[3]=[{type:2,data:cH(z)}],G[3].push({type:2,data:Br(Z)})})}X.messages[0].data=Br(G);var ae=Si(L),de=Ti(ae);R.content=de,R.size=R.content.length})();var Y=Bt(E[3][0].data);{var Q=Y[1][0];delete Y[2];var B=Bt(Q.data);{var V=Gr(B[2][0].data);(function(){for(var R=rt.find(d,o[V].location),L=Pa(Oa(R.content)),X,J=0;J<L.length;++J){var te=L[J];te.id==V&&(X=te)}var G=Bt(X.messages[0].data);{delete G[6],delete Y[7];var Z=new Uint8Array(G[5][0].data);G[5]=[];for(var ae=0,de=0;de<=a.e.r;++de){var z=Bt(Z);ae+=NH(z,i[de],l),z[1][0].data=Ht(de),G[5].push({data:Br(z),type:2})}G[1]=[{type:0,data:Ht(a.e.c+1)}],G[2]=[{type:0,data:Ht(a.e.r+1)}],G[3]=[{type:0,data:Ht(ae)}],G[4]=[{type:0,data:Ht(a.e.r+1)}]}X.messages[0].data=Br(G);var Ee=Si(L),ue=Ti(Ee);R.content=ue,R.size=R.content.length})()}Q.data=Br(B)}E[3][0].data=Br(Y)}y[4][0].data=Br(E)}m.messages[0].data=Br(y);var P=Si(h),T=Ti(P);return f.content=T,f.size=f.content.length,d}function Tj(e){return function(r){for(var a=0;a!=e.length;++a){var s=e[a];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function gx(e){Tj([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function vx(e){Tj([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function EH(e){return St.WS.indexOf(e)>-1?"sheet":e==St.CS?"chart":e==St.DS?"dialog":e==St.MS?"macro":e&&e.length?e:"sheet"}function SH(e,t){if(!e)return 0;try{e=t.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,EH(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function TH(e,t,r,a,s,i,l,o,c,d,u,f){try{i[a]=ro(Sa(e,r,!0),t);var h=jr(e,t),m;switch(o){case"sheet":m=XU(h,t,s,c,i[a],d,u,f);break;case"chart":if(m=qU(h,t,s,c,i[a],d,u,f),!m||!m["!drawel"])break;var x=Wl(m["!drawel"].Target,t),p=Bo(x),g=OB(Sa(e,x,!0),ro(Sa(e,p,!0),x)),y=Wl(g,x),N=Bo(y);m=NU(Sa(e,y,!0),y,c,ro(Sa(e,N,!0),y),d,m);break;case"macro":m=ZU(h,t,s,c,i[a],d,u,f);break;case"dialog":m=JU(h,t,s,c,i[a],d,u,f);break;default:throw new Error("Unrecognized sheet type "+o)}l[a]=m;var v=[];i&&i[a]&&gr(i[a]).forEach(function(S){var _="";if(i[a][S].Type==St.CMNT){_=Wl(i[a][S].Target,t);var F=rV(jr(e,_,!0),_,c);if(!F||!F.length)return;Vv(m,F,!1)}i[a][S].Type==St.TCMNT&&(_=Wl(i[a][S].Target,t),v=v.concat(LB(jr(e,_,!0),c)))}),v&&v.length&&Vv(m,v,!0,c.people||[])}catch(S){if(c.WTF)throw S}}function Ra(e){return e.charAt(0)=="/"?e.slice(1):e}function AH(e,t){if(Nl(),t=t||{},gx(t),Ia(e,"META-INF/manifest.xml")||Ia(e,"objectdata.xml"))return Qv(e,t);if(Ia(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Sf<"u"){if(e.FileIndex)return Sf(e);var r=rt.utils.cfb_new();return cv(e).forEach(function(re){vt(r,re,BO(e,re))}),Sf(r)}throw new Error("Unsupported NUMBERS file")}if(!Ia(e,"[Content_Types].xml"))throw Ia(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ia(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=cv(e),s=D5(Sa(e,"[Content_Types].xml")),i=!1,l,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",jr(e,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!jr(e,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),i=!0}s.workbooks[0].slice(-3)=="bin"&&(i=!0);var c={},d={};if(!t.bookSheets&&!t.bookProps){if(ao=[],s.sst)try{ao=tV(jr(e,Ra(s.sst)),s.sst,t)}catch(re){if(t.WTF)throw re}t.cellStyles&&s.themes.length&&(c=eV(Sa(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(d=QU(jr(e,Ra(s.style)),s.style,c,t))}s.links.map(function(re){try{var U=ro(Sa(e,Bo(Ra(re))),re);return nV(jr(e,Ra(re)),U,re,t)}catch{}});var u=YU(jr(e,Ra(s.workbooks[0])),s.workbooks[0],t),f={},h="";s.coreprops.length&&(h=jr(e,Ra(s.coreprops[0]),!0),h&&(f=xN(h)),s.extprops.length!==0&&(h=jr(e,Ra(s.extprops[0]),!0),h&&B5(h,f,t)));var m={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(h=Sa(e,Ra(s.custprops[0]),!0),h&&(m=U5(h,t)));var x={};if((t.bookSheets||t.bookProps)&&(u.Sheets?l=u.Sheets.map(function(U){return U.name}):f.Worksheets&&f.SheetNames.length>0&&(l=f.SheetNames),t.bookProps&&(x.Props=f,x.Custprops=m),t.bookSheets&&typeof l<"u"&&(x.SheetNames=l),t.bookSheets?x.SheetNames:t.bookProps))return x;l={};var p={};t.bookDeps&&s.calcchain&&(p=aV(jr(e,Ra(s.calcchain)),s.calcchain));var g=0,y={},N,v;{var S=u.Sheets;f.Worksheets=S.length,f.SheetNames=[];for(var _=0;_!=S.length;++_)f.SheetNames[_]=S[_].name}var F=i?"bin":"xml",k=s.workbooks[0].lastIndexOf("/"),j=(s.workbooks[0].slice(0,k+1)+"_rels/"+s.workbooks[0].slice(k+1)+".rels").replace(/^\//,"");Ia(e,j)||(j="xl/_rels/workbook."+F+".rels");var w=ro(Sa(e,j,!0),j.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=sV(jr(e,Ra(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=zB(jr(e,Ra(s.people[0])),t)),w&&(w=SH(w,u.Sheets));var E=jr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=f.Worksheets;++g){var A="sheet";if(w&&w[g]?(N="xl/"+w[g][1].replace(/[\/]?xl\//,""),Ia(e,N)||(N=w[g][1]),Ia(e,N)||(N=j.replace(/_rels\/.*$/,"")+w[g][1]),A=w[g][2]):(N="xl/worksheets/sheet"+(g+1-E)+"."+F,N=N.replace(/sheet0\./,"sheet.")),v=N.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(g!=t.sheets)continue e;break;case"string":if(f.SheetNames[g].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var D=!1,W=0;W!=t.sheets.length;++W)typeof t.sheets[W]=="number"&&t.sheets[W]==g&&(D=1),typeof t.sheets[W]=="string"&&t.sheets[W].toLowerCase()==f.SheetNames[g].toLowerCase()&&(D=1);if(!D)continue e}}TH(e,N,v,f.SheetNames[g],g,y,l,A,t,u,c,d)}return x={Directory:s,Workbook:u,Props:f,Custprops:m,Deps:p,Sheets:l,SheetNames:f.SheetNames,Strings:ao,Styles:d,Themes:c,SSF:er(it)},t&&t.bookFiles&&(e.files?(x.keys=a,x.files=e.files):(x.keys=[],x.files={},e.FullPaths.forEach(function(re,U){re=re.replace(/^Root Entry[\/]/,""),x.keys.push(re),x.files[re]=e.FileIndex[U]}))),t&&t.bookVBA&&(s.vba.length>0?x.vbaraw=jr(e,Ra(s.vba[0]),!0):s.defaults&&s.defaults.bin===YB&&(x.vbaraw=jr(e,"xl/vbaProject.bin",!0))),x}function _H(e,t){var r=t||{},a="Workbook",s=rt.find(e,a);try{if(a="/!DataSpaces/Version",s=rt.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(s6(s.content),a="/!DataSpaces/DataSpaceMap",s=rt.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var i=l6(s.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=rt.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var l=o6(s.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=rt.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);d6(s.content)}catch{}if(a="/EncryptionInfo",s=rt.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=u6(s.content);if(a="/EncryptedPackage",s=rt.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function CH(e,t){return t.bookType=="ods"?Sj(e,t):t.bookType=="numbers"?jH(e,t):t.bookType=="xlsb"?FH(e,t):DH(e,t)}function FH(e,t){zi=1024,e&&!e.SSF&&(e.SSF=er(it)),e&&e.SSF&&(Nl(),Au(e.SSF),t.revssf=Cu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,no?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",a=ej.indexOf(t.bookType)>-1,s=ax();vx(t=t||{});var i=Hm(),l="",o=0;if(t.cellXfs=[],Fs(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",vt(i,l,pN(e.Props,t)),s.coreprops.push(l),$t(t.rels,2,l,St.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(e.SheetNames[d]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,vt(i,l,yN(e.Props)),s.extprops.push(l),$t(t.rels,3,l,St.EXT_PROPS),e.Custprops!==e.Props&&gr(e.Custprops||{}).length>0&&(l="docProps/custom.xml",vt(i,l,bN(e.Custprops)),s.custprops.push(l),$t(t.rels,4,l,St.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var u={"!id":{}},f=e.Sheets[e.SheetNames[o-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:l="xl/worksheets/sheet"+o+"."+r,vt(i,l,lV(o-1,l,t,e,u)),s.sheets.push(l),$t(t.wbrels,-1,"worksheets/sheet"+o+"."+r,St.WS[0])}if(f){var m=f["!comments"],x=!1,p="";m&&m.length>0&&(p="xl/comments"+o+"."+r,vt(i,p,dV(m,p)),s.comments.push(p),$t(u,-1,"../comments"+o+"."+r,St.CMNT),x=!0),f["!legacy"]&&x&&vt(i,"xl/drawings/vmlDrawing"+o+".vml",JN(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}u["!id"].rId1&&vt(i,Bo(l),qi(u))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,vt(i,l,cV(t.Strings,l,t)),s.strs.push(l),$t(t.wbrels,-1,"sharedStrings."+r,St.SST)),l="xl/workbook."+r,vt(i,l,iV(e,l)),s.workbooks.push(l),$t(t.rels,1,l,St.WB),l="xl/theme/theme1.xml",vt(i,l,cx(e.Themes,t)),s.themes.push(l),$t(t.wbrels,-1,"theme/theme1.xml",St.THEME),l="xl/styles."+r,vt(i,l,oV(e,l,t)),s.styles.push(l),$t(t.wbrels,-1,"styles."+r,St.STY),e.vbaraw&&a&&(l="xl/vbaProject.bin",vt(i,l,e.vbaraw),s.vba.push(l),$t(t.wbrels,-1,"vbaProject.bin",St.VBA)),l="xl/metadata."+r,vt(i,l,uV(l)),s.metadata.push(l),$t(t.wbrels,-1,"metadata."+r,St.XLMETA),vt(i,"[Content_Types].xml",hN(s,t)),vt(i,"_rels/.rels",qi(t.rels)),vt(i,"xl/_rels/workbook."+r+".rels",qi(t.wbrels)),delete t.revssf,delete t.ssf,i}function DH(e,t){zi=1024,e&&!e.SSF&&(e.SSF=er(it)),e&&e.SSF&&(Nl(),Au(e.SSF),t.revssf=Cu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,no?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",a=ej.indexOf(t.bookType)>-1,s=ax();vx(t=t||{});var i=Hm(),l="",o=0;if(t.cellXfs=[],Fs(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",vt(i,l,pN(e.Props,t)),s.coreprops.push(l),$t(t.rels,2,l,St.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(e.SheetNames[d]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,vt(i,l,yN(e.Props)),s.extprops.push(l),$t(t.rels,3,l,St.EXT_PROPS),e.Custprops!==e.Props&&gr(e.Custprops||{}).length>0&&(l="docProps/custom.xml",vt(i,l,bN(e.Custprops)),s.custprops.push(l),$t(t.rels,4,l,St.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],m=(h||{})["!type"]||"sheet";switch(m){case"chart":default:l="xl/worksheets/sheet"+o+"."+r,vt(i,l,uj(o-1,t,e,f)),s.sheets.push(l),$t(t.wbrels,-1,"worksheets/sheet"+o+"."+r,St.WS[0])}if(h){var x=h["!comments"],p=!1,g="";if(x&&x.length>0){var y=!1;x.forEach(function(N){N[1].forEach(function(v){v.T==!0&&(y=!0)})}),y&&(g="xl/threadedComments/threadedComment"+o+"."+r,vt(i,g,BB(x,u,t)),s.threadedcomments.push(g),$t(f,-1,"../threadedComments/threadedComment"+o+"."+r,St.TCMNT)),g="xl/comments"+o+"."+r,vt(i,g,QN(x)),s.comments.push(g),$t(f,-1,"../comments"+o+"."+r,St.CMNT),p=!0}h["!legacy"]&&p&&vt(i,"xl/drawings/vmlDrawing"+o+".vml",JN(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&vt(i,Bo(l),qi(f))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,vt(i,l,zN(t.Strings,t)),s.strs.push(l),$t(t.wbrels,-1,"sharedStrings."+r,St.SST)),l="xl/workbook."+r,vt(i,l,pj(e)),s.workbooks.push(l),$t(t.rels,1,l,St.WB),l="xl/theme/theme1.xml",vt(i,l,cx(e.Themes,t)),s.themes.push(l),$t(t.wbrels,-1,"theme/theme1.xml",St.THEME),l="xl/styles."+r,vt(i,l,YN(e,t)),s.styles.push(l),$t(t.wbrels,-1,"styles."+r,St.STY),e.vbaraw&&a&&(l="xl/vbaProject.bin",vt(i,l,e.vbaraw),s.vba.push(l),$t(t.wbrels,-1,"vbaProject.bin",St.VBA)),l="xl/metadata."+r,vt(i,l,ZN()),s.metadata.push(l),$t(t.wbrels,-1,"metadata."+r,St.XLMETA),u.length>1&&(l="xl/persons/person.xml",vt(i,l,UB(u)),s.people.push(l),$t(t.wbrels,-1,"persons/person.xml",St.PEOPLE)),vt(i,"[Content_Types].xml",hN(s,t)),vt(i,"_rels/.rels",qi(t.rels)),vt(i,"xl/_rels/workbook."+r+".rels",qi(t.wbrels)),delete t.revssf,delete t.ssf,i}function yx(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=_a(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function RH(e,t){return rt.find(e,"EncryptedPackage")?_H(e,t):bj(e,t)}function MH(e,t){var r,a=e,s=t||{};return s.type||(s.type=Nt&&Buffer.isBuffer(e)?"buffer":"base64"),r=V2(a,s),AH(r,s)}function Aj(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Z0(e.slice(r),t);default:break e}return cl.to_workbook(e,t)}function PH(e,t){var r="",a=yx(e,t);switch(t.type){case"base64":r=_a(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=ii(e);break;default:throw new Error("Unrecognized type "+t.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(r=Gt(r)),t.type="binary",Aj(r,t)}function OH(e,t){var r=e;return t.type=="base64"&&(r=_a(r)),r=Ro.utils.decode(1200,r.slice(2),"str"),t.type="binary",Aj(r,t)}function IH(e){return e.match(/[^\x00-\x7F]/)?Cn(e):e}function Tf(e,t,r,a){return a?(r.type="string",cl.to_workbook(e,r)):cl.to_workbook(t,r)}function Wo(e,t){Lm();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Wo(new Uint8Array(e),(r=er(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var a=e,s=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Ji={},r.dateNF&&(Ji.dateNF=r.dateNF),r.type||(r.type=Nt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Nt?"buffer":"binary",a=FO(e),typeof Uint8Array<"u"&&!Nt&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,a=IH(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),o=new Uint8Array(l);if(o.foo="bar",!o.foo)return r=er(r),r.type="array",Wo(Bm(a),r)}switch((s=yx(a,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return RH(rt.read(a,r),r);break;case 9:if(s[1]<=8)return bj(a,r);break;case 60:return Z0(a,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return VL(a,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return LN.to_workbook(a,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?MH(a,r):Tf(e,a,r,i);case 239:return s[3]===60?Z0(a,r):Tf(e,a,r,i);case 255:if(s[1]===254)return OH(a,r);if(s[1]===0&&s[2]===2&&s[3]===0)return Zs.to_workbook(a,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Zs.to_workbook(a,r);break;case 3:case 131:case 139:case 140:return q0.to_workbook(a,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return KN.to_workbook(a,r);break;case 10:case 13:case 32:return PH(a,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return UL.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?q0.to_workbook(a,r):Tf(e,a,r,i)}function _j(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return oc(t.file,rt.write(e,{type:Nt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return rt.write(e,t)}function LH(e,t){var r=er(t||{}),a=CH(e,r);return BH(a,r)}function BH(e,t){var r={},a=Nt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=a;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?rt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(Tu(s))}return t.password&&typeof encrypt_agile<"u"?_j(encrypt_agile(s,t.password),t):t.type==="file"?oc(t.file,s):t.type=="string"?Gt(s):s}function zH(e,t){var r=t||{},a=IV(e,r);return _j(a,r)}function En(e,t,r){r||(r="");var a=r+e;switch(t.type){case"base64":return Mo(Cn(a));case"binary":return Cn(a);case"string":return e;case"file":return oc(t.file,a,"utf8");case"buffer":return Nt?Zn(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):En(a,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function UH(e,t){switch(t.type){case"base64":return Mo(e);case"binary":return e;case"string":return e;case"file":return oc(t.file,e,"binary");case"buffer":return Nt?Zn(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function zc(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",a=0;a<e.length;++a)r+=String.fromCharCode(e[a]);return t.type=="base64"?Mo(r):t.type=="string"?Gt(r):r;case"file":return oc(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function Cj(e,t){Lm(),RU(e);var r=er(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=Cj(e,r);return r.type="array",Tu(a)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return En(CV(e,r),r);case"slk":case"sylk":return En(IN.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return En(kj(e.Sheets[e.SheetNames[s]],r),r);case"txt":return UH(Fj(e.Sheets[e.SheetNames[s]],r),r);case"csv":return En(wx(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return En(LN.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return zc(q0.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return En(cl.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return En(KN.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return En(BN.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return En(Sj(e,r),r);case"wk1":return zc(Zs.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return zc(Zs.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),zc(wj(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),zH(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return LH(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function VH(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function bx(e,t,r){var a={};return a.type="file",a.file=t,VH(a),Cj(e,a)}function HH(e,t,r,a,s,i,l,o){var c=br(r),d=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,h=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!l||e[r])for(var m=t.s.c;m<=t.e.c;++m){var x=l?e[r][m]:e[a[m]+c];if(x===void 0||x.t===void 0){if(d===void 0)continue;i[m]!=null&&(h[i[m]]=d);continue}var p=x.v;switch(x.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(i[m]!=null){if(p==null)if(x.t=="e"&&p===null)h[i[m]]=null;else if(d!==void 0)h[i[m]]=d;else if(u&&p===null)h[i[m]]=null;else continue;else h[i[m]]=u&&(x.t!=="n"||x.t==="n"&&o.rawNumbers!==!1)?p:qn(x,p,o);p!=null&&(f=!1)}}return{row:h,isempty:f}}function Wd(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},a=0,s=1,i=[],l=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},u=d.range!=null?d.range:e["!ref"];switch(d.header===1?a=1:d.header==="A"?a=2:Array.isArray(d.header)?a=3:d.header==null&&(a=0),typeof u){case"string":c=It(u);break;case"number":c=It(e["!ref"]),c.s.r=u;break;default:c=u}a>0&&(s=0);var f=br(c.s.r),h=[],m=[],x=0,p=0,g=Array.isArray(e),y=c.s.r,N=0,v={};g&&!e[y]&&(e[y]=[]);var S=d.skipHidden&&e["!cols"]||[],_=d.skipHidden&&e["!rows"]||[];for(N=c.s.c;N<=c.e.c;++N)if(!(S[N]||{}).hidden)switch(h[N]=or(N),r=g?e[y][N]:e[h[N]+f],a){case 1:i[N]=N-c.s.c;break;case 2:i[N]=h[N];break;case 3:i[N]=d.header[N-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=l=qn(r,null,d),p=v[l]||0,!p)v[l]=1;else{do o=l+"_"+p++;while(v[o]);v[l]=p,v[o]=1}i[N]=o}for(y=c.s.r+s;y<=c.e.r;++y)if(!(_[y]||{}).hidden){var F=HH(e,c,y,h,a,i,g,d);(F.isempty===!1||(a===1?d.blankrows!==!1:d.blankrows))&&(m[x++]=F.row)}return m.length=x,m}var n1=/"/g;function $H(e,t,r,a,s,i,l,o){for(var c=!0,d=[],u="",f=br(r),h=t.s.c;h<=t.e.c;++h)if(a[h]){var m=o.dense?(e[r]||[])[h]:e[a[h]+f];if(m==null)u="";else if(m.v!=null){c=!1,u=""+(o.rawNumbers&&m.t=="n"?m.v:qn(m,null,o));for(var x=0,p=0;x!==u.length;++x)if((p=u.charCodeAt(x))===s||p===i||p===34||o.forceQuotes){u='"'+u.replace(n1,'""')+'"';break}u=="ID"&&(u='"ID"')}else m.f!=null&&!m.F?(c=!1,u="="+m.f,u.indexOf(",")>=0&&(u='"'+u.replace(n1,'""')+'"')):u="";d.push(u)}return o.blankrows===!1&&c?null:d.join(l)}function wx(e,t){var r=[],a=t??{};if(e==null||e["!ref"]==null)return"";var s=It(e["!ref"]),i=a.FS!==void 0?a.FS:",",l=i.charCodeAt(0),o=a.RS!==void 0?a.RS:`
`,c=o.charCodeAt(0),d=new RegExp((i=="|"?"\\|":i)+"+$"),u="",f=[];a.dense=Array.isArray(e);for(var h=a.skipHidden&&e["!cols"]||[],m=a.skipHidden&&e["!rows"]||[],x=s.s.c;x<=s.e.c;++x)(h[x]||{}).hidden||(f[x]=or(x));for(var p=0,g=s.s.r;g<=s.e.r;++g)(m[g]||{}).hidden||(u=$H(e,s,g,f,l,c,i,a),u!=null&&(a.strip&&(u=u.replace(d,"")),(u||a.blankrows!==!1)&&r.push((p++?o:"")+u)));return delete a.dense,r.join("")}function Fj(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=wx(e,t);return r}function KH(e){var t="",r,a="";if(e==null||e["!ref"]==null)return[];var s=It(e["!ref"]),i="",l=[],o,c=[],d=Array.isArray(e);for(o=s.s.c;o<=s.e.c;++o)l[o]=or(o);for(var u=s.s.r;u<=s.e.r;++u)for(i=br(u),o=s.s.c;o<=s.e.c;++o)if(t=l[o]+i,r=d?(e[u]||[])[o]:e[t],a="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;a=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}c[c.length]=t+"="+a}return c}function Dj(e,t,r){var a=r||{},s=+!a.skipHeader,i=e||{},l=0,o=0;if(i&&a.origin!=null)if(typeof a.origin=="number")l=a.origin;else{var c=typeof a.origin=="string"?cr(a.origin):a.origin;l=c.r,o=c.c}var d,u={s:{c:0,r:0},e:{c:o,r:l+t.length-1+s}};if(i["!ref"]){var f=It(i["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),l==-1&&(l=f.e.r+1,u.e.r=l+t.length-1+s)}else l==-1&&(l=0,u.e.r=t.length-1+s);var h=a.header||[],m=0;t.forEach(function(p,g){gr(p).forEach(function(y){(m=h.indexOf(y))==-1&&(h[m=h.length]=y);var N=p[y],v="z",S="",_=ct({c:o+m,r:l+g+s});d=Go(i,_),N&&typeof N=="object"&&!(N instanceof Date)?i[_]=N:(typeof N=="number"?v="n":typeof N=="boolean"?v="b":typeof N=="string"?v="s":N instanceof Date?(v="d",a.cellDates||(v="n",N=Mr(N)),S=a.dateNF||it[14]):N===null&&a.nullError&&(v="e",N=0),d?(d.t=v,d.v=N,delete d.w,delete d.R,S&&(d.z=S)):i[_]=d={t:v,v:N},S&&(d.z=S))})}),u.e.c=Math.max(u.e.c,o+h.length-1);var x=br(l);if(s)for(m=0;m<h.length;++m)i[or(m+o)+x]={t:"s",v:h[m]};return i["!ref"]=pt(u),i}function WH(e,t){return Dj(null,e,t)}function Go(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var a=cr(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Go(e,ct(t)):Go(e,ct({r:t,c:r||0}))}function GH(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function kx(){return{SheetNames:[],Sheets:{}}}function Nx(e,t,r,a){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);s=i&&+i[2]||0;var l=i&&i[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=l+s)!=-1;++s);}if(xj(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function YH(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=GH(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r}function XH(e,t){return e.z=t,e}function Rj(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function qH(e,t,r){return Rj(e,"#"+t,r)}function ZH(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function JH(e,t,r,a){for(var s=typeof t!="string"?t:It(t),i=typeof t=="string"?t:pt(t),l=s.s.r;l<=s.e.r;++l)for(var o=s.s.c;o<=s.e.c;++o){var c=Go(e,l,o);c.t="n",c.F=i,delete c.v,l==s.s.r&&o==s.s.c&&(c.f=r,a&&(c.D=!0))}return e}var Ha={encode_col:or,encode_row:br,encode_cell:ct,encode_range:pt,decode_col:Zm,decode_row:qm,split_cell:c5,decode_cell:cr,decode_range:pa,format_cell:qn,sheet_add_aoa:iN,sheet_add_json:Dj,sheet_add_dom:Nj,aoa_to_sheet:jl,json_to_sheet:WH,table_to_sheet:jj,table_to_book:sH,sheet_to_csv:wx,sheet_to_txt:Fj,sheet_to_json:Wd,sheet_to_html:kj,sheet_to_formulae:KH,sheet_to_row_object_array:Wd,sheet_get_cell:Go,book_new:kx,book_append_sheet:Nx,book_set_sheet_visibility:YH,cell_set_number_format:XH,cell_set_hyperlink:Rj,cell_set_internal_link:qH,cell_add_comment:ZH,sheet_set_array_formula:JH,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},od={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/var QH=od.exports,s1;function e$(){return s1||(s1=1,(function(e,t){((r,a)=>{e.exports=a()})(QH,function r(){var a=typeof self<"u"?self:typeof window<"u"?window:a!==void 0?a:{},s,i=!a.document&&!!a.postMessage,l=a.IS_PAPA_WORKER||!1,o={},c=0,d={};function u(j){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(w){var E=_(w);E.chunkSize=parseInt(E.chunkSize),w.step||w.chunk||(E.chunkSize=null),this._handle=new p(E),(this._handle.streamer=this)._config=E}).call(this,j),this.parseChunk=function(w,E){var A=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<A){let W=this._config.newline;W||(D=this._config.quoteChar||'"',W=this._handle.guessLineEndings(w,D)),w=[...w.split(W).slice(A)].join(W)}this.isFirstChunk&&k(this._config.beforeFirstChunk)&&(D=this._config.beforeFirstChunk(w))!==void 0&&(w=D),this.isFirstChunk=!1,this._halted=!1;var A=this._partialLine+w,D=(this._partialLine="",this._handle.parse(A,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(w=D.meta.cursor,A=(this._finished||(this._partialLine=A.substring(w-this._baseIndex),this._baseIndex=w),D&&D.data&&(this._rowCount+=D.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),l)a.postMessage({results:D,workerId:d.WORKER_ID,finished:A});else if(k(this._config.chunk)&&!E){if(this._config.chunk(D,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=D=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(D.data),this._completeResults.errors=this._completeResults.errors.concat(D.errors),this._completeResults.meta=D.meta),this._completed||!A||!k(this._config.complete)||D&&D.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),A||D&&D.meta.paused||this._nextChunk(),D}this._halted=!0},this._sendError=function(w){k(this._config.error)?this._config.error(w):l&&this._config.error&&a.postMessage({workerId:d.WORKER_ID,error:w,finished:!1})}}function f(j){var w;(j=j||{}).chunkSize||(j.chunkSize=d.RemoteChunkSize),u.call(this,j),this._nextChunk=i?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(E){this._input=E,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(w=new XMLHttpRequest,this._config.withCredentials&&(w.withCredentials=this._config.withCredentials),i||(w.onload=F(this._chunkLoaded,this),w.onerror=F(this._chunkError,this)),w.open(this._config.downloadRequestBody?"POST":"GET",this._input,!i),this._config.downloadRequestHeaders){var E,A=this._config.downloadRequestHeaders;for(E in A)w.setRequestHeader(E,A[E])}var D;this._config.chunkSize&&(D=this._start+this._config.chunkSize-1,w.setRequestHeader("Range","bytes="+this._start+"-"+D));try{w.send(this._config.downloadRequestBody)}catch(W){this._chunkError(W.message)}i&&w.status===0&&this._chunkError()}},this._chunkLoaded=function(){w.readyState===4&&(w.status<200||400<=w.status?this._chunkError():(this._start+=this._config.chunkSize||w.responseText.length,this._finished=!this._config.chunkSize||this._start>=(E=>(E=E.getResponseHeader("Content-Range"))!==null?parseInt(E.substring(E.lastIndexOf("/")+1)):-1)(w),this.parseChunk(w.responseText)))},this._chunkError=function(E){E=w.statusText||E,this._sendError(new Error(E))}}function h(j){(j=j||{}).chunkSize||(j.chunkSize=d.LocalChunkSize),u.call(this,j);var w,E,A=typeof FileReader<"u";this.stream=function(D){this._input=D,E=D.slice||D.webkitSlice||D.mozSlice,A?((w=new FileReader).onload=F(this._chunkLoaded,this),w.onerror=F(this._chunkError,this)):w=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var D=this._input,W=(this._config.chunkSize&&(W=Math.min(this._start+this._config.chunkSize,this._input.size),D=E.call(D,this._start,W)),w.readAsText(D,this._config.encoding));A||this._chunkLoaded({target:{result:W}})},this._chunkLoaded=function(D){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(D.target.result)},this._chunkError=function(){this._sendError(w.error)}}function m(j){var w;u.call(this,j=j||{}),this.stream=function(E){return w=E,this._nextChunk()},this._nextChunk=function(){var E,A;if(!this._finished)return E=this._config.chunkSize,w=E?(A=w.substring(0,E),w.substring(E)):(A=w,""),this._finished=!w,this.parseChunk(A)}}function x(j){u.call(this,j=j||{});var w=[],E=!0,A=!1;this.pause=function(){u.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){u.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(D){this._input=D,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){A&&w.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),w.length?this.parseChunk(w.shift()):E=!0},this._streamData=F(function(D){try{w.push(typeof D=="string"?D:D.toString(this._config.encoding)),E&&(E=!1,this._checkIsFinished(),this.parseChunk(w.shift()))}catch(W){this._streamError(W)}},this),this._streamError=F(function(D){this._streamCleanUp(),this._sendError(D)},this),this._streamEnd=F(function(){this._streamCleanUp(),A=!0,this._streamData("")},this),this._streamCleanUp=F(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function p(j){var w,E,A,D,W=Math.pow(2,53),re=-W,U=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,M=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,Y=this,Q=0,B=0,V=!1,P=!1,T=[],R={data:[],errors:[],meta:{}};function L(G){return j.skipEmptyLines==="greedy"?G.join("").trim()==="":G.length===1&&G[0].length===0}function X(){if(R&&A&&(te("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+d.DefaultDelimiter+"'"),A=!1),j.skipEmptyLines&&(R.data=R.data.filter(function(de){return!L(de)})),J()){let de=function(z,Ee){k(j.transformHeader)&&(z=j.transformHeader(z,Ee)),T.push(z)};if(R)if(Array.isArray(R.data[0])){for(var G=0;J()&&G<R.data.length;G++)R.data[G].forEach(de);R.data.splice(0,1)}else R.data.forEach(de)}function Z(de,z){for(var Ee=j.header?{}:[],ue=0;ue<de.length;ue++){var Ce=ue,ve=de[ue],ve=((ge,Fe)=>(Ie=>(j.dynamicTypingFunction&&j.dynamicTyping[Ie]===void 0&&(j.dynamicTyping[Ie]=j.dynamicTypingFunction(Ie)),(j.dynamicTyping[Ie]||j.dynamicTyping)===!0))(ge)?Fe==="true"||Fe==="TRUE"||Fe!=="false"&&Fe!=="FALSE"&&((Ie=>{if(U.test(Ie)&&(Ie=parseFloat(Ie),re<Ie&&Ie<W))return 1})(Fe)?parseFloat(Fe):M.test(Fe)?new Date(Fe):Fe===""?null:Fe):Fe)(Ce=j.header?ue>=T.length?"__parsed_extra":T[ue]:Ce,ve=j.transform?j.transform(ve,Ce):ve);Ce==="__parsed_extra"?(Ee[Ce]=Ee[Ce]||[],Ee[Ce].push(ve)):Ee[Ce]=ve}return j.header&&(ue>T.length?te("FieldMismatch","TooManyFields","Too many fields: expected "+T.length+" fields but parsed "+ue,B+z):ue<T.length&&te("FieldMismatch","TooFewFields","Too few fields: expected "+T.length+" fields but parsed "+ue,B+z)),Ee}var ae;R&&(j.header||j.dynamicTyping||j.transform)&&(ae=1,!R.data.length||Array.isArray(R.data[0])?(R.data=R.data.map(Z),ae=R.data.length):R.data=Z(R.data,0),j.header&&R.meta&&(R.meta.fields=T),B+=ae)}function J(){return j.header&&T.length===0}function te(G,Z,ae,de){G={type:G,code:Z,message:ae},de!==void 0&&(G.row=de),R.errors.push(G)}k(j.step)&&(D=j.step,j.step=function(G){R=G,J()?X():(X(),R.data.length!==0&&(Q+=G.data.length,j.preview&&Q>j.preview?E.abort():(R.data=R.data[0],D(R,Y))))}),this.parse=function(G,Z,ae){var de=j.quoteChar||'"',de=(j.newline||(j.newline=this.guessLineEndings(G,de)),A=!1,j.delimiter?k(j.delimiter)&&(j.delimiter=j.delimiter(G),R.meta.delimiter=j.delimiter):((de=((z,Ee,ue,Ce,ve)=>{var ge,Fe,Ie,Ze;ve=ve||[",","	","|",";",d.RECORD_SEP,d.UNIT_SEP];for(var yt=0;yt<ve.length;yt++){for(var ht,Ct=ve[yt],Ue=0,kt=0,qe=0,Ft=(Ie=void 0,new y({comments:Ce,delimiter:Ct,newline:Ee,preview:10}).parse(z)),Qe=0;Qe<Ft.data.length;Qe++)ue&&L(Ft.data[Qe])?qe++:(ht=Ft.data[Qe].length,kt+=ht,Ie===void 0?Ie=ht:0<ht&&(Ue+=Math.abs(ht-Ie),Ie=ht));0<Ft.data.length&&(kt/=Ft.data.length-qe),(Fe===void 0||Ue<=Fe)&&(Ze===void 0||Ze<kt)&&1.99<kt&&(Fe=Ue,ge=Ct,Ze=kt)}return{successful:!!(j.delimiter=ge),bestDelimiter:ge}})(G,j.newline,j.skipEmptyLines,j.comments,j.delimitersToGuess)).successful?j.delimiter=de.bestDelimiter:(A=!0,j.delimiter=d.DefaultDelimiter),R.meta.delimiter=j.delimiter),_(j));return j.preview&&j.header&&de.preview++,w=G,E=new y(de),R=E.parse(w,Z,ae),X(),V?{meta:{paused:!0}}:R||{meta:{paused:!1}}},this.paused=function(){return V},this.pause=function(){V=!0,E.abort(),w=k(j.chunk)?"":w.substring(E.getCharIndex())},this.resume=function(){Y.streamer._halted?(V=!1,Y.streamer.parseChunk(w,!0)):setTimeout(Y.resume,3)},this.aborted=function(){return P},this.abort=function(){P=!0,E.abort(),R.meta.aborted=!0,k(j.complete)&&j.complete(R),w=""},this.guessLineEndings=function(z,de){z=z.substring(0,1048576);var de=new RegExp(g(de)+"([^]*?)"+g(de),"gm"),ae=(z=z.replace(de,"")).split("\r"),de=z.split(`
`),z=1<de.length&&de[0].length<ae[0].length;if(ae.length===1||z)return`
`;for(var Ee=0,ue=0;ue<ae.length;ue++)ae[ue][0]===`
`&&Ee++;return Ee>=ae.length/2?`\r
`:"\r"}}function g(j){return j.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function y(j){var w=(j=j||{}).delimiter,E=j.newline,A=j.comments,D=j.step,W=j.preview,re=j.fastMode,U=null,M=!1,Y=j.quoteChar==null?'"':j.quoteChar,Q=Y;if(j.escapeChar!==void 0&&(Q=j.escapeChar),(typeof w!="string"||-1<d.BAD_DELIMITERS.indexOf(w))&&(w=","),A===w)throw new Error("Comment character same as delimiter");A===!0?A="#":(typeof A!="string"||-1<d.BAD_DELIMITERS.indexOf(A))&&(A=!1),E!==`
`&&E!=="\r"&&E!==`\r
`&&(E=`
`);var B=0,V=!1;this.parse=function(P,T,R){if(typeof P!="string")throw new Error("Input must be a string");var L=P.length,X=w.length,J=E.length,te=A.length,G=k(D),Z=[],ae=[],de=[],z=B=0;if(!P)return Ue();if(re||re!==!1&&P.indexOf(Y)===-1){for(var Ee=P.split(E),ue=0;ue<Ee.length;ue++){if(de=Ee[ue],B+=de.length,ue!==Ee.length-1)B+=E.length;else if(R)return Ue();if(!A||de.substring(0,te)!==A){if(G){if(Z=[],Ze(de.split(w)),kt(),V)return Ue()}else Ze(de.split(w));if(W&&W<=ue)return Z=Z.slice(0,W),Ue(!0)}}return Ue()}for(var Ce=P.indexOf(w,B),ve=P.indexOf(E,B),ge=new RegExp(g(Q)+g(Y),"g"),Fe=P.indexOf(Y,B);;)if(P[B]===Y)for(Fe=B,B++;;){if((Fe=P.indexOf(Y,Fe+1))===-1)return R||ae.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:Z.length,index:B}),ht();if(Fe===L-1)return ht(P.substring(B,Fe).replace(ge,Y));if(Y===Q&&P[Fe+1]===Q)Fe++;else if(Y===Q||Fe===0||P[Fe-1]!==Q){Ce!==-1&&Ce<Fe+1&&(Ce=P.indexOf(w,Fe+1));var Ie=yt((ve=ve!==-1&&ve<Fe+1?P.indexOf(E,Fe+1):ve)===-1?Ce:Math.min(Ce,ve));if(P.substr(Fe+1+Ie,X)===w){de.push(P.substring(B,Fe).replace(ge,Y)),P[B=Fe+1+Ie+X]!==Y&&(Fe=P.indexOf(Y,B)),Ce=P.indexOf(w,B),ve=P.indexOf(E,B);break}if(Ie=yt(ve),P.substring(Fe+1+Ie,Fe+1+Ie+J)===E){if(de.push(P.substring(B,Fe).replace(ge,Y)),Ct(Fe+1+Ie+J),Ce=P.indexOf(w,B),Fe=P.indexOf(Y,B),G&&(kt(),V))return Ue();if(W&&Z.length>=W)return Ue(!0);break}ae.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:Z.length,index:B}),Fe++}}else if(A&&de.length===0&&P.substring(B,B+te)===A){if(ve===-1)return Ue();B=ve+J,ve=P.indexOf(E,B),Ce=P.indexOf(w,B)}else if(Ce!==-1&&(Ce<ve||ve===-1))de.push(P.substring(B,Ce)),B=Ce+X,Ce=P.indexOf(w,B);else{if(ve===-1)break;if(de.push(P.substring(B,ve)),Ct(ve+J),G&&(kt(),V))return Ue();if(W&&Z.length>=W)return Ue(!0)}return ht();function Ze(qe){Z.push(qe),z=B}function yt(qe){var Ft=0;return Ft=qe!==-1&&(qe=P.substring(Fe+1,qe))&&qe.trim()===""?qe.length:Ft}function ht(qe){return R||(qe===void 0&&(qe=P.substring(B)),de.push(qe),B=L,Ze(de),G&&kt()),Ue()}function Ct(qe){B=qe,Ze(de),de=[],ve=P.indexOf(E,B)}function Ue(qe){if(j.header&&!T&&Z.length&&!M){var Ft=Z[0],Qe=Object.create(null),bt=new Set(Ft);let se=!1;for(let Ne=0;Ne<Ft.length;Ne++){let De=Ft[Ne];if(Qe[De=k(j.transformHeader)?j.transformHeader(De,Ne):De]){let lt,Rt=Qe[De];for(;lt=De+"_"+Rt,Rt++,bt.has(lt););bt.add(lt),Ft[Ne]=lt,Qe[De]++,se=!0,(U=U===null?{}:U)[lt]=De}else Qe[De]=1,Ft[Ne]=De;bt.add(De)}se&&console.warn("Duplicate headers found and renamed."),M=!0}return{data:Z,errors:ae,meta:{delimiter:w,linebreak:E,aborted:V,truncated:!!qe,cursor:z+(T||0),renamedHeaders:U}}}function kt(){D(Ue()),Z=[],ae=[]}},this.abort=function(){V=!0},this.getCharIndex=function(){return B}}function N(j){var w=j.data,E=o[w.workerId],A=!1;if(w.error)E.userError(w.error,w.file);else if(w.results&&w.results.data){var D={abort:function(){A=!0,v(w.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:S,resume:S};if(k(E.userStep)){for(var W=0;W<w.results.data.length&&(E.userStep({data:w.results.data[W],errors:w.results.errors,meta:w.results.meta},D),!A);W++);delete w.results}else k(E.userChunk)&&(E.userChunk(w.results,D,w.file),delete w.results)}w.finished&&!A&&v(w.workerId,w.results)}function v(j,w){var E=o[j];k(E.userComplete)&&E.userComplete(w),E.terminate(),delete o[j]}function S(){throw new Error("Not implemented.")}function _(j){if(typeof j!="object"||j===null)return j;var w,E=Array.isArray(j)?[]:{};for(w in j)E[w]=_(j[w]);return E}function F(j,w){return function(){j.apply(w,arguments)}}function k(j){return typeof j=="function"}return d.parse=function(j,w){var E=(w=w||{}).dynamicTyping||!1;if(k(E)&&(w.dynamicTypingFunction=E,E={}),w.dynamicTyping=E,w.transform=!!k(w.transform)&&w.transform,!w.worker||!d.WORKERS_SUPPORTED)return E=null,d.NODE_STREAM_INPUT,typeof j=="string"?(j=(A=>A.charCodeAt(0)!==65279?A:A.slice(1))(j),E=new(w.download?f:m)(w)):j.readable===!0&&k(j.read)&&k(j.on)?E=new x(w):(a.File&&j instanceof File||j instanceof Object)&&(E=new h(w)),E.stream(j);(E=(()=>{var A;return!!d.WORKERS_SUPPORTED&&(A=(()=>{var D=a.URL||a.webkitURL||null,W=r.toString();return d.BLOB_URL||(d.BLOB_URL=D.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",W,")();"],{type:"text/javascript"})))})(),(A=new a.Worker(A)).onmessage=N,A.id=c++,o[A.id]=A)})()).userStep=w.step,E.userChunk=w.chunk,E.userComplete=w.complete,E.userError=w.error,w.step=k(w.step),w.chunk=k(w.chunk),w.complete=k(w.complete),w.error=k(w.error),delete w.worker,E.postMessage({input:j,config:w,workerId:E.id})},d.unparse=function(j,w){var E=!1,A=!0,D=",",W=`\r
`,re='"',U=re+re,M=!1,Y=null,Q=!1,B=((()=>{if(typeof w=="object"){if(typeof w.delimiter!="string"||d.BAD_DELIMITERS.filter(function(T){return w.delimiter.indexOf(T)!==-1}).length||(D=w.delimiter),typeof w.quotes!="boolean"&&typeof w.quotes!="function"&&!Array.isArray(w.quotes)||(E=w.quotes),typeof w.skipEmptyLines!="boolean"&&typeof w.skipEmptyLines!="string"||(M=w.skipEmptyLines),typeof w.newline=="string"&&(W=w.newline),typeof w.quoteChar=="string"&&(re=w.quoteChar),typeof w.header=="boolean"&&(A=w.header),Array.isArray(w.columns)){if(w.columns.length===0)throw new Error("Option columns is empty");Y=w.columns}w.escapeChar!==void 0&&(U=w.escapeChar+re),w.escapeFormulae instanceof RegExp?Q=w.escapeFormulae:typeof w.escapeFormulae=="boolean"&&w.escapeFormulae&&(Q=/^[=+\-@\t\r].*$/)}})(),new RegExp(g(re),"g"));if(typeof j=="string"&&(j=JSON.parse(j)),Array.isArray(j)){if(!j.length||Array.isArray(j[0]))return V(null,j,M);if(typeof j[0]=="object")return V(Y||Object.keys(j[0]),j,M)}else if(typeof j=="object")return typeof j.data=="string"&&(j.data=JSON.parse(j.data)),Array.isArray(j.data)&&(j.fields||(j.fields=j.meta&&j.meta.fields||Y),j.fields||(j.fields=Array.isArray(j.data[0])?j.fields:typeof j.data[0]=="object"?Object.keys(j.data[0]):[]),Array.isArray(j.data[0])||typeof j.data[0]=="object"||(j.data=[j.data])),V(j.fields||[],j.data||[],M);throw new Error("Unable to serialize unrecognized input");function V(T,R,L){var X="",J=(typeof T=="string"&&(T=JSON.parse(T)),typeof R=="string"&&(R=JSON.parse(R)),Array.isArray(T)&&0<T.length),te=!Array.isArray(R[0]);if(J&&A){for(var G=0;G<T.length;G++)0<G&&(X+=D),X+=P(T[G],G);0<R.length&&(X+=W)}for(var Z=0;Z<R.length;Z++){var ae=(J?T:R[Z]).length,de=!1,z=J?Object.keys(R[Z]).length===0:R[Z].length===0;if(L&&!J&&(de=L==="greedy"?R[Z].join("").trim()==="":R[Z].length===1&&R[Z][0].length===0),L==="greedy"&&J){for(var Ee=[],ue=0;ue<ae;ue++){var Ce=te?T[ue]:ue;Ee.push(R[Z][Ce])}de=Ee.join("").trim()===""}if(!de){for(var ve=0;ve<ae;ve++){0<ve&&!z&&(X+=D);var ge=J&&te?T[ve]:ve;X+=P(R[Z][ge],ve)}Z<R.length-1&&(!L||0<ae&&!z)&&(X+=W)}}return X}function P(T,R){var L,X;return T==null?"":T.constructor===Date?JSON.stringify(T).slice(1,25):(X=!1,Q&&typeof T=="string"&&Q.test(T)&&(T="'"+T,X=!0),L=T.toString().replace(B,U),(X=X||E===!0||typeof E=="function"&&E(T,R)||Array.isArray(E)&&E[R]||((J,te)=>{for(var G=0;G<te.length;G++)if(-1<J.indexOf(te[G]))return!0;return!1})(L,d.BAD_DELIMITERS)||-1<L.indexOf(D)||L.charAt(0)===" "||L.charAt(L.length-1)===" ")?re+L+re:L)}},d.RECORD_SEP="",d.UNIT_SEP="",d.BYTE_ORDER_MARK="\uFEFF",d.BAD_DELIMITERS=["\r",`
`,'"',d.BYTE_ORDER_MARK],d.WORKERS_SUPPORTED=!i&&!!a.Worker,d.NODE_STREAM_INPUT=1,d.LocalChunkSize=10485760,d.RemoteChunkSize=5242880,d.DefaultDelimiter=",",d.Parser=y,d.ParserHandle=p,d.NetworkStreamer=f,d.FileStreamer=h,d.StringStreamer=m,d.ReadableStreamStreamer=x,a.jQuery&&((s=a.jQuery).fn.parse=function(j){var w=j.config||{},E=[];return this.each(function(W){if(!(s(this).prop("tagName").toUpperCase()==="INPUT"&&s(this).attr("type").toLowerCase()==="file"&&a.FileReader)||!this.files||this.files.length===0)return!0;for(var re=0;re<this.files.length;re++)E.push({file:this.files[re],inputElem:this,instanceConfig:s.extend({},w)})}),A(),this;function A(){if(E.length===0)k(j.complete)&&j.complete();else{var W,re,U,M,Y=E[0];if(k(j.before)){var Q=j.before(Y.file,Y.inputElem);if(typeof Q=="object"){if(Q.action==="abort")return W="AbortError",re=Y.file,U=Y.inputElem,M=Q.reason,void(k(j.error)&&j.error({name:W},re,U,M));if(Q.action==="skip")return void D();typeof Q.config=="object"&&(Y.instanceConfig=s.extend(Y.instanceConfig,Q.config))}else if(Q==="skip")return void D()}var B=Y.instanceConfig.complete;Y.instanceConfig.complete=function(V){k(B)&&B(V,Y.file,Y.inputElem),D()},d.parse(Y.file,Y.instanceConfig)}}function D(){E.splice(0,1),A()}}),l&&(a.onmessage=function(j){j=j.data,d.WORKER_ID===void 0&&j&&(d.WORKER_ID=j.workerId),typeof j.input=="string"?a.postMessage({workerId:d.WORKER_ID,results:d.parse(j.input,j.config),finished:!0}):(a.File&&j.input instanceof File||j.input instanceof Object)&&(j=d.parse(j.input,j.config))&&a.postMessage({workerId:d.WORKER_ID,results:j,finished:!0})}),(f.prototype=Object.create(u.prototype)).constructor=f,(h.prototype=Object.create(u.prototype)).constructor=h,(m.prototype=Object.create(m.prototype)).constructor=m,(x.prototype=Object.create(u.prototype)).constructor=x,d})})(od)),od.exports}var t$=e$();const jx=Yd(t$),Uc=[{id:1,name:"Testliner / C",pricePerM2:12.5},{id:2,name:"Kraft / B+C",pricePerM2:18.25},{id:3,name:"Beyaz / E",pricePerM2:22.1}],Af="excel_price_list";function i1(){const e=ca(),{id:t}=Ch(),[r]=zA(),{user:a,userRole:s,userProfile:i}=vr(),[l,o]=b.useState(!1);b.useEffect(()=>{s&&s!=="super_admin"&&i&&!i.profileCompleted&&(xe.warning("Teklif oluturmak iin profil bilgilerinizi tamamlamanz gerekiyor.",{duration:5e3}),e("/profile"))},[s,i,e]),b.useEffect(()=>{!t&&i&&(async()=>{try{const _e=i.companyCode||(a==null?void 0:a.uid)||"";if(!_e)return;(await ha.checkQuota(_e,"offer")).allowed||o(!0)}catch(_e){console.warn("Quota check error",_e)}})()},[t,i]);const[c,d]=b.useState(""),[u,f]=b.useState(""),[h,m]=b.useState(""),[x,p]=b.useState(""),[g,y]=b.useState("standard"),[N,v]=b.useState(!1),[S,_]=b.useState(0);b.useEffect(()=>{s&&s!=="super_admin"&&i&&!i.profileCompleted&&(xe.warning("Teklif oluturmak iin profil bilgilerinizi tamamlamanz gerekiyor.",{duration:5e3}),e("/profile"))},[s,i,e]);const[F,k]=b.useState(!1),[j,w]=b.useState(""),[E,A]=b.useState(""),[D,W]=b.useState(20),[re,U]=b.useState("20"),[M,Y]=b.useState(""),[Q,B]=b.useState("internal"),[V,P]=b.useState(""),[T,R]=b.useState("internal"),[L,X]=b.useState([]),[J,te]=b.useState(""),[G,Z]=b.useState(""),[ae,de]=b.useState(""),[z,Ee]=b.useState(""),[ue,Ce]=b.useState(!1),[ve,ge]=b.useState(""),[Fe,Ie]=b.useState("draft"),[Ze,yt]=b.useState({}),[ht,Ct]=b.useState(null),[Ue,kt]=b.useState(null),[qe,Ft]=b.useState(null),[Qe,bt]=b.useState(!1),[se,Ne]=b.useState(!1),[De,lt]=b.useState(!1),[Rt,_r]=b.useState(20),[Hr,Et]=b.useState(!1);b.useEffect(()=>{var Ae,_e;!t&&i&&!Hr&&(r.get("demo")==="true"&&(d("600"),f("400"),m("400"),p("500")),((Ae=i.settings)==null?void 0:Ae.defaultMargin)!==void 0&&(W(i.settings.defaultMargin),U(String(i.settings.defaultMargin))),((_e=i.settings)==null?void 0:_e.defaultVatRate)!==void 0&&_r(i.settings.defaultVatRate),Et(!0))},[t,i,Hr,r]),b.useEffect(()=>{const Ae=localStorage.getItem(Af);if(Ae)try{X(JSON.parse(Ae))}catch(_e){console.error("Error loading price list:",_e)}t&&(async()=>{var $e;try{const Ge=await Wt.getOfferById(t);if(Ge){d(String(Ge.payload.L)),f(String(Ge.payload.W)),m(String(Ge.payload.H)),p(String(Ge.payload.quantity||"")),y(Ge.payload.boxType||"standard"),v(Ge.payload.isDoublePiece||!1),W(Ge.payload.profitMargin||20),U(String(Ge.payload.profitMargin||20)),te(Ge.customerName),Z(Ge.title||""),de(Ge.payload.customerNotes||""),Ee(Ge.payload.specialRequirements||""),Y(Ge.payload.plateCost?String(Ge.payload.plateCost):""),B(Ge.payload.plateCostAllocation||"internal"),P(Ge.payload.shippingCost?String(Ge.payload.shippingCost):""),R(Ge.payload.shippingCostAllocation||"internal"),Ie(Ge.status),_r(Ge.payload.vatRate??(($e=i==null?void 0:i.settings)==null?void 0:$e.defaultVatRate)??20);const nt=(L.length>0?L:Uc).findIndex(rr=>rr.name===Ge.payload.qualityName);nt!==-1?(_(nt),k(!1)):(k(!0),w(Ge.payload.qualityName||""),A(String(Ge.payload.pricePerM2||"0")))}}catch(Ge){console.error("Error fetching offer:",Ge),xe.error("Teklif yklenemedi")}})()},[t,L.length]);const Fa=b.useMemo(()=>{const Ae=L.length>0?L:Uc;return ve?Ae.filter(_e=>_e.name.toLowerCase().includes(ve.toLowerCase())):Ae},[L,ve]),He=b.useMemo(()=>{if(F)return{name:j||"zel Kalite",pricePerM2:parseFloat(E.replace(",","."))||0};const Ae=L.length>0?L:Uc;return Ae[S]||Ae[0]},[F,j,E,S,L]);b.useEffect(()=>{bt(!0)},[c,u,h,x,He,g,N,D,M,Q,V,T]),b.useEffect(()=>{U(String(D))},[D]);const gt=b.useCallback(async()=>{var Ge,xt,nt,rr,ee,ne;if(lt(!0),yt({}),s!=="super_admin"&&i&&!i.profileCompleted){xe.error("Maliyet analizi yapabilmek iin profil bilgilerinizi tamamlamanz gerekmektedir.",{description:"Ltfen profil sayfasndan eksik bilgileri doldurunuz.",duration:5e3}),lt(!1),e("/profile");return}await new Promise(he=>setTimeout(he,600));const Ae=d2({customerName:J,lengthMm:c,widthMm:u,heightMm:h,quantity:x,pricePerM2:He.pricePerM2,boxType:g,isDoublePiece:N,flap:(Ge=i==null?void 0:i.settings)==null?void 0:Ge.defaultFlap,rillMm:(xt=i==null?void 0:i.settings)==null?void 0:xt.defaultRillMm});if(!Ae.ok){yt(Ae.fieldErrors||{});const he=Ae.errors.map(ye=>` ${ye} `).join(`
`);xe.error("Hesaplama yaplamad",{description:he,duration:4e3}),lt(!1);return}const _e=Mm({lengthMm:c,widthMm:u,heightMm:h,quantity:x,pricePerM2:He.pricePerM2,boxType:g,isDoublePiece:N,flap:(nt=i==null?void 0:i.settings)==null?void 0:nt.defaultFlap,rillMm:(rr=i==null?void 0:i.settings)==null?void 0:rr.defaultRillMm});if(!_e.ok){lt(!1);return}const $e=Eu({lengthMm:_e.values.lengthMm,widthMm:_e.values.widthMm,heightMm:_e.values.heightMm,quantity:_e.values.quantity,pricePerM2:_e.values.pricePerM2,qualityName:He.name,boxType:g,isDoublePiece:N,flap:(ee=i==null?void 0:i.settings)==null?void 0:ee.defaultFlap,rillMm:(ne=i==null?void 0:i.settings)==null?void 0:ne.defaultRillMm});if($e){if(s!=="super_admin"&&i){const Se=i.companyCode||(a==null?void 0:a.uid)||"";if(Se){const je=await ha.checkQuota(Se,"calculation");if(je.allowed)await ha.incrementCalculationUsage(Se);else{xe.error("Hesaplama Limiti Ald",{description:`Plannzn aylk hesaplama limitine (${je.limit}) ulatnz. Ltfen paketinizi ykseltin.`,duration:5e3}),lt(!1);return}}}kt($e);const he=Number($e.birimHamMaliyet||0),ye=Number($e.quantity||0),C=1+Number(D||0)/100,K=Number($e.toplamHamMaliyet),O=Math.round(he*C*100)/100*ye,I=O/ye,H=Number(M)||0,q=Number(V)||0;let le=0,ce=0;Q==="internal"?le+=H:ce+=H,T==="internal"?le+=q:ce+=q;const ie=O+ce,oe=K+le,fe=ie*((Rt||20)/100),be=ie+fe;Ft({birimSatisFiyati:I,toplamTutar:O,baseTotalSales:O,customerExtras:ce,internalExtras:le,finalCustomerTotal:ie,finalInternalTotalCost:oe,vatRate:Rt||20,finalVatAmount:fe,finalCustomerTotalWithVat:be}),(async()=>{if(a)try{const Se=ie-oe,je=await Tn.logCalculation({userUid:a.uid,userRole:s||"unknown",companyCode:(i==null?void 0:i.companyCode)||"unknown",customerName:J||"Unnamed",dimensions:{boy:Number(c),en:Number(u),yukseklik:Number(h)},quantity:Number(x),qualityName:He.name,baseCostTotal:K,baseSalesTotal:O,unitCost:he,unitSales:I,internalExtrasTotal:le,customerExtrasTotal:ce,finalSalesTotal:ie,finalCostTotal:oe,finalProfit:Se});je?(console.log("Calculation logged successfully:",je),Ct(je)):console.warn("Calculation log returned null ID")}catch(Se){console.error("Silent logging failed in CreateOffer:",Se)}})(),Ne(!0),bt(!1),xe.success("Hesaplama tamamland")}else xe.error("Hesaplama baarsz oldu");lt(!1)},[J,c,u,h,x,He,g,N,D,M,Q,V,T,a,s,i]);b.useEffect(()=>{t&&L.length>=0&&(async()=>{try{const _e=await Wt.getOfferById(t);if(_e){d(String(_e.payload.L)),f(String(_e.payload.W)),m(String(_e.payload.H)),p(String(_e.payload.quantity||"")),y(_e.payload.boxType||"standard"),v(_e.payload.isDoublePiece||!1),W(_e.payload.profitMargin||20),te(_e.customerName),Z(_e.title||""),de(_e.payload.customerNotes||""),Ee(_e.payload.specialRequirements||""),Ie(_e.status),_e.payload.birimHamMaliyet!==void 0&&(kt(_e.payload),Ft({birimSatisFiyati:_e.payload.birimSatisFiyati,toplamTutar:_e.payload.toplamTutar}),Ne(!0),setTimeout(()=>bt(!1),100));const Ge=(L.length>0?L:Uc).findIndex(xt=>xt.name===_e.payload.qualityName);Ge!==-1?(_(Ge),k(!1)):(k(!0),w(_e.payload.qualityName||""),A(String(_e.payload.pricePerM2||"0")))}}catch(_e){console.error("Error fetching offer:",_e)}})()},[t,L.length]);const Dt=Ae=>{var xt,nt;const _e=(xt=Ae.target.files)==null?void 0:xt[0];if(!_e)return;const $e=new FileReader,Ge=(nt=_e.name.split(".").pop())==null?void 0:nt.toLowerCase();$e.onload=async rr=>{var ee;try{let ne=[];const he=(ee=rr.target)==null?void 0:ee.result;if(Ge==="csv")ne=jx.parse(he,{header:!0,skipEmptyLines:!0}).data.map((C,K)=>({id:K+1,name:String(C.quality||"").trim(),pricePerM2:parseFloat(String(C.price_per_m2||"0").replace(",","."))||0})).filter(C=>C.name&&C.pricePerM2>0);else if(Ge==="xlsx"||Ge==="xls"){const ye=Wo(he,{type:"binary"}),C=ye.SheetNames[0],K=ye.Sheets[C];ne=Ha.sheet_to_json(K).map((I,H)=>({id:H+1,name:String(I.quality||"").trim(),pricePerM2:parseFloat(String(I.price_per_m2||"0").replace(",","."))||0})).filter(I=>I.name&&I.pricePerM2>0)}if(ne.length===0){xe.error("Geerli veri bulunamad. Kolonlar: quality, price_per_m2");return}X(ne),localStorage.setItem(Af,JSON.stringify(ne)),_(0),k(!1),xe.success(`${ne.length} kalite baaryla yklendi.`)}catch(ne){console.error("Excel import error:",ne),xe.error("Dosya okunamad.")}},Ge==="csv"?$e.readAsText(_e):$e.readAsBinaryString(_e)},mt=()=>{localStorage.removeItem(Af),X([]),_(0),xe.success("Kalite listesi sfrland.")},Pt=()=>{const Ae=[{quality:"Testliner / C",price_per_m2:12.5},{quality:"Kraft / B+C",price_per_m2:18.25},{quality:"Beyaz / E",price_per_m2:22.1},{quality:"Mikro E",price_per_m2:25},{quality:"Kraft / E",price_per_m2:20.5}],_e=Ha.json_to_sheet(Ae),$e=Ha.book_new();Ha.book_append_sheet($e,_e,"Fiyatlar"),bx($e,"Kalite_Fiyat_Listesi_Ornek.xlsx")},Ye=async(Ae,_e)=>{var $e;if(a){if(Ae!=="DELETE"&&Ae!=="PDF"){if(!se){xe.error("nce Hesapla'ya basarak maliyeti oluturun.");return}if(Qe&&!window.confirm("Deerler deiti. Mevcut hesapla devam edilsin mi? (En gncel maliyet iin ltfen tekrar hesaplayn)"))return}try{Ce(!0);const Ge=s||"individual";switch(Ae){case"SAVE":const xt={L:Number(c),W:Number(u),H:Number(h),waveType:(($e=He.name.split("/")[1])==null?void 0:$e.trim())||"B",qualityName:He.name,pricePerM2:He.pricePerM2,profitMargin:D,customerNotes:ae,specialRequirements:z,boxType:g,isDoublePiece:N,quantity:Number(x),plateCost:Number(M)||0,plateCostAllocation:Q,shippingCost:Number(V)||0,shippingCostAllocation:T,...Ue,...qe};if(t)return await Wt.updateOffer(t,{title:G||null,customerName:J,payload:xt}),ht&&Tn.linkOfferToCalculation(ht,t).catch(console.error),xe.success("Taslak gncellendi"),t;{const nt=await Wt.createOffer({title:G||null,customerName:J,payload:xt,createdByUid:a.uid,createdByName:(i==null?void 0:i.name)||a.email||"",companyCode:(i==null?void 0:i.companyCode)||null,status:"draft"});return ht&&Tn.linkOfferToCalculation(ht,nt).catch(console.error),e(`/edit-offer/${nt}`,{replace:!0}),xe.success("Taslak kaydedildi"),nt}case"SUBMIT":{const nt=await Ye("SAVE");nt&&(await Wt.submitForApproval(nt,a.uid,Ge),Ie("pending_approval"),xe.success("Onaya gnderildi"));break}case"WITHDRAW":t&&(await Wt.withdrawOffer(t,a.uid,Ge),Ie("draft"),xe.success("Geri ekildi"));break;case"APPROVE":t&&(await Wt.approveOffer(t,a.uid,Ge),Ie("approved"),xe.info("Teklif onayland"));break;case"REJECT":t&&(await Wt.rejectOffer(t,a.uid,Ge,(_e==null?void 0:_e.reason)||"Neden belirtilmedi"),Ie("rejected"),xe.info("Teklif reddedildi"));break;case"CLONE":if(t){const nt=await Wt.cloneOfferToDraft(t,a.uid);e(`/edit-offer/${nt}`),xe.success("Klonland, dzenleyebilirsiniz")}break;case"DELETE":t&&(await Wt.softDeleteOffer(t,a.uid,Ge),xe.success("Silindi"),e("/my-offers"));break;case"PDF":xe.info("PDF hazrlanyor..."),su(async()=>{const{pdfService:nt}=await Promise.resolve().then(()=>Pj);return{pdfService:nt}},void 0).then(({pdfService:nt})=>{var rr,ee,ne,he,ye;if(t){const C={id:t,customerName:J,title:G,status:Fe,payload:{L:Number(c),W:Number(u),H:Number(h),qualityName:He.name,quantity:(Ue==null?void 0:Ue.quantity)||0,boxType:g,isDoublePiece:N,profitMargin:D,customerNotes:ae,specialRequirements:z,plateCost:Number(M)||0,plateCostAllocation:Q,shippingCost:Number(V)||0,shippingCostAllocation:T,...Ue,...qe,vatRate:qe.vatRate||Rt||20,finalVatAmount:qe.finalVatAmount||0,finalCustomerTotalWithVat:qe.finalCustomerTotalWithVat||0}};nt.exportOfferToPdf(C,{companyName:((rr=i==null?void 0:i.profileInfo)==null?void 0:rr.companyName)||(i==null?void 0:i.companyCode)||"Bireysel Kullanc",contactName:i==null?void 0:i.name,email:i==null?void 0:i.email,phone:((ee=i==null?void 0:i.profileInfo)==null?void 0:ee.phone)||"",taxNumber:((ne=i==null?void 0:i.profileInfo)==null?void 0:ne.taxNumber)||"",address:(he=i==null?void 0:i.profileInfo)!=null&&he.address?`${i.profileInfo.address}${i.profileInfo.city?", "+i.profileInfo.city:""} `:"",logoBase64:((ye=i==null?void 0:i.profileInfo)==null?void 0:ye.logoBase64)||null})}});break;case"FORCE_APPROVE":case"FORCE_REJECT":case"FORCE_DRAFT":if(t){const nt=Ae==="FORCE_APPROVE"?"approved":Ae==="FORCE_REJECT"?"rejected":"draft";await Wt.updateOffer(t,{status:nt}),Ie(nt),xe.success(`Durum gncellendi: ${nt} `)}break}}catch(Ge){console.error(`Action ${Ae} failed: `,Ge),xe.error("lem baarsz")}finally{Ce(!1)}}};return l?n.jsx(po,{children:n.jsxs("div",{className:"max-w-md mx-auto min-h-[50vh] flex flex-col items-center justify-center text-center space-y-4 animate-in fade-in duration-500",children:[n.jsx("div",{className:"w-16 h-16 bg-[var(--burgundy-light)]/20 text-[var(--burgundy)] rounded-full flex items-center justify-center",children:n.jsx(Xr,{size:32})}),n.jsx("h2",{className:"text-2xl font-black text-slate-800",children:"Limitine Ulatn"}),n.jsx("p",{className:"text-sm text-slate-500 font-medium",children:"Mevcut planndaki aylk teklif oluturma limitini doldurdun. Snrsz analiz veya daha yksek kapasite iin plann ykselt."}),n.jsx(Button,{onClick:()=>e("/upgrade"),className:"mt-4 bg-[var(--burgundy)] hover:bg-[#600018] text-white",children:"Plan Ykselt"})]})}):n.jsxs(po,{children:[n.jsx(nu,{title:"Yeni Teklif Olutur",description:"lleri girin ve anlk maliyet analizi yapn",actions:n.jsxs(n.Fragment,{children:[n.jsx(Button,{variant:"outline",className:"border-border/70 text-muted-foreground hover:bg-surface-secondary font-bold shadow-sm",onClick:()=>e("/my-offers"),children:"Vazge"}),(Fe==="draft"||!t)&&n.jsx(Button,{onClick:()=>Ye("SAVE"),disabled:ue||!Ue,className:"bg-[#1A1D1F] hover:bg-black text-white font-black tracking-wide shadow-md px-6",children:ue?n.jsx(Ar,{className:"animate-spin mr-2"}):n.jsxs(n.Fragment,{children:[n.jsx(Gd,{size:18,className:"mr-2"}),t?"Deiiklikleri Kaydet":"Tasla Kaydet"]})})]})}),n.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-12 gap-8",children:[n.jsxs("div",{className:"xl:col-span-8 space-y-8",children:[n.jsxs(tt,{className:"p-8",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[n.jsx("div",{className:"w-10 h-10 rounded-sm bg-surface-secondary flex items-center justify-center font-black text-lg shadow-sm border border-border/50",children:"1"}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-black uppercase tracking-tight text-foreground",children:"Mteri ve Proje"}),n.jsx("p",{className:"text-sm font-medium text-muted-foreground mt-1",children:"Kime ve hangi proje iin teklif veriliyor?"})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(et,{htmlFor:"customerName",className:"text-xs font-bold uppercase tracking-widest text-foreground",children:"Mteri Ad *"}),n.jsx(ze,{id:"customerName",placeholder:"Mteri veya irket Ad",value:J,onChange:Ae=>{te(Ae.target.value),Ze.customerName&&yt(_e=>{const $e={..._e};return delete $e.customerName,$e})},className:`h-12 border-2 border-border/70 rounded-md bg-white text-sm ${Ze.customerName?"border-red-500 focus-visible:ring-red-500":""}`}),Ze.customerName&&n.jsx("p",{className:"text-xs text-red-500 font-bold mt-1 uppercase tracking-wider",children:Ze.customerName})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(et,{htmlFor:"title",className:"text-xs font-bold uppercase tracking-widest text-foreground",children:"Proje / Referans Bal"}),n.jsx(ze,{id:"title",placeholder:"rn: 2024 Yaz Kampanyas Kolileri",value:G,onChange:Ae=>Z(Ae.target.value),className:"h-12 border-2 border-border/70 rounded-md bg-white text-sm"})]})]})]}),n.jsxs(tt,{className:"p-8",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[n.jsx("div",{className:"w-10 h-10 rounded-sm bg-surface-secondary flex items-center justify-center font-black text-lg shadow-sm border border-border/50",children:"2"}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-black uppercase tracking-tight text-foreground",children:"Koli Ebatlar ve Tip"}),n.jsx("p",{className:"text-sm font-medium text-muted-foreground mt-1",children:"retilecek kolinin teknik llerini girin"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6 mb-10",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsxs(et,{className:"text-sm font-semibold text-slate-700 flex items-center gap-1.5",children:[n.jsx(cn,{size:14,className:"text-[var(--burgundy)]"})," BOY (mm)"]}),n.jsx(ze,{type:"number",placeholder:"0",value:c,onChange:Ae=>{d(Ae.target.value),Ze.lengthMm&&yt(_e=>{const $e={..._e};return delete $e.lengthMm,$e})},className:`bg - slate - 50 h - 11 font - mono text - lg ${Ze.lengthMm?"border-red-500 focus-visible:ring-red-500":""} `})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs(et,{className:"text-sm font-semibold text-slate-700 flex items-center gap-1.5",children:[n.jsx(cn,{size:14,className:"text-[var(--burgundy)]"})," EN (mm)"]}),n.jsx(ze,{type:"number",placeholder:"0",value:u,onChange:Ae=>{f(Ae.target.value),Ze.widthMm&&yt(_e=>{const $e={..._e};return delete $e.widthMm,$e})},className:`bg - slate - 50 h - 11 font - mono text - lg ${Ze.widthMm?"border-red-500 focus-visible:ring-red-500":""} `})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs(et,{className:"text-sm font-semibold text-slate-700 flex items-center gap-1.5",children:[n.jsx(cn,{size:14,className:"text-[var(--burgundy)]"})," YKSEKLK (mm)"]}),n.jsx(ze,{type:"number",placeholder:"0",value:h,onChange:Ae=>{m(Ae.target.value),Ze.heightMm&&yt(_e=>{const $e={..._e};return delete $e.heightMm,$e})},className:`bg - slate - 50 h - 11 font - mono text - lg ${Ze.heightMm?"border-red-500 focus-visible:ring-red-500":""} `})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(et,{className:"text-sm font-semibold text-slate-700",children:"ADET"}),n.jsx(ze,{type:"number",placeholder:"0",value:x,onChange:Ae=>{p(Ae.target.value),Ze.quantity&&yt(_e=>{const $e={..._e};return delete $e.quantity,$e})},className:`bg - [var(--burgundy - light)]/30 border-none h-11 font-mono text-lg font-bold text-[var(--burgundy)] ${Ze.quantity?"ring-2 ring-red-500":""}`})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-10 p-6 bg-slate-50 rounded-2xl border border-slate-100",children:[n.jsxs("div",{className:"space-y-4",children:[n.jsx(et,{className:"text-sm font-bold text-slate-600 uppercase tracking-wider",children:"Koli Tipi"}),n.jsx("div",{className:"pt-2",children:n.jsxs(jo,{value:g,onValueChange:Ae=>y(Ae),children:[n.jsx(So,{className:"h-12 text-md bg-white border-border shadow-sm focus:ring-[var(--burgundy)]",children:n.jsx(Eo,{placeholder:"Kutu Tipi Sein"})}),n.jsxs(To,{children:[n.jsx(_n,{value:"standard",className:"py-3",children:n.jsxs("div",{className:"flex flex-col",children:[n.jsx("span",{className:"font-bold",children:"Standart Koli (0201)"}),n.jsx("span",{className:"text-xs text-muted-foreground",children:"Normal kapakl (A-Box) retim"})]})}),n.jsx(_n,{value:"fullFlap",className:"py-3",children:n.jsxs("div",{className:"flex flex-col",children:[n.jsx("span",{className:"font-bold",children:"Tam Kapak (0203)"}),n.jsx("span",{className:"text-xs text-muted-foreground",children:"st ste binen kapakl (F-Box) retim"})]})})]})]})})]}),n.jsxs("div",{className:"space-y-4 flex flex-col justify-start",children:[n.jsx(et,{className:"text-sm font-bold text-slate-600 uppercase tracking-wider",children:"retim Modu"}),n.jsxs("div",{className:"flex items-center gap-4 pt-4 bg-white p-4 rounded-xl border border-slate-200 shadow-sm h-[4.5rem]",children:[n.jsx(tm,{id:"double-piece-offer",checked:N,onCheckedChange:v,className:"data-[state=checked]:bg-[var(--burgundy)] scale-125 ml-2"}),n.jsxs("div",{className:"flex flex-col",children:[n.jsx(et,{htmlFor:"double-piece-offer",className:"text-sm font-bold text-slate-800 cursor-pointer select-none",children:"ift Para retim"}),n.jsx("span",{className:"text-xs text-slate-500 font-medium mt-0.5",children:"Byk ebatlar iin iki paral birletirme"})]})]})]})]})]}),n.jsxs(tt,{className:"p-8",children:[n.jsxs("div",{className:"flex items-center justify-between mb-8",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-10 h-10 rounded-sm bg-surface-secondary flex items-center justify-center font-black text-lg shadow-sm border border-border/50",children:"3"}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-black uppercase tracking-tight text-foreground",children:"Kalite ve Kr Oran"}),n.jsx("p",{className:"text-sm font-medium text-muted-foreground mt-1",children:"Kat kalitesi ve marj belirleyin"})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs(Button,{variant:"ghost",size:"sm",onClick:Pt,className:"text-slate-500 hover:text-slate-700 h-9 flex items-center gap-2",children:[n.jsx(xh,{size:16})," rnek ndir"]}),n.jsxs("div",{className:"relative",children:[n.jsx(ze,{type:"file",className:"absolute inset-0 opacity-0 cursor-pointer z-10",accept:".xlsx,.xls,.csv",onChange:Dt}),n.jsxs(Button,{variant:"outline",size:"sm",className:"bg-emerald-50 text-emerald-700 border-emerald-200 hover:bg-emerald-100 h-9",children:[n.jsx(I1,{size:16,className:"mr-2"})," Excel Ykle"]})]}),L.length>0&&n.jsx(Button,{variant:"ghost",size:"sm",onClick:mt,className:"text-red-500 hover:bg-red-50 h-9",children:n.jsx(sa,{size:16})})]})]}),F?n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 p-6 bg-[var(--burgundy-light)]/5 rounded-2xl border-2 border-dashed border-[var(--burgundy)]/20",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(et,{className:"text-sm font-semibold text-slate-700",children:"KALTE ADI"}),n.jsx(ze,{placeholder:"rn: zel A+",value:j,onChange:Ae=>w(Ae.target.value),className:"bg-white"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(et,{className:"text-sm font-semibold text-slate-700",children:"M FYATI ()"}),n.jsx(ze,{type:"number",placeholder:"0.00",value:E,onChange:Ae=>A(Ae.target.value),className:"bg-white font-mono"})]})]}):n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"relative mb-4",children:[n.jsx(ze,{placeholder:"Kalite ara...",value:ve,onChange:Ae=>ge(Ae.target.value),className:"bg-slate-50 pl-10 border-slate-200"}),n.jsx(is,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"})]}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:Fa.map((Ae,_e)=>{const $e=S===_e;return n.jsxs("div",{onClick:()=>_(_e),className:`p-4 rounded-xl border-2 cursor-pointer transition-all ${$e?"border-[var(--burgundy)] bg-[var(--burgundy-light)]/10":"border-slate-100 bg-white hover:border-slate-300"}`,children:[n.jsx("span",{className:`text-sm font-bold block ${$e?"text-[var(--burgundy)]":"text-slate-800"}`,children:Ae.name}),n.jsxs("span",{className:"text-lg font-black text-slate-900",children:[Ae.pricePerM2.toFixed(2),"  / m"]})]},_e)})})]}),n.jsxs("div",{className:"mt-8 pt-8 border-t",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsx(et,{className:"text-sm font-bold text-slate-600 uppercase",children:"KR MARJI (%)"}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(ze,{type:"number",value:re,onChange:Ae=>U(Ae.target.value),className:"w-20 text-center font-bold text-lg text-[var(--burgundy)]"}),n.jsx("span",{className:"text-2xl font-black text-[var(--burgundy)]",children:"%"})]})]}),n.jsx(j2,{value:[D],min:0,max:100,step:1,onValueChange:Ae=>{W(Ae[0]),U(String(Ae[0]))}})]}),n.jsxs("div",{className:"mt-8 pt-8 border-t border-slate-100",children:[n.jsx("h3",{className:"text-sm font-bold text-slate-800 mb-4 uppercase tracking-wider",children:"Ek Maliyetler"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"space-y-3",children:[n.jsx(et,{className:"text-sm font-semibold text-slate-700",children:"Klie Maliyeti"}),n.jsx("div",{className:"flex gap-2",children:n.jsxs("div",{className:"relative flex-1",children:[n.jsx(ze,{type:"number",placeholder:"0",value:M,onChange:Ae=>Y(Ae.target.value),className:"pl-8"}),n.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 font-bold",children:""})]})}),n.jsxs("div",{className:"flex bg-slate-100 p-1 rounded-lg",children:[n.jsx("button",{onClick:()=>B("internal"),className:`flex-1 text-xs font-bold py-2 rounded-md transition-all ${Q==="internal"?"bg-white shadow text-slate-800":"text-slate-500 hover:text-slate-700"}`,children:" Maliyet"}),n.jsx("button",{onClick:()=>B("customer"),className:`flex-1 text-xs font-bold py-2 rounded-md transition-all ${Q==="customer"?"bg-white shadow text-[var(--burgundy)]":"text-slate-500 hover:text-slate-700"}`,children:"Mteriye"})]})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsx(et,{className:"text-sm font-semibold text-slate-700",children:"Nakliye Maliyeti"}),n.jsx("div",{className:"flex gap-2",children:n.jsxs("div",{className:"relative flex-1",children:[n.jsx(ze,{type:"number",placeholder:"0",value:V,onChange:Ae=>P(Ae.target.value),className:"pl-8"}),n.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 font-bold",children:""})]})}),n.jsxs("div",{className:"flex bg-slate-100 p-1 rounded-lg",children:[n.jsx("button",{onClick:()=>R("internal"),className:`flex-1 text-xs font-bold py-2 rounded-md transition-all ${T==="internal"?"bg-white shadow text-slate-800":"text-slate-500 hover:text-slate-700"}`,children:" Maliyet"}),n.jsx("button",{onClick:()=>R("customer"),className:`flex-1 text-xs font-bold py-2 rounded-md transition-all ${T==="customer"?"bg-white shadow text-[var(--burgundy)]":"text-slate-500 hover:text-slate-700"}`,children:"Mteriye"})]})]})]})]})]})]}),n.jsx("div",{className:"xl:col-span-4",children:n.jsx("div",{className:"sticky top-8 space-y-6",children:n.jsxs(tt,{className:"overflow-hidden p-0 border-2 border-border/60 shadow-md",children:[n.jsxs("div",{className:"bg-[#1A1D1F] p-6 text-white",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(is,{size:20,className:"text-white/80"}),n.jsx("span",{className:"text-sm font-bold uppercase opacity-80",children:"Maliyet Analizi"})]}),n.jsx("div",{className:`px-3 py-1 rounded-full text-[10px] font-bold flex items-center gap-1.5 ${se?Qe?"bg-amber-400 text-amber-950 shadow-lg shadow-amber-400/20":"bg-emerald-400 text-emerald-950":"bg-white/20 text-white/80"}`,children:se?Qe?n.jsxs(n.Fragment,{children:[n.jsx(oo,{size:10}),"GNCEL DEL"]}):n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-emerald-900 animate-pulse"}),"CANLI"]}):n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-white/40 animate-pulse"}),"HAZIR DEL"]})})]}),n.jsx(Og,{mode:"wait",children:n.jsx(hf.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.3},children:se&&qe?n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-baseline gap-2",children:[n.jsxs("span",{className:"text-4xl font-black",children:["",(qe.finalCustomerTotalWithVat||qe.finalCustomerTotal||qe.toplamTutar).toLocaleString("tr-TR",{minimumFractionDigits:2})]}),n.jsx("span",{className:"text-[10px] opacity-60 uppercase font-bold tracking-wider",children:"(KDV Dahil)"})]}),n.jsx("p",{className:"text-xs text-white/60 mt-2 font-medium",children:"Genel Toplam Proje Tutar"}),n.jsxs("div",{className:"mt-4 pt-4 border-t border-white/10 text-xs text-white/80 space-y-2",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{children:"Ara Toplam (KDV Hari):"}),n.jsxs("span",{children:["",(qe.finalCustomerTotal||qe.toplamTutar).toLocaleString("tr-TR",{minimumFractionDigits:2})]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{children:["KDV (%",qe.vatRate||20,"):"]}),n.jsxs("span",{children:["",(qe.finalVatAmount||0).toLocaleString("tr-TR",{minimumFractionDigits:2})]})]}),qe.customerExtras>0&&n.jsxs("div",{className:"pt-2 mt-2 border-t border-white/10 flex justify-between text-emerald-300",children:[n.jsx("span",{children:"indeki Ek Bedeller:"}),n.jsxs("span",{children:["+ ",qe.customerExtras.toLocaleString("tr-TR",{minimumFractionDigits:2})]})]})]})]}):n.jsxs("div",{className:"py-4",children:[n.jsx("div",{className:"text-lg font-bold text-white/90",children:"Hesaplama Gerekli"}),n.jsx("p",{className:"text-xs text-white/50 leading-relaxed mt-1",children:"Ltfen gerekli lleri girin."})]})},se?Qe?"dirty":"calculated":"empty")}),n.jsx("div",{className:"mt-6",children:n.jsxs(Button,{onClick:gt,disabled:De||!c||!u||!h||!x||!F&&S===-1,className:`w-full h-12 font-bold transition-all ${!se||Qe?"bg-white text-[var(--burgundy)] hover:bg-slate-50 shadow-xl scale-105":"bg-white/20 text-white hover:bg-white/30"}`,children:[De?n.jsx(CE,{className:"animate-spin mr-2",size:18}):n.jsx(is,{size:18,className:"mr-2"}),se?Qe?"Yeniden Hesapla":"Hesaplamay Gncelle":"Maliyeti Hesapla"]})})]}),n.jsx("div",{className:"bg-white p-6 space-y-6",children:n.jsx(Og,{mode:"wait",children:se?n.jsxs(hf.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-6",children:[Qe&&n.jsxs("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-2xl flex items-start gap-3 animate-in fade-in slide-in-from-top-2",children:[n.jsx(oo,{className:"text-amber-500 shrink-0 mt-0.5",size:18}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-bold text-amber-900",children:"Hesap Gncel Deil"}),n.jsx("p",{className:"text-[11px] text-amber-700 mt-1 leading-relaxed",children:"Deerler deiti. Gncel analiz iin tekrar hesaplayn."})]})]}),n.jsxs("div",{className:`space-y-4 ${Qe?"opacity-60":""}`,children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"p-3 bg-slate-50 rounded-xl border border-slate-100",children:[n.jsx("span",{className:"text-[10px] text-slate-400 block font-bold uppercase tracking-wider mb-1",children:"Birim Maliyet"}),n.jsxs("span",{className:"font-bold text-slate-700",children:["",Ue==null?void 0:Ue.birimHamMaliyet.toFixed(2)]})]}),n.jsxs("div",{className:"p-3 bg-[var(--burgundy-light)]/20 rounded-xl border border-[var(--burgundy)]/5",children:[n.jsx("span",{className:"text-[10px] text-[var(--burgundy)] block font-bold uppercase tracking-wider mb-1",children:"Birim Sat"}),n.jsxs("span",{className:"font-black text-[var(--burgundy)] text-lg",children:["",qe==null?void 0:qe.birimSatisFiyati.toFixed(2)]})]})]}),n.jsxs("div",{className:"space-y-3 p-4 bg-slate-50 rounded-2xl border border-slate-100",children:[n.jsxs("div",{className:"flex justify-between items-center text-sm",children:[n.jsx("span",{className:"text-slate-500 font-medium",children:"Safiha Boyutu"}),n.jsxs("span",{className:"font-bold text-slate-700",children:[Math.round((Ue==null?void 0:Ue.safihaBoyMm)||0),"",Math.round((Ue==null?void 0:Ue.safihaEnMm)||0)," mm"]})]}),n.jsxs("div",{className:"flex justify-between items-center text-sm",children:[n.jsx("span",{className:"text-slate-500 font-medium",children:"Safiha Alan"}),n.jsxs("span",{className:"font-bold font-mono text-slate-700",children:[Ue==null?void 0:Ue.safihaAlanM2.toFixed(4)," m"]})]}),(Number(M)>0||Number(V)>0)&&n.jsxs("div",{className:"pt-3 mt-3 border-t border-slate-200",children:[n.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase mb-2",children:"Ek Maliyet zeti"}),(Q==="internal"||T==="internal")&&n.jsxs("div",{className:"flex justify-between items-center text-xs mb-1",children:[n.jsx("span",{className:"text-slate-500",children:" Maliyetler (Gizli)"}),n.jsxs("span",{className:"font-bold text-slate-600",children:["",((Q==="internal"?Number(M):0)+(T==="internal"?Number(V):0)).toLocaleString()]})]}),(Q==="customer"||T==="customer")&&n.jsxs("div",{className:"flex justify-between items-center text-xs",children:[n.jsx("span",{className:"text-[var(--burgundy)]",children:"Mteriye Yanstlan"}),n.jsxs("div",{className:"flex flex-col items-end",children:[n.jsxs("span",{className:"font-bold text-[var(--burgundy)]",children:["+",((Q==="customer"?Number(M):0)+(T==="customer"?Number(V):0)).toLocaleString()]}),n.jsx("span",{className:"text-[9px] text-[var(--burgundy)]/60 font-medium",children:"Ayr kalem olarak eklenir"})]})]})]})]}),Ue&&n.jsx(Rd,{widthMm:Ue.calculatedEn,heightMm:Ue.calculatedBoy,flapMm:Ue.chosenRil,kulakMm:Ue.kulakPayi,enRilleri:Ue.enRilleri,boyRilleri:Ue.boyRilleri})]}),n.jsx(Yb,{offerId:t,currentUserRole:s||"individual",offerStatus:Fe,isProcessing:ue,onAction:Ye,disabled:!se})]},"result-state"):n.jsxs(hf.div,{initial:{opacity:0},animate:{opacity:1},className:"py-12 text-center space-y-4",children:[n.jsx("div",{className:"w-16 h-16 bg-slate-50 rounded-2xl flex items-center justify-center mx-auto text-[var(--burgundy)] opacity-30",children:n.jsx(is,{size:32})}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("h3",{className:"font-bold text-slate-800",children:"Maliyet Analizi Hazr Deil"}),n.jsx("p",{className:"text-xs text-slate-400 px-6 leading-relaxed",children:"lleri girdikten sonra 'Hesapla' butonuna basarak maliyet ve kr analizini oluturun."})]})]},"empty-state")})})]})})})]})]})}const ba=e=>Number(e||0).toLocaleString("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2}),Mj=e=>e?(e.toDate?e.toDate():new Date(e)).toLocaleDateString("tr-TR",{day:"2-digit",month:"2-digit",year:"numeric"}):new Date().toLocaleDateString("tr-TR"),r$=(e,t)=>{const{payload:r,customerName:a,title:s,createdAt:i,id:l}=e,o=t!=null&&t.logoBase64?`<div style="flex-shrink: 0; margin-right: 20px;"><img src="${t.logoBase64}" style="max-width: 120px; max-height: 60px; object-fit: contain;" /></div>`:"",c=t?`
    <div style="text-align: right; flex: 1;">
      ${t.companyName?`<div style="font-family: 'Georgia', serif; font-weight: bold; font-size: 20px; color: #800020; letter-spacing: 0.5px;">${t.companyName}</div>`:""}
      ${t.contactName?`<div style="font-size: 12px; color: #555; margin-top: 4px;">${t.contactName}</div>`:""}
      ${t.address?`<div style="font-size: 11px; color: #777; margin-top: 2px;">${t.address}</div>`:""}
      <div style="margin-top: 8px;">
        ${t.phone?`<span style="font-size: 11px; color: #555; margin-left: 10px;"> ${t.phone}</span>`:""}
        ${t.email?`<span style="font-size: 11px; color: #555; margin-left: 10px;"> ${t.email}</span>`:""}
      </div>
      ${t.taxNumber?`<div style="font-size: 10px; color: #888; margin-top: 4px;">Vergi No: ${t.taxNumber}</div>`:""}
      ${t.website?`<div style="font-size: 11px; color: #800020; margin-top: 4px;"> ${t.website}</div>`:""}
    </div>
  `:"",d=r.unitPrice||r.birimSatisFiyati||r.toplamTutar/r.quantity||0;return`
    <!DOCTYPE html>
    <html>
    <head>
      <meta charset="UTF-8">
      <style>
        @page { margin: 0; }
        * { box-sizing: border-box; }
        body { 
          font-family: 'Helvetica Neue', 'Helvetica', 'Arial', sans-serif; 
          padding: 30px 40px;
          color: #2c3e50;
          line-height: 1.5;
          font-size: 12px;
          position: relative;
        }
        .header { 
          display: flex; 
          justify-content: flex-end; 
          align-items: center;
          padding-bottom: 20px;
          border-bottom: 1px solid #eaeaea;
          margin-bottom: 30px;
          position: relative;
        }
        .quote-title {
          font-family: 'Georgia', serif;
          font-size: 32px;
          color: #800020;
          margin-bottom: 5px;
          letter-spacing: 1px;
        }
        .quote-subtitle {
          font-size: 11px;
          color: #7f8c8d;
          text-transform: uppercase;
          letter-spacing: 2px;
          margin-bottom: 30px;
        }
        .info-grid {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 40px;
          margin-bottom: 40px;
          padding: 20px;
          background-color: #fcfcfc;
          border-left: 3px solid #800020;
          border-radius: 0 4px 4px 0;
        }
        .info-group { margin-bottom: 15px; }
        .info-label {
          font-size: 10px;
          text-transform: uppercase;
          letter-spacing: 1.5px;
          color: #999;
          margin-bottom: 4px;
          font-weight: 700;
        }
        .info-value {
          font-size: 14px;
          font-weight: 500;
          color: #2c3e50;
        }
        .section-header {
          font-family: 'Georgia', serif;
          font-size: 16px;
          color: #800020;
          margin-bottom: 15px;
          padding-bottom: 5px;
          border-bottom: 1px solid #800020;
        }
        .specs-table {
          width: 100%;
          border-collapse: collapse;
          margin-bottom: 30px;
        }
        .specs-table td {
          padding: 12px 15px;
          border-bottom: 1px solid #f0f0f0;
          font-size: 13px;
        }
        .specs-table td:first-child {
          width: 200px;
          font-weight: 600;
          color: #555;
          background-color: #fafafa;
        }
        .price-summ {
          display: flex;
          justify-content: flex-end;
        }
        .price-box {
          background: linear-gradient(135deg, #800020 0%, #a0003a 100%);
          color: white;
          padding: 25px 30px;
          border-radius: 8px;
          text-align: center;
          min-width: 280px;
        }
        .price-label {
          font-size: 10px;
          text-transform: uppercase;
          letter-spacing: 1.5px;
          opacity: 0.8;
          margin-bottom: 8px;
        }
        .price-value {
          font-family: 'Georgia', serif;
          font-size: 28px;
          font-weight: bold;
          letter-spacing: 0.5px;
        }
        .notes-section {
          margin-top: 40px;
          padding-top: 20px;
          border-top: 1px solid #eaeaea;
        }
        .notes-label {
          font-size: 10px;
          text-transform: uppercase;
          letter-spacing: 1.5px;
          color: #bbb;
          margin-bottom: 8px;
          font-weight: 700;
        }
        .notes-text {
          font-size: 11px;
          color: #999;
          line-height: 1.8;
        }
        .footer {
          margin-top: 60px;
          text-align: center;
          font-size: 9px;
          color: #aaa;
          border-top: 1px solid #f0f0f0;
          padding-top: 10px;
        }
        .watermark {
          position: fixed;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%) rotate(-45deg);
          font-size: 150px;
          color: rgba(128, 0, 32, 0.1);
          font-weight: bold;
          z-index: -1;
          pointer-events: none;
          white-space: nowrap;
          text-transform: uppercase;
        }
      </style>
    </head>
    <body>
      <div class="header">
        ${o}
        ${c}
      </div>

      ${e.status==="pending_approval"?'<div class="watermark">GEERSZ <br> TASLAK</div>':""}

      <div class="quote-title">FYAT TEKLF</div>
      <div class="quote-subtitle">REF: #${l.substring(0,8).toUpperCase()}</div>

      <div class="info-grid">
        <div class="column">
          <div class="info-group">
            <div class="info-label">Sayn / Firma</div>
            <div class="info-value">${a||"Belirtilmemi"}</div>
          </div>
          <div class="info-group" style="margin-bottom:0;">
            <div class="info-label">Proje / Balk</div>
            <div class="info-value">${s||"-"}</div>
          </div>
        </div>
        <div class="column">
          <div class="info-group">
            <div class="info-label">Tarih</div>
            <div class="info-value">${Mj(i)}</div>
          </div>
          <div class="info-group" style="margin-bottom:0;">
            <div class="info-label">Geerlilik</div>
            <div class="info-value">7 Gn</div>
          </div>
        </div>
      </div>

      <div class="section-header">rn Detaylar</div>
      
      <table class="specs-table">
        <tr>
          <td>Ebatlar (L x W x H)</td>
          <td>${r.L}  ${r.W}  ${r.H} mm</td>
        </tr>
        <tr>
          <td>Miktar</td>
          <td>${Number(r.quantity||0).toLocaleString("tr-TR")} Adet</td>
        </tr>
        <tr>
          <td>Kalite</td>
          <td>${r.qualityName||"-"}</td>
        </tr>
        <tr>
          <td>Koli Tipi</td>
          <td>${r.boxType==="fullFlap"?"Tam Kapak":"Standart"}</td>
        </tr>
        <tr>
          <td>Para Tipi</td>
          <td>${r.isDoublePiece?"ift Para (Geni Kesim)":"Tek Para Standart"}</td>
        </tr>
        <tr>
          <td>Birim Sat Fiyat</td>
          <td>${ba(r.birimSatisFiyati||d)} </td>
        </tr>
      </table>

      ${r.plateCost&&r.plateCostAllocation==="customer"||r.shippingCost&&r.shippingCostAllocation==="customer"?`
      <div class="section-header">Ek Bedeller</div>
      <table class="specs-table">
        ${r.plateCost&&r.plateCostAllocation==="customer"?`
        <tr>
          <td>Klie Bedeli</td>
          <td>${Number(r.plateCost).toLocaleString("tr-TR",{minimumFractionDigits:2})} </td>
        </tr>`:""}
        ${r.shippingCost&&r.shippingCostAllocation==="customer"?`
        <tr>
          <td>Nakliye Bedeli</td>
          <td>${Number(r.shippingCost).toLocaleString("tr-TR",{minimumFractionDigits:2})} </td>
        </tr>`:""}
      </table>
      `:""}

      <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-top: 40px; padding-top: 20px; border-top: 1px solid #eaeaea;">
        
        <div class="notes-section" style="flex: 1; padding-right: 40px; margin-top: 0; padding-top: 0; border-top: none;">
          <div class="notes-label">HKM VE KOULLAR</div>
          <div class="notes-text">
            Bu teklif, yukarda belirtilen tarih itibariyle 7 gn sreyle geerlidir.<br>
            deme ve teslimat koullar sipari onaynda ayrca teyit edilmelidir.
          </div>
        </div>

        <div class="price-summ" style="margin-top: 0;">
          <div>
            <div style="text-align: right; margin-bottom: 8px; padding-right: 15px;">
              <div style="font-size: 11px; color: #777; margin-bottom: 4px;">ARA TOPLAM (KDV HAR): ${ba(r.finalCustomerTotal||r.toplamTutar||d*r.quantity)} </div>
              <div style="font-size: 11px; color: #777; margin-bottom: 8px;">KDV (%${r.vatRate||20}): ${ba(r.finalVatAmount||(r.finalCustomerTotal||r.toplamTutar||d*r.quantity)*((r.vatRate||20)/100))} </div>
            </div>
            <div class="price-box">
              <div class="price-label">GENEL TOPLAM (KDV DAHL)</div>
              <div class="price-value">${ba(r.finalCustomerTotalWithVat||(r.finalCustomerTotal||r.toplamTutar||d*r.quantity)*(1+(r.vatRate||20)/100))} </div>
            </div>
          </div>
        </div>

      </div>

      <div class="footer">
         ${new Date().getFullYear()} ${(t==null?void 0:t.companyName)||"ULGEN ONE"}. Bu belge ULGEN ONE altyaps ile elektronik olarak retilmitir.
      </div>
    </body>
    </html>
  `},a$=(e,t)=>{const{customerName:r,title:a,lineItems:s,totalRevenue:i,id:l,createdAt:o,status:c}=e;let d=0,u=0;(s||[]).forEach(x=>{u+=Number(x.toplamTutar)||0,x.plateCostAllocation==="customer"&&(d+=Number(x.plateCost)||0),x.shippingCostAllocation==="customer"&&(d+=Number(x.shippingCost)||0)});const f=(s||[]).map((x,p)=>{const g=x.label||`Kalem ${p+1}`,y=x.plateCostAllocation==="customer"&&Number(x.plateCost)||0,N=x.shippingCostAllocation==="customer"&&Number(x.shippingCost)||0,v=y+N,S=(Number(x.toplamTutar)||0)+v,_=p%2===0?"#fff":"#fdfbfc";let F="";if(v>0){const k=[];y>0&&k.push(`Klie: ${ba(y)} `),N>0&&k.push(`Nakliye: ${ba(N)} `),F=`<div style="font-size:9px;color:#999;margin-top:1px;">${k.join("  ")}</div>`}return`
      <tr style="background:${_};">
        <td style="padding:6px 10px;color:#800020;font-weight:700;text-align:center;width:30px;">${p+1}</td>
        <td style="padding:6px 10px;font-weight:500;">${g}${F}</td>
        <td style="padding:6px 10px;font-size:11px;">${x.L}${x.W}${x.H}</td>
        <td style="padding:6px 10px;font-size:11px;">${x.qualityName||"-"}</td>
        <td style="padding:6px 10px;text-align:right;font-size:11px;">${Number(x.quantity||0).toLocaleString("tr-TR")}</td>
        <td style="padding:6px 10px;text-align:right;font-size:11px;">${ba(x.birimSatisFiyati)}</td>
        <td style="padding:6px 10px;text-align:right;font-weight:600;color:#2c3e50;">${ba(S)} </td>
      </tr>
    `}).join(""),h=t!=null&&t.logoBase64?`<div style="background:white; border-radius:6px; padding:4px; flex-shrink:0;"><img src="${t.logoBase64}" style="max-width:80px; max-height:45px; object-fit:contain; display:block;" /></div>`:"",m=t?(()=>{const x=[];t.companyName&&x.push(`<div style="font-family:'Georgia',serif;font-size:16px;font-weight:bold;color:white;letter-spacing:0.5px;">${t.companyName}</div>`),t.contactName&&x.push(`<div style="font-size:10px;color:rgba(255,255,255,0.7);margin-top:2px;">${t.contactName}</div>`);const p=[t.address,t.city].filter(Boolean).join(", ");p&&x.push(`<div style="font-size:9px;color:rgba(255,255,255,0.5);margin-top:3px;">${p}</div>`);const g=[];return t.phone&&g.push(`Tel: ${t.phone}`),t.email&&g.push(t.email),g.length&&x.push(`<div style="font-size:9px;color:rgba(255,255,255,0.5);margin-top:2px;">${g.join("  ")}</div>`),t.taxNumber&&x.push(`<div style="font-size:9px;color:rgba(255,255,255,0.4);margin-top:2px;">V.No: ${t.taxNumber}</div>`),x.join("")})():"";return`
    <!DOCTYPE html>
    <html>
    <head>
      <meta charset="UTF-8">
      <style>
        @page { margin: 0; size: A4; }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Helvetica Neue','Helvetica','Arial',sans-serif; color: #2c3e50; font-size: 11px; line-height: 1.4; }
        .wm { position:fixed; top:50%; left:50%; transform:translate(-50%,-50%) rotate(-45deg); font-size:130px; color:rgba(128,0,32,0.06); font-weight:bold; z-index:-1; pointer-events:none; white-space:nowrap; text-transform:uppercase; letter-spacing:4px; }
      </style>
    </head>
    <body>

      ${c==="pending_approval"?'<div class="wm">TASLAK</div>':""}

      <!-- HEADER BAND -->
      <div style="background:#800020; padding:18px 35px 14px; display:flex; justify-content:space-between; align-items:center;">
        <div style="display:flex; align-items:center; gap:14px;">
          ${h}
          <div>
            <div style="font-family:'Georgia',serif; font-size:20px; color:white; font-weight:bold; letter-spacing:1px;">TOPLU FYAT TEKLF</div>
            <div style="font-size:9px; color:rgba(255,255,255,0.45); text-transform:uppercase; letter-spacing:2px; margin-top:2px;">REF: ${(l||"").toUpperCase()}</div>
          </div>
        </div>
        <div style="text-align:right;">
          ${m}
        </div>
      </div>
      <div style="height:2px; background:linear-gradient(90deg,#800020,#c04060,#800020);"></div>

      <!-- MAIN -->
      <div style="padding:18px 35px 40px;">

        <!-- INFO ROW -->
        <div style="display:flex; gap:0; margin-bottom:16px; border:1px solid #e8e0e3; border-radius:6px; overflow:hidden; font-size:11px;">
          <div style="flex:1; padding:12px 16px; border-right:1px solid #f0e0e4;">
            <div style="font-size:8px; text-transform:uppercase; color:#b0a0a4; font-weight:700; letter-spacing:0.8px; margin-bottom:3px;">Sayn / Firma</div>
            <div style="font-size:13px; font-weight:600; color:#2c3e50;">${r||"Belirtilmemi"}</div>
            ${a?`<div style="font-size:10px; color:#999; margin-top:1px;">${a}</div>`:""}
          </div>
          <div style="width:110px; padding:12px 16px; border-right:1px solid #f0e0e4; background:#fefbfc;">
            <div style="font-size:8px; text-transform:uppercase; color:#b0a0a4; font-weight:700; letter-spacing:0.8px; margin-bottom:3px;">Tarih</div>
            <div style="font-weight:500;">${Mj(o)}</div>
          </div>
          <div style="width:90px; padding:12px 16px; border-right:1px solid #f0e0e4; background:#fefbfc;">
            <div style="font-size:8px; text-transform:uppercase; color:#b0a0a4; font-weight:700; letter-spacing:0.8px; margin-bottom:3px;">Geerlilik</div>
            <div style="font-weight:500;">7 Gn</div>
          </div>
          <div style="width:70px; padding:12px 16px; background:#fdf2f4; display:flex; flex-direction:column; align-items:center; justify-content:center;">
            <div style="font-family:'Georgia',serif; font-size:22px; font-weight:bold; color:#800020; line-height:1;">${(s||[]).length}</div>
            <div style="font-size:8px; text-transform:uppercase; color:#800020; font-weight:700; letter-spacing:0.5px;">KALEM</div>
          </div>
        </div>

        <!-- ITEMS TABLE -->
        <table style="width:100%; border-collapse:collapse; margin-bottom:12px;">
          <thead>
            <tr>
              <th style="background:#800020; color:white; padding:6px 10px; text-align:center; font-size:9px; text-transform:uppercase; letter-spacing:0.5px; width:30px;">#</th>
              <th style="background:#800020; color:white; padding:6px 10px; text-align:left; font-size:9px; text-transform:uppercase; letter-spacing:0.5px;">Aklama</th>
              <th style="background:#800020; color:white; padding:6px 10px; text-align:left; font-size:9px; text-transform:uppercase; letter-spacing:0.5px;">Ebat (mm)</th>
              <th style="background:#800020; color:white; padding:6px 10px; text-align:left; font-size:9px; text-transform:uppercase; letter-spacing:0.5px;">Kalite</th>
              <th style="background:#800020; color:white; padding:6px 10px; text-align:right; font-size:9px; text-transform:uppercase; letter-spacing:0.5px;">Adet</th>
              <th style="background:#800020; color:white; padding:6px 10px; text-align:right; font-size:9px; text-transform:uppercase; letter-spacing:0.5px;">Birim </th>
              <th style="background:#800020; color:white; padding:6px 10px; text-align:right; font-size:9px; text-transform:uppercase; letter-spacing:0.5px;">Toplam</th>
            </tr>
          </thead>
          <tbody>
            ${f}
          </tbody>
        </table>

        <!-- TOTALS (right-aligned) -->
        <div style="display:flex; justify-content:flex-end;">
          <table style="width:260px; border-collapse:collapse; font-size:11px;">
            <tr>
              <td style="padding:5px 10px; color:#888;">Ara Toplam</td>
              <td style="padding:5px 10px; text-align:right; font-weight:500;">${ba(u)} </td>
            </tr>
            ${d>0?`
            <tr>
              <td style="padding:5px 10px; color:#888;">Ek Bedeller</td>
              <td style="padding:5px 10px; text-align:right; font-weight:500; color:#800020;">+ ${ba(d)} </td>
            </tr>
            `:""}
            <tr>
              <td colspan="2" style="padding:0;"><div style="border-top:2px solid #800020; margin:3px 0;"></div></td>
            </tr>
            <tr>
              <td style="padding:6px 10px; font-weight:700; font-size:11px; color:#777;">ARA TOPLAM <span style="font-size:9px;color:#999;font-weight:400;">(KDV Hari)</span></td>
              <td style="padding:6px 10px; text-align:right; font-family:'Georgia',serif; font-size:14px; font-weight:bold; color:#555;">${ba(i||0)} </td>
            </tr>
            <tr>
              <td style="padding:6px 10px; color:#888;">KDV (%${e.totalRevenueWithVat?e.vatRate:20})</td>
              <td style="padding:6px 10px; text-align:right; font-weight:500;">${ba(e.vatAmount||i*((e.vatRate||20)/100))} </td>
            </tr>
            <tr>
              <td style="padding:6px 10px; font-weight:700; font-size:12px;">GENEL TOPLAM <span style="font-size:9px;color:#999;font-weight:400;">(KDV Dahil)</span></td>
              <td style="padding:6px 10px; text-align:right; font-family:'Georgia',serif; font-size:18px; font-weight:bold; color:#800020;">${ba(e.totalRevenueWithVat||i*(1+(e.vatRate||20)/100))} </td>
            </tr>
          </table>
        </div>

        <!-- TERMS (compact) -->
        <div style="margin-top:20px; padding-top:12px; border-top:1px solid #eee;">
          <div style="font-size:9px; font-weight:700; text-transform:uppercase; letter-spacing:0.8px; color:#bbb; margin-bottom:4px;">Koullar</div>
          <div style="font-size:9px; color:#999; line-height:1.5;">
            Bu teklif 7 gn geerlidir. deme/teslimat koullar sipari onaynda belirlenecektir. Birim fiyatlar belirtilen miktarlar iin geerlidir.
          </div>
        </div>

      </div>

      <!-- FOOTER -->
      <div style="position:fixed; bottom:0; left:0; right:0; background:#fafafa; border-top:1px solid #f0f0f0; padding:7px 35px; display:flex; justify-content:space-between; align-items:center;">
        <div style="font-size:8px; color:#ccc;"> ${new Date().getFullYear()} ${(t==null?void 0:t.companyName)||"ULGEN ONE"}${t!=null&&t.address?`  ${t.address}`:""}${t!=null&&t.city?`, ${t.city}`:""}</div>
        <div style="font-size:7px; color:#ddd; font-style:italic;">Powered by ULGEN ONE</div>
      </div>

    </body>
    </html>
  `},l1=e=>{var t;try{const r=document.createElement("iframe");r.style.position="fixed",r.style.bottom="0",r.style.right="0",r.style.width="0",r.style.height="0",r.style.border="none",document.body.appendChild(r);const a=(t=r.contentWindow)==null?void 0:t.document;a&&(a.open(),a.write(e),a.close(),setTimeout(()=>{var s,i;try{(s=r.contentWindow)==null||s.focus(),(i=r.contentWindow)==null||i.print()}catch(l){console.error("Print error:",l)}finally{setTimeout(()=>{document.body.contains(r)&&document.body.removeChild(r)},3e3)}},500))}catch(r){console.error("Web print setup error:",r)}},Ex={exportOfferToPdf:(e,t)=>{const r=r$(e,t);l1(r)},exportBulkOfferToPdf:(e,t)=>{const r=a$(e,t);l1(r)}},Pj=Object.freeze(Object.defineProperty({__proto__:null,pdfService:Ex},Symbol.toStringTag,{value:"Module"})),n$=[{id:1,name:"Testliner / C",pricePerM2:12.5},{id:2,name:"Kraft / B+C",pricePerM2:18.25},{id:3,name:"Beyaz / E",pricePerM2:22.1}],_f="excel_price_list";function Cf(){return{lineId:crypto.randomUUID(),label:"",L:0,W:0,H:0,quantity:0,boxType:"standard",isDoublePiece:!1,qualityName:"",pricePerM2:0,profitMargin:20,plateCost:0,plateCostAllocation:"internal",shippingCost:0,shippingCostAllocation:"internal",results:null,birimSatisFiyati:0,toplamTutar:0,birimHamMaliyet:0,toplamHamMaliyet:0,finalCustomerTotal:0,isCalculated:!1}}function o1(){const e=ca(),{id:t}=Ch(),{user:r,userProfile:a}=vr(),[s,i]=b.useState(""),[l,o]=b.useState(""),[c,d]=b.useState("draft"),[u,f]=b.useState([Cf()]),[h,m]=b.useState(null),[x,p]=b.useState(!1),[g,y]=b.useState([]);b.useEffect(()=>{const U=localStorage.getItem(_f);if(U)try{y(JSON.parse(U))}catch{}},[]);const[N,v]=b.useState(!1);b.useEffect(()=>{var U;!t&&a&&!N&&(((U=a.settings)==null?void 0:U.defaultMargin)!==void 0&&f(M=>{var Y;return M.length===1&&!M[0].isCalculated?[{...M[0],profitMargin:((Y=a.settings)==null?void 0:Y.defaultMargin)??20}]:M}),v(!0))},[t,a,N]),b.useEffect(()=>{u.length>0&&!h&&m(u[0].lineId)},[u,h]);const S=b.useMemo(()=>g.length>0?g:n$,[g]);b.useEffect(()=>{t&&(async()=>{try{const U=await Ua.getBulkOfferById(t);U&&(i(U.customerName),o(U.title||""),d(U.status||"draft"),f(U.lineItems.length>0?U.lineItems:[Cf()]),U.lineItems.length>0&&m(U.lineItems[0].lineId))}catch(U){console.error("Failed to load bulk offer:",U),xe.error("Toplu teklif yklenemedi")}})()},[t]);const _=U=>{var B,V;const M=(B=U.target.files)==null?void 0:B[0];if(!M)return;const Y=new FileReader,Q=(V=M.name.split(".").pop())==null?void 0:V.toLowerCase();Y.onload=async P=>{var T;try{let R=[];const L=(T=P.target)==null?void 0:T.result;if(Q==="csv")R=jx.parse(L,{header:!0,skipEmptyLines:!0}).data.map((J,te)=>({id:te+1,name:String(J.quality||"").trim(),pricePerM2:parseFloat(String(J.price_per_m2||"0").replace(",","."))||0})).filter(J=>J.name&&J.pricePerM2>0);else if(Q==="xlsx"||Q==="xls"){const X=Wo(L,{type:"binary"}),J=X.SheetNames[0],te=X.Sheets[J];R=Ha.sheet_to_json(te).map((Z,ae)=>({id:ae+1,name:String(Z.quality||"").trim(),pricePerM2:parseFloat(String(Z.price_per_m2||"0").replace(",","."))||0})).filter(Z=>Z.name&&Z.pricePerM2>0)}if(R.length===0){xe.error("Geerli veri bulunamad. Kolonlar: quality, price_per_m2");return}y(R),localStorage.setItem(_f,JSON.stringify(R)),xe.success(`${R.length} kalite baaryla yklendi.`)}catch(R){console.error("Excel import error:",R),xe.error("Dosya okunamad.")}},Q==="csv"?Y.readAsText(M):Y.readAsBinaryString(M)},F=()=>{localStorage.removeItem(_f),y([]),xe.success("Kalite listesi sfrland.")},k=b.useCallback(()=>{var M;const U=Cf();((M=a==null?void 0:a.settings)==null?void 0:M.defaultMargin)!==void 0&&(U.profitMargin=a.settings.defaultMargin),f(Y=>[...Y,U]),m(U.lineId)},[a]),j=b.useCallback(U=>{f(M=>M.length<=1?(xe.warning("En az 1 kalem olmaldr"),M):M.filter(Y=>Y.lineId!==U))},[]),w=b.useCallback((U,M)=>{f(Y=>Y.map(Q=>Q.lineId===U?{...Q,...M,isCalculated:!1}:Q))},[]),E=b.useCallback(U=>{var V,P,T,R,L,X;const M=u.find(J=>J.lineId===U);if(!M)return;const Y=d2({customerName:s||"Bulk",lengthMm:M.L,widthMm:M.W,heightMm:M.H,quantity:M.quantity,pricePerM2:M.pricePerM2,boxType:M.boxType,isDoublePiece:M.isDoublePiece,flap:(V=a==null?void 0:a.settings)==null?void 0:V.defaultFlap,rillMm:(P=a==null?void 0:a.settings)==null?void 0:P.defaultRillMm});if(!Y.ok){const J=Y.errors.map(te=>` ${te}`).join(`
`);xe.error("Hesaplama yaplamad",{description:J,duration:4e3});return}const Q=Mm({lengthMm:M.L,widthMm:M.W,heightMm:M.H,quantity:M.quantity,pricePerM2:M.pricePerM2,boxType:M.boxType,isDoublePiece:M.isDoublePiece,flap:(T=a==null?void 0:a.settings)==null?void 0:T.defaultFlap,rillMm:(R=a==null?void 0:a.settings)==null?void 0:R.defaultRillMm});if(!Q.ok)return;const B=Eu({lengthMm:Q.values.lengthMm,widthMm:Q.values.widthMm,heightMm:Q.values.heightMm,quantity:Q.values.quantity,pricePerM2:Q.values.pricePerM2,qualityName:M.qualityName,boxType:M.boxType,isDoublePiece:M.isDoublePiece,flap:(L=a==null?void 0:a.settings)==null?void 0:L.defaultFlap,rillMm:(X=a==null?void 0:a.settings)==null?void 0:X.defaultRillMm});if(B){const J=Number(B.birimHamMaliyet||0),te=Number(B.quantity||0),G=1+Number(M.profitMargin||0)/100,Z=Math.round(J*G*100)/100*te,ae=te>0?Z/te:0,de=Number(M.plateCost)||0,z=Number(M.shippingCost)||0;let Ee=0;M.plateCostAllocation==="customer"&&(Ee+=de),M.shippingCostAllocation==="customer"&&(Ee+=z);const ue=Z+Ee;f(Ce=>Ce.map(ve=>ve.lineId===U?{...ve,results:B,birimSatisFiyati:ae,toplamTutar:Z,birimHamMaliyet:J,toplamHamMaliyet:Number(B.toplamHamMaliyet),finalCustomerTotal:ue,isCalculated:!0}:ve)),xe.success("Kalem hesapland")}else xe.error("Hesaplama baarsz")},[u,s]),A=b.useMemo(()=>{var R;const U=u.filter(L=>L.isCalculated),M=U.reduce((L,X)=>L+X.finalCustomerTotal,0),Y=U.reduce((L,X)=>{let J=0;return X.plateCostAllocation==="internal"&&(J+=Number(X.plateCost)||0),X.shippingCostAllocation==="internal"&&(J+=Number(X.shippingCost)||0),L+X.toplamHamMaliyet+J},0),Q=M-Y,B=U.length>0?U.reduce((L,X)=>L+X.profitMargin,0)/U.length:0,V=((R=a==null?void 0:a.settings)==null?void 0:R.defaultVatRate)??20,P=M*(V/100),T=M+P;return{itemCount:u.length,calculatedCount:U.length,totalRevenue:M,totalCost:Y,profit:Q,avgMargin:B,allCalculated:U.length===u.length&&u.length>0,vatRate:V,vatAmount:P,totalRevenueWithVat:T}},[u,a]),D=b.useCallback(()=>{if(!A.allCalculated){xe.error("Tm kalemleri hesaplamadan PDF oluturamazsnz.");return}const U=a==null?void 0:a.profileInfo,M=a?{companyName:(U==null?void 0:U.companyName)||a.companyName||"",contactName:a.name||"",address:(U==null?void 0:U.address)||a.address||"",phone:(U==null?void 0:U.phone)||a.phone||"",email:a.email||"",taxNumber:(U==null?void 0:U.taxNumber)||a.taxNumber||"",city:(U==null?void 0:U.city)||a.city||"",logoBase64:(U==null?void 0:U.logoBase64)||null}:null,Y={id:t||"TASLAK",customerName:s,title:l,lineItems:u,totalRevenue:A.totalRevenue,totalCost:A.totalCost,totalProfit:A.profit,itemCount:A.itemCount,createdAt:new Date,status:"draft"};Ex.exportBulkOfferToPdf(Y,M),xe.success("PDF hazrlanyor...")},[A,u,s,l,t,a]),W=b.useCallback(async()=>{if(!r)return null;if(!s.trim())return xe.error("Mteri ad zorunludur"),null;if(!A.allCalculated)return xe.error("Tm kalemleri hesaplamanz gerekmektedir"),null;p(!0);try{const U={customerName:s,title:l||null,status:c,lineItems:u,totalRevenue:A.totalRevenue,totalCost:A.totalCost,totalProfit:A.profit,itemCount:A.itemCount,createdByUid:r.uid,createdByName:(a==null?void 0:a.name)||r.email||"",companyCode:(a==null?void 0:a.companyCode)||null};if(t)return await Ua.updateBulkOffer(t,U),xe.success("Toplu teklif gncellendi"),t;{const M=await Ua.createBulkOffer(U);return e(`/edit-bulk-offer/${M}`,{replace:!0}),xe.success("Toplu teklif kaydedildi"),M}}catch(U){return console.error("Save error:",U),xe.error("Kaydetme hatas olutu"),null}finally{p(!1)}},[r,s,l,u,A,t,a,e,c]),re=b.useCallback(async()=>{if(r){if(!A.allCalculated){xe.error("Tm kalemleri hesaplamanz gerekmektedir");return}if(window.confirm("Teklifi onaylamak istediinize emin misiniz? Onayl teklifler zerinde dzenleme yaplamaz.")){p(!0);try{const U=await W();U&&(await Ua.approveOffer(U,r.uid,(a==null?void 0:a.role)||"individual"),d("approved"),xe.success("Toplu teklif dorudan onayland"),e("/my-offers"))}catch(U){console.error("Approve error:",U),xe.error("Onaylama srasnda hata olutu")}finally{p(!1)}}}},[r,a,A,W,e]);return n.jsxs("div",{className:"max-w-[1400px] mx-auto space-y-8 animate-in fade-in duration-500",children:[n.jsx("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:n.jsxs("div",{children:[n.jsxs("h1",{className:"text-3xl font-bold text-[var(--burgundy)] tracking-tight flex items-center gap-3",children:[n.jsx(us,{size:28}),"Toplu Teklif Olutur"]}),n.jsxs("p",{className:"text-text-secondary mt-1 flex items-center gap-2",children:[n.jsx(L1,{size:14,className:"text-[var(--burgundy)] opacity-60"}),"Bir mteri iin birden fazla kalem rn tek teklifte toplayn"]})]})}),n.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-12 gap-8",children:[n.jsxs("div",{className:"xl:col-span-8 space-y-6",children:[n.jsxs(tt,{className:"p-6 border-none bg-white shadow-xl shadow-slate-200/50 rounded-2xl",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[n.jsx("div",{className:"w-10 h-10 rounded-xl bg-[var(--burgundy-light)] text-[var(--burgundy)] flex items-center justify-center font-bold text-lg shadow-sm",children:"1"}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Mteri ve Proje"}),n.jsx("p",{className:"text-sm text-slate-500",children:"Tm kalemler bu mteri iin geerli olacak"})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(et,{className:"text-sm font-semibold text-slate-700",children:"Mteri Ad *"}),n.jsx(ze,{placeholder:"Mteri veya irket Ad",value:s,onChange:U=>i(U.target.value),className:"bg-slate-50 border-slate-200 focus:bg-white h-11"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(et,{className:"text-sm font-semibold text-slate-700",children:"Proje / Referans"}),n.jsx(ze,{placeholder:"rn: 2024 Yaz Kampanyas",value:l,onChange:U=>o(U.target.value),className:"bg-slate-50 border-slate-200 focus:bg-white h-11"})]})]})]}),n.jsxs(tt,{className:"p-6 border-none bg-white shadow-xl shadow-slate-200/50 rounded-2xl",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-10 h-10 rounded-xl bg-[var(--burgundy-light)] text-[var(--burgundy)] flex items-center justify-center font-bold text-lg shadow-sm",children:"2"}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Kalite Listesi"}),n.jsxs("p",{className:"text-sm text-slate-500",children:["Kalemler iin kullanlacak fiyat listesi (",S.length," kalite)"]})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("div",{className:"relative",children:[n.jsx(ze,{type:"file",className:"absolute inset-0 opacity-0 cursor-pointer z-10",accept:".xlsx,.xls,.csv",onChange:_}),n.jsxs(Re,{variant:"outline",size:"sm",className:"bg-emerald-50 text-emerald-700 border-emerald-200 hover:bg-emerald-100 h-9",children:[n.jsx(I1,{size:16,className:"mr-2"})," Excel Ykle"]})]}),g.length>0&&n.jsx(Re,{variant:"ghost",size:"sm",onClick:F,className:"text-red-500 hover:bg-red-50 h-9",children:n.jsx(sa,{size:16})})]})]}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:S.slice(0,12).map((U,M)=>n.jsxs("div",{className:"p-2.5 rounded-lg border border-slate-100 bg-slate-50/50",children:[n.jsx("span",{className:"font-bold text-xs text-slate-700 block",children:U.name}),n.jsxs("span",{className:"font-black text-sm text-slate-900",children:[U.pricePerM2.toFixed(2)," /m"]})]},M))}),g.length>0&&n.jsx("p",{className:"text-[10px] text-emerald-600 mt-3 font-bold",children:" Excel'den yklenen zel fiyat listesi aktif"})]}),n.jsxs(tt,{className:"p-6 border-none bg-white shadow-xl shadow-slate-200/50 rounded-2xl",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-10 h-10 rounded-xl bg-[var(--burgundy-light)] text-[var(--burgundy)] flex items-center justify-center font-bold text-lg shadow-sm",children:"3"}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Kalemler"}),n.jsxs("p",{className:"text-sm text-slate-500",children:[u.length," kalem  ",A.calculatedCount," hesapland"]})]})]}),n.jsxs(Re,{onClick:k,variant:"outline",className:"gap-2 border-[var(--burgundy)]/30 text-[var(--burgundy)] hover:bg-[var(--burgundy-light)]/20 font-bold",children:[n.jsx(ti,{size:16}),"Yeni Kalem"]})]}),n.jsx("div",{className:"space-y-3",children:u.map((U,M)=>n.jsx(s$,{item:U,index:M,isExpanded:h===U.lineId,onToggle:()=>m(h===U.lineId?null:U.lineId),onUpdate:Y=>w(U.lineId,Y),onCalculate:()=>E(U.lineId),onRemove:()=>j(U.lineId),priceList:S,canRemove:u.length>1},U.lineId))})]})]}),n.jsx("div",{className:"xl:col-span-4",children:n.jsxs("div",{className:"sticky top-8 space-y-6",children:[n.jsxs(tt,{className:"overflow-hidden border-none shadow-2xl shadow-[var(--burgundy)]/10 rounded-3xl",children:[n.jsxs("div",{className:"bg-[var(--burgundy)] p-6 text-white",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(us,{size:20,className:"text-white/80"}),n.jsx("span",{className:"text-sm font-bold uppercase opacity-80",children:"Toplu Teklif zeti"})]}),n.jsx("div",{className:`px-3 py-1 rounded-full text-[10px] font-bold flex items-center gap-1.5 ${A.allCalculated?"bg-emerald-400 text-emerald-950":"bg-amber-400 text-amber-950"}`,children:A.allCalculated?n.jsxs(n.Fragment,{children:[n.jsx(Jr,{size:10})," HAZIR"]}):n.jsxs(n.Fragment,{children:[n.jsx(oo,{size:10})," ",A.calculatedCount,"/",A.itemCount," HESAPLANDI"]})})]}),n.jsxs("div",{className:"text-4xl font-black mb-1",children:["",A.totalRevenueWithVat.toLocaleString("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2}),n.jsx("span",{className:"text-[12px] ml-2 opacity-60 uppercase font-bold tracking-wider",children:"(KDV Dahil)"})]}),n.jsx("p",{className:"text-sm text-white/60 mb-3",children:"Genel Toplam Proje Tutar"}),n.jsxs("div",{className:"pt-3 border-t border-white/10 text-xs text-white/80 space-y-1",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{children:"Ara Toplam (KDV Hari):"}),n.jsxs("span",{children:["",A.totalRevenue.toLocaleString("tr-TR",{minimumFractionDigits:2})]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{children:["KDV (%",A.vatRate,"):"]}),n.jsxs("span",{children:["",A.vatAmount.toLocaleString("tr-TR",{minimumFractionDigits:2})]})]})]})]}),n.jsxs("div",{className:"p-6 space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between text-sm",children:[n.jsx("span",{className:"text-slate-500",children:"Kalem Says"}),n.jsx("span",{className:"font-bold text-slate-800",children:A.itemCount})]}),n.jsxs("div",{className:"flex items-center justify-between text-sm",children:[n.jsx("span",{className:"text-slate-500",children:"Toplam Maliyet"}),n.jsxs("span",{className:"font-bold text-slate-800",children:["",A.totalCost.toLocaleString("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),n.jsxs("div",{className:"flex items-center justify-between text-sm",children:[n.jsx("span",{className:"text-slate-500",children:"Toplam Kr"}),n.jsxs("span",{className:`font-bold ${A.profit>=0?"text-emerald-600":"text-red-600"}`,children:["",A.profit.toLocaleString("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),n.jsxs("div",{className:"flex items-center justify-between text-sm",children:[n.jsx("span",{className:"text-slate-500",children:"Ort. Kr Marj"}),n.jsxs("span",{className:"font-bold text-slate-800",children:["%",A.avgMargin.toFixed(1)]})]})]}),n.jsxs("div",{className:"px-6 pb-6",children:[n.jsx("p",{className:"text-xs font-bold text-slate-500 uppercase mb-3",children:"Kalem Dkm"}),n.jsx("div",{className:"space-y-2 max-h-[300px] overflow-y-auto",children:u.map((U,M)=>n.jsxs("div",{className:`flex items-center justify-between p-2.5 rounded-lg text-xs ${U.isCalculated?"bg-emerald-50":"bg-slate-50"}`,children:[n.jsxs("div",{className:"flex items-center gap-2",children:[U.isCalculated?n.jsx(Jr,{size:12,className:"text-emerald-500"}):n.jsx(oo,{size:12,className:"text-amber-400"}),n.jsxs("div",{className:"flex flex-col",children:[n.jsx("span",{className:"font-medium text-slate-700",children:U.label||`Kalem ${M+1}`}),U.isCalculated&&n.jsxs("span",{className:"text-[10px] text-slate-400 font-mono mt-0.5",children:["m: ",(U.pricePerM2||0).toFixed(2)]})]})]}),n.jsx("span",{className:"font-bold text-slate-800",children:U.isCalculated?`${U.finalCustomerTotal.toLocaleString("tr-TR",{minimumFractionDigits:2})}`:""})]},U.lineId))})]})]}),n.jsxs("div",{className:"flex flex-col gap-3",children:[n.jsx(Re,{onClick:W,disabled:x||!A.allCalculated||c!=="draft",className:"w-full h-12 bg-[#1A1D1F] hover:bg-black text-white shadow-md font-bold text-base",children:x?n.jsx(Ar,{className:"animate-spin"}):n.jsxs(n.Fragment,{children:[n.jsx(Gd,{size:18,className:"mr-2"}),t?"Deiiklikleri Kaydet":"Tasla Kaydet"]})}),n.jsx(Re,{onClick:re,disabled:x||!A.allCalculated||c!=="draft",className:"w-full h-12 bg-emerald-600 hover:bg-emerald-700 text-white shadow-lg shadow-emerald-600/20 font-black text-base uppercase tracking-wider",children:x?n.jsx(Ar,{className:"animate-spin"}):n.jsxs(n.Fragment,{children:[n.jsx(Jr,{size:18,className:"mr-2"}),"Onayla"]})}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(Re,{variant:"outline",className:"flex-1 h-11 border-slate-200 text-slate-500 hover:bg-slate-50 font-bold",onClick:()=>e("/my-offers"),children:"Vazge"}),n.jsxs(Re,{variant:"outline",onClick:D,disabled:!A.allCalculated,className:"flex-1 h-11 gap-2 border-[var(--burgundy)]/30 text-[var(--burgundy)] hover:bg-[var(--burgundy-light)]/20 font-bold",children:[n.jsx(ma,{size:16}),"PDF ndir"]})]})]})]})})]})]})}function s$({item:e,index:t,isExpanded:r,onToggle:a,onUpdate:s,onCalculate:i,onRemove:l,priceList:o,canRemove:c}){const[d,u]=b.useState(()=>{if(e.qualityName){const x=o.findIndex(p=>p.name===e.qualityName);return x>=0?x:0}return 0});b.useEffect(()=>{const x=o[d];x&&(x.name!==e.qualityName||x.pricePerM2!==e.pricePerM2)&&s({qualityName:x.name,pricePerM2:x.pricePerM2})},[d,o]);const[f,h]=b.useState(!1),m=()=>{h(!0),setTimeout(()=>{i(),h(!1)},400)};return n.jsxs("div",{className:`rounded-xl border-2 transition-all ${e.isCalculated?"border-emerald-200 bg-emerald-50/30":r?"border-[var(--burgundy)]/30 bg-[var(--burgundy-light)]/5":"border-slate-100 bg-white hover:border-slate-200"}`,children:[n.jsxs("div",{className:"flex items-center gap-3 p-4 cursor-pointer select-none",onClick:a,children:[n.jsx(FE,{size:14,className:"text-slate-300 flex-shrink-0"}),n.jsx("div",{className:"w-7 h-7 rounded-lg bg-[var(--burgundy-light)] text-[var(--burgundy)] flex items-center justify-center font-bold text-xs flex-shrink-0",children:t+1}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"font-bold text-sm text-slate-800 truncate",children:e.label||`Kalem ${t+1}`}),e.isCalculated&&n.jsx(ut,{variant:"outline",className:"text-[10px] bg-emerald-50 text-emerald-700 border-emerald-200",children:" Hesapland"})]}),e.isCalculated&&n.jsxs("p",{className:"text-xs text-slate-500 mt-0.5",children:[e.L,"",e.W,"",e.H,"mm  ",e.qualityName,"  ",e.quantity," ad  ",e.finalCustomerTotal.toLocaleString("tr-TR",{minimumFractionDigits:2})]})]}),n.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.isCalculated&&n.jsxs("span",{className:"text-sm font-bold text-[var(--burgundy)]",children:["",e.finalCustomerTotal.toLocaleString("tr-TR",{minimumFractionDigits:2})]}),r?n.jsx(mh,{size:16,className:"text-slate-400"}):n.jsx(lo,{size:16,className:"text-slate-400"})]})]}),r&&n.jsxs("div",{className:"px-4 pb-4 space-y-5 border-t border-slate-100/60 pt-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(et,{className:"text-xs font-semibold text-slate-600",children:"Kalem Aklamas"}),n.jsx(ze,{placeholder:"rn: Byk Koli, Kk Koli...",value:e.label||"",onChange:x=>s({label:x.target.value}),className:"bg-white h-9 text-sm"})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsxs("div",{className:"space-y-1.5",children:[n.jsxs(et,{className:"text-xs font-semibold text-slate-600 flex items-center gap-1",children:[n.jsx(cn,{size:12,className:"text-[var(--burgundy)]"})," BOY (mm)"]}),n.jsx(ze,{type:"number",placeholder:"0",value:e.L||"",onChange:x=>s({L:Number(x.target.value)}),className:"bg-white h-9 font-mono text-sm"})]}),n.jsxs("div",{className:"space-y-1.5",children:[n.jsxs(et,{className:"text-xs font-semibold text-slate-600 flex items-center gap-1",children:[n.jsx(cn,{size:12,className:"text-[var(--burgundy)]"})," EN (mm)"]}),n.jsx(ze,{type:"number",placeholder:"0",value:e.W||"",onChange:x=>s({W:Number(x.target.value)}),className:"bg-white h-9 font-mono text-sm"})]}),n.jsxs("div",{className:"space-y-1.5",children:[n.jsxs(et,{className:"text-xs font-semibold text-slate-600 flex items-center gap-1",children:[n.jsx(cn,{size:12,className:"text-[var(--burgundy)]"})," YK. (mm)"]}),n.jsx(ze,{type:"number",placeholder:"0",value:e.H||"",onChange:x=>s({H:Number(x.target.value)}),className:"bg-white h-9 font-mono text-sm"})]}),n.jsxs("div",{className:"space-y-1.5",children:[n.jsx(et,{className:"text-xs font-semibold text-slate-600",children:"ADET"}),n.jsx(ze,{type:"number",placeholder:"0",value:e.quantity||"",onChange:x=>s({quantity:Number(x.target.value)}),className:"bg-[var(--burgundy-light)]/30 h-9 font-mono text-sm font-bold text-[var(--burgundy)]"})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-1.5",children:[n.jsx(et,{className:"text-xs font-bold text-slate-600 uppercase tracking-wider",children:"Koli Tipi"}),n.jsxs("div",{className:"flex bg-slate-100 p-1 rounded-lg",children:[n.jsx("button",{onClick:()=>s({boxType:"standard"}),className:`flex-1 py-2 px-3 rounded-md text-xs font-bold transition-all ${e.boxType==="standard"?"bg-[var(--burgundy)] text-white shadow":"text-slate-500"}`,children:"Standart"}),n.jsx("button",{onClick:()=>s({boxType:"fullFlap"}),className:`flex-1 py-2 px-3 rounded-md text-xs font-bold transition-all ${e.boxType==="fullFlap"?"bg-[var(--burgundy)] text-white shadow":"text-slate-500"}`,children:"Tam Kapak"})]})]}),n.jsxs("div",{className:"space-y-1.5",children:[n.jsx(et,{className:"text-xs font-bold text-slate-600 uppercase tracking-wider",children:"retim Modu"}),n.jsxs("div",{className:"flex bg-slate-100 p-1 rounded-lg",children:[n.jsxs("button",{onClick:()=>s({isDoublePiece:!1}),className:`flex-1 py-2 px-3 rounded-md text-xs font-bold transition-all flex items-center justify-center gap-1.5 ${e.isDoublePiece?"text-slate-500":"bg-[var(--burgundy)] text-white shadow"}`,children:[n.jsx(Dx,{size:14,className:e.isDoublePiece?"opacity-50":"opacity-80"})," Tek Para"]}),n.jsxs("button",{onClick:()=>s({isDoublePiece:!0}),className:`flex-1 py-2 px-3 rounded-md text-xs font-bold transition-all flex items-center justify-center gap-1.5 ${e.isDoublePiece?"bg-[var(--burgundy)] text-white shadow":"text-slate-500"}`,children:[n.jsx(Dx,{size:14,className:e.isDoublePiece?"opacity-80":"opacity-50"})," ift Para"]})]})]})]}),n.jsxs("div",{className:"space-y-1.5",children:[n.jsx(et,{className:"text-xs font-bold text-slate-600 uppercase tracking-wider",children:"Kalite"}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:o.slice(0,9).map((x,p)=>{const g=d===p;return n.jsxs("div",{onClick:()=>u(p),className:`p-2.5 rounded-lg border cursor-pointer transition-all text-xs ${g?"border-[var(--burgundy)] bg-[var(--burgundy-light)]/10":"border-slate-100 hover:border-slate-200"}`,children:[n.jsx("span",{className:`font-bold block ${g?"text-[var(--burgundy)]":"text-slate-700"}`,children:x.name}),n.jsxs("span",{className:"font-black text-slate-900",children:[x.pricePerM2.toFixed(2)," /m"]})]},p)})})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx(et,{className:"text-xs font-bold text-slate-600 uppercase",children:"Kr Marj"}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(ze,{type:"number",value:e.profitMargin,onChange:x=>s({profitMargin:Number(x.target.value)||0}),className:"w-16 h-7 text-center text-xs font-bold text-[var(--burgundy)]"}),n.jsx("span",{className:"text-sm font-black text-[var(--burgundy)]",children:"%"})]})]}),n.jsx(j2,{value:[e.profitMargin],min:0,max:100,step:1,onValueChange:x=>s({profitMargin:x[0]})})]}),n.jsxs("div",{className:"p-4 bg-slate-50 rounded-xl border border-slate-100 space-y-4",children:[n.jsx("h4",{className:"text-xs font-bold text-slate-800 uppercase tracking-wider",children:"Ek Maliyetler (Bu Kalem)"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(et,{className:"text-xs font-semibold text-slate-600",children:"Klie Maliyeti"}),n.jsxs("div",{className:"relative",children:[n.jsx(ze,{type:"number",placeholder:"0",value:e.plateCost||"",onChange:x=>s({plateCost:Number(x.target.value)||0}),className:"pl-7 h-8 text-sm bg-white"}),n.jsx("span",{className:"absolute left-2.5 top-1/2 -translate-y-1/2 text-slate-400 font-bold text-xs",children:""})]}),n.jsxs("div",{className:"flex bg-white p-0.5 rounded-md border border-slate-200",children:[n.jsx("button",{onClick:()=>s({plateCostAllocation:"internal"}),className:`flex-1 text-[10px] font-bold py-1.5 rounded transition-all ${e.plateCostAllocation==="internal"?"bg-slate-100 text-slate-800 shadow-sm":"text-slate-400"}`,children:" Maliyet"}),n.jsx("button",{onClick:()=>s({plateCostAllocation:"customer"}),className:`flex-1 text-[10px] font-bold py-1.5 rounded transition-all ${e.plateCostAllocation==="customer"?"bg-slate-100 text-[var(--burgundy)] shadow-sm":"text-slate-400"}`,children:"Mteriye"})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(et,{className:"text-xs font-semibold text-slate-600",children:"Nakliye Maliyeti"}),n.jsxs("div",{className:"relative",children:[n.jsx(ze,{type:"number",placeholder:"0",value:e.shippingCost||"",onChange:x=>s({shippingCost:Number(x.target.value)||0}),className:"pl-7 h-8 text-sm bg-white"}),n.jsx("span",{className:"absolute left-2.5 top-1/2 -translate-y-1/2 text-slate-400 font-bold text-xs",children:""})]}),n.jsxs("div",{className:"flex bg-white p-0.5 rounded-md border border-slate-200",children:[n.jsx("button",{onClick:()=>s({shippingCostAllocation:"internal"}),className:`flex-1 text-[10px] font-bold py-1.5 rounded transition-all ${e.shippingCostAllocation==="internal"?"bg-slate-100 text-slate-800 shadow-sm":"text-slate-400"}`,children:" Maliyet"}),n.jsx("button",{onClick:()=>s({shippingCostAllocation:"customer"}),className:`flex-1 text-[10px] font-bold py-1.5 rounded transition-all ${e.shippingCostAllocation==="customer"?"bg-slate-100 text-[var(--burgundy)] shadow-sm":"text-slate-400"}`,children:"Mteriye"})]})]})]})]}),n.jsxs("div",{className:"flex items-center justify-between pt-2",children:[n.jsxs(Re,{onClick:m,disabled:f,className:"bg-[var(--burgundy)] hover:bg-[var(--burgundy-hover)] text-white gap-2 font-bold",children:[f?n.jsx(Ar,{size:14,className:"animate-spin"}):n.jsx(is,{size:14}),"Hesapla"]}),c&&n.jsx(Re,{variant:"ghost",size:"sm",onClick:x=>{x.stopPropagation(),l()},className:"text-red-400 hover:text-red-600 hover:bg-red-50",children:n.jsx(sa,{size:14})})]}),e.isCalculated&&n.jsxs("div",{className:"bg-emerald-50 rounded-lg p-3 border border-emerald-100",children:[n.jsxs("div",{className:"grid grid-cols-3 gap-3 text-center",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-[10px] text-emerald-600 font-bold uppercase",children:"Birim Maliyet"}),n.jsxs("p",{className:"text-sm font-black text-slate-800",children:["",e.birimHamMaliyet.toFixed(2)]})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-[10px] text-emerald-600 font-bold uppercase",children:"Birim Sat"}),n.jsxs("p",{className:"text-sm font-black text-slate-800",children:["",e.birimSatisFiyati.toFixed(2)]})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-[10px] text-emerald-600 font-bold uppercase",children:"Toplam (Ek Dahil)"}),n.jsxs("p",{className:"text-sm font-black text-[var(--burgundy)]",children:["",e.finalCustomerTotal.toLocaleString("tr-TR",{minimumFractionDigits:2})]})]})]}),(Number(e.plateCost)>0||Number(e.shippingCost)>0)&&n.jsxs("div",{className:"mt-2 pt-2 border-t border-emerald-200/50 flex gap-4 justify-center text-[10px] text-emerald-700",children:[Number(e.plateCost)>0&&n.jsxs("span",{children:["Klie: ",e.plateCost," (",e.plateCostAllocation==="internal"?"":"Mteri",")"]}),Number(e.shippingCost)>0&&n.jsxs("span",{children:["Nakliye: ",e.shippingCost," (",e.shippingCostAllocation==="internal"?"":"Mteri",")"]})]}),e.results&&n.jsx(Rd,{widthMm:e.results.calculatedEn,heightMm:e.results.calculatedBoy,flapMm:e.results.chosenRil,kulakMm:e.results.kulakPayi,enRilleri:e.results.enRilleri,boyRilleri:e.results.boyRilleri})]})]})]})}var Sx="Checkbox",[i$]=In(Sx),[l$,o$]=i$(Sx),Oj=b.forwardRef((e,t)=>{const{__scopeCheckbox:r,name:a,checked:s,defaultChecked:i,required:l,disabled:o,value:c="on",onCheckedChange:d,form:u,...f}=e,[h,m]=b.useState(null),x=Yt(t,S=>m(S)),p=b.useRef(!1),g=h?u||!!h.closest("form"):!0,[y=!1,N]=xs({prop:s,defaultProp:i,onChange:d}),v=b.useRef(y);return b.useEffect(()=>{const S=h==null?void 0:h.form;if(S){const _=()=>N(v.current);return S.addEventListener("reset",_),()=>S.removeEventListener("reset",_)}},[h,N]),n.jsxs(l$,{scope:r,state:y,disabled:o,children:[n.jsx(_t.button,{type:"button",role:"checkbox","aria-checked":fs(y)?"mixed":y,"aria-required":l,"data-state":Bj(y),"data-disabled":o?"":void 0,disabled:o,value:c,...f,ref:x,onKeyDown:Je(e.onKeyDown,S=>{S.key==="Enter"&&S.preventDefault()}),onClick:Je(e.onClick,S=>{N(_=>fs(_)?!0:!_),g&&(p.current=S.isPropagationStopped(),p.current||S.stopPropagation())})}),g&&n.jsx(c$,{control:h,bubbles:!p.current,name:a,value:c,checked:y,required:l,disabled:o,form:u,style:{transform:"translateX(-100%)"},defaultChecked:fs(i)?!1:i})]})});Oj.displayName=Sx;var Ij="CheckboxIndicator",Lj=b.forwardRef((e,t)=>{const{__scopeCheckbox:r,forceMount:a,...s}=e,i=o$(Ij,r);return n.jsx(hl,{present:a||fs(i.state)||i.state===!0,children:n.jsx(_t.span,{"data-state":Bj(i.state),"data-disabled":i.disabled?"":void 0,...s,ref:t,style:{pointerEvents:"none",...e.style}})})});Lj.displayName=Ij;var c$=e=>{const{control:t,checked:r,bubbles:a=!0,defaultChecked:s,...i}=e,l=b.useRef(null),o=gu(r),c=uu(t);b.useEffect(()=>{const u=l.current,f=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(f,"checked").set;if(o!==r&&m){const x=new Event("click",{bubbles:a});u.indeterminate=fs(r),m.call(u,fs(r)?!1:r),u.dispatchEvent(x)}},[o,r,a]);const d=b.useRef(fs(r)?!1:r);return n.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:s??d.current,...i,tabIndex:-1,ref:l,style:{...e.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function fs(e){return e==="indeterminate"}function Bj(e){return fs(e)?"indeterminate":e?"checked":"unchecked"}var d$=Oj,u$=Lj;function Ui({className:e,...t}){return n.jsx(d$,{"data-slot":"checkbox",className:We("peer border bg-input-background dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:n.jsx(u$,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:n.jsx(Ws,{className:"size-3.5"})})})}var f$="Separator",c1="horizontal",h$=["horizontal","vertical"],zj=b.forwardRef((e,t)=>{const{decorative:r,orientation:a=c1,...s}=e,i=m$(a)?a:c1,o=r?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return n.jsx(_t.div,{"data-orientation":i,...o,...s,ref:t})});zj.displayName=f$;function m$(e){return h$.includes(e)}var x$=zj;function Vc({className:e,orientation:t="horizontal",decorative:r=!0,...a}){return n.jsx(x$,{"data-slot":"separator-root",decorative:r,orientation:t,className:We("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",e),...a})}function hn({className:e,...t}){return n.jsx("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:n.jsx("table",{"data-slot":"table",className:We("w-full caption-bottom text-sm",e),...t})})}function mn({className:e,...t}){return n.jsx("thead",{"data-slot":"table-header",className:We("[&_tr]:border-b",e),...t})}function xn({className:e,...t}){return n.jsx("tbody",{"data-slot":"table-body",className:We("[&_tr:last-child]:border-0",e),...t})}function zt({className:e,...t}){return n.jsx("tr",{"data-slot":"table-row",className:We("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...t})}function Ve({className:e,...t}){return n.jsx("th",{"data-slot":"table-head",className:We("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}function Oe({className:e,...t}){return n.jsx("td",{"data-slot":"table-cell",className:We("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}function p$({...e}){return n.jsx(lh,{"data-slot":"sheet",...e})}function g$({...e}){return n.jsx(fh,{"data-slot":"sheet-portal",...e})}function v$({className:e,...t}){return n.jsx(hh,{"data-slot":"sheet-overlay",className:We("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...t})}function y$({className:e,children:t,side:r="right",...a}){return n.jsxs(g$,{children:[n.jsx(v$,{}),n.jsxs(oh,{"data-slot":"sheet-content",className:We("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500",r==="right"&&"data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm",r==="left"&&"data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm",r==="top"&&"data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b",r==="bottom"&&"data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t",e),...a,children:[t,n.jsxs(ch,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none",children:[n.jsx(M1,{className:"size-4"}),n.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function b$({className:e,...t}){return n.jsx("div",{"data-slot":"sheet-header",className:We("flex flex-col gap-1.5 p-4",e),...t})}function w$({className:e,...t}){return n.jsx(dh,{"data-slot":"sheet-title",className:We("text-foreground font-semibold",e),...t})}function k$({className:e,...t}){return n.jsx(uh,{"data-slot":"sheet-description",className:We("text-muted-foreground text-sm",e),...t})}const N$=e=>e.createdAt&&typeof e.createdAt.toDate=="function"?e.createdAt.toDate():new Date;function j$(){var z,Ee,ue,Ce,ve,ge,Fe,Ie,Ze,yt,ht,Ct,Ue,kt,qe,Ft,Qe,bt;const e=ca(),{user:t,userRole:r,userProfile:a}=vr(),[s,i]=b.useState(!0),[l,o]=b.useState([]),[c,d]=b.useState([]),[u]=b.useState("all"),[f,h]=b.useState("single"),[m,x]=b.useState(""),[p,g]=b.useState([]),[y,N]=b.useState([]),[v,S]=b.useState(null),[_,F]=b.useState(!1),[k,j]=b.useState(null),[w,E]=b.useState(!1),[A,D]=b.useState(""),[W,re]=b.useState(null);b.useEffect(()=>{async function se(){if(t)try{i(!0);const[Ne,De]=await Promise.all([Wt.getUserOffers(t.uid),Ua.getUserBulkOffers(t.uid)]);o(Ne),d(De)}catch(Ne){console.error("Error fetching offers:",Ne),Ne.code==="failed-precondition"||Ne.message&&Ne.message.includes("requires an index")?xe.error("Grnm hazrlanyor (indeks oluturuluyor), ltfen bir dakika sonra tekrar deneyin."):xe.error("Teklifler yklenirken bir hata olutu.")}finally{i(!1)}}se()},[t]);const U=se=>{S(se),F(!0)},M=se=>{g(Ne=>Ne.includes(se)?Ne.filter(De=>De!==se):[...Ne,se])},Y=()=>{p.length===l.length?g([]):g(l.map(se=>se.id))},Q=se=>{N(Ne=>Ne.includes(se)?Ne.filter(De=>De!==se):[...Ne,se])},B=()=>{y.length===c.length?N([]):N(c.map(se=>se.id))},V=se=>{var Ne,De,lt,Rt,_r;if(!(!t||!a))try{Ex.exportOfferToPdf(se,{companyName:((Ne=a.profileInfo)==null?void 0:Ne.companyName)||a.companyCode||"Bireysel Kullanc",contactName:a.name,email:a.email,phone:((De=a.profileInfo)==null?void 0:De.phone)||"",taxNumber:((lt=a.profileInfo)==null?void 0:lt.taxNumber)||"",address:(Rt=a.profileInfo)!=null&&Rt.address?`${a.profileInfo.address}${a.profileInfo.city?", "+a.profileInfo.city:""}`:"",logoBase64:((_r=a.profileInfo)==null?void 0:_r.logoBase64)||null}),xe.success("PDF hazrlanyor...")}catch{xe.error("PDF oluturulamad")}},P=async se=>{if(t)try{j(se.id),await Wt.submitForApproval(se.id,t.uid,r||"individual"),xe.success("Teklif onaya gnderildi"),o(Ne=>Ne.map(De=>De.id===se.id?{...De,status:"pending_approval"}:De))}catch{xe.error("lem baarsz")}finally{j(null)}},T=async se=>{if(t)try{j(se.id),await Wt.withdrawOffer(se.id,t.uid,r||"individual"),xe.success("Teklif geri ekildi"),o(Ne=>Ne.map(De=>De.id===se.id?{...De,status:"draft"}:De))}catch{xe.error("lem baarsz")}finally{j(null)}},R=async se=>{if(t)try{j(se.id),await Wt.approveOffer(se.id,t.uid,r||"company_admin"),xe.success("Teklif onayland"),o(Ne=>Ne.map(De=>De.id===se.id?{...De,status:"approved"}:De))}catch{xe.error("lem baarsz")}finally{j(null)}},L=async()=>{if(!(!t||!W||!A))try{j(W.id),await Wt.rejectOffer(W.id,t.uid,r||"company_admin",A),xe.success("Teklif reddedildi"),o(se=>se.map(Ne=>Ne.id===W.id?{...Ne,status:"rejected",rejectionReason:A}:Ne)),E(!1),D(""),re(null)}catch{xe.error("lem baarsz")}finally{j(null)}},X=async se=>{if(t)try{j(se.id);const Ne=await Wt.cloneOfferToDraft(se.id,t.uid);xe.success("Teklif kopyaland"),e(`/edit-offer/${Ne}`)}catch{xe.error("Klonlama baarsz")}finally{j(null)}},J=async se=>{if(!t||!r)return;if(!(r===Jt.SUPER_ADMIN||r===Jt.COMPANY_ADMIN&&se.companyCode===(a==null?void 0:a.companyCode)||r===Jt.COMPANY_MEMBER&&se.createdByUid===t.uid||r===Jt.INDIVIDUAL&&se.createdByUid===t.uid)){xe.error("Bu teklifi silme yetkiniz yok.");return}if(window.confirm("Bu teklifi silmek istediinize emin misiniz?"))try{j(se.id),await Wt.softDeleteOffer(se.id,t.uid,r),xe.success("Teklif silindi"),o(De=>De.filter(lt=>lt.id!==se.id))}catch(De){console.error(De),xe.error("Silme ilemi baarsz")}finally{j(null)}},te=l.filter(se=>{const Ne=(se.customerName||"").toLowerCase().includes(m.toLowerCase())||se.id.toLowerCase().includes(m.toLowerCase());return u==="all"?Ne:Ne&&se.status===u}),G=c.filter(se=>{const Ne=(se.customerName||"").toLowerCase().includes(m.toLowerCase())||se.id.toLowerCase().includes(m.toLowerCase());return u==="all"?Ne:Ne&&se.status===u}),Z=async se=>{if(t&&window.confirm("Bu toplu teklifi silmek istediinize emin misiniz?"))try{j(se.id),await Ua.softDeleteBulkOffer(se.id,t.uid,r||"individual"),d(Ne=>Ne.filter(De=>De.id!==se.id)),xe.success("Toplu teklif silindi")}catch{xe.error("Silme baarsz")}finally{j(null)}},ae=async()=>{if(!(!t||p.length===0)&&window.confirm(`${p.length} adet teklifi silmek istediinize emin misiniz?`))try{j("bulk-delete");const se=p.map(Ne=>Wt.softDeleteOffer(Ne,t.uid,r||"individual"));await Promise.allSettled(se),xe.success(`${p.length} teklif silindi`),o(Ne=>Ne.filter(De=>!p.includes(De.id))),g([])}catch(se){console.error(se),xe.error("Baz teklifler silinirken hata olutu")}finally{j(null)}},de=async()=>{if(!(!t||y.length===0)&&window.confirm(`${y.length} adet toplu teklifi silmek istediinize emin misiniz?`))try{j("bulk-delete-bulk");const se=y.map(Ne=>Ua.softDeleteBulkOffer(Ne,t.uid,r||"individual"));await Promise.allSettled(se),xe.success(`${y.length} toplu teklif silindi`),d(Ne=>Ne.filter(De=>!y.includes(De.id))),N([])}catch(se){console.error(se),xe.error("Baz teklifler silinirken hata olutu")}finally{j(null)}};return n.jsxs(po,{children:[n.jsx(nu,{title:"Tekliflerim",description:"Ynettiiniz ve oluturduunuz tm koli teklifleri",actions:n.jsxs(Re,{onClick:()=>e(f==="bulk"?"/bulk-offer":"/create-offer"),className:"bg-[#1A1D1F] hover:bg-black text-white font-black uppercase tracking-widest text-xs shadow-md gap-3 flex items-center h-10 px-4",children:[n.jsx(ti,{size:16}),f==="bulk"?"Yeni Toplu Teklif":"Yeni Teklif"]})}),n.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-4 mb-6",children:[n.jsxs("div",{className:"flex bg-surface-secondary p-1 rounded-md border border-border/50 shrink-0",children:[n.jsxs("button",{onClick:()=>h("single"),className:`flex items-center gap-2 px-4 py-2 rounded-sm text-sm font-black uppercase tracking-tight transition-all ${f==="single"?"bg-white shadow-sm text-foreground":"text-muted-foreground hover:text-foreground"}`,children:[n.jsx(ma,{size:14}),"Tekli Teklifler",n.jsx("span",{className:`text-[10px] px-1.5 py-0.5 rounded-full font-black ${f==="single"?"bg-[#800020]/10 text-[#800020]":"bg-border text-muted-foreground"}`,children:l.length})]}),n.jsxs("button",{onClick:()=>h("bulk"),className:`flex items-center gap-2 px-4 py-2 rounded-sm text-sm font-black uppercase tracking-tight transition-all ${f==="bulk"?"bg-white shadow-sm text-foreground":"text-muted-foreground hover:text-foreground"}`,children:[n.jsx(us,{size:14}),"Toplu Teklifler",n.jsx("span",{className:`text-[10px] px-1.5 py-0.5 rounded-full font-black ${f==="bulk"?"bg-[#800020]/10 text-[#800020]":"bg-border text-muted-foreground"}`,children:c.length})]})]}),n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(ph,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground"}),n.jsx(ze,{placeholder:"Mteri ad veya teklif numaras ile ara...",value:m,onChange:se=>x(se.target.value),className:"pl-10 h-10 border-2 border-border/60 rounded-md bg-white font-medium shadow-sm transition-smooth focus-visible:ring-1 focus-visible:ring-border"})]}),f==="single"&&p.length>0&&n.jsxs(Re,{variant:"destructive",onClick:ae,disabled:k==="bulk-delete",className:"shrink-0 bg-status-error hover:bg-status-error/90 text-white",children:[k==="bulk-delete"?n.jsx("div",{className:"h-4 w-4 animate-spin border-2 border-white border-t-transparent rounded-full mr-2"}):n.jsx(sa,{size:16,className:"mr-2"}),"Seilenleri Sil (",p.length,")"]}),f==="bulk"&&y.length>0&&n.jsxs(Re,{variant:"destructive",onClick:de,disabled:k==="bulk-delete-bulk",className:"shrink-0 bg-status-error hover:bg-status-error/90 text-white",children:[k==="bulk-delete-bulk"?n.jsx("div",{className:"h-4 w-4 animate-spin border-2 border-white border-t-transparent rounded-full mr-2"}):n.jsx(sa,{size:16,className:"mr-2"}),"Seilenleri Sil (",y.length,")"]})]}),f==="single"&&n.jsx(tt,{children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs(hn,{children:[n.jsx(mn,{children:n.jsxs(zt,{className:"hover:bg-transparent border-b-2 border-border/60",children:[n.jsx(Ve,{className:"w-12",children:n.jsx(Ui,{checked:p.length>0&&p.length===l.length,onCheckedChange:Y})}),n.jsx(Ve,{className:"font-black uppercase tracking-widest text-[#1A1D1F] text-xs",children:"Teklif No"}),n.jsx(Ve,{className:"font-black uppercase tracking-widest text-[#1A1D1F] text-xs",children:"Mteri / Proje"}),n.jsx(Ve,{className:"font-black uppercase tracking-widest text-[#1A1D1F] text-xs",children:"Tarih"}),n.jsx(Ve,{className:"font-black uppercase tracking-widest text-[#1A1D1F] text-xs",children:"ller (mm)"}),n.jsx(Ve,{className:"font-black uppercase tracking-widest text-[#1A1D1F] text-xs text-right",children:"Miktar"}),n.jsx(Ve,{className:"font-black uppercase tracking-widest text-[#1A1D1F] text-xs text-right",children:"Birim Sat"}),n.jsx(Ve,{className:"font-black uppercase tracking-widest text-[#1A1D1F] text-xs text-right",children:"Toplam Tutar"}),n.jsx(Ve,{className:"font-black uppercase tracking-widest text-[#1A1D1F] text-xs text-center",children:"Durum"}),n.jsx(Ve,{className:"w-12"})]})}),n.jsx(xn,{children:s?n.jsx(zt,{children:n.jsx(Oe,{colSpan:10,className:"text-center py-8",children:"Ykleniyor..."})}):te.length===0?n.jsx(zt,{children:n.jsx(Oe,{colSpan:10,className:"text-center py-8",children:"Teklif bulunamad."})}):te.map(se=>{var Ne,De,lt,Rt,_r,Hr;return n.jsxs(zt,{className:"cursor-pointer hover:bg-surface-secondary/50 transition-colors border-b border-border/50",onClick:()=>U(se),children:[n.jsx(Oe,{onClick:Et=>Et.stopPropagation(),children:n.jsx(Ui,{checked:p.includes(se.id),onCheckedChange:()=>M(se.id)})}),n.jsx(Oe,{className:"font-medium text-[var(--burgundy)]",children:se.id}),n.jsx(Oe,{className:"font-medium",children:n.jsxs("div",{className:"flex flex-col",children:[n.jsx("span",{className:"text-slate-900",children:se.customerName}),se.title&&n.jsx("span",{className:"text-[10px] text-slate-400 font-medium italic",children:se.title})]})}),n.jsx(Oe,{className:"text-text-secondary",children:N$(se).toLocaleDateString("tr-TR")}),n.jsxs(Oe,{className:"numeric font-mono text-sm",children:[(Ne=se.payload)==null?void 0:Ne.L,"x",(De=se.payload)==null?void 0:De.W,"x",(lt=se.payload)==null?void 0:lt.H]}),n.jsx(Oe,{className:"numeric text-right",children:(((Rt=se.payload)==null?void 0:Rt.quantity)||0).toLocaleString("tr-TR")}),n.jsxs(Oe,{className:"numeric text-right",children:["",(((_r=se.payload)==null?void 0:_r.birimSatisFiyati)||0).toLocaleString("tr-TR",{minimumFractionDigits:2})]}),n.jsxs(Oe,{className:"numeric text-right font-bold text-[var(--burgundy)]",children:["",(((Hr=se.payload)==null?void 0:Hr.toplamTutar)||0).toLocaleString("tr-TR",{minimumFractionDigits:2})]}),n.jsx(Oe,{className:"text-center",children:n.jsx(ut,{variant:ed[se.status],children:Yl[se.status]})}),n.jsx(Oe,{className:"text-right",onClick:Et=>Et.stopPropagation(),children:n.jsxs(nl,{children:[n.jsx(sl,{asChild:!0,children:n.jsx(Re,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:Et=>Et.stopPropagation(),children:k===se.id?n.jsx("div",{className:"h-4 w-4 animate-spin border-2 border-[var(--burgundy)] border-t-transparent rounded-full"}):n.jsx(co,{className:"h-4 w-4"})})}),n.jsxs(il,{align:"end",onClick:Et=>Et.stopPropagation(),children:[n.jsxs(Vt,{onClick:Et=>{Et.stopPropagation(),U(se)},children:[n.jsx(uo,{className:"mr-2 h-4 w-4"}),"Grntle"]}),se.status==="draft"&&n.jsxs(n.Fragment,{children:[n.jsxs(Vt,{onClick:Et=>{Et.stopPropagation(),P(se)},children:[n.jsx(dd,{className:"mr-2 h-4 w-4"}),"Onaya Gnder"]}),n.jsxs(Vt,{onClick:Et=>{Et.stopPropagation(),e(`/edit-offer/${se.id}`)},children:[n.jsx(DE,{className:"mr-2 h-4 w-4"}),"Dzenle"]}),n.jsxs(Vt,{className:"text-status-error focus:text-status-error",onClick:Et=>{Et.stopPropagation(),J(se)},children:[n.jsx(sa,{className:"mr-2 h-4 w-4"}),"Sil"]})]}),se.status==="pending_approval"&&n.jsxs(n.Fragment,{children:[se.createdByUid===(t==null?void 0:t.uid)&&n.jsxs(Vt,{onClick:Et=>{Et.stopPropagation(),T(se)},children:[n.jsx(Jf,{className:"mr-2 h-4 w-4"}),"Geri ek"]}),(r===Jt.SUPER_ADMIN||r===Jt.COMPANY_ADMIN)&&n.jsxs(n.Fragment,{children:[n.jsxs(Vt,{className:"text-status-success focus:text-status-success",onClick:Et=>{Et.stopPropagation(),R(se)},children:[n.jsx(qf,{className:"mr-2 h-4 w-4"}),"Onayla"]}),n.jsxs(Vt,{className:"text-status-error focus:text-status-error",onClick:Et=>{Et.stopPropagation(),re(se),E(!0)},children:[n.jsx(Zf,{className:"mr-2 h-4 w-4"}),"Reddet"]})]})]}),se.status==="rejected"&&n.jsxs(Vt,{onClick:Et=>{Et.stopPropagation(),X(se)},children:[n.jsx(P1,{className:"mr-2 h-4 w-4"}),"Kopyala ve Dzenle"]}),(se.status==="approved"||se.status==="pending_approval")&&n.jsxs(Vt,{onClick:Et=>{Et.stopPropagation(),V(se)},children:[n.jsx(ma,{className:"mr-2 h-4 w-4"}),"PDF ndir ",se.status==="pending_approval"&&"(Taslak)"]}),n.jsxs(Vt,{className:"text-status-error focus:text-status-error",onClick:Et=>{Et.stopPropagation(),J(se)},children:[n.jsx(sa,{className:"mr-2 h-4 w-4"}),"Teklifi Sil"]})]})]})})]},se.id)})})]})})}),f==="bulk"&&n.jsx(tt,{children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs(hn,{children:[n.jsx(mn,{children:n.jsxs(zt,{className:"hover:bg-transparent border-b-2 border-border/60",children:[n.jsx(Ve,{className:"w-12",children:n.jsx(Ui,{checked:G.length>0&&y.length===G.length,onCheckedChange:B})}),n.jsx(Ve,{className:"font-black uppercase tracking-widest text-[#1A1D1F] text-xs",children:"Teklif No"}),n.jsx(Ve,{className:"font-black uppercase tracking-widest text-[#1A1D1F] text-xs",children:"Mteri / Proje"}),n.jsx(Ve,{className:"font-black uppercase tracking-widest text-[#1A1D1F] text-xs",children:"Tarih"}),n.jsx(Ve,{className:"font-black uppercase tracking-widest text-[#1A1D1F] text-xs text-center",children:"Kalem"}),n.jsx(Ve,{className:"font-black uppercase tracking-widest text-[#1A1D1F] text-xs text-right",children:"Toplam Ciro"}),n.jsx(Ve,{className:"font-black uppercase tracking-widest text-[#1A1D1F] text-xs text-right",children:"Toplam Maliyet"}),n.jsx(Ve,{className:"font-black uppercase tracking-widest text-[#1A1D1F] text-xs text-right",children:"Kr"}),n.jsx(Ve,{className:"font-black uppercase tracking-widest text-[#1A1D1F] text-xs text-center",children:"Durum"}),n.jsx(Ve,{className:"w-12"})]})}),n.jsx(xn,{children:s?n.jsx(zt,{children:n.jsx(Oe,{colSpan:10,className:"text-center py-8",children:"Ykleniyor..."})}):G.length===0?n.jsx(zt,{children:n.jsx(Oe,{colSpan:10,className:"text-center py-12",children:n.jsxs("div",{className:"flex flex-col items-center gap-3",children:[n.jsx(us,{size:32,className:"text-slate-300"}),n.jsx("p",{className:"text-sm text-slate-500",children:"Henz toplu teklif oluturulmad."}),n.jsxs(Re,{size:"sm",onClick:()=>e("/bulk-offer"),className:"bg-[var(--burgundy)] hover:bg-[var(--burgundy-hover)] text-white gap-2 mt-2",children:[n.jsx(ti,{size:14}),"lk Toplu Teklifinizi Oluturun"]})]})})}):G.map(se=>{const Ne=se.date?new Date(se.date):new Date;return n.jsxs(zt,{className:"cursor-pointer hover:bg-surface-secondary/50 transition-colors border-b border-border/50",onClick:()=>e(`/edit-bulk-offer/${se.id}`),children:[n.jsx(Oe,{onClick:De=>De.stopPropagation(),children:n.jsx(Ui,{checked:y.includes(se.id),onCheckedChange:()=>Q(se.id)})}),n.jsx(Oe,{className:"font-medium text-[var(--burgundy)]",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(us,{size:14,className:"text-[var(--burgundy)]/50"}),se.id]})}),n.jsx(Oe,{className:"font-medium",children:n.jsxs("div",{className:"flex flex-col",children:[n.jsx("span",{className:"text-slate-900",children:se.customerName}),se.title&&n.jsx("span",{className:"text-[10px] text-slate-400 font-medium italic",children:se.title})]})}),n.jsx(Oe,{className:"text-text-secondary",children:Ne.toLocaleDateString("tr-TR")}),n.jsx(Oe,{className:"text-center",children:n.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-slate-100 text-xs font-bold text-slate-700",children:[se.itemCount," kalem"]})}),n.jsxs(Oe,{className:"numeric text-right font-bold text-[var(--burgundy)]",children:["",(se.totalRevenue||0).toLocaleString("tr-TR",{minimumFractionDigits:2})]}),n.jsxs(Oe,{className:"numeric text-right",children:["",(se.totalCost||0).toLocaleString("tr-TR",{minimumFractionDigits:2})]}),n.jsxs(Oe,{className:`numeric text-right font-bold ${(se.totalProfit||0)>=0?"text-emerald-600":"text-red-600"}`,children:["",(se.totalProfit||0).toLocaleString("tr-TR",{minimumFractionDigits:2})]}),n.jsx(Oe,{className:"text-center",children:n.jsx(ut,{variant:ed[se.status],children:Yl[se.status]})}),n.jsx(Oe,{className:"text-right",onClick:De=>De.stopPropagation(),children:n.jsxs(nl,{children:[n.jsx(sl,{asChild:!0,children:n.jsx(Re,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:De=>De.stopPropagation(),children:k===se.id?n.jsx("div",{className:"h-4 w-4 animate-spin border-2 border-[var(--burgundy)] border-t-transparent rounded-full"}):n.jsx(co,{className:"h-4 w-4"})})}),n.jsxs(il,{align:"end",onClick:De=>De.stopPropagation(),children:[n.jsxs(Vt,{onClick:De=>{De.stopPropagation(),e(`/edit-bulk-offer/${se.id}`)},children:[n.jsx(uo,{className:"mr-2 h-4 w-4"}),"Grntle / Dzenle"]}),n.jsxs(Vt,{className:"text-status-error focus:text-status-error",onClick:De=>{De.stopPropagation(),Z(se)},children:[n.jsx(sa,{className:"mr-2 h-4 w-4"}),"Sil"]})]})]})})]},se.id)})})]})})}),n.jsx(p$,{open:_,onOpenChange:F,children:n.jsx(y$,{className:"w-full max-w-md sm:max-w-xl p-6",children:v&&n.jsxs("div",{className:"flex flex-col h-full bg-white",children:[n.jsx(b$,{className:"pb-4 border-b",children:n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsxs("div",{className:"flex flex-col gap-1",children:[n.jsxs(w$,{className:"flex items-center gap-2 text-2xl font-black text-slate-800",children:[n.jsx(ma,{size:20,className:"text-[var(--burgundy)]"}),v.id]}),n.jsx(k$,{className:"text-sm font-medium",children:v.customerName})]}),n.jsx(ut,{variant:ed[v.status],className:"uppercase font-bold tracking-wider",children:Yl[v.status]})]})}),n.jsxs("div",{className:"flex-1 overflow-y-auto py-6 space-y-6 pr-4 -mr-4 custom-scrollbar",children:[n.jsxs("div",{className:"bg-[var(--burgundy-light)]/20 border border-[var(--burgundy)]/20 p-5 rounded-xl shadow-sm",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsxs("span",{className:"text-xs font-black uppercase text-[var(--burgundy)] flex items-center gap-1",children:[n.jsx(B1,{size:14})," FNANSAL ZET"]}),n.jsxs("span",{className:`text-sm font-bold px-2 py-0.5 rounded-full ${(((z=v.payload)==null?void 0:z.profitMargin)||0)>=20?"bg-emerald-100 text-emerald-700":"bg-red-100 text-red-700"}`,children:["%",((Ee=v.payload)==null?void 0:Ee.profitMargin)||0," Marj"]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"bg-white p-3 rounded-lg border border-slate-100",children:[n.jsx("div",{className:"text-[10px] text-slate-500 font-bold uppercase mb-1",children:"Toplam Maliyet"}),n.jsxs("div",{className:"font-mono text-sm font-semibold",children:["",(((ue=v.payload)==null?void 0:ue.toplamHamMaliyet)||v.totalCost||v.toplamMaliyet||0).toLocaleString("tr-TR")]})]}),n.jsxs("div",{className:"bg-white p-3 rounded-lg border border-emerald-100",children:[n.jsx("div",{className:"text-[10px] text-emerald-600 font-bold uppercase mb-1",children:"Final Sat"}),n.jsxs("div",{className:"font-mono text-lg font-black text-emerald-700",children:["",(((Ce=v.payload)==null?void 0:Ce.toplamTutar)||v.totalRevenue||v.toplamTutar||v.amount||0).toLocaleString("tr-TR",{minimumFractionDigits:2})]})]})]})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("h3",{className:"text-xs font-black text-slate-400 uppercase tracking-widest flex items-center gap-2",children:[n.jsx(cn,{size:14})," RN DETAYLARI"]}),v.id.startsWith("TKT-")?n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"bg-slate-50 border border-slate-100 p-4 rounded-xl flex justify-between items-center",children:[n.jsx("span",{className:"text-sm font-bold text-slate-600",children:"Toplam Kalem Adedi"}),n.jsxs("span",{className:"font-black text-lg text-slate-800",children:[v.itemCount||((ge=(ve=v.payload)==null?void 0:ve.items)==null?void 0:ge.length)||0," eit"]})]}),(Ie=(Fe=v.payload)==null?void 0:Fe.items)==null?void 0:Ie.filter(se=>{var Ne;return((Ne=se.results)==null?void 0:Ne.calculatedEn)!==void 0}).map((se,Ne)=>n.jsxs("div",{className:"mb-2",children:[n.jsx("span",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest block mb-2 px-1",children:se.label||`Kalem ${Ne+1}`}),n.jsx(Rd,{widthMm:se.results.calculatedEn,heightMm:se.results.calculatedBoy,flapMm:se.results.chosenRil,kulakMm:se.results.kulakPayi,enRilleri:se.results.enRilleri,boyRilleri:se.results.boyRilleri})]},Ne)),n.jsx("div",{className:"text-xs text-slate-500 italic px-2 mt-2",children:"* Tm detaylar ve dzenleme iin teklifi grntleyin."})]}):n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"bg-slate-50 border border-slate-100 p-4 rounded-xl space-y-3 shadow-inner",children:[n.jsxs("div",{className:"flex justify-between items-center text-sm",children:[n.jsx("span",{className:"text-slate-500 font-medium",children:"Kat Kalitesi"}),n.jsx("span",{className:"font-bold text-slate-800",children:((Ze=v.payload)==null?void 0:Ze.qualityName)||((yt=v.payload)==null?void 0:yt.paperQuality)||v.paperQuality||"-"})]}),n.jsx(Vc,{className:"bg-slate-200"}),n.jsxs("div",{className:"flex justify-between items-center text-sm",children:[n.jsx("span",{className:"text-slate-500 font-medium",children:"Kutu Tipi"}),n.jsx("span",{className:"font-bold text-slate-800",children:((ht=v.payload)==null?void 0:ht.boxType)==="standard"?"Standart A.K.":((Ct=v.payload)==null?void 0:Ct.boxType)||"-"})]}),n.jsx(Vc,{className:"bg-slate-200"}),n.jsxs("div",{className:"flex justify-between items-center text-sm",children:[n.jsx("span",{className:"text-slate-500 font-medium",children:"ller (LWH)"}),n.jsxs("span",{className:"font-bold font-mono text-slate-800",children:[((Ue=v.payload)==null?void 0:Ue.L)||v.length||"-","  ",((kt=v.payload)==null?void 0:kt.W)||v.width||"-","  ",((qe=v.payload)==null?void 0:qe.H)||v.height||"-"," mm"]})]}),n.jsx(Vc,{className:"bg-slate-200"}),n.jsxs("div",{className:"flex justify-between items-center text-sm",children:[n.jsx("span",{className:"text-slate-500 font-medium",children:"retim Miktar"}),n.jsxs("span",{className:"font-bold font-mono text-[var(--burgundy)] bg-[var(--burgundy-light)]/20 px-2 py-0.5 rounded",children:[(((Ft=v.payload)==null?void 0:Ft.quantity)||v.quantity||0).toLocaleString("tr-TR")," Adet"]})]}),n.jsx(Vc,{className:"bg-slate-200"}),n.jsxs("div",{className:"flex justify-between items-center text-sm",children:[n.jsx("span",{className:"text-slate-500 font-medium",children:"Birim Sat Fiyat"}),n.jsxs("span",{className:"font-bold font-mono text-slate-800",children:["",(((Qe=v.payload)==null?void 0:Qe.birimSatisFiyati)||v.birimSatisFiyati||0).toLocaleString("tr-TR",{minimumFractionDigits:2})]})]})]}),((bt=v.payload)==null?void 0:bt.calculatedEn)!==void 0&&n.jsx(Rd,{widthMm:v.payload.calculatedEn,heightMm:v.payload.calculatedBoy,flapMm:v.payload.chosenRil,kulakMm:v.payload.kulakPayi,enRilleri:v.payload.enRilleri,boyRilleri:v.payload.boyRilleri})]})]})]}),n.jsx("div",{className:"pt-4 mt-auto border-t bg-white",children:v.status==="draft"?n.jsxs("div",{className:"space-y-3",children:[n.jsxs(Re,{className:"w-full h-12 bg-emerald-600 hover:bg-emerald-700 text-white font-black uppercase tracking-widest gap-2 shadow-lg shadow-emerald-600/20",onClick:async()=>{if(t)try{await Wt.submitForApproval(v.id,t.uid,r||"individual"),xe.success("Teklif onaya gnderildi"),F(!1);const se=await Wt.getUserOffers(t.uid);o(se)}catch{xe.error("Gnderim baarsz")}},children:[n.jsx(dd,{size:18}),"YNETC ONAYINA GNDER"]}),n.jsx("p",{className:"text-[10px] text-center text-slate-400 font-medium",children:"Onaya giden teklifler deitirilemez."})]}):n.jsx(Re,{variant:"outline",className:"w-full h-12 font-bold",onClick:()=>F(!1),children:"Kapat"})})]})})}),w&&n.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:n.jsxs(tt,{className:"w-full max-w-md p-6",children:[n.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Red Sebepini Girin"}),n.jsx("textarea",{className:"w-full h-32 p-3 border rounded-md mb-4 focus:outline-none focus:ring-2 focus:ring-[var(--burgundy)]",placeholder:"Teklifin neden reddedildiini aklayn...",value:A,onChange:se=>D(se.target.value)}),n.jsxs("div",{className:"flex justify-end gap-3",children:[n.jsx(Re,{variant:"outline",onClick:()=>{E(!1),re(null)},children:"ptal"}),n.jsx(Re,{className:"bg-status-error hover:bg-status-error/90 text-white",onClick:L,disabled:!A||k!==null,children:k===(W==null?void 0:W.id)?"leniyor...":"Reddet"})]})]})})]})}const Ff=e=>e.createdAt&&typeof e.createdAt.toDate=="function"?e.createdAt.toDate():new Date;function E$(){var m,x,p,g,y,N;const e=ca(),{user:t,userRole:r,userProfile:a}=vr(),[s,i]=b.useState(!0),[l,o]=b.useState([]),[c,d]=b.useState(null),[u,f]=b.useState(!1);b.useEffect(()=>{async function v(){if(!(!t||!(a!=null&&a.companyCode))&&Ty(r))try{i(!0);const[S,_]=await Promise.all([Wt.getPendingApprovalOffersForCompany(a.companyCode),Ua.getPendingApprovalBulkOffersForCompany(a.companyCode)]),F=_.map(j=>({...j,payload:{toplamTutar:j.totalRevenue,toplamHamMaliyet:j.totalCost,profitMargin:j.totalCost>0?j.totalProfit/j.totalCost*100:0,quantity:j.itemCount}})),k=[...S,...F];k.sort((j,w)=>Ff(w).getTime()-Ff(j).getTime()),o(k)}catch(S){console.error("Error fetching pending offers:",S)}finally{i(!1)}}v()},[t,r,a]);const h=async(v,S)=>{if(!(!c||!t))try{f(!0);const _=r||"company_admin",F=c.id.startsWith("TKT-");switch(v){case"APPROVE":F?await Ua.approveOffer(c.id,t.uid,_):await Wt.approveOffer(c.id,t.uid,_),xe.success("Teklif onayland"),o(k=>k.filter(j=>j.id!==c.id)),d(null);break;case"REJECT":F?await Ua.rejectOffer(c.id,t.uid,(S==null?void 0:S.reason)||"Neden belirtilmedi",_):await Wt.rejectOffer(c.id,t.uid,_,(S==null?void 0:S.reason)||"Neden belirtilmedi"),xe.success("Teklif reddedildi"),o(k=>k.filter(j=>j.id!==c.id)),d(null);break;case"CLONE":if(F)xe.error("Toplu teklif dorudan kopyalanamaz");else{const k=await Wt.cloneOfferToDraft(c.id,t.uid);xe.success("Kopyaland"),e(`/edit-offer/${k}`)}break;case"PDF":su(async()=>{const{pdfService:k}=await Promise.resolve().then(()=>Pj);return{pdfService:k}},void 0).then(({pdfService:k})=>{var w,E,A,D,W;const j={companyName:((w=a==null?void 0:a.profileInfo)==null?void 0:w.companyName)||(a==null?void 0:a.companyCode)||"Bireysel Kullanc",contactName:a==null?void 0:a.name,email:a==null?void 0:a.email,phone:((E=a==null?void 0:a.profileInfo)==null?void 0:E.phone)||"",taxNumber:((A=a==null?void 0:a.profileInfo)==null?void 0:A.taxNumber)||"",address:(D=a==null?void 0:a.profileInfo)!=null&&D.address?`${a.profileInfo.address}${a.profileInfo.city?", "+a.profileInfo.city:""}`:"",logoBase64:((W=a==null?void 0:a.profileInfo)==null?void 0:W.logoBase64)||null};F?k.exportBulkOfferToPdf(c,j):k.exportOfferToPdf(c,j)});break}}catch(_){console.error(_),xe.error("lem baarsz oldu")}finally{f(!1)}};return n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-semibold text-text-primary",children:"Teklif Onay"}),n.jsx("p",{className:"text-sm text-text-secondary mt-1",children:"Onay bekleyen teklifleri inceleyin ve deerlendirin"})]})}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[n.jsx("div",{className:"md:col-span-2",children:n.jsxs(tt,{children:[n.jsxs("div",{className:"p-4 border-b border-border-light flex items-center justify-between",children:[n.jsx("h2",{className:"font-semibold text-text-primary",children:"Bekleyen Teklifler"}),n.jsxs(ut,{variant:"secondary",children:[l.length," Adet"]})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs(hn,{children:[n.jsx(mn,{children:n.jsxs(zt,{children:[n.jsx(Ve,{children:"Teklif No"}),n.jsx(Ve,{children:"Mteri"}),n.jsx(Ve,{children:"Tarih"}),n.jsx(Ve,{className:"text-right",children:"Tutar"}),n.jsx(Ve,{className:"text-right",children:"Marj"}),n.jsx(Ve,{className:"w-[100px]"})]})}),n.jsx(xn,{children:s?n.jsx(zt,{children:n.jsx(Oe,{colSpan:6,className:"text-center",children:"Ykleniyor..."})}):l.length===0?n.jsx(zt,{children:n.jsx(Oe,{colSpan:6,className:"text-center",children:"Onay bekleyen teklif yok."})}):l.map(v=>{var S,_,F;return n.jsxs(zt,{className:`cursor-pointer transition-colors ${(c==null?void 0:c.id)===v.id?"bg-[var(--burgundy-light)]/50":"hover:bg-surface-secondary"}`,onClick:()=>d(v),children:[n.jsx(Oe,{className:"font-medium text-[var(--burgundy)]",children:v.id}),n.jsx(Oe,{children:v.customerName}),n.jsx(Oe,{className:"text-text-secondary",children:Ff(v).toLocaleDateString("tr-TR")}),n.jsxs(Oe,{className:"text-right font-medium",children:["",(((S=v.payload)==null?void 0:S.toplamTutar)||v.toplamTutar||v.amount||0).toLocaleString("tr-TR",{minimumFractionDigits:2})]}),n.jsx(Oe,{className:"text-right",children:n.jsxs("span",{className:`font-medium ${(((_=v.payload)==null?void 0:_.profitMargin)||0)<20?"text-status-error":"text-status-success"}`,children:["%",(((F=v.payload)==null?void 0:F.profitMargin)||0).toFixed(1)]})}),n.jsx(Oe,{children:n.jsx(Re,{variant:"ghost",size:"icon",children:n.jsx(uo,{className:"h-4 w-4 text-text-secondary"})})})]},v.id)})})]})})]})}),n.jsx("div",{children:c?n.jsxs(tt,{className:"p-6 sticky top-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h2",{className:"text-lg font-semibold text-text-primary",children:[c.id," Detay"]}),n.jsx(ut,{variant:"outline",children:"Onay Bekliyor"})]}),n.jsxs("div",{className:"space-y-6",children:[(((m=c.payload)==null?void 0:m.profitMargin)||0)<20&&n.jsxs("div",{className:"p-3 bg-status-error/10 border border-status-error/20 rounded-lg flex items-start gap-3",children:[n.jsx(ms,{className:"text-status-error shrink-0",size:18}),n.jsxs("div",{className:"text-sm text-status-error",children:[n.jsx("span",{className:"font-semibold block",children:"Dk Kar Marj"}),"Bu teklifin kar marj hedef deerin (%20) altnda."]})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx("span",{className:"text-sm text-text-secondary block",children:"Mteri"}),n.jsx("span",{className:"text-base font-medium text-text-primary",children:c.customerName})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-sm text-text-secondary block",children:"Miktar"}),n.jsx("span",{className:"text-base font-medium text-text-primary",children:(((x=c.payload)==null?void 0:x.quantity)||c.quantity||0).toLocaleString()})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-sm text-text-secondary block",children:"Tutar"}),n.jsxs("span",{className:"text-base font-medium text-text-primary",children:["",(((p=c.payload)==null?void 0:p.toplamTutar)||c.toplamTutar||c.amount||0).toLocaleString()]})]})]}),n.jsxs("div",{className:"p-4 bg-surface-secondary rounded-lg space-y-2",children:[n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{className:"text-text-secondary",children:"Maliyet"}),n.jsxs("span",{children:["",(((g=c.payload)==null?void 0:g.toplamHamMaliyet)||c.toplamMaliyet||0).toLocaleString()]})]}),n.jsxs("div",{className:"flex justify-between text-sm font-semibold pt-2 border-t border-border-light",children:[n.jsx("span",{children:"Marj"}),n.jsxs("span",{className:(((y=c.payload)==null?void 0:y.profitMargin)||0)<20?"text-status-error":"text-status-success",children:["%",(((N=c.payload)==null?void 0:N.profitMargin)||0).toFixed(1)]})]})]})]}),n.jsx(Yb,{offerId:c.id,currentUserRole:r||"individual",offerStatus:c.status,isProcessing:u,onAction:h})]})]}):n.jsxs(tt,{className:"p-12 flex flex-col items-center justify-center text-center text-text-secondary h-full border-dashed",children:[n.jsx(ma,{size:48,className:"mb-4 opacity-20"}),n.jsx("p",{children:"Detaylarn grntlemek iin soldaki listeden bir teklif sein"})]})})]})]})}const S$={async getCompany(e){const t=Be(ke,"companies",e),r=await hr(t);return r.exists()?{code:r.id,...r.data()}:null},async updateCompany(e,t){const r=Be(ke,"companies",e);await Ut(r,t)},async generateUniqueCompanyCode(){const e="ABCDEFGHJKLMNPQRSTUVWXYZ23456789";for(let a=0;a<5;a++){let s="";for(let l=0;l<7;l++)s+=e.charAt(Math.floor(Math.random()*e.length));if(!await this.getCompany(s))return s}throw new Error("Failed to generate unique company code after multiple attempts.")},async createCompany(e,t,r="Yeni Firma",a){const s=Be(ke,"companies",e);await nr(s,{adminUid:t,name:r,isActive:!0,createdAt:Ke(),updatedAt:Ke(),expiresAt:a,memberLimit:5,memberCount:1,companyInfo:{},initialMembers:[]})}},ul={async createCompany(e,t){const r=Be(ke,"companies",e);await nr(r,{adminUid:t.adminUid,name:t.name,isActive:!0,expiresAt:null,memberLimit:t.memberLimit??20,memberCount:1,companyInfo:{},initialMembers:[],createdAt:an.now()})},async addCompanyMember(e,t,r="Ek ye"){const a=Be(ke,"companies",e);await Ut(a,{initialMembers:pS({label:r,email:t}),memberCount:Gs(1)})},async removeCompanyMember(e,t){const r=hd(ke),a=Be(ke,"users",t);r.update(a,{isActive:!1,companyCode:null,companyId:null});const s=Be(ke,"companies",e);r.update(s,{memberCount:Gs(-1)}),await r.commit()},async getAllUsers(){return(await mr(ir(ke,"users"))).docs.map(t=>({id:t.id,...t.data()}))},async updateUserRole(e,t){const r=Be(ke,"users",e);await Ut(r,{role:t})},async setUserActive(e,t){const r=Be(ke,"users",e);await Ut(r,{isActive:t})},async getAllCompanies(){return(await mr(ir(ke,"companies"))).docs.map(t=>({id:t.id,...t.data()}))},async setCompanyActive(e,t){const r=Be(ke,"companies",e);await Ut(r,{isActive:t})},async getCompanyMembers(e){const t=Ir(ir(ke,"users"),wt("companyCode","==",e));return(await mr(t)).docs.map(a=>({id:a.id,...a.data()}))}};function T$(){const{user:e,userProfile:t}=vr(),[r,a]=b.useState(!0),[s,i]=b.useState(null),[l,o]=b.useState([]);b.useEffect(()=>{async function h(){if(!(!e||!(t!=null&&t.companyCode)))try{a(!0);const[m,x]=await Promise.all([S$.getCompany(t.companyCode),ul.getCompanyMembers(t.companyCode)]);i(m),o(x)}catch(m){console.error("Error fetching company data:",m)}finally{a(!1)}}h()},[e,t]);const c=async h=>{if(t!=null&&t.companyCode&&confirm("Bu yeyi irketten karmak istediinize emin misiniz?"))try{await ul.removeCompanyMember(t.companyCode,h),xe.success("ye karld"),o(m=>m.filter(x=>x.id!==h))}catch(m){console.error(m),xe.error("lem baarsz")}},d=((s==null?void 0:s.memberLimit)||0)-((s==null?void 0:s.memberCount)||l.length),u=(s==null?void 0:s.memberLimit)||20,f=((s==null?void 0:s.memberCount)||l.length)/u*100;return r?n.jsx("div",{className:"p-8 text-center",children:"Ykleniyor..."}):n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-semibold text-text-primary",children:"irket Ynetimi"}),n.jsx("p",{className:"text-sm text-text-secondary mt-1",children:"Ekip arkadalarn ynet ve yetkilendir"})]})}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[n.jsxs(tt,{className:"p-6",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 rounded-lg bg-[var(--burgundy-light)]/50 flex items-center justify-center text-[var(--burgundy)]",children:n.jsx(ud,{size:24})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-text-secondary",children:"Toplam ye"}),n.jsx("h3",{className:"text-2xl font-bold text-text-primary",children:l.length})]})]}),n.jsxs("div",{className:"mt-4",children:[n.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[n.jsx("span",{children:"Kullanm"}),n.jsxs("span",{children:[Math.round(f),"%"]})]}),n.jsx("div",{className:"h-2 bg-surface-secondary rounded-full overflow-hidden",children:n.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${f>90?"bg-status-error":"bg-[var(--burgundy)]"}`,style:{width:`${f}%`}})}),n.jsxs("p",{className:"text-xs text-text-secondary mt-2",children:[d," koltuk bo"]})]})]}),n.jsx(tt,{className:"p-6",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 rounded-lg bg-blue-50 flex items-center justify-center text-blue-600",children:n.jsx(tl,{size:24})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-text-secondary",children:"irket Bilgileri"}),n.jsx("h3",{className:"text-lg font-bold text-text-primary truncate",children:(s==null?void 0:s.name)||(t==null?void 0:t.companyCode)}),n.jsx("p",{className:"text-xs text-text-secondary",children:"Kurumsal Plan"})]})]})})]}),n.jsx(tt,{children:n.jsxs(hn,{children:[n.jsx(mn,{children:n.jsxs(zt,{children:[n.jsx(Ve,{children:"Kullanc"}),n.jsx(Ve,{children:"Rol"}),n.jsx(Ve,{children:"Durum"}),n.jsx(Ve,{children:"Son Grlme"}),n.jsx(Ve,{className:"w-[50px]"})]})}),n.jsx(xn,{children:l.map(h=>n.jsxs(zt,{className:"hover:bg-surface-secondary/50",children:[n.jsx(Oe,{children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-8 h-8 rounded-full bg-surface-secondary flex items-center justify-center text-[var(--burgundy)] font-medium",children:h.name?h.name.charAt(0).toUpperCase():n.jsx(gh,{size:14})}),n.jsxs("div",{children:[n.jsx("div",{className:"font-medium text-text-primary",children:h.name||"simsiz"}),n.jsx("div",{className:"text-xs text-text-secondary",children:h.email})]})]})}),n.jsx(Oe,{children:n.jsx(ut,{variant:"outline",className:"font-normal",children:h.role===Jt.COMPANY_ADMIN?n.jsxs("span",{className:"flex items-center gap-1 text-[var(--burgundy)]",children:[n.jsx(hs,{size:12}),"Ynetici"]}):"ye"})}),n.jsx(Oe,{children:n.jsx(ut,{variant:h.isActive?"default":"secondary",className:h.isActive?"bg-green-600 hover:bg-green-700 text-white":"",children:h.isActive?"Aktif":"Pasif"})}),n.jsx(Oe,{className:"text-text-secondary text-sm",children:"-"}),n.jsx(Oe,{children:n.jsxs(nl,{children:[n.jsx(sl,{asChild:!0,children:n.jsx(Re,{variant:"ghost",size:"icon",className:"h-8 w-8",children:n.jsx(co,{size:14})})}),n.jsx(il,{align:"end",children:n.jsxs(Vt,{className:"text-status-error",onClick:()=>c(h.id),children:[n.jsx(sa,{className:"mr-2 h-4 w-4"}),"irketten kar"]})})]})})]},h.id))})]})})]})}const Os={async setCompanyActive(e,t,r,a){if(a!=="super_admin")throw new Error("FORBIDDEN_ACTION");const s=Be(ke,"companies",e);await Ut(s,{isActive:t,updatedAt:Ke()}),await sr.logAction({actorUid:r,actionType:t?"COMPANY_ACTIVATE":"COMPANY_DEACTIVATE",targetType:"company",targetId:e})},async hardDeleteCompany(e,t,r){if(r!=="super_admin")throw new Error("FORBIDDEN_ACTION");const a=Be(ke,"companies",e),s=Be(ke,"subscriptions",e),i=Ir(ir(ke,"users"),wt("companyCode","==",e)),l=await mr(i);for(const o of l.docs)await Ki(Be(ke,"users",o.id));await Ki(s),await Ki(a),await sr.logAction({actorUid:t,actionType:"COMPANY_DELETE",targetType:"company",targetId:e,metadata:{memberCount:l.size,method:"HARD_DELETE"}})},async listCompanyMembers(e){const t=Ir(ir(ke,"users"),wt("companyCode","==",e));return(await mr(t)).docs.map(a=>({id:a.id,...a.data()}))},async getCompany(e){const t=await hr(Be(ke,"companies",e));return t.exists()?{id:t.id,...t.data()}:null},async extendCompanySubscription(e,t,r,a){var u;if(a!=="super_admin")throw new Error("FORBIDDEN_ACTION");const s=Be(ke,"companies",e),i=Be(ke,"subscriptions",e),[l,o]=await Promise.all([hr(s),hr(i)]);if(!l.exists())throw new Error("Company not found");let c;o.exists()?c=o.data().endDate.toDate():c=((u=l.data().expiresAt)==null?void 0:u.toDate())||new Date;const d=new Date(c);d.setDate(d.getDate()+t),await Ut(s,{expiresAt:an.fromDate(d),updatedAt:Ke()}),await nr(i,{companyCode:e,endDate:an.fromDate(d),updatedAt:Ke(),planType:o.exists()?o.data().planType:"corporate",status:"ACTIVE"},{merge:!0}),await sr.logAction({actorUid:r,actionType:"SUBSCRIPTION_EXTEND",targetType:"company",targetId:e,metadata:{extendedDays:t,newEndDate:d}})},async assignProPlan(e,t,r,a){if(a!=="super_admin")throw new Error("FORBIDDEN_ACTION");const s=Be(ke,"subscriptions",e),i=Be(ke,"companies",e),l=new Date;l.setDate(l.getDate()+t),await nr(s,{companyCode:e,planType:st.PRO,status:"ACTIVE",endDate:an.fromDate(l),updatedAt:Ke(),createdAt:Ke()},{merge:!0}),await nr(i,{expiresAt:an.fromDate(l),updatedAt:Ke()},{merge:!0});const o=Ir(ir(ke,"users"),wt("companyCode","==",e)),c=await mr(o);for(const f of c.docs)await nr(Be(ke,"users",f.id),{plan:st.PRO},{merge:!0});const d=Be(ke,"users",e);(await hr(d)).exists()&&await nr(d,{plan:st.PRO},{merge:!0}),await sr.logAction({actorUid:r,actionType:"ASSIGN_PRO_PLAN",targetType:"company",targetId:e,metadata:{days:t}})},async revokeProPlan(e,t,r){if(r!=="super_admin")throw new Error("FORBIDDEN_ACTION");const a=Be(ke,"subscriptions",e),s=Be(ke,"companies",e);await nr(a,{companyCode:e,planType:st.FREE,status:"CANCELED",endDate:an.fromDate(new Date),updatedAt:Ke()},{merge:!0}),await nr(s,{expiresAt:null,updatedAt:Ke()},{merge:!0});const i=Ir(ir(ke,"users"),wt("companyCode","==",e)),l=await mr(i);for(const d of l.docs)await nr(Be(ke,"users",d.id),{plan:st.FREE},{merge:!0});const o=Be(ke,"users",e);(await hr(o)).exists()&&await nr(o,{plan:st.FREE},{merge:!0}),await sr.logAction({actorUid:t,actionType:"REVOKE_PRO_PLAN",targetType:"company",targetId:e,metadata:{}})}},ts={async setUserActive(e,t,r,a){if(a!=="super_admin")throw new Error("FORBIDDEN_ACTION");const s=Be(ke,"users",e);await Ut(s,{isActive:t,updatedAt:Ke()}),await sr.logAction({actorUid:r,actionType:t?"USER_ACTIVATE":"USER_DEACTIVATE",targetType:"user",targetId:e})},async hardDeleteUser(e,t,r){if(r!=="super_admin")throw new Error("FORBIDDEN_ACTION");const a=Be(ke,"users",e),i=(await hr(a)).data();i!=null&&i.companyCode&&await this.removeUserFromCompany(e,i.companyCode,t,r),await Ki(a),await sr.logAction({actorUid:t,actionType:"USER_DELETE",targetType:"user",targetId:e,metadata:{method:"HARD_DELETE"}})},async assignUserToCompany(e,t,r,a){if(a!=="super_admin")throw new Error("FORBIDDEN_ACTION");await Ox(ke,async s=>{const i=Be(ke,"users",e),l=Be(ke,"companies",t),[o,c]=await Promise.all([s.get(i),s.get(l)]);if(!o.exists())throw new Error("User not found");if(!c.exists())throw new Error("Company not found");const d=c.data(),u=d.memberLimit||20;if((d.memberCount||0)>=u)throw new Error("COMPANY_FULL");s.update(i,{companyCode:t,updatedAt:Ke()}),s.update(l,{memberCount:Gs(1),updatedAt:Ke()})}),await sr.logAction({actorUid:r,actionType:"MEMBER_ADD",targetType:"user",targetId:e,metadata:{companyCode:t}})},async removeUserFromCompany(e,t,r,a){if(a!=="super_admin")throw new Error("FORBIDDEN_ACTION");await Ox(ke,async s=>{const i=Be(ke,"users",e),l=Be(ke,"companies",t),[o,c]=await Promise.all([s.get(i),s.get(l)]);if(!o.exists())throw new Error("User not found");c.exists()&&(s.update(i,{companyCode:null,updatedAt:Ke()}),c.exists()&&s.update(l,{memberCount:Gs(-1),updatedAt:Ke()}))}),await sr.logAction({actorUid:r,actionType:"MEMBER_REMOVE",targetType:"user",targetId:e,metadata:{companyCode:t}})},async updateUserRole(e,t,r,a){if(a!=="super_admin")throw new Error("FORBIDDEN_ACTION");const s=Be(ke,"users",e);await Ut(s,{role:t,updatedAt:Ke()}),await sr.logAction({actorUid:r,actionType:"ROLE_CHANGE",targetType:"user",targetId:e,metadata:{newRole:t}})},async searchUserByEmail(e){const t=Ir(ir(ke,"users"),wt("email","==",e)),r=await mr(t);return r.empty?null:{id:r.docs[0].id,...r.docs[0].data()}},async assignProPlan(e,t,r,a){if(a!=="super_admin")throw new Error("FORBIDDEN_ACTION");const s=Be(ke,"subscriptions",e),i=Be(ke,"users",e),l=new Date;l.setDate(l.getDate()+t),await nr(s,{companyCode:e,planType:st.PRO,status:"ACTIVE",endDate:an.fromDate(l),updatedAt:Ke(),createdAt:Ke()},{merge:!0}),await Ut(i,{plan:st.PRO,updatedAt:Ke()}),await sr.logAction({actorUid:r,actionType:"ASSIGN_PRO_PLAN",targetType:"user",targetId:e,metadata:{days:t}})},async revokeProPlan(e,t,r){if(r!=="super_admin")throw new Error("FORBIDDEN_ACTION");const a=Be(ke,"subscriptions",e),s=Be(ke,"users",e);await nr(a,{companyCode:e,planType:st.FREE,status:"CANCELED",endDate:an.fromDate(new Date),updatedAt:Ke()},{merge:!0}),await Ut(s,{plan:st.FREE,updatedAt:Ke()}),await sr.logAction({actorUid:t,actionType:"REVOKE_PRO_PLAN",targetType:"user",targetId:e,metadata:{}})}};function A$(){const[e,t]=b.useState(!0),[r,a]=b.useState("companies"),[s,i]=b.useState([]),[l,o]=b.useState([]),[c,d]=b.useState(""),[u,f]=b.useState(null),[h,m]=b.useState(null),[x,p]=b.useState([]),[g,y]=b.useState(!1),[N,v]=b.useState(""),[S,_]=b.useState(!1),[F,k]=b.useState(""),[j,w]=b.useState(null),{user:E,userRole:A}=vr(),D=A===Jt.SUPER_ADMIN;b.useEffect(()=>{W()},[]);const W=async()=>{try{t(!0);const[G,Z]=await Promise.all([ul.getAllCompanies(),ul.getAllUsers()]);i(G),o(Z)}catch(G){console.error(G),xe.error("Veriler yklenemedi")}finally{t(!1)}},re=async(G,Z)=>{if(!(!E||!A))try{f(G),await Os.setCompanyActive(G,!Z,E.uid,A),xe.success(`irket ${Z?"pasif":"aktif"} duruma getirildi`),i(ae=>ae.map(de=>de.id===G?{...de,isActive:!Z}:de))}catch{xe.error("lem baarsz")}finally{f(null)}},U=async(G,Z)=>{if(!(!E||!A))try{f(G),await ts.setUserActive(G,!Z,E.uid,A),xe.success(`Kullanc ${Z?"pasif":"aktif"} duruma getirildi`),o(ae=>ae.map(de=>de.id===G?{...de,isActive:!Z}:de))}catch{xe.error("lem baarsz")}finally{f(null)}},M=async()=>{if(!(!E||!j))try{if(f(j.id),j.type==="company"){if(F!==j.code){xe.error("irket kodu hatal");return}await Os.hardDeleteCompany(j.id,E.uid,A),xe.success("irket ve yeleri kalc olarak silindi")}else await ts.hardDeleteUser(j.id,E.uid,A),xe.success("Kullanc kalc olarak silindi");_(!1),await W()}catch{xe.error("Hata olutu")}finally{f(null)}},Y=async G=>{m(G),y(!0);const Z=await Os.listCompanyMembers(G.id);p(Z)},Q=async()=>{if(!(!E||!h||!N))try{const G=await ts.searchUserByEmail(N);if(!G){xe.error("Kullanc bulunamad");return}await ts.assignUserToCompany(G.id,h.id,E.uid,A),xe.success("ye eklendi"),v("");const Z=await Os.listCompanyMembers(h.id);p(Z),W()}catch(G){xe.error(G.message==="COMPANY_FULL"?"irket ye limiti dolu":"Hata olutu")}},B=async G=>{if(!(!E||!h||!A))try{await ts.removeUserFromCompany(G,h.id,E.uid,A),xe.success("ye karld"),p(Z=>Z.filter(ae=>ae.id!==G)),W()}catch{xe.error("Hata olutu")}},V=async(G,Z)=>{if(!(!E||!A))try{await ts.updateUserRole(G,Z,E.uid,A),xe.success("Rol gncellendi"),o(ae=>ae.map(de=>de.id===G?{...de,role:Z}:de))}catch{xe.error("Hata olutu")}},P=async G=>{if(!(!E||!A))try{f(G),await Os.extendCompanySubscription(G,30,E.uid,A),xe.success("Abonelik 30 gn uzatld"),W()}catch{xe.error("Hata olutu")}finally{f(null)}},T=async(G,Z=30)=>{if(!(!E||!A))try{f(G),await Os.assignProPlan(G,Z,E.uid,A),xe.success(`irket Pro Plan'a alnd (${Z} Gn)`),W()}catch{xe.error("Hata olutu")}finally{f(null)}},R=async G=>{if(!(!E||!A))try{f(G),await Os.revokeProPlan(G,E.uid,A),xe.success("irket Pro Plan'dan kartld"),W()}catch{xe.error("Hata olutu")}finally{f(null)}},L=async(G,Z=30)=>{if(!(!E||!A))try{f(G),await ts.assignProPlan(G,Z,E.uid,A),xe.success(`Kullanc Pro Plan'a alnd (${Z} Gn)`),W()}catch{xe.error("Hata olutu")}finally{f(null)}},X=async G=>{if(!(!E||!A))try{f(G),await ts.revokeProPlan(G,E.uid,A),xe.success("Kullanc Pro Plan'dan kartld"),W()}catch{xe.error("Hata olutu")}finally{f(null)}},J=s.filter(G=>{var Z,ae;return((Z=G.name)==null?void 0:Z.toLowerCase().includes(c.toLowerCase()))||((ae=G.id)==null?void 0:ae.toLowerCase().includes(c.toLowerCase()))}),te=l.filter(G=>{var Z,ae;return((Z=G.email)==null?void 0:Z.toLowerCase().includes(c.toLowerCase()))||((ae=G.name)==null?void 0:ae.toLowerCase().includes(c.toLowerCase()))});return n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-semibold text-text-primary",children:"Super Admin"}),n.jsx("p",{className:"text-sm text-text-secondary mt-1",children:"Sistem genelindeki irketleri ve kullanclar ynetin"})]})}),n.jsxs("div",{className:"flex items-center gap-4 border-b border-border-light",children:[n.jsx("button",{className:`px-4 py-2 text-sm font-medium border-b-2 transition-colors ${r==="companies"?"border-[var(--burgundy)] text-[var(--burgundy)]":"border-transparent text-text-secondary hover:text-text-primary"}`,onClick:()=>a("companies"),children:"irketler"}),n.jsx("button",{className:`px-4 py-2 text-sm font-medium border-b-2 transition-colors ${r==="users"?"border-[var(--burgundy)] text-[var(--burgundy)]":"border-transparent text-text-secondary hover:text-text-primary"}`,onClick:()=>a("users"),children:"Kullanclar"})]}),n.jsxs("div",{className:"relative",children:[n.jsx(ph,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-text-tertiary"}),n.jsx(ze,{placeholder:r==="companies"?"irket ara...":"Kullanc ara...",value:c,onChange:G=>d(G.target.value),className:"pl-10 max-w-md"})]}),e?n.jsx("div",{className:"text-center py-12",children:"Ykleniyor..."}):r==="companies"?n.jsx(tt,{children:n.jsxs(hn,{children:[n.jsx(mn,{children:n.jsxs(zt,{children:[n.jsx(Ve,{children:"irket Kodu"}),n.jsx(Ve,{children:"Ad"}),n.jsx(Ve,{children:"ye Says"}),n.jsx(Ve,{children:"Durum"}),n.jsx(Ve,{className:"w-[50px]"})]})}),n.jsx(xn,{children:J.map(G=>n.jsxs(zt,{children:[n.jsx(Oe,{className:"font-mono",children:G.id}),n.jsx(Oe,{className:"font-medium",children:G.name}),n.jsx(Oe,{children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ud,{size:14,className:"text-text-tertiary"}),G.memberCount," / ",G.memberLimit]})}),n.jsx(Oe,{children:n.jsx(ut,{variant:G.isActive?"default":"secondary",children:G.isActive?"Aktif":"Pasif"})}),n.jsx(Oe,{children:D&&n.jsxs(nl,{children:[n.jsx(sl,{asChild:!0,children:n.jsx(Re,{variant:"ghost",size:"icon",className:"h-8 w-8",disabled:u===G.id,children:u===G.id?n.jsx(Ar,{size:14,className:"animate-spin"}):n.jsx(co,{size:14})})}),n.jsxs(il,{align:"end",children:[n.jsx(Vt,{onClick:()=>re(G.id,G.isActive),children:G.isActive?n.jsxs(n.Fragment,{children:[n.jsx(RE,{className:"mr-2 h-4 w-4 text-status-error"}),"Pasife Al"]}):n.jsxs(n.Fragment,{children:[n.jsx(Jr,{className:"mr-2 h-4 w-4 text-status-success"}),"Aktifletir"]})}),n.jsxs(Vt,{onClick:()=>Y(G),children:[n.jsx(ud,{className:"mr-2 h-4 w-4"}),"yeleri Ynet"]}),n.jsxs(Vt,{onClick:()=>P(G.id),children:[n.jsx(Xd,{className:"mr-2 h-4 w-4 text-blue-500"}),"Sreyi Uzat (30 Gn)"]}),n.jsxs(Vt,{onClick:()=>T(G.id,30),children:[n.jsx(Xr,{className:"mr-2 h-4 w-4 text-yellow-500"}),"Pro Plan'a Al (30 Gn)"]}),n.jsxs(Vt,{onClick:()=>T(G.id,180),children:[n.jsx(Xr,{className:"mr-2 h-4 w-4 text-yellow-500"}),"Pro Plan'a Al (6 Ay)"]}),n.jsxs(Vt,{onClick:()=>T(G.id,365),children:[n.jsx(Xr,{className:"mr-2 h-4 w-4 text-yellow-500"}),"Pro Plan'a Al (1 Yl)"]}),n.jsxs(Vt,{onClick:()=>R(G.id),children:[n.jsx(Rx,{className:"mr-2 h-4 w-4 text-text-secondary"}),"Pro Plandan kart"]}),n.jsxs(Vt,{className:"text-status-error",onClick:()=>{w({type:"company",id:G.id,code:G.id}),k(""),_(!0)},children:[n.jsx(sa,{className:"mr-2 h-4 w-4"}),"irketi Sil"]})]})]})})]},G.id))})]})}):n.jsx(tt,{children:n.jsxs(hn,{children:[n.jsx(mn,{children:n.jsxs(zt,{children:[n.jsx(Ve,{children:"Kullanc"}),n.jsx(Ve,{children:"E-posta"}),n.jsx(Ve,{children:"Rol"}),n.jsx(Ve,{children:"irket"}),n.jsx(Ve,{children:"Durum"}),n.jsx(Ve,{className:"w-[50px]"})]})}),n.jsx(xn,{children:te.map(G=>n.jsxs(zt,{children:[n.jsx(Oe,{className:"font-medium",children:G.name||"-"}),n.jsx(Oe,{children:G.email}),n.jsx(Oe,{children:n.jsx(ut,{variant:"outline",children:G.role})}),n.jsx(Oe,{children:G.companyCode||"-"}),n.jsx(Oe,{children:n.jsx(ut,{variant:G.isActive?"default":"secondary",children:G.isActive?"Aktif":"Pasif"})}),n.jsx(Oe,{children:D&&n.jsxs(nl,{children:[n.jsx(sl,{asChild:!0,children:n.jsx(Re,{variant:"ghost",size:"icon",className:"h-8 w-8",disabled:u===G.id,children:u===G.id?n.jsx(Ar,{size:14,className:"animate-spin"}):n.jsx(co,{size:14})})}),n.jsxs(il,{align:"end",children:[n.jsx(Vt,{onClick:()=>U(G.id,G.isActive),children:G.isActive?"Pasife Al":"Aktifletir"}),n.jsxs(Vt,{onClick:()=>L(G.id,30),children:[n.jsx(Xr,{className:"mr-2 h-4 w-4 text-yellow-500"}),"Pro Plan'a Al (30 Gn)"]}),n.jsxs(Vt,{onClick:()=>L(G.id,180),children:[n.jsx(Xr,{className:"mr-2 h-4 w-4 text-yellow-500"}),"Pro Plan'a Al (6 Ay)"]}),n.jsxs(Vt,{onClick:()=>L(G.id,365),children:[n.jsx(Xr,{className:"mr-2 h-4 w-4 text-yellow-500"}),"Pro Plan'a Al (1 Yl)"]}),n.jsxs(Vt,{onClick:()=>X(G.id),children:[n.jsx(Rx,{className:"mr-2 h-4 w-4 text-text-secondary"}),"Pro Plandan kart"]}),n.jsxs(Vt,{className:"text-status-error",onClick:()=>{w({type:"user",id:G.id}),k(""),_(!0)},children:[n.jsx(sa,{className:"mr-2 h-4 w-4"}),"Sil"]}),n.jsxs("div",{className:"p-2 border-t border-border mt-1",children:[n.jsx("p",{className:"text-[10px] text-text-tertiary mb-1 uppercase font-bold",children:"Rol Deitir"}),n.jsx("div",{className:"grid grid-cols-1 gap-1",children:Object.values(Jt).map(Z=>n.jsx(Re,{variant:G.role===Z?"secondary":"ghost",size:"sm",className:"h-7 text-xs justify-start",onClick:()=>V(G.id,Z),children:Z},Z))})]})]})]})})]},G.id))})]})}),n.jsx(bo,{open:g,onOpenChange:y,children:n.jsxs(wo,{className:"max-w-2xl",children:[n.jsxs(ko,{children:[n.jsxs(No,{children:[h==null?void 0:h.name," - ye Ynetimi"]}),n.jsxs(kd,{children:["irket yelerini ekleyin veya karn. Limit: ",h==null?void 0:h.memberCount," / ",h==null?void 0:h.memberLimit]})]}),n.jsxs("div",{className:"space-y-4 py-4",children:[n.jsxs("div",{className:"flex items-end gap-2",children:[n.jsxs("div",{className:"flex-1 space-y-2",children:[n.jsx(et,{children:"E-posta ile ye Ekle"}),n.jsx(ze,{placeholder:"kullanici@email.com",value:N,onChange:G=>v(G.target.value)})]}),n.jsxs(Re,{onClick:Q,children:[n.jsx(z1,{className:"mr-2 h-4 w-4"}),"Ekle"]})]}),n.jsx("div",{className:"border rounded-lg overflow-hidden",children:n.jsxs(hn,{children:[n.jsx(mn,{children:n.jsxs(zt,{children:[n.jsx(Ve,{children:"ye"}),n.jsx(Ve,{children:"Rol"}),n.jsx(Ve,{className:"w-[50px]"})]})}),n.jsxs(xn,{children:[x.map(G=>n.jsxs(zt,{children:[n.jsxs(Oe,{children:[n.jsx("div",{className:"font-medium",children:G.name||"simsiz"}),n.jsx("div",{className:"text-xs text-text-tertiary",children:G.email})]}),n.jsx(Oe,{children:n.jsx(ut,{variant:"outline",children:G.role})}),n.jsx(Oe,{children:n.jsx(Re,{variant:"ghost",size:"icon",className:"text-status-error",onClick:()=>B(G.id),children:n.jsx(ME,{className:"h-4 w-4"})})})]},G.id)),x.length===0&&n.jsx(zt,{children:n.jsx(Oe,{colSpan:3,className:"text-center py-4 text-text-tertiary",children:"ye bulunamad"})})]})]})})]})]})}),n.jsx(bo,{open:S,onOpenChange:_,children:n.jsxs(wo,{children:[n.jsxs(ko,{children:[n.jsxs(No,{className:"flex items-center gap-2 text-status-error",children:[n.jsx(O1,{}),"Dikkat: Kalc Silme lemi"]}),n.jsx(kd,{children:(j==null?void 0:j.type)==="company"?"irketi ve tm yelerini KALICI olarak silmek zeresiniz. Bu ilem geri alnamaz ve tm veriler veritabanndan temizlenecektir.":"Kullancy KALICI olarak silmek zeresiniz. Bu ilem geri alnamaz."})]}),(j==null?void 0:j.type)==="company"&&n.jsxs("div",{className:"space-y-2 py-4",children:[n.jsxs(et,{children:["Onaylamak iin irket kodunu (",j.code,") yazn:"]}),n.jsx(ze,{value:F,onChange:G=>k(G.target.value.toUpperCase()),placeholder:j.code})]}),n.jsxs(Gb,{children:[n.jsx(Re,{variant:"ghost",onClick:()=>_(!1),children:"Vazge"}),n.jsx(Re,{variant:"default",className:"bg-status-error hover:bg-red-700",onClick:M,disabled:(j==null?void 0:j.type)==="company"&&F!==j.code,children:(j==null?void 0:j.type)==="company"?"irketi Sil":"Kullancy Sil"})]})]})})]})}function _$(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}const Uj=me.createContext({drawerRef:{current:null},overlayRef:{current:null},onPress:()=>{},onRelease:()=>{},onDrag:()=>{},onNestedDrag:()=>{},onNestedOpenChange:()=>{},onNestedRelease:()=>{},openProp:void 0,dismissible:!1,isOpen:!1,isDragging:!1,keyboardIsOpen:{current:!1},snapPointsOffset:null,snapPoints:null,handleOnly:!1,modal:!1,shouldFade:!1,activeSnapPoint:null,onOpenChange:()=>{},setActiveSnapPoint:()=>{},closeDrawer:()=>{},direction:"bottom",shouldAnimate:{current:!0},shouldScaleBackground:!1,setBackgroundColorOnScale:!0,noBodyStyles:!1,container:null,autoFocus:!1}),pc=()=>{const e=me.useContext(Uj);if(!e)throw new Error("useDrawerContext must be used within a Drawer.Root");return e};_$(`[data-vaul-drawer]{touch-action:none;will-change:transform;transition:transform .5s cubic-bezier(.32, .72, 0, 1);animation-duration:.5s;animation-timing-function:cubic-bezier(0.32,0.72,0,1)}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=bottom][data-state=open]{animation-name:slideFromBottom}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=bottom][data-state=closed]{animation-name:slideToBottom}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=top][data-state=open]{animation-name:slideFromTop}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=top][data-state=closed]{animation-name:slideToTop}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=left][data-state=open]{animation-name:slideFromLeft}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=left][data-state=closed]{animation-name:slideToLeft}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=right][data-state=open]{animation-name:slideFromRight}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=right][data-state=closed]{animation-name:slideToRight}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=bottom]{transform:translate3d(0,var(--initial-transform,100%),0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=top]{transform:translate3d(0,calc(var(--initial-transform,100%) * -1),0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=left]{transform:translate3d(calc(var(--initial-transform,100%) * -1),0,0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=right]{transform:translate3d(var(--initial-transform,100%),0,0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=top]{transform:translate3d(0,var(--snap-point-height,0),0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=bottom]{transform:translate3d(0,var(--snap-point-height,0),0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=left]{transform:translate3d(var(--snap-point-height,0),0,0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=right]{transform:translate3d(var(--snap-point-height,0),0,0)}[data-vaul-overlay][data-vaul-snap-points=false]{animation-duration:.5s;animation-timing-function:cubic-bezier(0.32,0.72,0,1)}[data-vaul-overlay][data-vaul-snap-points=false][data-state=open]{animation-name:fadeIn}[data-vaul-overlay][data-state=closed]{animation-name:fadeOut}[data-vaul-animate=false]{animation:none!important}[data-vaul-overlay][data-vaul-snap-points=true]{opacity:0;transition:opacity .5s cubic-bezier(.32, .72, 0, 1)}[data-vaul-overlay][data-vaul-snap-points=true]{opacity:1}[data-vaul-drawer]:not([data-vaul-custom-container=true])::after{content:'';position:absolute;background:inherit;background-color:inherit}[data-vaul-drawer][data-vaul-drawer-direction=top]::after{top:initial;bottom:100%;left:0;right:0;height:200%}[data-vaul-drawer][data-vaul-drawer-direction=bottom]::after{top:100%;bottom:initial;left:0;right:0;height:200%}[data-vaul-drawer][data-vaul-drawer-direction=left]::after{left:initial;right:100%;top:0;bottom:0;width:200%}[data-vaul-drawer][data-vaul-drawer-direction=right]::after{left:100%;right:initial;top:0;bottom:0;width:200%}[data-vaul-overlay][data-vaul-snap-points=true]:not([data-vaul-snap-points-overlay=true]):not(
[data-state=closed]
){opacity:0}[data-vaul-overlay][data-vaul-snap-points-overlay=true]{opacity:1}[data-vaul-handle]{display:block;position:relative;opacity:.7;background:#e2e2e4;margin-left:auto;margin-right:auto;height:5px;width:32px;border-radius:1rem;touch-action:pan-y}[data-vaul-handle]:active,[data-vaul-handle]:hover{opacity:1}[data-vaul-handle-hitarea]{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:max(100%,2.75rem);height:max(100%,2.75rem);touch-action:inherit}@media (hover:hover) and (pointer:fine){[data-vaul-drawer]{user-select:none}}@media (pointer:fine){[data-vaul-handle-hitarea]:{width:100%;height:100%}}@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes fadeOut{to{opacity:0}}@keyframes slideFromBottom{from{transform:translate3d(0,var(--initial-transform,100%),0)}to{transform:translate3d(0,0,0)}}@keyframes slideToBottom{to{transform:translate3d(0,var(--initial-transform,100%),0)}}@keyframes slideFromTop{from{transform:translate3d(0,calc(var(--initial-transform,100%) * -1),0)}to{transform:translate3d(0,0,0)}}@keyframes slideToTop{to{transform:translate3d(0,calc(var(--initial-transform,100%) * -1),0)}}@keyframes slideFromLeft{from{transform:translate3d(calc(var(--initial-transform,100%) * -1),0,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToLeft{to{transform:translate3d(calc(var(--initial-transform,100%) * -1),0,0)}}@keyframes slideFromRight{from{transform:translate3d(var(--initial-transform,100%),0,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToRight{to{transform:translate3d(var(--initial-transform,100%),0,0)}}`);function C$(){const e=navigator.userAgent;return typeof window<"u"&&(/Firefox/.test(e)&&/Mobile/.test(e)||/FxiOS/.test(e))}function F$(){return Tx(/^Mac/)}function D$(){return Tx(/^iPhone/)}function d1(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function R$(){return Tx(/^iPad/)||F$()&&navigator.maxTouchPoints>1}function Vj(){return D$()||R$()}function Tx(e){return typeof window<"u"&&window.navigator!=null?e.test(window.navigator.platform):void 0}const M$=24,P$=typeof window<"u"?b.useLayoutEffect:b.useEffect;function u1(...e){return(...t)=>{for(let r of e)typeof r=="function"&&r(...t)}}const Df=typeof document<"u"&&window.visualViewport;function f1(e){let t=window.getComputedStyle(e);return/(auto|scroll)/.test(t.overflow+t.overflowX+t.overflowY)}function Hj(e){for(f1(e)&&(e=e.parentElement);e&&!f1(e);)e=e.parentElement;return e||document.scrollingElement||document.documentElement}const O$=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);let Hc=0,Rf;function I$(e={}){let{isDisabled:t}=e;P$(()=>{if(!t)return Hc++,Hc===1&&Vj()&&(Rf=L$()),()=>{Hc--,Hc===0&&(Rf==null||Rf())}},[t])}function L$(){let e,t=0,r=f=>{e=Hj(f.target),!(e===document.documentElement&&e===document.body)&&(t=f.changedTouches[0].pageY)},a=f=>{if(!e||e===document.documentElement||e===document.body){f.preventDefault();return}let h=f.changedTouches[0].pageY,m=e.scrollTop,x=e.scrollHeight-e.clientHeight;x!==0&&((m<=0&&h>t||m>=x&&h<t)&&f.preventDefault(),t=h)},s=f=>{let h=f.target;eh(h)&&h!==document.activeElement&&(f.preventDefault(),h.style.transform="translateY(-2000px)",h.focus(),requestAnimationFrame(()=>{h.style.transform=""}))},i=f=>{let h=f.target;eh(h)&&(h.style.transform="translateY(-2000px)",requestAnimationFrame(()=>{h.style.transform="",Df&&(Df.height<window.innerHeight?requestAnimationFrame(()=>{h1(h)}):Df.addEventListener("resize",()=>h1(h),{once:!0}))}))},l=()=>{window.scrollTo(0,0)},o=window.pageXOffset,c=window.pageYOffset,d=u1(B$(document.documentElement,"paddingRight",`${window.innerWidth-document.documentElement.clientWidth}px`));window.scrollTo(0,0);let u=u1(Ml(document,"touchstart",r,{passive:!1,capture:!0}),Ml(document,"touchmove",a,{passive:!1,capture:!0}),Ml(document,"touchend",s,{passive:!1,capture:!0}),Ml(document,"focus",i,!0),Ml(window,"scroll",l));return()=>{d(),u(),window.scrollTo(o,c)}}function B$(e,t,r){let a=e.style[t];return e.style[t]=r,()=>{e.style[t]=a}}function Ml(e,t,r,a){return e.addEventListener(t,r,a),()=>{e.removeEventListener(t,r,a)}}function h1(e){let t=document.scrollingElement||document.documentElement;for(;e&&e!==t;){let r=Hj(e);if(r!==document.documentElement&&r!==document.body&&r!==e){let a=r.getBoundingClientRect().top,s=e.getBoundingClientRect().top,i=e.getBoundingClientRect().bottom;const l=r.getBoundingClientRect().bottom+M$;i>l&&(r.scrollTop+=s-a)}e=r.parentElement}}function eh(e){return e instanceof HTMLInputElement&&!O$.has(e.type)||e instanceof HTMLTextAreaElement||e instanceof HTMLElement&&e.isContentEditable}function z$(e,t){typeof e=="function"?e(t):e!=null&&(e.current=t)}function U$(...e){return t=>e.forEach(r=>z$(r,t))}function $j(...e){return b.useCallback(U$(...e),e)}const Kj=new WeakMap;function Fr(e,t,r=!1){if(!e||!(e instanceof HTMLElement))return;let a={};Object.entries(t).forEach(([s,i])=>{if(s.startsWith("--")){e.style.setProperty(s,i);return}a[s]=e.style[s],e.style[s]=i}),!r&&Kj.set(e,a)}function V$(e,t){if(!e||!(e instanceof HTMLElement))return;let r=Kj.get(e);r&&(e.style[t]=r[t])}const Sr=e=>{switch(e){case"top":case"bottom":return!0;case"left":case"right":return!1;default:return e}};function $c(e,t){if(!e)return null;const r=window.getComputedStyle(e),a=r.transform||r.webkitTransform||r.mozTransform;let s=a.match(/^matrix3d\((.+)\)$/);return s?parseFloat(s[1].split(", ")[Sr(t)?13:12]):(s=a.match(/^matrix\((.+)\)$/),s?parseFloat(s[1].split(", ")[Sr(t)?5:4]):null)}function H$(e){return 8*(Math.log(e+1)-2)}function Mf(e,t){if(!e)return()=>{};const r=e.style.cssText;return Object.assign(e.style,t),()=>{e.style.cssText=r}}function $$(...e){return(...t)=>{for(const r of e)typeof r=="function"&&r(...t)}}const ar={DURATION:.5,EASE:[.32,.72,0,1]},Wj=.4,K$=.25,W$=100,Gj=8,Is=16,th=26,Pf="vaul-dragging";function Yj(e){const t=me.useRef(e);return me.useEffect(()=>{t.current=e}),me.useMemo(()=>(...r)=>t.current==null?void 0:t.current.call(t,...r),[])}function G$({defaultProp:e,onChange:t}){const r=me.useState(e),[a]=r,s=me.useRef(a),i=Yj(t);return me.useEffect(()=>{s.current!==a&&(i(a),s.current=a)},[a,s,i]),r}function Xj({prop:e,defaultProp:t,onChange:r=()=>{}}){const[a,s]=G$({defaultProp:t,onChange:r}),i=e!==void 0,l=i?e:a,o=Yj(r),c=me.useCallback(d=>{if(i){const f=typeof d=="function"?d(e):d;f!==e&&o(f)}else s(d)},[i,e,s,o]);return[l,c]}function Y$({activeSnapPointProp:e,setActiveSnapPointProp:t,snapPoints:r,drawerRef:a,overlayRef:s,fadeFromIndex:i,onSnapPointChange:l,direction:o="bottom",container:c,snapToSequentialPoint:d}){const[u,f]=Xj({prop:e,defaultProp:r==null?void 0:r[0],onChange:t}),[h,m]=me.useState(typeof window<"u"?{innerWidth:window.innerWidth,innerHeight:window.innerHeight}:void 0);me.useEffect(()=>{function k(){m({innerWidth:window.innerWidth,innerHeight:window.innerHeight})}return window.addEventListener("resize",k),()=>window.removeEventListener("resize",k)},[]);const x=me.useMemo(()=>u===(r==null?void 0:r[r.length-1])||null,[r,u]),p=me.useMemo(()=>{var k;return(k=r==null?void 0:r.findIndex(j=>j===u))!=null?k:null},[r,u]),g=r&&r.length>0&&(i||i===0)&&!Number.isNaN(i)&&r[i]===u||!r,y=me.useMemo(()=>{const k=c?{width:c.getBoundingClientRect().width,height:c.getBoundingClientRect().height}:typeof window<"u"?{width:window.innerWidth,height:window.innerHeight}:{width:0,height:0};var j;return(j=r==null?void 0:r.map(w=>{const E=typeof w=="string";let A=0;if(E&&(A=parseInt(w,10)),Sr(o)){const W=E?A:h?w*k.height:0;return h?o==="bottom"?k.height-W:-k.height+W:W}const D=E?A:h?w*k.width:0;return h?o==="right"?k.width-D:-k.width+D:D}))!=null?j:[]},[r,h,c]),N=me.useMemo(()=>p!==null?y==null?void 0:y[p]:null,[y,p]),v=me.useCallback(k=>{var j;const w=(j=y==null?void 0:y.findIndex(E=>E===k))!=null?j:null;l(w),Fr(a.current,{transition:`transform ${ar.DURATION}s cubic-bezier(${ar.EASE.join(",")})`,transform:Sr(o)?`translate3d(0, ${k}px, 0)`:`translate3d(${k}px, 0, 0)`}),y&&w!==y.length-1&&i!==void 0&&w!==i&&w<i?Fr(s.current,{transition:`opacity ${ar.DURATION}s cubic-bezier(${ar.EASE.join(",")})`,opacity:"0"}):Fr(s.current,{transition:`opacity ${ar.DURATION}s cubic-bezier(${ar.EASE.join(",")})`,opacity:"1"}),f(r==null?void 0:r[Math.max(w,0)])},[a.current,r,y,i,s,f]);me.useEffect(()=>{if(u||e){var k;const j=(k=r==null?void 0:r.findIndex(w=>w===e||w===u))!=null?k:-1;y&&j!==-1&&typeof y[j]=="number"&&v(y[j])}},[u,e,r,y,v]);function S({draggedDistance:k,closeDrawer:j,velocity:w,dismissible:E}){if(i===void 0)return;const A=o==="bottom"||o==="right"?(N??0)-k:(N??0)+k,D=p===i-1,W=p===0,re=k>0;if(D&&Fr(s.current,{transition:`opacity ${ar.DURATION}s cubic-bezier(${ar.EASE.join(",")})`}),!d&&w>2&&!re){E?j():v(y[0]);return}if(!d&&w>2&&re&&y&&r){v(y[r.length-1]);return}const U=y==null?void 0:y.reduce((Y,Q)=>typeof Y!="number"||typeof Q!="number"?Y:Math.abs(Q-A)<Math.abs(Y-A)?Q:Y),M=Sr(o)?window.innerHeight:window.innerWidth;if(w>Wj&&Math.abs(k)<M*.4){const Y=re?1:-1;if(Y>0&&x&&r){v(y[r.length-1]);return}if(W&&Y<0&&E&&j(),p===null)return;v(y[p+Y]);return}v(U)}function _({draggedDistance:k}){if(N===null)return;const j=o==="bottom"||o==="right"?N-k:N+k;(o==="bottom"||o==="right")&&j<y[y.length-1]||(o==="top"||o==="left")&&j>y[y.length-1]||Fr(a.current,{transform:Sr(o)?`translate3d(0, ${j}px, 0)`:`translate3d(${j}px, 0, 0)`})}function F(k,j){if(!r||typeof p!="number"||!y||i===void 0)return null;const w=p===i-1;if(p>=i&&j)return 0;if(w&&!j)return 1;if(!g&&!w)return null;const A=w?p+1:p-1,D=w?y[A]-y[A-1]:y[A+1]-y[A],W=k/Math.abs(D);return w?1-W:W}return{isLastSnapPoint:x,activeSnapPoint:u,shouldFade:g,getPercentageDragged:F,setActiveSnapPoint:f,activeSnapPointIndex:p,onRelease:S,onDrag:_,snapPointsOffset:y}}const X$=()=>()=>{};function q$(){const{direction:e,isOpen:t,shouldScaleBackground:r,setBackgroundColorOnScale:a,noBodyStyles:s}=pc(),i=me.useRef(null),l=b.useMemo(()=>document.body.style.backgroundColor,[]);function o(){return(window.innerWidth-th)/window.innerWidth}me.useEffect(()=>{if(t&&r){i.current&&clearTimeout(i.current);const c=document.querySelector("[data-vaul-drawer-wrapper]")||document.querySelector("[vaul-drawer-wrapper]");if(!c)return;$$(a&&!s?Mf(document.body,{background:"black"}):X$,Mf(c,{transformOrigin:Sr(e)?"top":"left",transitionProperty:"transform, border-radius",transitionDuration:`${ar.DURATION}s`,transitionTimingFunction:`cubic-bezier(${ar.EASE.join(",")})`}));const d=Mf(c,{borderRadius:`${Gj}px`,overflow:"hidden",...Sr(e)?{transform:`scale(${o()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`}:{transform:`scale(${o()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`}});return()=>{d(),i.current=window.setTimeout(()=>{l?document.body.style.background=l:document.body.style.removeProperty("background")},ar.DURATION*1e3)}}},[t,r,l])}let Pl=null;function Z$({isOpen:e,modal:t,nested:r,hasBeenOpened:a,preventScrollRestoration:s,noBodyStyles:i}){const[l,o]=me.useState(()=>typeof window<"u"?window.location.href:""),c=me.useRef(0),d=me.useCallback(()=>{if(d1()&&Pl===null&&e&&!i){Pl={position:document.body.style.position,top:document.body.style.top,left:document.body.style.left,height:document.body.style.height,right:"unset"};const{scrollX:f,innerHeight:h}=window;document.body.style.setProperty("position","fixed","important"),Object.assign(document.body.style,{top:`${-c.current}px`,left:`${-f}px`,right:"0px",height:"auto"}),window.setTimeout(()=>window.requestAnimationFrame(()=>{const m=h-window.innerHeight;m&&c.current>=h&&(document.body.style.top=`${-(c.current+m)}px`)}),300)}},[e]),u=me.useCallback(()=>{if(d1()&&Pl!==null&&!i){const f=-parseInt(document.body.style.top,10),h=-parseInt(document.body.style.left,10);Object.assign(document.body.style,Pl),window.requestAnimationFrame(()=>{if(s&&l!==window.location.href){o(window.location.href);return}window.scrollTo(h,f)}),Pl=null}},[l]);return me.useEffect(()=>{function f(){c.current=window.scrollY}return f(),window.addEventListener("scroll",f),()=>{window.removeEventListener("scroll",f)}},[]),me.useEffect(()=>{if(t)return()=>{typeof document>"u"||document.querySelector("[data-vaul-drawer]")||u()}},[t,u]),me.useEffect(()=>{r||!a||(e?(!window.matchMedia("(display-mode: standalone)").matches&&d(),t||window.setTimeout(()=>{u()},500)):u())},[e,a,l,t,r,d,u]),{restorePositionSetting:u}}function J$({open:e,onOpenChange:t,children:r,onDrag:a,onRelease:s,snapPoints:i,shouldScaleBackground:l=!1,setBackgroundColorOnScale:o=!0,closeThreshold:c=K$,scrollLockTimeout:d=W$,dismissible:u=!0,handleOnly:f=!1,fadeFromIndex:h=i&&i.length-1,activeSnapPoint:m,setActiveSnapPoint:x,fixed:p,modal:g=!0,onClose:y,nested:N,noBodyStyles:v=!1,direction:S="bottom",defaultOpen:_=!1,disablePreventScroll:F=!0,snapToSequentialPoint:k=!1,preventScrollRestoration:j=!1,repositionInputs:w=!0,onAnimationEnd:E,container:A,autoFocus:D=!1}){var W,re;const[U=!1,M]=Xj({defaultProp:_,prop:e,onChange:He=>{t==null||t(He),!He&&!N&&Ft(),setTimeout(()=>{E==null||E(He)},ar.DURATION*1e3),He&&!g&&typeof window<"u"&&window.requestAnimationFrame(()=>{document.body.style.pointerEvents="auto"}),He||(document.body.style.pointerEvents="auto")}}),[Y,Q]=me.useState(!1),[B,V]=me.useState(!1),[P,T]=me.useState(!1),R=me.useRef(null),L=me.useRef(null),X=me.useRef(null),J=me.useRef(null),te=me.useRef(null),G=me.useRef(!1),Z=me.useRef(null),ae=me.useRef(0),de=me.useRef(!1),z=me.useRef(!_),Ee=me.useRef(0),ue=me.useRef(null),Ce=me.useRef(((W=ue.current)==null?void 0:W.getBoundingClientRect().height)||0),ve=me.useRef(((re=ue.current)==null?void 0:re.getBoundingClientRect().width)||0),ge=me.useRef(0),Fe=me.useCallback(He=>{i&&He===Ct.length-1&&(L.current=new Date)},[]),{activeSnapPoint:Ie,activeSnapPointIndex:Ze,setActiveSnapPoint:yt,onRelease:ht,snapPointsOffset:Ct,onDrag:Ue,shouldFade:kt,getPercentageDragged:qe}=Y$({snapPoints:i,activeSnapPointProp:m,setActiveSnapPointProp:x,drawerRef:ue,fadeFromIndex:h,overlayRef:R,onSnapPointChange:Fe,direction:S,container:A,snapToSequentialPoint:k});I$({isDisabled:!U||B||!g||P||!Y||!w||!F});const{restorePositionSetting:Ft}=Z$({isOpen:U,modal:g,nested:N??!1,hasBeenOpened:Y,preventScrollRestoration:j,noBodyStyles:v});function Qe(){return(window.innerWidth-th)/window.innerWidth}function bt(He){var gt,Dt;!u&&!i||ue.current&&!ue.current.contains(He.target)||(Ce.current=((gt=ue.current)==null?void 0:gt.getBoundingClientRect().height)||0,ve.current=((Dt=ue.current)==null?void 0:Dt.getBoundingClientRect().width)||0,V(!0),X.current=new Date,Vj()&&window.addEventListener("touchend",()=>G.current=!1,{once:!0}),He.target.setPointerCapture(He.pointerId),ae.current=Sr(S)?He.pageY:He.pageX)}function se(He,gt){var Dt;let mt=He;const Pt=(Dt=window.getSelection())==null?void 0:Dt.toString(),Ye=ue.current?$c(ue.current,S):null,Ae=new Date;if(mt.tagName==="SELECT"||mt.hasAttribute("data-vaul-no-drag")||mt.closest("[data-vaul-no-drag]"))return!1;if(S==="right"||S==="left")return!0;if(L.current&&Ae.getTime()-L.current.getTime()<500)return!1;if(Ye!==null&&(S==="bottom"?Ye>0:Ye<0))return!0;if(Pt&&Pt.length>0)return!1;if(te.current&&Ae.getTime()-te.current.getTime()<d&&Ye===0||gt)return te.current=Ae,!1;for(;mt;){if(mt.scrollHeight>mt.clientHeight){if(mt.scrollTop!==0)return te.current=new Date,!1;if(mt.getAttribute("role")==="dialog")return!0}mt=mt.parentNode}return!0}function Ne(He){if(ue.current&&B){const gt=S==="bottom"||S==="right"?1:-1,Dt=(ae.current-(Sr(S)?He.pageY:He.pageX))*gt,mt=Dt>0,Pt=i&&!u&&!mt;if(Pt&&Ze===0)return;const Ye=Math.abs(Dt),Ae=document.querySelector("[data-vaul-drawer-wrapper]"),_e=S==="bottom"||S==="top"?Ce.current:ve.current;let $e=Ye/_e;const Ge=qe(Ye,mt);if(Ge!==null&&($e=Ge),Pt&&$e>=1||!G.current&&!se(He.target,mt))return;if(ue.current.classList.add(Pf),G.current=!0,Fr(ue.current,{transition:"none"}),Fr(R.current,{transition:"none"}),i&&Ue({draggedDistance:Dt}),mt&&!i){const nt=H$(Dt),rr=Math.min(nt*-1,0)*gt;Fr(ue.current,{transform:Sr(S)?`translate3d(0, ${rr}px, 0)`:`translate3d(${rr}px, 0, 0)`});return}const xt=1-$e;if((kt||h&&Ze===h-1)&&(a==null||a(He,$e),Fr(R.current,{opacity:`${xt}`,transition:"none"},!0)),Ae&&R.current&&l){const nt=Math.min(Qe()+$e*(1-Qe()),1),rr=8-$e*8,ee=Math.max(0,14-$e*14);Fr(Ae,{borderRadius:`${rr}px`,transform:Sr(S)?`scale(${nt}) translate3d(0, ${ee}px, 0)`:`scale(${nt}) translate3d(${ee}px, 0, 0)`,transition:"none"},!0)}if(!i){const nt=Ye*gt;Fr(ue.current,{transform:Sr(S)?`translate3d(0, ${nt}px, 0)`:`translate3d(${nt}px, 0, 0)`})}}}me.useEffect(()=>{window.requestAnimationFrame(()=>{z.current=!0})},[]),me.useEffect(()=>{var He;function gt(){if(!ue.current||!w)return;const Dt=document.activeElement;if(eh(Dt)||de.current){var mt;const Pt=((mt=window.visualViewport)==null?void 0:mt.height)||0,Ye=window.innerHeight;let Ae=Ye-Pt;const _e=ue.current.getBoundingClientRect().height||0,$e=_e>Ye*.8;ge.current||(ge.current=_e);const Ge=ue.current.getBoundingClientRect().top;if(Math.abs(Ee.current-Ae)>60&&(de.current=!de.current),i&&i.length>0&&Ct&&Ze){const xt=Ct[Ze]||0;Ae+=xt}if(Ee.current=Ae,_e>Pt||de.current){const xt=ue.current.getBoundingClientRect().height;let nt=xt;xt>Pt&&(nt=Pt-($e?Ge:th)),p?ue.current.style.height=`${xt-Math.max(Ae,0)}px`:ue.current.style.height=`${Math.max(nt,Pt-Ge)}px`}else C$()||(ue.current.style.height=`${ge.current}px`);i&&i.length>0&&!de.current?ue.current.style.bottom="0px":ue.current.style.bottom=`${Math.max(Ae,0)}px`}}return(He=window.visualViewport)==null||He.addEventListener("resize",gt),()=>{var Dt;return(Dt=window.visualViewport)==null?void 0:Dt.removeEventListener("resize",gt)}},[Ze,i,Ct]);function De(He){Rt(),y==null||y(),He||M(!1),setTimeout(()=>{i&&yt(i[0])},ar.DURATION*1e3)}function lt(){if(!ue.current)return;const He=document.querySelector("[data-vaul-drawer-wrapper]"),gt=$c(ue.current,S);Fr(ue.current,{transform:"translate3d(0, 0, 0)",transition:`transform ${ar.DURATION}s cubic-bezier(${ar.EASE.join(",")})`}),Fr(R.current,{transition:`opacity ${ar.DURATION}s cubic-bezier(${ar.EASE.join(",")})`,opacity:"1"}),l&&gt&&gt>0&&U&&Fr(He,{borderRadius:`${Gj}px`,overflow:"hidden",...Sr(S)?{transform:`scale(${Qe()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`,transformOrigin:"top"}:{transform:`scale(${Qe()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`,transformOrigin:"left"},transitionProperty:"transform, border-radius",transitionDuration:`${ar.DURATION}s`,transitionTimingFunction:`cubic-bezier(${ar.EASE.join(",")})`},!0)}function Rt(){!B||!ue.current||(ue.current.classList.remove(Pf),G.current=!1,V(!1),J.current=new Date)}function _r(He){if(!B||!ue.current)return;ue.current.classList.remove(Pf),G.current=!1,V(!1),J.current=new Date;const gt=$c(ue.current,S);if(!He||!se(He.target,!1)||!gt||Number.isNaN(gt)||X.current===null)return;const Dt=J.current.getTime()-X.current.getTime(),mt=ae.current-(Sr(S)?He.pageY:He.pageX),Pt=Math.abs(mt)/Dt;if(Pt>.05&&(T(!0),setTimeout(()=>{T(!1)},200)),i){ht({draggedDistance:mt*(S==="bottom"||S==="right"?1:-1),closeDrawer:De,velocity:Pt,dismissible:u}),s==null||s(He,!0);return}if(S==="bottom"||S==="right"?mt>0:mt<0){lt(),s==null||s(He,!0);return}if(Pt>Wj){De(),s==null||s(He,!1);return}var Ye;const Ae=Math.min((Ye=ue.current.getBoundingClientRect().height)!=null?Ye:0,window.innerHeight);var _e;const $e=Math.min((_e=ue.current.getBoundingClientRect().width)!=null?_e:0,window.innerWidth),Ge=S==="left"||S==="right";if(Math.abs(gt)>=(Ge?$e:Ae)*c){De(),s==null||s(He,!1);return}s==null||s(He,!0),lt()}me.useEffect(()=>(U&&(Fr(document.documentElement,{scrollBehavior:"auto"}),L.current=new Date),()=>{V$(document.documentElement,"scrollBehavior")}),[U]);function Hr(He){const gt=He?(window.innerWidth-Is)/window.innerWidth:1,Dt=He?-Is:0;Z.current&&window.clearTimeout(Z.current),Fr(ue.current,{transition:`transform ${ar.DURATION}s cubic-bezier(${ar.EASE.join(",")})`,transform:Sr(S)?`scale(${gt}) translate3d(0, ${Dt}px, 0)`:`scale(${gt}) translate3d(${Dt}px, 0, 0)`}),!He&&ue.current&&(Z.current=setTimeout(()=>{const mt=$c(ue.current,S);Fr(ue.current,{transition:"none",transform:Sr(S)?`translate3d(0, ${mt}px, 0)`:`translate3d(${mt}px, 0, 0)`})},500))}function Et(He,gt){if(gt<0)return;const Dt=(window.innerWidth-Is)/window.innerWidth,mt=Dt+gt*(1-Dt),Pt=-Is+gt*Is;Fr(ue.current,{transform:Sr(S)?`scale(${mt}) translate3d(0, ${Pt}px, 0)`:`scale(${mt}) translate3d(${Pt}px, 0, 0)`,transition:"none"})}function Fa(He,gt){const Dt=Sr(S)?window.innerHeight:window.innerWidth,mt=gt?(Dt-Is)/Dt:1,Pt=gt?-Is:0;gt&&Fr(ue.current,{transition:`transform ${ar.DURATION}s cubic-bezier(${ar.EASE.join(",")})`,transform:Sr(S)?`scale(${mt}) translate3d(0, ${Pt}px, 0)`:`scale(${mt}) translate3d(${Pt}px, 0, 0)`})}return me.useEffect(()=>{g||window.requestAnimationFrame(()=>{document.body.style.pointerEvents="auto"})},[g]),me.createElement(lh,{defaultOpen:_,onOpenChange:He=>{!u&&!He||(He?Q(!0):De(!0),M(He))},open:U},me.createElement(Uj.Provider,{value:{activeSnapPoint:Ie,snapPoints:i,setActiveSnapPoint:yt,drawerRef:ue,overlayRef:R,onOpenChange:t,onPress:bt,onRelease:_r,onDrag:Ne,dismissible:u,shouldAnimate:z,handleOnly:f,isOpen:U,isDragging:B,shouldFade:kt,closeDrawer:De,onNestedDrag:Et,onNestedOpenChange:Hr,onNestedRelease:Fa,keyboardIsOpen:de,modal:g,snapPointsOffset:Ct,activeSnapPointIndex:Ze,direction:S,shouldScaleBackground:l,setBackgroundColorOnScale:o,noBodyStyles:v,container:A,autoFocus:D}},r))}const qj=me.forwardRef(function({...e},t){const{overlayRef:r,snapPoints:a,onRelease:s,shouldFade:i,isOpen:l,modal:o,shouldAnimate:c}=pc(),d=$j(t,r),u=a&&a.length>0;if(!o)return null;const f=me.useCallback(h=>s(h),[s]);return me.createElement(hh,{onMouseUp:f,ref:d,"data-vaul-overlay":"","data-vaul-snap-points":l&&u?"true":"false","data-vaul-snap-points-overlay":l&&i?"true":"false","data-vaul-animate":c!=null&&c.current?"true":"false",...e})});qj.displayName="Drawer.Overlay";const Zj=me.forwardRef(function({onPointerDownOutside:e,style:t,onOpenAutoFocus:r,...a},s){const{drawerRef:i,onPress:l,onRelease:o,onDrag:c,keyboardIsOpen:d,snapPointsOffset:u,activeSnapPointIndex:f,modal:h,isOpen:m,direction:x,snapPoints:p,container:g,handleOnly:y,shouldAnimate:N,autoFocus:v}=pc(),[S,_]=me.useState(!1),F=$j(s,i),k=me.useRef(null),j=me.useRef(null),w=me.useRef(!1),E=p&&p.length>0;q$();const A=(W,re,U=0)=>{if(w.current)return!0;const M=Math.abs(W.y),Y=Math.abs(W.x),Q=Y>M,B=["bottom","right"].includes(re)?1:-1;if(re==="left"||re==="right"){if(!(W.x*B<0)&&Y>=0&&Y<=U)return Q}else if(!(W.y*B<0)&&M>=0&&M<=U)return!Q;return w.current=!0,!0};me.useEffect(()=>{E&&window.requestAnimationFrame(()=>{_(!0)})},[]);function D(W){k.current=null,w.current=!1,o(W)}return me.createElement(oh,{"data-vaul-drawer-direction":x,"data-vaul-drawer":"","data-vaul-delayed-snap-points":S?"true":"false","data-vaul-snap-points":m&&E?"true":"false","data-vaul-custom-container":g?"true":"false","data-vaul-animate":N!=null&&N.current?"true":"false",...a,ref:F,style:u&&u.length>0?{"--snap-point-height":`${u[f??0]}px`,...t}:t,onPointerDown:W=>{y||(a.onPointerDown==null||a.onPointerDown.call(a,W),k.current={x:W.pageX,y:W.pageY},l(W))},onOpenAutoFocus:W=>{r==null||r(W),v||W.preventDefault()},onPointerDownOutside:W=>{if(e==null||e(W),!h||W.defaultPrevented){W.preventDefault();return}d.current&&(d.current=!1)},onFocusOutside:W=>{if(!h){W.preventDefault();return}},onPointerMove:W=>{if(j.current=W,y||(a.onPointerMove==null||a.onPointerMove.call(a,W),!k.current))return;const re=W.pageY-k.current.y,U=W.pageX-k.current.x,M=W.pointerType==="touch"?10:2;A({x:U,y:re},x,M)?c(W):(Math.abs(U)>M||Math.abs(re)>M)&&(k.current=null)},onPointerUp:W=>{a.onPointerUp==null||a.onPointerUp.call(a,W),k.current=null,w.current=!1,o(W)},onPointerOut:W=>{a.onPointerOut==null||a.onPointerOut.call(a,W),D(j.current)},onContextMenu:W=>{a.onContextMenu==null||a.onContextMenu.call(a,W),j.current&&D(j.current)}})});Zj.displayName="Drawer.Content";const Q$=250,eK=120,tK=me.forwardRef(function({preventCycle:e=!1,children:t,...r},a){const{closeDrawer:s,isDragging:i,snapPoints:l,activeSnapPoint:o,setActiveSnapPoint:c,dismissible:d,handleOnly:u,isOpen:f,onPress:h,onDrag:m}=pc(),x=me.useRef(null),p=me.useRef(!1);function g(){if(p.current){v();return}window.setTimeout(()=>{y()},eK)}function y(){if(i||e||p.current){v();return}if(v(),!l||l.length===0){d||s();return}if(o===l[l.length-1]&&d){s();return}const _=l.findIndex(k=>k===o);if(_===-1)return;const F=l[_+1];c(F)}function N(){x.current=window.setTimeout(()=>{p.current=!0},Q$)}function v(){x.current&&window.clearTimeout(x.current),p.current=!1}return me.createElement("div",{onClick:g,onPointerCancel:v,onPointerDown:S=>{u&&h(S),N()},onPointerMove:S=>{u&&m(S)},ref:a,"data-vaul-drawer-visible":f?"true":"false","data-vaul-handle":"","aria-hidden":"true",...r},me.createElement("span",{"data-vaul-handle-hitarea":"","aria-hidden":"true"},t))});tK.displayName="Drawer.Handle";function rK(e){const t=pc(),{container:r=t.container,...a}=e;return me.createElement(fh,{container:r,...a})}const bi={Root:J$,Content:Zj,Overlay:qj,Portal:rK,Close:ch,Title:dh,Description:uh};function aK({...e}){return n.jsx(bi.Root,{"data-slot":"drawer",...e})}function nK({...e}){return n.jsx(bi.Portal,{"data-slot":"drawer-portal",...e})}function sK({...e}){return n.jsx(bi.Close,{"data-slot":"drawer-close",...e})}function iK({className:e,...t}){return n.jsx(bi.Overlay,{"data-slot":"drawer-overlay",className:We("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...t})}function lK({className:e,children:t,...r}){return n.jsxs(nK,{"data-slot":"drawer-portal",children:[n.jsx(iK,{}),n.jsxs(bi.Content,{"data-slot":"drawer-content",className:We("group/drawer-content bg-background fixed z-50 flex h-auto flex-col","data-[vaul-drawer-direction=top]:inset-x-0 data-[vaul-drawer-direction=top]:top-0 data-[vaul-drawer-direction=top]:mb-24 data-[vaul-drawer-direction=top]:max-h-[80vh] data-[vaul-drawer-direction=top]:rounded-b-lg data-[vaul-drawer-direction=top]:border-b","data-[vaul-drawer-direction=bottom]:inset-x-0 data-[vaul-drawer-direction=bottom]:bottom-0 data-[vaul-drawer-direction=bottom]:mt-24 data-[vaul-drawer-direction=bottom]:max-h-[80vh] data-[vaul-drawer-direction=bottom]:rounded-t-lg data-[vaul-drawer-direction=bottom]:border-t","data-[vaul-drawer-direction=right]:inset-y-0 data-[vaul-drawer-direction=right]:right-0 data-[vaul-drawer-direction=right]:w-3/4 data-[vaul-drawer-direction=right]:border-l data-[vaul-drawer-direction=right]:sm:max-w-sm","data-[vaul-drawer-direction=left]:inset-y-0 data-[vaul-drawer-direction=left]:left-0 data-[vaul-drawer-direction=left]:w-3/4 data-[vaul-drawer-direction=left]:border-r data-[vaul-drawer-direction=left]:sm:max-w-sm",e),...r,children:[n.jsx("div",{className:"bg-muted mx-auto mt-4 hidden h-2 w-[100px] shrink-0 rounded-full group-data-[vaul-drawer-direction=bottom]/drawer-content:block"}),t]})]})}function oK({className:e,...t}){return n.jsx("div",{"data-slot":"drawer-header",className:We("flex flex-col gap-1.5 p-4",e),...t})}function cK({className:e,...t}){return n.jsx("div",{"data-slot":"drawer-footer",className:We("mt-auto flex flex-col gap-2 p-4",e),...t})}function dK({className:e,...t}){return n.jsx(bi.Title,{"data-slot":"drawer-title",className:We("text-foreground font-semibold",e),...t})}function uK({className:e,...t}){return n.jsx(bi.Description,{"data-slot":"drawer-description",className:We("text-muted-foreground text-sm",e),...t})}const m1={async getAllOffers(e,t){const r=[];r.push(wt("isDeleted","==",!1)),e.companyCode&&r.push(wt("companyCode","==",e.companyCode)),e.userUid&&r.push(wt("createdByUid","==",e.userUid)),e.startDate&&r.push(wt("createdAt",">=",an.fromDate(e.startDate))),e.endDate&&r.push(wt("createdAt","<=",an.fromDate(e.endDate))),e.minPrice!==void 0&&r.push(wt("amount",">=",Number(e.minPrice))),e.maxPrice!==void 0&&r.push(wt("amount","<=",Number(e.maxPrice))),r.push(nn("createdAt","desc")),r.push(Xc(25)),t&&r.push(gS(t));const a=Ir(ir(ke,"offers"),...r),s=Ir(ir(ke,"bulkOffers"),...r),[i,l]=await Promise.all([mr(a),mr(s)]),o=i.docs.map(f=>({...f.data(),id:f.id})),c=l.docs.map(f=>{const h=f.data();return{...h,id:f.id,toplamTutar:h.totalRevenue,amount:h.totalRevenue,payload:{pricePerM2:0,profitMargin:h.totalCost>0?h.totalProfit/h.totalCost*100:0,L:"-",W:"-",H:"-"}}}),d=[...o,...c];return d.sort((f,h)=>{var p,g;const m=typeof((p=f.createdAt)==null?void 0:p.toMillis)=="function"?f.createdAt.toMillis():f.createdAt?new Date(f.createdAt).getTime():0;return(typeof((g=h.createdAt)==null?void 0:g.toMillis)=="function"?h.createdAt.toMillis():h.createdAt?new Date(h.createdAt).getTime():0)-m}),{offers:d.slice(0,25),lastVisible:null}},async getOfferDetail(e){let t=Be(ke,"offers",e),r=await hr(t);if(!r.exists()&&(t=Be(ke,"bulkOffers",e),r=await hr(t),!r.exists()))return null;const a=r.data(),s=e.startsWith("TKT-"),i={...a,toplamTutar:s?a.totalRevenue:a.toplamTutar,amount:s?a.totalRevenue:a.amount,payload:s?{profitMargin:a.totalCost>0?a.totalProfit/a.totalCost*100:0,qualityName:"Toplu",L:"-",W:"-",H:"-"}:a.payload};let l="Bilinmeyen irket";if(i.companyCode){const f=Be(ke,"companies",i.companyCode),h=await hr(f);h.exists()&&(l=h.data().name)}let o="Bilinmeyen Kullanc";const c=Be(ke,"users",i.createdByUid),d=await hr(c);d.exists()&&(o=d.data().email);let u="SPARK";if(i.companyCode){const f=await Ry.getSubscription(i.companyCode);f&&(u=f.planType)}return{...i,companyName:l,userEmail:o,planType:u}}},fK={lessThanXSeconds:{one:"bir saniyeden az",other:"{{count}} saniyeden az"},xSeconds:{one:"1 saniye",other:"{{count}} saniye"},halfAMinute:"yarm dakika",lessThanXMinutes:{one:"bir dakikadan az",other:"{{count}} dakikadan az"},xMinutes:{one:"1 dakika",other:"{{count}} dakika"},aboutXHours:{one:"yaklak 1 saat",other:"yaklak {{count}} saat"},xHours:{one:"1 saat",other:"{{count}} saat"},xDays:{one:"1 gn",other:"{{count}} gn"},aboutXWeeks:{one:"yaklak 1 hafta",other:"yaklak {{count}} hafta"},xWeeks:{one:"1 hafta",other:"{{count}} hafta"},aboutXMonths:{one:"yaklak 1 ay",other:"yaklak {{count}} ay"},xMonths:{one:"1 ay",other:"{{count}} ay"},aboutXYears:{one:"yaklak 1 yl",other:"yaklak {{count}} yl"},xYears:{one:"1 yl",other:"{{count}} yl"},overXYears:{one:"1 yldan fazla",other:"{{count}} yldan fazla"},almostXYears:{one:"neredeyse 1 yl",other:"neredeyse {{count}} yl"}},hK=(e,t,r)=>{let a;const s=fK[e];return typeof s=="string"?a=s:t===1?a=s.one:a=s.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?a+" sonra":a+" nce":a},mK={full:"d MMMM y EEEE",long:"d MMMM y",medium:"d MMM y",short:"dd.MM.yyyy"},xK={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},pK={full:"{{date}} 'saat' {{time}}",long:"{{date}} 'saat' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},gK={date:Ou({formats:mK,defaultWidth:"full"}),time:Ou({formats:xK,defaultWidth:"full"}),dateTime:Ou({formats:pK,defaultWidth:"full"})},vK={lastWeek:"'geen hafta' eeee 'saat' p",yesterday:"'dn saat' p",today:"'bugn saat' p",tomorrow:"'yarn saat' p",nextWeek:"eeee 'saat' p",other:"P"},yK=(e,t,r,a)=>vK[e],bK={narrow:["M","MS"],abbreviated:["M","MS"],wide:["Milattan nce","Milattan Sonra"]},wK={narrow:["1","2","3","4"],abbreviated:["1","2","3","4"],wide:["lk eyrek","kinci eyrek","nc eyrek","Son eyrek"]},kK={narrow:["O","","M","N","M","H","T","A","E","E","K","A"],abbreviated:["Oca","ub","Mar","Nis","May","Haz","Tem","Au","Eyl","Eki","Kas","Ara"],wide:["Ocak","ubat","Mart","Nisan","Mays","Haziran","Temmuz","Austos","Eyll","Ekim","Kasm","Aralk"]},NK={narrow:["P","P","S","","P","C","C"],short:["Pz","Pt","Sa","a","Pe","Cu","Ct"],abbreviated:["Paz","Pzt","Sal","ar","Per","Cum","Cts"],wide:["Pazar","Pazartesi","Sal","aramba","Perembe","Cuma","Cumartesi"]},jK={narrow:{am:"",pm:"s",midnight:"gy",noon:"",morning:"sa",afternoon:"s",evening:"ak",night:"ge"},abbreviated:{am:"",pm:"S",midnight:"gece yars",noon:"le",morning:"sabah",afternoon:"leden sonra",evening:"akam",night:"gece"},wide:{am:"..",pm:".S.",midnight:"gece yars",noon:"le",morning:"sabah",afternoon:"leden sonra",evening:"akam",night:"gece"}},EK={narrow:{am:"",pm:"s",midnight:"gy",noon:"",morning:"sa",afternoon:"s",evening:"ak",night:"ge"},abbreviated:{am:"",pm:"S",midnight:"gece yars",noon:"len",morning:"sabahleyin",afternoon:"leden sonra",evening:"akamleyin",night:"geceleyin"},wide:{am:"..",pm:".s.",midnight:"gece yars",noon:"len",morning:"sabahleyin",afternoon:"leden sonra",evening:"akamleyin",night:"geceleyin"}},SK=(e,t)=>Number(e)+".",TK={ordinalNumber:SK,era:Sl({values:bK,defaultWidth:"wide"}),quarter:Sl({values:wK,defaultWidth:"wide",argumentCallback:e=>Number(e)-1}),month:Sl({values:kK,defaultWidth:"wide"}),day:Sl({values:NK,defaultWidth:"wide"}),dayPeriod:Sl({values:jK,defaultWidth:"wide",formattingValues:EK,defaultFormattingWidth:"wide"})},AK=/^(\d+)(\.)?/i,_K=/\d+/i,CK={narrow:/^(m|ms)/i,abbreviated:/^(m|ms)/i,wide:/^(milattan nce|milattan sonra)/i},FK={any:[/(^m|^milattan nce)/i,/(^ms|^milattan sonra)/i]},DK={narrow:/^[1234]/i,abbreviated:/^[1234]/i,wide:/^((i|)lk|(i|)kinci|nc|son) eyrek/i},RK={any:[/1/i,/2/i,/3/i,/4/i],abbreviated:[/1/i,/2/i,/3/i,/4/i],wide:[/^(i|)lk eyrek/i,/(i|)kinci eyrek/i,/nc eyrek/i,/son eyrek/i]},MK={narrow:/^[omnhtaek]/i,abbreviated:/^(oca|ub|mar|nis|may|haz|tem|au|eyl|eki|kas|ara)/i,wide:/^(ocak|ubat|mart|nisan|mays|haziran|temmuz|austos|eyll|ekim|kasm|aralk)/i},PK={narrow:[/^o/i,/^/i,/^m/i,/^n/i,/^m/i,/^h/i,/^t/i,/^a/i,/^e/i,/^e/i,/^k/i,/^a/i],any:[/^o/i,/^/i,/^mar/i,/^n/i,/^may/i,/^h/i,/^t/i,/^a/i,/^ey/i,/^ek/i,/^k/i,/^ar/i]},OK={narrow:/^[psc]/i,short:/^(pz|pt|sa|a|pe|cu|ct)/i,abbreviated:/^(paz|pzt|sal|ar|per|cum|cts)/i,wide:/^(pazar(?!tesi)|pazartesi|sal|aramba|perembe|cuma(?!rtesi)|cumartesi)/i},IK={narrow:[/^p/i,/^p/i,/^s/i,/^/i,/^p/i,/^c/i,/^c/i],any:[/^pz/i,/^pt/i,/^sa/i,/^a/i,/^pe/i,/^cu/i,/^ct/i],wide:[/^pazar(?!tesi)/i,/^pazartesi/i,/^sal/i,/^aramba/i,/^perembe/i,/^cuma(?!rtesi)/i,/^cumartesi/i]},LK={narrow:/^(|s|gy||sa|s|ak|ge)/i,any:/^(\.?\s?[s]\.?|leden sonra|gece yars|le|(sabah||akam|gece)(leyin))/i},BK={any:{am:/^\.?\.?/i,pm:/^\.?s\.?/i,midnight:/^(gy|gece yars)/i,noon:/^/i,morning:/^sa/i,afternoon:/^leden sonra/i,evening:/^ak/i,night:/^ge/i}},zK={ordinalNumber:oS({matchPattern:AK,parsePattern:_K,valueCallback:function(e){return parseInt(e,10)}}),era:Tl({matchPatterns:CK,defaultMatchWidth:"wide",parsePatterns:FK,defaultParseWidth:"any"}),quarter:Tl({matchPatterns:DK,defaultMatchWidth:"wide",parsePatterns:RK,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Tl({matchPatterns:MK,defaultMatchWidth:"wide",parsePatterns:PK,defaultParseWidth:"any"}),day:Tl({matchPatterns:OK,defaultMatchWidth:"wide",parsePatterns:IK,defaultParseWidth:"any"}),dayPeriod:Tl({matchPatterns:LK,defaultMatchWidth:"any",parsePatterns:BK,defaultParseWidth:"any"})},rh={code:"tr",formatDistance:hK,formatLong:gK,formatRelative:yK,localize:TK,match:zK,options:{weekStartsOn:1,firstWeekContainsDate:1}};function UK(){var A,D,W,re,U,M,Y,Q,B,V,P;const[e,t]=b.useState(!0),[r,a]=b.useState([]),[s,i]=b.useState(null),[l,o]=b.useState(!1),[c,d]=b.useState([]),[u,f]=b.useState([]),[h,m]=b.useState({}),[x,p]=b.useState({}),[g,y]=b.useState(null),[N,v]=b.useState(!1),[S,_]=b.useState(!1);b.useEffect(()=>{F(),k(!0)},[]);const F=async()=>{try{const[T,R]=await Promise.all([ul.getAllCompanies(),ul.getAllUsers()]);d(T),f(R)}catch(T){console.error("Metadata fetch error:",T)}},k=async(T=!1)=>{try{t(!0);const R=await m1.getAllOffers(T?x:h,T?null:s);T?(a(R.offers),m(x)):a(L=>[...L,...R.offers]),i(R.lastVisible),o(R.offers.length===25)}catch(R){console.error("Fetch offers error:",R),xe.error("Teklifler yklenemedi")}finally{t(!1)}},j=()=>{k(!0)},w=async T=>{try{_(!0),v(!0);const R=await m1.getOfferDetail(T.id);y(R)}catch{xe.error("Detaylar yklenemedi")}finally{_(!1)}},E=T=>{switch(T){case"approved":return n.jsx(ut,{className:"bg-status-success/10 text-status-success border-status-success/20",children:"Onayland"});case"rejected":return n.jsx(ut,{className:"bg-status-error/10 text-status-error border-status-error/20",children:"Reddedildi"});case"pending_approval":return n.jsx(ut,{className:"bg-status-warning/10 text-status-warning border-status-warning/20",children:"Onay Bekliyor"});default:return n.jsx(ut,{variant:"secondary",children:"Taslak"})}};return n.jsxs("div",{className:"space-y-6 animate-in fade-in duration-500",children:[n.jsx("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-semibold text-text-primary",children:"Tm Teklifler"}),n.jsx("p",{className:"text-sm text-text-secondary mt-1",children:"Sistem genelindeki tm tekliflerin takibi ve analizi"})]})}),n.jsx(tt,{className:"p-4 bg-white border-border-light shadow-sm",children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 xl:grid-cols-6 gap-4",children:[n.jsxs("div",{className:"space-y-1.5",children:[n.jsx("label",{className:"text-[10px] font-bold text-text-tertiary uppercase ml-1",children:"irket"}),n.jsxs(jo,{onValueChange:T=>p(R=>({...R,companyCode:T==="all"?void 0:T})),defaultValue:"all",children:[n.jsx(So,{className:"h-9",children:n.jsx(Eo,{placeholder:"Tm irketler"})}),n.jsxs(To,{children:[n.jsx(_n,{value:"all",children:"Tm irketler"}),c.map(T=>n.jsx(_n,{value:T.id,children:T.name},T.id))]})]})]}),n.jsxs("div",{className:"space-y-1.5",children:[n.jsx("label",{className:"text-[10px] font-bold text-text-tertiary uppercase ml-1",children:"Kullanc"}),n.jsxs(jo,{onValueChange:T=>p(R=>({...R,userUid:T==="all"?void 0:T})),defaultValue:"all",children:[n.jsx(So,{className:"h-9",children:n.jsx(Eo,{placeholder:"Tm Kullanclar"})}),n.jsxs(To,{children:[n.jsx(_n,{value:"all",children:"Tm Kullanclar"}),u.map(T=>n.jsx(_n,{value:T.id,children:T.name||T.email},T.id))]})]})]}),n.jsxs("div",{className:"space-y-1.5",children:[n.jsx("label",{className:"text-[10px] font-bold text-text-tertiary uppercase ml-1",children:"Min Tutar ()"}),n.jsx(ze,{type:"number",placeholder:"0",className:"h-9",onChange:T=>p(R=>({...R,minPrice:T.target.value?Number(T.target.value):void 0}))})]}),n.jsxs("div",{className:"space-y-1.5",children:[n.jsx("label",{className:"text-[10px] font-bold text-text-tertiary uppercase ml-1",children:"Max Tutar ()"}),n.jsx(ze,{type:"number",placeholder:"999...",className:"h-9",onChange:T=>p(R=>({...R,maxPrice:T.target.value?Number(T.target.value):void 0}))})]}),n.jsx("div",{className:"flex items-end lg:col-span-2 xl:col-span-2",children:n.jsxs(Re,{className:"w-full bg-[var(--burgundy)] hover:bg-[var(--burgundy-hover)] text-white h-9",onClick:j,disabled:e,children:[e?n.jsx(Ar,{className:"animate-spin mr-2",size:16}):n.jsx(U1,{size:16,className:"mr-2"}),"Filtrele"]})})]})}),n.jsxs(tt,{className:"overflow-hidden border-border-light shadow-sm",children:[n.jsxs(hn,{children:[n.jsx(mn,{className:"bg-slate-50",children:n.jsxs(zt,{children:[n.jsx(Ve,{className:"w-[120px]",children:"Teklif ID"}),n.jsx(Ve,{children:"irket Kodu"}),n.jsx(Ve,{children:"Mteri / Balk"}),n.jsx(Ve,{children:"Oluturan"}),n.jsx(Ve,{className:"text-right",children:"Toplam Tutar"}),n.jsx(Ve,{className:"text-right",children:"m Fiyat"}),n.jsx(Ve,{children:"Tarih"}),n.jsx(Ve,{children:"Durum"}),n.jsx(Ve,{className:"w-[80px] text-center",children:"lem"})]})}),n.jsx(xn,{children:r.length===0&&!e?n.jsx(zt,{children:n.jsx(Oe,{colSpan:9,className:"h-64 text-center text-text-tertiary",children:n.jsxs("div",{className:"flex flex-col items-center gap-2",children:[n.jsx(ph,{size:32,className:"opacity-20"}),n.jsx("p",{children:"Teklif bulunamad"})]})})}):r.map(T=>{var R,L;return n.jsxs(zt,{className:"group hover:bg-slate-50 transition-colors cursor-pointer",onClick:()=>w(T),children:[n.jsx(Oe,{className:"font-mono text-xs font-semibold",children:T.id}),n.jsx(Oe,{className:"text-text-secondary",children:T.companyCode}),n.jsx(Oe,{children:n.jsxs("div",{className:"flex flex-col",children:[n.jsx("span",{className:"font-medium text-text-primary",children:T.customerName}),n.jsx("span",{className:"text-[10px] text-text-tertiary truncate max-w-[150px]",children:T.title||"-"})]})}),n.jsx(Oe,{className:"text-sm",children:T.createdByName||"Anonim"}),n.jsxs(Oe,{className:"text-right font-bold text-[var(--burgundy)]",children:["",Number(T.toplamTutar||T.amount||0).toLocaleString("tr-TR",{minimumFractionDigits:2})]}),n.jsxs(Oe,{className:"text-right font-mono text-xs text-text-secondary",children:["",((L=(R=T.payload)==null?void 0:R.pricePerM2)==null?void 0:L.toFixed(2))||"-"]}),n.jsx(Oe,{className:"text-xs text-text-tertiary",children:T.createdAt?fd(T.createdAt.toDate(),"dd MMM yyyy",{locale:rh}):"-"}),n.jsx(Oe,{children:E(T.status)}),n.jsx(Oe,{className:"text-center",children:n.jsx(Re,{variant:"ghost",size:"icon",className:"h-8 w-8 opacity-0 group-hover:opacity-100 transition-opacity",children:n.jsx(uo,{size:14})})})]},T.id)})})]}),l&&n.jsx("div",{className:"p-4 border-t border-border-light text-center",children:n.jsxs(Re,{variant:"ghost",size:"sm",onClick:()=>k(!1),disabled:e,className:"text-[var(--burgundy)]",children:[e?n.jsx(Ar,{className:"animate-spin mr-2",size:14}):null,"Daha Fazla Ykle"]})})]}),n.jsx(aK,{open:N,onOpenChange:v,children:n.jsx(lK,{className:"max-h-[85vh]",children:n.jsxs("div",{className:"mx-auto w-full max-w-4xl overflow-y-auto p-6 scrollbar-hide",children:[n.jsx(oK,{className:"px-0 pt-0",children:S?n.jsxs("div",{className:"flex flex-col items-center justify-center py-20 gap-4",children:[n.jsx(Ar,{className:"animate-spin text-[var(--burgundy)]",size:40}),n.jsx("p",{className:"text-text-secondary animate-pulse",children:"Teklif detaylar indiriliyor..."})]}):g?n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"p-2 bg-[var(--burgundy-light)] rounded-lg text-[var(--burgundy)]",children:n.jsx(ma,{size:24})}),n.jsxs("div",{children:[n.jsx(dK,{className:"text-2xl font-bold",children:g.id}),n.jsxs(uK,{children:[g.customerName," | ",g.title||"Proje Teklifi"]})]})]}),n.jsxs("div",{className:"text-right",children:[n.jsx("div",{className:"text-sm font-bold text-text-tertiary uppercase tracking-widest mb-1",children:"Toplam Tutar"}),n.jsxs("div",{className:"text-3xl font-black text-[var(--burgundy)]",children:["",Number(g.toplamTutar||g.amount).toLocaleString("tr-TR",{minimumFractionDigits:2})]})]})]}),n.jsx(VK,{className:"my-6"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{children:[n.jsxs("h4",{className:"text-xs font-black text-text-tertiary uppercase tracking-widest mb-3 flex items-center gap-2",children:[n.jsx(L1,{size:14})," Sistem Bilgileri"]}),n.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl space-y-3 border border-slate-100",children:[n.jsxs("div",{className:"flex justify-between items-center text-sm",children:[n.jsxs("span",{className:"text-text-secondary flex items-center gap-2",children:[n.jsx(tl,{size:14})," irket"]}),n.jsxs("span",{className:"font-bold text-text-primary",children:[g.companyName," (",g.companyCode,")"]})]}),n.jsxs("div",{className:"flex justify-between items-center text-sm",children:[n.jsxs("span",{className:"text-text-secondary flex items-center gap-2",children:[n.jsx(gh,{size:14})," Oluturan"]}),n.jsx("span",{className:"font-bold text-text-primary",children:g.createdByName})]}),n.jsxs("div",{className:"flex justify-between items-center text-sm",children:[n.jsxs("span",{className:"text-text-secondary flex items-center gap-2",children:[n.jsx(Xd,{size:14})," Tarih"]}),n.jsx("span",{className:"font-bold text-text-primary",children:g.createdAt?fd(g.createdAt.toDate(),"dd MMMM yyyy HH:mm",{locale:rh}):"-"})]}),n.jsxs("div",{className:"flex justify-between items-center text-sm",children:[n.jsxs("span",{className:"text-text-secondary flex items-center gap-2",children:[n.jsx(hs,{size:14})," Abonelik Plan"]}),n.jsx(ut,{variant:"outline",className:"font-bold uppercase border-[var(--burgundy)]/20 text-[var(--burgundy)] bg-[var(--burgundy-light)]/10",children:g.planType})]})]})]}),n.jsxs("div",{children:[n.jsxs("h4",{className:"text-xs font-black text-text-tertiary uppercase tracking-widest mb-3 flex items-center gap-2",children:[n.jsx(B1,{size:14})," Fiyatlandrma Krlm"]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between text-sm p-2 hover:bg-slate-50 rounded-lg",children:[n.jsx("span",{className:"text-text-secondary",children:"Kat Kalitesi"}),n.jsx("span",{className:"font-bold",children:((A=g.payload)==null?void 0:A.qualityName)||((D=g.payload)==null?void 0:D.paperQuality)||g.paperQuality||"-"})]}),n.jsxs("div",{className:"flex justify-between text-sm p-2 hover:bg-slate-50 rounded-lg",children:[n.jsx("span",{className:"text-text-secondary",children:"m Ham Fiyat"}),n.jsxs("span",{className:"font-bold",children:["",(((W=g.payload)==null?void 0:W.pricePerM2)||g.pricePerM2||0).toFixed(2)]})]}),n.jsxs("div",{className:"flex justify-between text-sm p-2 hover:bg-slate-50 rounded-lg",children:[n.jsx("span",{className:"text-text-secondary",children:"Kr Marj"}),n.jsxs("span",{className:"font-bold text-emerald-600",children:["%",(re=g.payload)==null?void 0:re.profitMargin]})]}),n.jsxs("div",{className:"flex justify-between text-sm p-2 bg-emerald-50 rounded-lg text-emerald-700",children:[n.jsx("span",{className:"font-medium",children:"Birim Sat Fiyat"}),n.jsxs("span",{className:"font-black font-mono",children:["",(((U=g.payload)==null?void 0:U.birimSatisFiyati)||g.birimSatisFiyati||0).toFixed(2)]})]})]})]})]}),n.jsx("div",{className:"space-y-6",children:(M=g.id)!=null&&M.startsWith("TKT-")?n.jsxs("div",{children:[n.jsxs("h4",{className:"text-xs font-black text-text-tertiary uppercase tracking-widest mb-3 flex items-center gap-2",children:[n.jsx(cn,{size:14})," Kalem Listesi"]}),n.jsx("div",{className:"space-y-2 max-h-[300px] overflow-y-auto pr-2",children:(Y=g.lineItems)==null?void 0:Y.map((T,R)=>n.jsxs("div",{className:"p-3 bg-slate-50 border border-slate-100 rounded-lg flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("div",{className:"font-bold text-sm text-slate-800",children:T.label||`Kalem ${R+1}`}),n.jsxs("div",{className:"text-xs text-slate-500",children:[T.L,"",T.W,"",T.H,"mm  ",T.qualityName]}),n.jsxs("div",{className:"text-[10px] text-slate-400 mt-1 font-mono",children:["m Fiyat: ",(T.pricePerM2||0).toFixed(2)]})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("div",{className:"font-bold text-[var(--burgundy)]",children:["",(T.finalCustomerTotal||0).toLocaleString("tr-TR",{minimumFractionDigits:2})]}),n.jsxs("div",{className:"text-xs text-slate-500",children:[T.quantity," Adet"]})]})]},R))}),n.jsxs("div",{className:"mt-2 p-3 bg-slate-50 rounded-xl border border-slate-100 flex justify-between items-center px-4",children:[n.jsx("span",{className:"text-xs font-bold text-text-tertiary",children:"TOPLAM ADET"}),n.jsx("span",{className:"text-xl font-black text-slate-800",children:g.itemCount||0})]})]}):n.jsxs("div",{children:[n.jsxs("h4",{className:"text-xs font-black text-text-tertiary uppercase tracking-widest mb-3 flex items-center gap-2",children:[n.jsx(cn,{size:14})," Teknik ller"]}),n.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[n.jsxs("div",{className:"p-3 bg-slate-50 rounded-xl border border-slate-100 text-center",children:[n.jsx("span",{className:"text-[10px] text-text-tertiary block mb-1",children:"MAMUL L"}),n.jsx("span",{className:"font-bold text-lg",children:((Q=g.payload)==null?void 0:Q.L)||g.length||"-"})]}),n.jsxs("div",{className:"p-3 bg-slate-50 rounded-xl border border-slate-100 text-center",children:[n.jsx("span",{className:"text-[10px] text-text-tertiary block mb-1",children:"MAMUL W"}),n.jsx("span",{className:"font-bold text-lg",children:((B=g.payload)==null?void 0:B.W)||g.width||"-"})]}),n.jsxs("div",{className:"p-3 bg-slate-50 rounded-xl border border-slate-100 text-center",children:[n.jsx("span",{className:"text-[10px] text-text-tertiary block mb-1",children:"MAMUL H"}),n.jsx("span",{className:"font-bold text-lg",children:((V=g.payload)==null?void 0:V.H)||g.height||"-"})]})]}),n.jsxs("div",{className:"mt-2 p-3 bg-slate-50 rounded-xl border border-slate-100 flex justify-between items-center px-4",children:[n.jsx("span",{className:"text-xs font-bold text-text-tertiary",children:"ADET"}),n.jsx("span",{className:"text-xl font-black text-slate-800",children:((P=g.payload)==null?void 0:P.quantity)||g.quantity||0})]})]})})]}),(g.customerNotes||g.specialRequirements)&&n.jsxs("div",{className:"mt-8 grid grid-cols-1 md:grid-cols-2 gap-4",children:[g.customerNotes&&n.jsxs("div",{className:"p-4 bg-yellow-50/50 rounded-xl border border-yellow-100",children:[n.jsx("span",{className:"text-[10px] uppercase font-bold text-yellow-700 block mb-1",children:"Mteri Notlar"}),n.jsxs("p",{className:"text-xs text-slate-600 leading-relaxed italic",children:['"',g.customerNotes,'"']})]}),g.specialRequirements&&n.jsxs("div",{className:"p-4 bg-sky-50/50 rounded-xl border border-sky-100",children:[n.jsx("span",{className:"text-[10px] uppercase font-bold text-sky-700 block mb-1",children:"zel Gereksinimler"}),n.jsxs("p",{className:"text-xs text-slate-600 leading-relaxed italic",children:['"',g.specialRequirements,'"']})]})]})]}):null}),n.jsx(cK,{className:"px-0",children:n.jsx(sK,{asChild:!0,children:n.jsx(Re,{variant:"outline",className:"w-full h-11",children:"Kapat"})})})]})})})]})}const VK=({className:e})=>n.jsx("div",{className:`h-[1px] bg-slate-200 ${e}`});function HK(){const e=ca();return n.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-8rem)]",children:n.jsxs(tt,{className:"p-12 max-w-md text-center",children:[n.jsx("div",{className:"w-16 h-16 rounded-lg bg-surface-secondary flex items-center justify-center mx-auto mb-6",children:n.jsx(PE,{size:32,strokeWidth:1.5,className:"text-text-secondary"})}),n.jsx("h1",{className:"text-2xl font-semibold text-text-primary mb-3",children:"Sayfa Bulunamad"}),n.jsx("p",{className:"text-sm text-text-secondary mb-8",children:"Aradnz sayfa mevcut deil veya tanm olabilir."}),n.jsx(Re,{onClick:()=>e("/dashboard"),className:"bg-[var(--burgundy)] hover:bg-[var(--burgundy-hover)] text-white",children:"Ana Sayfaya Dn"})]})})}function $K(){var y,N;const[e]=b.useState("bireysel"),[t,r]=b.useState(""),[a,s]=b.useState(""),[i,l]=b.useState(""),[o,c]=b.useState(!1),{login:d,isThrottled:u,user:f,loading:h}=vr(),m=ca(),p=((N=(y=ga().state)==null?void 0:y.from)==null?void 0:N.pathname)||"/";b.useEffect(()=>{!h&&f&&m("/",{replace:!0})},[f,h,m]);const g=async v=>{if(v.preventDefault(),!t||!a){xe.error("Ltfen e-posta ve ifrenizi girin.");return}if(e==="kurumsal"&&!i){xe.error("Ltfen firma kodunu girin.");return}if(u){xe.error("ok fazla deneme yapld. Ltfen bekleyin.");return}try{c(!0),await d(t,a,e,i),xe.success("Giri baarl"),m(p,{replace:!0})}catch(S){console.error(S),S.message?xe.error(S.message):S.code==="auth/invalid-credential"?xe.error("Hatal e-posta veya ifre"):S.code==="auth/too-many-requests"?xe.error("Bu cihazdan ok fazla deneme yapld. Ltfen daha sonra tekrar deneyin."):xe.error("Giri yaplrken bir hata olutu")}finally{c(!1)}};return n.jsxs("div",{className:"min-h-screen flex w-full",children:[n.jsx(au,{position:"top-right"}),n.jsxs("div",{className:"hidden lg:flex w-1/2 bg-[#1A1D1F] p-12 flex-col justify-between relative overflow-hidden",children:[n.jsx("div",{className:"absolute top-0 right-0 w-full h-full bg-[radial-gradient(circle_at_100%_0%,#80002030,transparent)]"}),n.jsx("div",{className:"relative z-10",children:n.jsx("div",{className:"flex items-center gap-3",children:n.jsx("img",{src:ps,alt:"Ulgen One Logo",className:"h-[6rem] lg:h-[8rem] w-auto brightness-0 invert"})})}),n.jsxs("div",{className:"relative z-10 space-y-8 mb-24",children:[n.jsxs("h1",{className:"text-5xl lg:text-7xl font-black text-white tracking-tighter uppercase leading-none",children:["MATEMATKSEL ",n.jsx("br",{}),"HASSASYET ",n.jsx("br",{}),n.jsx("span",{className:"text-white/40",children:"SSTEME GR"})]}),n.jsx("p",{className:"text-xl text-white/70 font-medium max-w-lg leading-relaxed",children:"B2B retim srelerinizi milimetrik hassasiyetle ynetin."})]}),n.jsx("div",{className:"relative z-10",children:n.jsx("p",{className:"text-xs text-white/30 font-bold tracking-widest uppercase",children:" 2026 ULGEN ONE INDUSTRIAL SYSTEMS"})})]}),n.jsx("div",{className:"flex-1 flex items-center justify-center p-8 lg:p-16 bg-[#FAFBFC] overflow-y-auto",children:n.jsxs("div",{className:"w-full max-w-md space-y-10",children:[n.jsx("div",{className:"flex items-center gap-3 lg:hidden -ml-2",children:n.jsx("img",{src:ps,alt:"Ulgen One Logo",className:"h-[5rem] sm:h-[6rem] w-auto"})}),n.jsxs("div",{className:"space-y-3",children:[n.jsx("h2",{className:"text-3xl font-black tracking-tighter uppercase text-[#1A1D1F]",children:"Sisteme Giri"}),n.jsx("p",{className:"text-sm font-medium text-muted-foreground leading-relaxed",children:"Ltfen devam etmek iin kurumsal hesap bilgilerinizi girin."})]}),n.jsxs("form",{onSubmit:g,className:"space-y-6",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(et,{htmlFor:"email",className:"font-bold text-[#1A1D1F]",children:"E-posta Adresi"}),n.jsx(ze,{id:"email",type:"email",placeholder:"ornek@sirket.com",value:t,onChange:v=>r(v.target.value),disabled:o||u,className:"h-12 border-2 border-border/70 rounded-md bg-white text-sm"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx(et,{htmlFor:"password",className:"font-bold text-[#1A1D1F]",children:"ifre"}),n.jsx(At,{to:"/forgot-password",className:"text-xs font-bold text-[#800020] hover:underline",children:"ifremi unuttum"})]}),n.jsx(ze,{id:"password",type:"password",placeholder:"",value:a,onChange:v=>s(v.target.value),disabled:o||u,className:"h-12 border-2 border-border/70 rounded-md bg-white text-sm"})]}),e==="kurumsal"&&n.jsxs("div",{className:"space-y-2 animate-in fade-in slide-in-from-top-1 duration-200",children:[n.jsx(et,{htmlFor:"companyCode",className:"font-bold text-[#1A1D1F]",children:"Firma Kodu"}),n.jsx(ze,{id:"companyCode",placeholder:"RN-XXXXX",value:i,onChange:v=>l(v.target.value.toUpperCase()),disabled:o||u,className:"h-12 border-2 border-border/70 rounded-md bg-white uppercase text-sm"})]}),n.jsx("div",{className:"pt-4",children:n.jsx(Re,{type:"submit",className:"w-full h-14 bg-[#1A1D1F] hover:bg-black text-white font-black uppercase tracking-widest text-xs rounded-sm shadow-xl flex items-center justify-center gap-3 transition-all active:scale-[0.98]",disabled:o||u,children:o?n.jsxs(n.Fragment,{children:[n.jsx(Ar,{className:"h-4 w-4 animate-spin"}),"Giri Yaplyor..."]}):n.jsxs(n.Fragment,{children:[n.jsx(OE,{className:"h-4 w-4"}),"Sisteme Giri Yap"]})})})]}),n.jsxs("div",{className:"pt-8 border-t border-border/50 text-center text-sm font-medium",children:[n.jsx("span",{className:"text-muted-foreground text-xs uppercase tracking-widest mr-2",children:"Hesabnz yok mu?"}),n.jsx(At,{to:"/register",className:"text-[#1A1D1F] font-black uppercase tracking-widest text-xs hover:text-[#800020] transition-colors",children:"Kayt Olun"})]})]})})]})}function KK(e){if(!e)return null;let t=e.replace(/[^\d+]/g,"");return t.startsWith("+90")?t=t.substring(3):t.startsWith("90")?t=t.substring(2):t.startsWith("0")&&(t=t.substring(1)),t.length!==10?null:`+90${t}`}function WK(){const[e]=b.useState("individual"),[t,r]=b.useState(""),[a,s]=b.useState(""),[i,l]=b.useState(""),[o,c]=b.useState(""),[d,u]=b.useState(""),[f,h]=b.useState(!1),{register:m,user:x,loading:p}=vr(),g=ca();b.useEffect(()=>{!p&&x&&!f&&g("/dashboard",{replace:!0})},[x,p,g,f]);const y=async N=>{if(N.preventDefault(),!t||!a||!i||!o){xe.error("Ltfen zorunlu alanlar doldurun.");return}if(i.length<6){xe.error("ifre en az 6 karakter olmaldr.");return}const v=KK(o);if(!v){xe.error("Ltfen geerli bir telefon numaras girin (rn: 05551234567 veya +905551234567)");return}if(e==="corporate"&&!d){xe.error("Firma ad zorunludur.");return}try{h(!0),await m({email:a,password:i,fullName:t,phoneNumber:v,accountType:e,companyName:e==="corporate"?d:void 0}),xe.success("Hesabnz oluturuldu, ynlendiriliyorsunuz..."),g("/dashboard")}catch(S){console.error(S),S.code==="auth/email-already-in-use"?xe.error("Bu e-posta adresi zaten kullanmda."):xe.error(S.message||"Kayt olurken bir hata olutu.")}finally{h(!1)}};return n.jsxs("div",{className:"min-h-screen flex w-full",children:[n.jsx(au,{position:"top-right"}),n.jsxs("div",{className:"hidden lg:flex w-1/2 bg-[#1A1D1F] p-12 flex-col justify-between relative overflow-hidden",children:[n.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-[radial-gradient(circle_at_0%_100%,#80002030,transparent)]"}),n.jsx("div",{className:"relative z-10 flex justify-end",children:n.jsx("div",{className:"flex items-center gap-3",children:n.jsx("img",{src:ps,alt:"Ulgen One Logo",className:"h-[6rem] lg:h-[8rem] w-auto brightness-0 invert"})})}),n.jsxs("div",{className:"relative z-10 space-y-8 mb-24",children:[n.jsx("span",{className:"text-[#10B981] font-black tracking-widest text-xs uppercase bg-[#10B981]/10 px-3 py-1.5 rounded-sm",children:"YEN YELK"}),n.jsxs("h1",{className:"text-5xl lg:text-7xl font-black text-white tracking-tighter uppercase leading-none",children:["ENDSTRYEL ",n.jsx("br",{}),"DNM ",n.jsx("br",{}),n.jsx("span",{className:"text-white/40",children:"BALIYOR"})]}),n.jsxs("div",{className:"max-w-md space-y-6 pt-8",children:[n.jsxs("div",{className:"flex items-start gap-4 p-4 border border-white/10 rounded-md bg-white/5",children:[n.jsx(Ws,{className:"text-[#10B981] mt-1 shrink-0",size:20}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-white font-bold text-sm",children:"Hassas Saysal Optimizasyon"}),n.jsx("p",{className:"text-white/60 text-xs mt-1 leading-relaxed",children:"Milimetrik safiha analizi ile retim firelerini %2'nin altna indirin."})]})]}),n.jsxs("div",{className:"flex items-start gap-4 p-4 border border-white/10 rounded-md bg-white/5",children:[n.jsx(Ws,{className:"text-[#10B981] mt-1 shrink-0",size:20}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-white font-bold text-sm",children:"Dinamik Teklif Robotu"}),n.jsx("p",{className:"text-white/60 text-xs mt-1 leading-relaxed",children:"Binlerce kombinasyonu saniyeler iinde hesaplayp API ile PDF'e dkn."})]})]})]})]}),n.jsx("div",{className:"relative z-10",children:n.jsx("p",{className:"text-xs text-white/30 font-bold tracking-widest uppercase",children:" 2026 ULGEN ONE INDUSTRIAL SYSTEMS"})})]}),n.jsx("div",{className:"flex-1 flex items-center justify-center p-8 lg:p-12 bg-[#FAFBFC] overflow-y-auto",children:n.jsxs("div",{className:"w-full max-w-md space-y-10",children:[n.jsx("div",{className:"flex items-center gap-3 lg:hidden -ml-2",children:n.jsx("img",{src:ps,alt:"Ulgen One Logo",className:"h-[5rem] sm:h-[6rem] w-auto"})}),n.jsxs("div",{className:"space-y-3",children:[n.jsx("h2",{className:"text-3xl font-black tracking-tighter uppercase text-[#1A1D1F]",children:"Hesap Olutur"}),n.jsx("p",{className:"text-sm font-medium text-muted-foreground leading-relaxed",children:"Sistem eriimi iin kurumsal bilgilerinizi tanmlayn."})]}),n.jsxs("form",{onSubmit:y,className:"space-y-5",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(et,{htmlFor:"fullName",className:"font-bold text-[#1A1D1F]",children:"Ad Soyad"}),n.jsx(ze,{id:"fullName",value:t,onChange:N=>r(N.target.value),disabled:f,required:!0,className:"h-12 border-2 border-border/70 rounded-md bg-white text-sm"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(et,{htmlFor:"email",className:"font-bold text-[#1A1D1F]",children:"E-posta Adresi"}),n.jsx(ze,{id:"email",type:"email",value:a,onChange:N=>s(N.target.value),disabled:f,required:!0,className:"h-12 border-2 border-border/70 rounded-md bg-white text-sm"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(et,{htmlFor:"phoneNumber",className:"font-bold text-[#1A1D1F]",children:"Telefon Numaras"}),n.jsx(ze,{id:"phoneNumber",placeholder:"05XX XXX XX XX",value:o,onChange:N=>c(N.target.value),disabled:f,required:!0,className:"h-12 border-2 border-border/70 rounded-md bg-white text-sm"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(et,{htmlFor:"password",className:"font-bold text-[#1A1D1F]",children:"ifre"}),n.jsx(ze,{id:"password",type:"password",value:i,onChange:N=>l(N.target.value),disabled:f,required:!0,className:"h-12 border-2 border-border/70 rounded-md bg-white text-sm"}),n.jsx("p",{className:"text-[10px] uppercase tracking-widest font-bold text-muted-foreground",children:"Min. 6 Karakter"})]}),e==="corporate"&&n.jsxs("div",{className:"space-y-2 animate-in fade-in slide-in-from-top-1 duration-200 pt-2 border-t border-border/50",children:[n.jsx(et,{htmlFor:"companyName",className:"font-bold text-[#1A1D1F]",children:"Firma Ad"}),n.jsx(ze,{id:"companyName",value:d,onChange:N=>u(N.target.value),disabled:f,required:!0,className:"h-12 border-2 border-border/70 rounded-md bg-white text-sm"})]}),n.jsx("div",{className:"pt-6",children:n.jsx(Re,{type:"submit",className:"w-full h-14 bg-[#1A1D1F] hover:bg-black text-white font-black uppercase tracking-widest text-xs rounded-sm shadow-xl flex items-center justify-center gap-3 transition-all active:scale-[0.98]",disabled:f,children:f?n.jsxs(n.Fragment,{children:[n.jsx(Ar,{className:"h-4 w-4 animate-spin"}),"Hesap Oluturuluyor..."]}):n.jsxs(n.Fragment,{children:[n.jsx(z1,{className:"h-4 w-4"}),"Sisteme Kayt Ol"]})})})]}),n.jsxs("div",{className:"pt-8 border-t border-border/50 text-center text-sm font-medium",children:[n.jsx("span",{className:"text-muted-foreground text-xs uppercase tracking-widest mr-2",children:"Zaten hesabnz var m?"}),n.jsx(At,{to:"/login",className:"text-[#1A1D1F] font-black uppercase tracking-widest text-xs hover:text-[#800020] transition-colors",children:"Sisteme Giri Yap"})]})]})})]})}const GK={individual:{id:"pro_individual",name:"Ulgen One Pro",baseMonthlyPrice:1790,periods:[{id:1,label:"1 Ay",netPrice:1790,tag:""},{id:6,label:"6 Ay",netPrice:1590,tag:"%11 ndirim"},{id:12,label:"1 Yl",netPrice:1390,tag:"En yi Fiyat"}],features:["Snrsz teklif oluturma","Snrsz maliyet ve break-even analizleri","Mteriye zel logo eklemeli PDF dkmleri","ncelikli mhendislik ve yazlm destei"]},corporate:{id:"pro_corporate",name:"Corporate Pro",baseMonthlyPrice:4850,periods:[{id:1,label:"1 Ay",netPrice:4850,tag:""},{id:6,label:"6 Ay",netPrice:3977,tag:"%18 ndirim"},{id:12,label:"1 Yl",netPrice:2958,tag:"En yi Fiyat"}],features:["Tm departmanda limitsiz teklif oluturma imkan","oklu onay mekanizmas ve rol tabanl yetkilendirme","Detayl irket ii perofmans, teklif ve analiz istatistikleri","irkete dedike edilen zel telefon ve e-posta destei","Toplu analiz ve fiyat gncelleme (CSV/Excel) aralar"]}};function YK(){const{userProfile:e,user:t}=vr(),[r,a]=b.useState(!1),[s,i]=b.useState(null);if(!e)return null;const l=e.accountType==="corporate"?"corporate":"individual",o=GK[l],c=async d=>{a(!0);try{const u=await fetch("https://YOUR_REGION-YOUR_PROJECT_ID.cloudfunctions.net/createPayTRToken",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:t==null?void 0:t.uid,accountType:l,period:d})});if(!u.ok)throw new Error("Sunucu hatas: deme oturumu balatlamad.");const f=await u.json();if(f.paytr_token){if(i(f.paytr_token),!document.getElementById("paytr-iframe-resizer")){const h=document.createElement("script");h.src="https://www.paytr.com/js/iframeResizer.min.js",h.id="paytr-iframe-resizer",document.body.appendChild(h),h.onload=()=>{window.iFrameResize&&window.iFrameResize({},"#paytriframe")}}}else if(f.url)window.location.href=f.url;else throw new Error("Geersiz yant: deme tokeni bulunamad.")}catch(u){console.error("Checkout validation error:",u),xe.error("deme ilemi balatlamad. Ltfen tekrar deneyin.")}finally{a(!1)}};return s?n.jsx("div",{className:"w-full flex-1 flex flex-col items-center justify-start pt-10 pb-20 px-4 min-h-full",children:n.jsxs("div",{className:"max-w-4xl w-full",children:[n.jsxs(Re,{variant:"outline",onClick:()=>i(null),className:"mb-6 h-10 px-6 font-semibold flex items-center gap-2 text-text-secondary hover:text-text-primary",children:[n.jsx(Ta,{className:"w-4 h-4 rotate-180"})," Fiyatlandrma Planlarna Dn"]}),n.jsx(tt,{className:"shadow-2xl border-border bg-surface rounded-2xl overflow-hidden ring-1 ring-border p-2",children:n.jsx("iframe",{src:`https://www.paytr.com/odeme/guvenli/${s}`,id:"paytriframe",frameBorder:"0",scrolling:"yes",className:"w-full min-h-[650px] rounded-xl"})}),n.jsx("div",{className:"mt-8 flex justify-center",children:n.jsxs("div",{className:"flex items-center gap-2 text-xs font-semibold text-text-tertiary",children:[n.jsx(hs,{size:16,className:"text-emerald-500"}),n.jsx("span",{children:"256-Bit SSL Koruma"}),n.jsx("span",{className:"text-border mx-1",children:""}),n.jsx(Xr,{size:16,className:"text-emerald-500"}),n.jsx("span",{children:"deme annda annda hesabnza Pro tanmlanr."})]})})]})}):n.jsxs("div",{className:"w-full flex flex-col min-h-full pb-20",children:[n.jsxs("div",{className:"relative bg-gradient-to-b from-surface to-background w-full pt-20 pb-16 px-6 text-center shadow-sm border-b border-border",children:[n.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:n.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-[600px] h-[300px] bg-[var(--burgundy)]/5 rounded-full blur-3xl"})}),n.jsxs("div",{className:"relative z-10 max-w-3xl mx-auto flex flex-col items-center",children:[n.jsxs(ut,{variant:"secondary",className:"mb-6 px-4 py-1 text-sm bg-[var(--burgundy)]/10 text-[var(--burgundy)] border-none",children:[n.jsx(Xr,{className:"w-4 h-4 mr-2"})," Profesyonel retime Gei"]}),n.jsxs("h1",{className:"text-4xl md:text-5xl lg:text-6xl font-black text-text-primary tracking-tight mb-6 leading-tight",children:["retim Analizinde ",n.jsx("br",{})," ",n.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-[var(--burgundy)] to-red-500",children:"Snrlar Kaldrn"})]}),n.jsx("p",{className:"text-text-secondary text-lg md:text-xl max-w-2xl mb-10 leading-relaxed",children:l==="corporate"?"Kurumsal ekibinizin analiz gcn en st seviyeye tayn. Tm kotalar an, derinlemesine teknik analizlere ve ncelikli donanm optimizasyonlarna annda eriin.":"Hesaplama kotalarndan kurtulun. Hzl, kesintisiz teklif ynetimi ve ileri seviye raporlama aralaryla sat potansiyelinizi maksimize edin."})]})]}),n.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 w-full mt-10 grid grid-cols-1 md:grid-cols-3 gap-8 items-stretch pt-8 border-t border-border",children:o.periods.map(d=>{const u=d.id===12,f=d.netPrice,h=f*d.id,m=o.baseMonthlyPrice-f;return n.jsxs("div",{className:"relative flex flex-col h-full mt-4 md:mt-0",children:[u&&n.jsx("div",{className:"absolute -inset-3 bg-gradient-to-b from-[var(--burgundy)] to-transparent opacity-[0.08] blur-xl rounded-[2.5rem] pointer-events-none"}),n.jsxs(tt,{className:`relative flex flex-col shadow-xl border-border bg-surface rounded-2xl overflow-hidden h-full ${u?"ring-2 ring-[var(--burgundy)] scale-100 md:scale-105 z-10":"ring-1 ring-border opacity-90 hover:opacity-100 transition-opacity"}`,children:[d.tag&&n.jsx("div",{className:`text-white text-center py-2 text-xs font-bold tracking-widest uppercase shadow-inner ${u?"bg-[var(--burgundy)]":"bg-status-success/80"}`,children:d.tag}),!d.tag&&n.jsx("div",{className:"py-2 opacity-0 text-xs",children:"-"}),n.jsxs(xd,{className:"p-8 flex flex-col flex-1",children:[n.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[n.jsx("h3",{className:"text-xl font-bold text-text-primary",children:o.name}),n.jsx(ut,{variant:"outline",className:`px-3 py-1 text-sm font-semibold border ${u?"text-[var(--burgundy)] border-[var(--burgundy)]/30 bg-[var(--burgundy)]/5":"text-text-secondary border-border"}`,children:d.label})]}),n.jsxs("div",{className:"mb-8",children:[n.jsxs("div",{className:"flex items-baseline gap-2 mb-2 mt-4",children:[n.jsxs("span",{className:"text-5xl font-black text-text-primary tracking-tight",children:["",f]}),n.jsx("span",{className:"text-text-secondary font-medium text-lg",children:"/ ay"})]}),m>0?n.jsxs("span",{className:"text-sm text-status-success font-semibold",children:["ndirimsiz halinden aylk ",m," avantaj"]}):n.jsx("span",{className:"text-sm text-text-secondary font-medium",children:"Standart Aylk cret"}),n.jsx("p",{className:"text-xs text-text-tertiary mt-2",children:d.id===1?"Aylk periyotlarla yenilenir":`${d.label} pein alnr (Toplam ${h})`})]}),n.jsx("div",{className:"h-px bg-border w-full mb-8"}),n.jsxs("ul",{className:"space-y-4 mb-8 flex-1",children:[o.features.map((x,p)=>n.jsxs("li",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"w-5 h-5 rounded-full bg-status-success/15 text-status-success flex items-center justify-center flex-shrink-0 mt-0.5 shadow-sm",children:n.jsx(Ws,{size:12,strokeWidth:3})}),n.jsx("span",{className:"text-text-primary text-[14px] font-medium leading-snug",children:x})]},p)),n.jsxs("li",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"w-5 h-5 rounded-full bg-status-success/15 text-status-success flex items-center justify-center flex-shrink-0 mt-0.5 shadow-sm",children:n.jsx(Ws,{size:12,strokeWidth:3})}),n.jsx("span",{className:"text-text-primary text-[14px] font-medium leading-snug",children:"Gelimi analitik ve lmleme"})]}),n.jsxs("li",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"w-5 h-5 rounded-full bg-status-success/15 text-status-success flex items-center justify-center flex-shrink-0 mt-0.5 shadow-sm",children:n.jsx(Ws,{size:12,strokeWidth:3})}),n.jsx("span",{className:"text-text-primary text-[14px] font-medium leading-snug",children:"Snrsz sunucu ilem kotas ()"})]})]}),n.jsxs(Re,{onClick:()=>c(d.id),disabled:r,className:`w-full h-12 text-base font-bold text-white shadow-lg transition-all active:scale-[0.98] flex items-center justify-center gap-2 rounded-xl group relative overflow-hidden mt-auto ${u?"bg-[var(--burgundy)] hover:bg-[var(--burgundy-hover)] shadow-[var(--burgundy)]/30":"bg-slate-800 hover:bg-slate-700 shadow-slate-900/20"}`,children:[n.jsx("div",{className:"absolute inset-0 bg-white/20 translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-700 ease-out skew-x-12"}),r?n.jsxs(n.Fragment,{children:[n.jsx(Ar,{className:"h-4 w-4 animate-spin"})," Ynlendiriliyor..."]}):n.jsxs(n.Fragment,{children:["Se ve Ykselt ",n.jsx(Ta,{className:"w-4 h-4 group-hover:translate-x-1 transition-transform"})]})]}),u&&n.jsx("div",{className:"mt-4 flex justify-center",children:n.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-semibold text-text-tertiary",children:[n.jsx(hs,{size:12,className:"text-emerald-500"}),n.jsx("span",{children:"Gvenli deme A"})]})})]})]})]},d.id)})})]})}function Kc({allowedRoles:e}){const{user:t,userRole:r,userProfile:a,loading:s}=vr(),i=ga();return s?n.jsx("div",{className:"flex items-center justify-center h-screen bg-background",children:n.jsxs("div",{className:"flex flex-col items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 rounded-full border-4 border-[var(--burgundy)] border-t-transparent animate-spin"}),n.jsx("p",{className:"text-sm text-text-secondary animate-pulse",children:"Ykleniyor..."})]})}):t?e&&r&&!e.includes(r)?n.jsx(Zc,{to:"/dashboard",replace:!0}):r!==Jt.SUPER_ADMIN&&!(a!=null&&a.profileCompleted)&&i.pathname!=="/profile"?n.jsx(Zc,{to:"/profile",replace:!0}):n.jsx(Rh,{}):n.jsx(Zc,{to:"/login",state:{from:i},replace:!0})}function XK(){const{user:e}=vr(),[t,r]=b.useState([]),[a,s]=b.useState(!0),[i,l]=b.useState(""),[o,c]=b.useState(""),[d,u]=b.useState(null),[f,h]=b.useState([]),[m,x]=b.useState(!1),[p,g]=b.useState("30"),[y,N]=b.useState(null),[v,S]=b.useState(!1),[_,F]=b.useState(""),k=async()=>{s(!0),u(null);try{const U={limit:50};i&&(U.companyCode=i),o&&(U.userUid=o);const M=await Tn.getCalculationLogs(U);r(M),h([])}catch(U){console.error(U),u("Loglar yklenirken bir hata olutu. Ltfen yetkilerinizi kontrol edin.")}finally{s(!1)}};b.useEffect(()=>{k()},[]);const j=()=>{k()},w=()=>{f.length===t.length?h([]):h(t.map(U=>U.id))},E=U=>{f.includes(U)?h(M=>M.filter(Y=>Y!==U)):h(M=>[...M,U])},A=async(U=!1)=>{if(!(!f.length||!e)&&confirm(`Seili ${f.length} kayd ${U?"KALICI OLARAK":""} silmek istediinize emin misiniz?`)){s(!0);try{U?await Tn.bulkHardDeleteLogs(f):await Tn.bulkSoftDeleteLogs(f,e.uid),xe.success(`Seili kaytlar ${U?"kalc olarak":""} silindi`),k()}catch(M){console.error(M),xe.error(`Silme ilemi baarsz: ${M.message||"Bilinmeyen hata"}`)}finally{s(!1)}}},D=async()=>{S(!0);try{const U=parseInt(p),M=await Tn.getOldLogs(U);N(M.length)}catch(U){console.error(U),xe.error("Saym baarsz")}finally{S(!1)}},W=async(U=!1)=>{if(!(!e||_!=="SL")){S(!0);try{const M=parseInt(p),Y=await Tn.getOldLogs(M);U?await Tn.bulkHardDeleteLogs(Y):await Tn.bulkSoftDeleteLogs(Y,e.uid),xe.success(`${Y.length} kayt temizlendi`),x(!1),F(""),N(null),k()}catch(M){console.error(M),xe.error(`Temizlik ilemi baarsz: ${M.message||"Bilinmeyen hata"}`)}finally{S(!1)}}},re=()=>{const U=Ha.json_to_sheet(t.map(Y=>{var Q,B,V;return{Tarih:Y.createdAt?fd(Y.createdAt,"dd.MM.yyyy HH:mm"):"-",Kullanc:Y.userRole,irket:Y.companyCode,Mteri:Y.customerName,Ebatlar:`${(Q=Y.dimensions)==null?void 0:Q.boy}x${(B=Y.dimensions)==null?void 0:B.en}x${(V=Y.dimensions)==null?void 0:V.yukseklik}`,Adet:Y.quantity,"Toplam Sat":Y.finalSalesTotal,Maliyet:Y.finalCostTotal,Kr:Y.finalProfit,"Teklife Dnt":Y.convertedToOfferId?"EVET":"HAYIR"}})),M=Ha.book_new();Ha.book_append_sheet(M,U,"Hesaplamalar"),bx(M,"hesaplama_loglari.xlsx")};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Hesaplama zleme"}),n.jsx("p",{className:"text-sm text-slate-500",children:"Sistemdeki tm hesaplama ilemlerini izleyin ve ynetin."})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs(bo,{open:m,onOpenChange:x,children:[n.jsx(Wb,{asChild:!0,children:n.jsxs(Re,{variant:"destructive",size:"sm",children:[n.jsx(sa,{className:"mr-2 h-4 w-4"})," Eski Loglar Temizle"]})}),n.jsxs(wo,{children:[n.jsxs(ko,{children:[n.jsxs(No,{className:"flex items-center gap-2 text-destructive",children:[n.jsx(ms,{className:"h-5 w-5"}),"Toplu Temizlik"]}),n.jsx(kd,{children:"Belirli bir tarihten eski olan loglar toplu olarak silebilirsiniz."})]}),n.jsxs("div",{className:"space-y-4 py-4",children:[n.jsxs("div",{className:"grid gap-2",children:[n.jsx("label",{className:"text-sm font-medium",children:"u gnden eski olanlar sil:"}),n.jsxs("select",{className:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",value:p,onChange:U=>{g(U.target.value),N(null)},children:[n.jsx("option",{value:"30",children:"30 Gn"}),n.jsx("option",{value:"60",children:"60 Gn"}),n.jsx("option",{value:"90",children:"90 Gn"}),n.jsx("option",{value:"180",children:"180 Gn"})]})]}),y===null?n.jsx(Re,{onClick:D,variant:"outline",className:"w-full",disabled:v,children:v?"Saylyor...":"Etkilenecek Kayt Saysn Gr"}):n.jsxs("div",{className:"bg-slate-50 p-3 rounded border text-center",children:[n.jsx("div",{className:"text-2xl font-bold text-slate-800",children:y}),n.jsx("div",{className:"text-xs text-slate-500",children:"Kayt Bulundu"})]}),y!==null&&y>0&&n.jsxs("div",{className:"space-y-4 pt-2 border-t",children:[n.jsx("div",{className:"text-sm text-red-600 font-medium",children:'Bu ilem iin "SL" yazarak onaylayn:'}),n.jsx(ze,{value:_,onChange:U=>F(U.target.value),placeholder:"SL"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(Re,{variant:"outline",className:"flex-1 text-red-600 hover:text-red-700 hover:bg-red-50",onClick:()=>W(!1),disabled:_!=="SL"||v,children:"Gizle (Soft Delete)"}),n.jsx(Re,{variant:"destructive",className:"flex-1",onClick:()=>W(!0),disabled:_!=="SL"||v,children:"Kalc Sil (Hard)"})]})]})]})]})]}),n.jsxs(Re,{onClick:re,variant:"outline",size:"sm",children:[n.jsx(xh,{className:"mr-2 h-4 w-4"})," Excel ndir"]})]})]}),d&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded relative",role:"alert",children:[n.jsx("strong",{className:"font-bold",children:"Hata! "}),n.jsx("span",{className:"block sm:inline",children:d})]}),n.jsxs(tt,{children:[n.jsx(Fy,{className:"pb-3",children:n.jsx(Dy,{className:"text-sm font-medium text-slate-500",children:"Filtreleme"})}),n.jsx(xd,{children:n.jsxs("div",{className:"flex gap-4 items-end flex-wrap",children:[n.jsxs("div",{className:"grid gap-2",children:[n.jsx("label",{className:"text-xs font-medium",children:"irket Kodu"}),n.jsx(ze,{placeholder:"rn: COMP001",value:i,onChange:U=>l(U.target.value),className:"h-8 w-40"})]}),n.jsxs("div",{className:"grid gap-2",children:[n.jsx("label",{className:"text-xs font-medium",children:"Kullanc UID"}),n.jsx(ze,{placeholder:"UID",value:o,onChange:U=>c(U.target.value),className:"h-8 w-40"})]}),n.jsxs(Re,{size:"sm",onClick:j,disabled:a,children:[n.jsx(U1,{className:"mr-2 h-3.5 w-3.5"})," Filtrele"]}),n.jsx(Re,{size:"sm",variant:"ghost",onClick:k,disabled:a,children:n.jsx(IE,{className:`h-3.5 w-3.5 ${a?"animate-spin":""}`})})]})})]}),f.length>0&&n.jsxs("div",{className:"bg-slate-100 p-2 rounded-md flex items-center justify-between px-4 border",children:[n.jsxs("div",{className:"text-sm font-medium text-slate-700",children:[f.length," kayt seildi"]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(Re,{variant:"ghost",size:"sm",className:"text-red-600 hover:text-red-700 hover:bg-red-50",onClick:()=>A(!1),children:"Gizle (Soft)"}),n.jsx(Re,{variant:"ghost",size:"sm",className:"text-red-600 hover:text-red-700 hover:bg-red-50",onClick:()=>A(!0),children:"Kalc Sil"})]})]}),n.jsx(tt,{children:n.jsx(xd,{className:"p-0",children:n.jsxs(hn,{children:[n.jsx(mn,{children:n.jsxs(zt,{children:[n.jsx(Ve,{className:"w-[40px]",children:n.jsx(Ui,{checked:f.length===t.length&&t.length>0,onCheckedChange:w,disabled:a||t.length===0})}),n.jsx(Ve,{children:"Tarih"}),n.jsx(Ve,{children:"Kullanc / irket"}),n.jsx(Ve,{children:"Mteri"}),n.jsx(Ve,{children:"rn"}),n.jsx(Ve,{className:"text-right",children:"Toplam Tutar"}),n.jsx(Ve,{className:"text-right",children:"Kr"}),n.jsx(Ve,{className:"text-center",children:"Teklif"}),n.jsx(Ve,{})]})}),n.jsx(xn,{children:a?n.jsx(zt,{children:n.jsx(Oe,{colSpan:9,className:"text-center py-8",children:"Ykleniyor..."})}):t.length===0?n.jsx(zt,{children:n.jsx(Oe,{colSpan:9,className:"text-center py-8",children:"Kayt bulunamad."})}):t.map(U=>n.jsx(qK,{log:U,isSelected:f.includes(U.id),onSelect:()=>E(U.id)},U.id))})]})})})]})}function qK({log:e,isSelected:t,onSelect:r}){var i,l,o,c,d,u,f,h,m,x,p,g,y;const[a,s]=b.useState(!1);return n.jsxs(zt,{className:t?"bg-slate-50":"",children:[n.jsx(Oe,{children:n.jsx(Ui,{checked:t,onCheckedChange:r})}),n.jsx(Oe,{className:"text-xs",children:e.createdAt?fd(e.createdAt,"dd MMM HH:mm",{locale:rh}):"-"}),n.jsx(Oe,{children:n.jsxs("div",{className:"flex flex-col",children:[n.jsx("span",{className:"text-xs font-medium",children:e.userRole}),n.jsx("span",{className:"text-[10px] text-slate-500",children:e.companyCode})]})}),n.jsx(Oe,{className:"font-medium text-sm",children:e.customerName}),n.jsxs(Oe,{className:"text-xs text-slate-600",children:[(i=e.dimensions)==null?void 0:i.boy,"x",(l=e.dimensions)==null?void 0:l.en,"x",(o=e.dimensions)==null?void 0:o.yukseklik," ",n.jsx("br",{}),n.jsxs("span",{className:"font-semibold text-slate-800",children:[e.quantity," Adet"]})]}),n.jsxs(Oe,{className:"text-right font-mono text-sm",children:[Number(e.finalSalesTotal).toLocaleString("tr-TR",{maximumFractionDigits:0})," "]}),n.jsxs(Oe,{className:`text-right font-mono text-sm ${e.finalProfit>0?"text-green-600":"text-red-500"}`,children:[Number(e.finalProfit).toLocaleString("tr-TR",{maximumFractionDigits:0})," "]}),n.jsx(Oe,{className:"text-center",children:e.convertedToOfferId?n.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800",children:"Evet"}):n.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-slate-100 text-slate-600",children:"Hayr"})}),n.jsx(Oe,{children:n.jsxs(bo,{open:a,onOpenChange:s,children:[n.jsx(Wb,{asChild:!0,children:n.jsx(Re,{variant:"ghost",size:"sm",children:"Detay"})}),n.jsxs(wo,{className:"max-w-xl",children:[n.jsx(ko,{children:n.jsx(No,{children:"Hesaplama Detay"})}),n.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm mt-4",children:[n.jsxs("div",{className:"space-y-1",children:[n.jsx("div",{className:"text-xs text-slate-500",children:"Boyutlar"}),n.jsxs("div",{className:"font-medium",children:[(c=e.dimensions)==null?void 0:c.boy," x ",(d=e.dimensions)==null?void 0:d.en," x ",(u=e.dimensions)==null?void 0:u.yukseklik," mm"]})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("div",{className:"text-xs text-slate-500",children:"Miktar"}),n.jsxs("div",{className:"font-medium",children:[e.quantity," Adet"]})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("div",{className:"text-xs text-slate-500",children:"rn Kalitesi"}),n.jsx("div",{className:"font-medium",children:e.qualityName||"-"})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("div",{className:"text-xs text-slate-500",children:"Birim Maliyet (Taban)"}),n.jsxs("div",{className:"font-mono",children:[(f=e.unitCost)==null?void 0:f.toFixed(2)," "]})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("div",{className:"text-xs text-slate-500",children:"Birim Sat (Taban)"}),n.jsxs("div",{className:"font-mono",children:[(h=e.unitSales)==null?void 0:h.toFixed(2)," "]})]}),n.jsx("div",{className:"col-span-2 border-t pt-2 mt-2"}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("div",{className:"text-xs text-slate-500",children:" Ek Maliyetler"}),n.jsxs("div",{className:"font-mono",children:[(m=e.internalExtrasTotal)==null?void 0:m.toFixed(2)," "]})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("div",{className:"text-xs text-slate-500",children:"Mteri Ek Bedeller"}),n.jsxs("div",{className:"font-mono",children:[(x=e.customerExtrasTotal)==null?void 0:x.toFixed(2)," "]})]}),n.jsx("div",{className:"col-span-2 border-t pt-2 mt-2"}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("div",{className:"text-xs text-slate-500 font-bold",children:"TOPLAM MALYET"}),n.jsxs("div",{className:"font-mono font-bold text-red-600",children:[(p=e.finalCostTotal)==null?void 0:p.toFixed(2)," "]})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("div",{className:"text-xs text-slate-500 font-bold",children:"TOPLAM SATI"}),n.jsxs("div",{className:"font-mono font-bold text-slate-800",children:[(g=e.finalSalesTotal)==null?void 0:g.toFixed(2)," "]})]}),n.jsxs("div",{className:"col-span-2 bg-green-50 p-3 rounded mt-2 flex justify-between items-center",children:[n.jsx("span",{className:"font-bold text-green-800",children:"TOPLAM KR"}),n.jsxs("span",{className:"font-bold text-xl text-green-700",children:[(y=e.finalProfit)==null?void 0:y.toLocaleString("tr-TR")," "]})]})]})]})]})})]})}function ZK(){const{user:e,userProfile:t,userRole:r,refreshProfile:a}=vr(),s=ca(),[i,l]=b.useState(!1),[o,c]=b.useState({phone:"",city:"",address:"",taxNumber:"",companyName:""}),[d,u]=b.useState(null),[f,h]=b.useState(!1);b.useEffect(()=>{t!=null&&t.profileInfo&&(c({phone:t.profileInfo.phone||"",city:t.profileInfo.city||"",address:t.profileInfo.address||"",taxNumber:t.profileInfo.taxNumber||"",companyName:t.profileInfo.companyName||""}),u(t.profileInfo.logoBase64||null)),t!=null&&t.profileCompleted?h(!1):h(!0)},[t]);const m=g=>{const{name:y,value:N}=g.target;c(v=>({...v,[y]:N}))},x=g=>{g.preventDefault(),h(!0)},p=async g=>{if(g.preventDefault(),!!f&&e){if(!o.phone||!o.city||!o.address){xe.error("Ltfen zorunlu alanlar doldurun (Telefon, ehir, Adres)");return}l(!0);try{const y=Be(ke,"users",e.uid);await Ut(y,{profileInfo:{...o,logoBase64:d||null},profileCompleted:!0,updatedAt:Ke()}),xe.success("Profil bilgileri baaryla gncellendi"),await a(),h(!1),!(t!=null&&t.profileCompleted)&&r!=="super_admin"&&s("/")}catch(y){console.error("Profile update error:",y),y.code==="permission-denied"?xe.error("Yetki hatas: Sadece kendi profilinizi gncelleyebilirsiniz."):xe.error("Profil gncellenirken bir hata olutu")}finally{l(!1)}}};return n.jsxs("div",{className:"max-w-xl mx-auto py-8 px-4",children:[n.jsxs("div",{className:"mb-8 text-center",children:[n.jsx("h1",{className:"text-3xl font-bold text-slate-800 mb-2",children:"Profil Bilgileri"}),n.jsx("p",{className:"text-slate-500",children:t!=null&&t.profileCompleted?"Profil bilgilerinizi buradan gncelleyebilirsiniz.":"Devam etmek iin ltfen profil bilgilerinizi tamamlayn."})]}),n.jsxs(tt,{className:"border-t-4 border-t-[var(--burgundy)] shadow-lg",children:[n.jsx(Fy,{children:n.jsxs(Dy,{className:"flex items-center gap-2 text-xl",children:[n.jsx(gh,{className:"h-5 w-5 text-[var(--burgundy)]"}),"Kullanc Bilgileri"]})}),n.jsx(xd,{children:n.jsxs("form",{onSubmit:p,className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 bg-slate-50 p-4 rounded-lg",children:[n.jsxs("div",{children:[n.jsx(et,{className:"text-xs text-slate-500",children:"E-posta"}),n.jsx("div",{className:"font-medium text-slate-700",children:e==null?void 0:e.email})]}),n.jsxs("div",{children:[n.jsx(et,{className:"text-xs text-slate-500",children:"Rol"}),n.jsx("div",{className:"font-medium text-slate-700 capitalize",children:r==null?void 0:r.replace("_"," ")})]})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid gap-2",children:[n.jsxs(et,{htmlFor:"phone",className:"flex items-center gap-1",children:[n.jsx(V1,{className:"h-3.5 w-3.5"})," Telefon ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx(ze,{id:"phone",name:"phone",value:o.phone,onChange:m,placeholder:"0555 555 55 55",required:!0,disabled:!f,className:f?"":"bg-slate-50 text-slate-600"})]}),n.jsxs("div",{className:"grid gap-2",children:[n.jsxs(et,{htmlFor:"city",className:"flex items-center gap-1",children:[n.jsx(Qf,{className:"h-3.5 w-3.5"})," ehir ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx(ze,{id:"city",name:"city",value:o.city,onChange:m,placeholder:"stanbul",required:!0,disabled:!f,className:f?"":"bg-slate-50 text-slate-600"})]}),n.jsxs("div",{className:"grid gap-2",children:[n.jsxs(et,{htmlFor:"address",className:"flex items-center gap-1",children:[n.jsx(Qf,{className:"h-3.5 w-3.5"})," Ak Adres ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx(ze,{id:"address",name:"address",value:o.address,onChange:m,placeholder:"Mahalle, Cadde, No...",required:!0,disabled:!f,className:f?"":"bg-slate-50 text-slate-600"})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{className:"grid gap-2",children:[n.jsxs(et,{htmlFor:"companyName",className:"flex items-center gap-1",children:[n.jsx(tl,{className:"h-3.5 w-3.5"})," Firma Ad"]}),n.jsx(ze,{id:"companyName",name:"companyName",value:o.companyName,onChange:m,placeholder:"irket Ad (Varsa)",disabled:!f,className:f?"":"bg-slate-50 text-slate-600"})]}),n.jsxs("div",{className:"grid gap-2",children:[n.jsxs(et,{htmlFor:"taxNumber",className:"flex items-center gap-1",children:[n.jsx(LE,{className:"h-3.5 w-3.5"})," Vergi No"]}),n.jsx(ze,{id:"taxNumber",name:"taxNumber",value:o.taxNumber,onChange:m,placeholder:"Vergi Numaras (Varsa)",disabled:!f,className:f?"":"bg-slate-50 text-slate-600"})]})]})]}),n.jsxs("div",{className:"grid gap-2",children:[n.jsxs(et,{className:"flex items-center gap-1",children:[n.jsx(Mx,{className:"h-3.5 w-3.5"})," Firma Logosu"]}),n.jsxs("div",{className:"flex items-center gap-4",children:[d?n.jsxs("div",{className:"relative",children:[n.jsx("img",{src:d,alt:"Logo",className:"h-16 w-auto max-w-[160px] rounded border border-slate-200 object-contain bg-white p-1"}),f&&n.jsx("button",{type:"button",onClick:()=>u(null),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-0.5 hover:bg-red-600 transition-colors",children:n.jsx(sa,{size:12})})]}):n.jsx("div",{className:"h-16 w-32 rounded border-2 border-dashed border-slate-300 flex items-center justify-center text-slate-400 text-xs",children:"Logo yok"}),f&&n.jsxs("div",{className:"relative",children:[n.jsxs(Re,{type:"button",variant:"outline",size:"sm",className:"text-xs",children:[n.jsx(Mx,{size:14,className:"mr-1"}),d?"Deitir":"Logo Ykle"]}),n.jsx("input",{type:"file",accept:"image/png,image/jpeg,image/jpg",className:"absolute inset-0 opacity-0 cursor-pointer",onChange:g=>{var v;const y=(v=g.target.files)==null?void 0:v[0];if(!y)return;if(y.size>2*1024*1024){xe.error("Logo dosyas 2MB'den kk olmaldr.");return}const N=new FileReader;N.onload=S=>{var F;const _=new Image;_.onload=()=>{const k=document.createElement("canvas"),j=200;let w=_.width,E=_.height;(w>j||E>j)&&(w>E?(E=Math.round(E*j/w),w=j):(w=Math.round(w*j/E),E=j)),k.width=w,k.height=E,k.getContext("2d").drawImage(_,0,0,w,E);const D=k.toDataURL("image/jpeg",.7);u(D),xe.success('Logo yklendi. Kaydetmek iin "Gncelle" butonuna basn.')},_.src=(F=S.target)==null?void 0:F.result},N.readAsDataURL(y),g.target.value=""}})]})]}),n.jsx("p",{className:"text-[10px] text-slate-400",children:"PNG veya JPG, max 2MB. PDF teklif belgelerinde kullanlr."})]}),f?n.jsx(Re,{type:"submit",className:"w-full bg-[var(--burgundy)] hover:bg-[var(--burgundy)]/90",disabled:i,children:i?"Kaydediliyor...":n.jsxs("span",{className:"flex items-center gap-2",children:[n.jsx(Jr,{className:"h-4 w-4"}),t!=null&&t.profileCompleted?"Gncelle":"Kaydet ve Devam Et"]})}):n.jsx(Re,{type:"button",onClick:x,className:"w-full bg-slate-700 hover:bg-slate-800",children:n.jsx("span",{className:"flex items-center gap-2",children:"Dzenle"})})]})})]})]})}var Ax="Tabs",[JK]=In(Ax,[mu]),Jj=mu(),[QK,_x]=JK(Ax),Qj=b.forwardRef((e,t)=>{const{__scopeTabs:r,value:a,onValueChange:s,defaultValue:i,orientation:l="horizontal",dir:o,activationMode:c="automatic",...d}=e,u=Qo(o),[f,h]=xs({prop:a,onChange:s,defaultProp:i});return n.jsx(QK,{scope:r,baseId:ri(),value:f,onValueChange:h,orientation:l,dir:u,activationMode:c,children:n.jsx(_t.div,{dir:u,"data-orientation":l,...d,ref:t})})});Qj.displayName=Ax;var eE="TabsList",tE=b.forwardRef((e,t)=>{const{__scopeTabs:r,loop:a=!0,...s}=e,i=_x(eE,r),l=Jj(r);return n.jsx(ub,{asChild:!0,...l,orientation:i.orientation,dir:i.dir,loop:a,children:n.jsx(_t.div,{role:"tablist","aria-orientation":i.orientation,...s,ref:t})})});tE.displayName=eE;var rE="TabsTrigger",aE=b.forwardRef((e,t)=>{const{__scopeTabs:r,value:a,disabled:s=!1,...i}=e,l=_x(rE,r),o=Jj(r),c=iE(l.baseId,a),d=lE(l.baseId,a),u=a===l.value;return n.jsx(fb,{asChild:!0,...o,focusable:!s,active:u,children:n.jsx(_t.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":d,"data-state":u?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:c,...i,ref:t,onMouseDown:Je(e.onMouseDown,f=>{!s&&f.button===0&&f.ctrlKey===!1?l.onValueChange(a):f.preventDefault()}),onKeyDown:Je(e.onKeyDown,f=>{[" ","Enter"].includes(f.key)&&l.onValueChange(a)}),onFocus:Je(e.onFocus,()=>{const f=l.activationMode!=="manual";!u&&!s&&f&&l.onValueChange(a)})})})});aE.displayName=rE;var nE="TabsContent",sE=b.forwardRef((e,t)=>{const{__scopeTabs:r,value:a,forceMount:s,children:i,...l}=e,o=_x(nE,r),c=iE(o.baseId,a),d=lE(o.baseId,a),u=a===o.value,f=b.useRef(u);return b.useEffect(()=>{const h=requestAnimationFrame(()=>f.current=!1);return()=>cancelAnimationFrame(h)},[]),n.jsx(hl,{present:s||u,children:({present:h})=>n.jsx(_t.div,{"data-state":u?"active":"inactive","data-orientation":o.orientation,role:"tabpanel","aria-labelledby":c,hidden:!h,id:d,tabIndex:0,...l,ref:t,style:{...e.style,animationDuration:f.current?"0s":void 0},children:h&&i})})});sE.displayName=nE;function iE(e,t){return`${e}-trigger-${t}`}function lE(e,t){return`${e}-content-${t}`}var eW=Qj,tW=tE,rW=aE,aW=sE;function nW({className:e,...t}){return n.jsx(eW,{"data-slot":"tabs",className:We("flex flex-col gap-2",e),...t})}function sW({className:e,...t}){return n.jsx(tW,{"data-slot":"tabs-list",className:We("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-xl p-[3px] flex",e),...t})}function Of({className:e,...t}){return n.jsx(rW,{"data-slot":"tabs-trigger",className:We("data-[state=active]:bg-card dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-xl border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...t})}function If({className:e,...t}){return n.jsx(aW,{"data-slot":"tabs-content",className:We("flex-1 outline-none",e),...t})}function iW(e,t){if(!t||t.length===0)return[];const r=Eu({...e,pricePerM2:1,qualityName:"Analiz"});if(!r)return[];const a=r.safihaBoyMm,s=r.safihaEnMm,i=a*s/1e6,l=i*e.quantity;if(a<=0||s<=0)return[];const o=[];for(const c of t){const d=[{bx:a,by:s,rotated:!1},{bx:s,by:a,rotated:!0}];let u=null;for(const{bx:f,by:h,rotated:m}of d){if(f>c.widthMm||h>c.heightMm)continue;const x=Math.floor(c.widthMm/f),p=Math.floor(c.heightMm/h),g=x*p;if(g<=0)continue;const y=c.widthMm*c.heightMm/1e6,N=Math.ceil(e.quantity/g),v=N*y,S=v-l,_=S/v*100,F={sheetName:c.name,sheetWidthMm:c.widthMm,sheetHeightMm:c.heightMm,sheetAreaM2:y,fitsPerSheet:g,fitRows:p,fitCols:x,usedAreaM2:i*g,wastePercent:parseFloat(_.toFixed(4)),sheetsNeeded:N,totalWasteM2:parseFloat(S.toFixed(4)),isRotated:m};u?(F.totalWasteM2<u.totalWasteM2||F.totalWasteM2===u.totalWasteM2&&F.sheetsNeeded<u.sheetsNeeded||F.totalWasteM2===u.totalWasteM2&&F.sheetsNeeded===u.sheetsNeeded&&F.wastePercent<u.wastePercent)&&(u=F):u=F}u&&o.push(u)}return o.sort((c,d)=>c.totalWasteM2!==d.totalWasteM2?c.totalWasteM2-d.totalWasteM2:c.sheetsNeeded!==d.sheetsNeeded?c.sheetsNeeded-d.sheetsNeeded:c.wastePercent-d.wastePercent),o}function lW(e){const t=Math.round(e*10)/10;let r;return t<.1?r="< %0.1":r=`Fire: %${t.toFixed(1)}`,{fire:t,minFire:t,maxFire:t,displayText:r}}function oW(){const{user:e,userProfile:t,userRole:r}=vr(),[a,s]=b.useState(""),[i,l]=b.useState(""),[o,c]=b.useState(""),[d,u]=b.useState(""),[f,h]=b.useState("standard"),[m,x]=b.useState(!1),[p,g]=b.useState([]),[y,N]=b.useState(!1),[v,S]=b.useState([]),[_,F]=b.useState(!0),k=b.useCallback(async()=>{if(e!=null&&e.uid)try{F(!0);const E=await Mi.getUserSheets(e.uid);S(E.map(A=>({name:A.code||`${A.widthMm}${A.heightMm}`,widthMm:A.widthMm,heightMm:A.heightMm})))}catch(E){console.error("Error fetching user sheets:",E)}finally{F(!1)}},[e==null?void 0:e.uid]);b.useEffect(()=>{k()},[k]);const j=async()=>{var U,M;const E=parseFloat(a),A=parseFloat(i),D=parseFloat(o),W=parseInt(d)||1e3;if(!E||!A||!D)return;if(r!=="super_admin"&&t){const Y=t.companyCode||(e==null?void 0:e.uid)||"";if(Y){const Q=await ha.checkQuota(Y,"analysis");if(Q.allowed)await ha.incrementAnalysisUsage(Y);else{xe.error("Analiz Limiti Ald",{description:`Plannzn aylk analiz limitine (${Q.limit}) ulatnz. Ltfen paketinizi ykseltin.`,duration:5e3});return}}}const re=iW({lengthMm:E,widthMm:A,heightMm:D,quantity:W,boxType:f,isDoublePiece:m,flap:(U=t==null?void 0:t.settings)==null?void 0:U.defaultFlap,rillMm:(M=t==null?void 0:t.settings)==null?void 0:M.defaultRillMm},v);g(re),N(!0)},w=!_&&v.length===0;return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"bg-blue-50/50 border border-blue-100 rounded-xl p-4 flex items-start gap-3",children:[n.jsx(Px,{size:20,className:"text-blue-500 mt-0.5 shrink-0"}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-bold text-slate-800",children:"Safiha Optimizasyonu Nedir?"}),n.jsx("p",{className:"text-xs text-slate-600 mt-1 leading-relaxed",children:"retilecek kutu llerini, elinizdeki mevcut levha (safiha) llerine en dk fire oranyla sdrmanz salayan hesaplama aracdr. Doru safihay seerek maliyetlerinizi drebilir ve atk kat (fire) miktarn minimize edebilirsiniz."})]})]}),w&&n.jsx(tt,{className:"p-5 border-status-warning/30 bg-status-warning/5 shadow-sm",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx(ms,{size:20,className:"text-status-warning shrink-0 mt-0.5"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-bold text-text-primary mb-1",children:"Safiha tanm bulunamad"}),n.jsx("p",{className:"text-xs text-text-secondary mb-2",children:"Optimizasyon yapabilmek iin nce elinizde bulunan safiha ebatlarn sisteme tanmlamanz gerekiyor."}),n.jsx(At,{to:"/my-sheets",children:n.jsx(Re,{size:"sm",className:"bg-[var(--burgundy)] hover:bg-[var(--burgundy-hover)] text-white text-xs h-8",children:"Safiha Ekle "})})]})]})}),n.jsxs(tt,{className:"p-6 bg-surface border-border shadow-sm",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("h3",{className:"text-sm font-bold text-text-primary flex items-center gap-2",children:[n.jsx(Px,{size:16,className:"text-[var(--burgundy)]"}),"Koli lleri"]}),_?n.jsx(Ar,{size:14,className:"animate-spin text-text-tertiary"}):n.jsxs(ut,{variant:"outline",className:`text-[10px] font-medium ${w?"border-status-warning/40 text-status-warning":""}`,children:[v.length," Safiha Tanml"]})]}),n.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 mb-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-xs font-medium text-text-secondary mb-1 block",children:"Boy (mm)"}),n.jsx(ze,{value:a,onChange:E=>s(E.target.value),placeholder:"300",type:"number"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-xs font-medium text-text-secondary mb-1 block",children:"En (mm)"}),n.jsx(ze,{value:i,onChange:E=>l(E.target.value),placeholder:"200",type:"number"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-xs font-medium text-text-secondary mb-1 block",children:"Ykseklik (mm)"}),n.jsx(ze,{value:o,onChange:E=>c(E.target.value),placeholder:"150",type:"number"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-xs font-medium text-text-secondary mb-1 block",children:"Miktar (adet)"}),n.jsx(ze,{value:d,onChange:E=>u(E.target.value),placeholder:"1000",type:"number"})]})]}),n.jsxs("div",{className:"flex flex-wrap items-center gap-6 mb-5",children:[n.jsxs("div",{className:"space-y-1.5 w-48",children:[n.jsx(et,{className:"text-xs text-text-secondary",children:"Kutu Tipi"}),n.jsxs(jo,{value:f,onValueChange:E=>h(E),children:[n.jsx(So,{className:"h-10 text-sm bg-surface border-border focus:ring-[var(--burgundy)]",children:n.jsx(Eo,{placeholder:"Kutu Tipi Sein"})}),n.jsxs(To,{children:[n.jsx(_n,{value:"standard",children:"Standart Koli (0201)"}),n.jsx(_n,{value:"fullFlap",children:"Full Flap (0203)"})]})]})]}),n.jsxs("div",{className:"flex items-center gap-2 mt-5",children:[n.jsx(tm,{id:"double-piece",checked:m,onCheckedChange:x,className:"data-[state=checked]:bg-[var(--burgundy)]"}),n.jsx(et,{htmlFor:"double-piece",className:"text-sm font-medium text-text-secondary cursor-pointer select-none",children:"ift Para retim"})]})]}),n.jsx(Re,{onClick:j,disabled:w||_,className:"bg-[var(--burgundy)] hover:bg-[var(--burgundy-hover)] text-white disabled:opacity-50",children:"Analiz Et"})]}),y&&n.jsxs(tt,{className:"overflow-hidden border-border shadow-sm",children:[n.jsxs("div",{className:"p-4 border-b border-border bg-surface",children:[n.jsx("h3",{className:"text-sm font-bold text-text-primary",children:"Safiha Verimlilik Sonular"}),n.jsx("p",{className:"text-xs text-text-tertiary mt-1",children:p.length>0?`${p.length} farkl safiha analiz edildi`:"Bu ller tanml safihalara smyor"})]}),p.length>0&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full text-sm",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"bg-surface-secondary text-text-secondary text-xs uppercase tracking-wider",children:[n.jsx("th",{className:"text-left px-4 py-3 font-semibold",children:"Safiha"}),n.jsx("th",{className:"text-center px-4 py-3 font-semibold",children:"Safihadan kan Adet"}),n.jsx("th",{className:"text-center px-4 py-3 font-semibold",children:"Dizilim"}),n.jsx("th",{className:"text-center px-4 py-3 font-semibold",children:"Fire %"}),n.jsx("th",{className:"text-center px-4 py-3 font-semibold",children:"Gerekli Safiha"}),n.jsx("th",{className:"text-center px-4 py-3 font-semibold",children:"Toplam Fire (m)"})]})}),n.jsx("tbody",{className:"divide-y divide-border",children:p.map((E,A)=>n.jsxs("tr",{className:`${A===0?"bg-status-success/5":"bg-surface"} hover:bg-surface-secondary/50 transition-colors`,children:[n.jsxs("td",{className:"px-4 py-3 font-medium text-text-primary flex items-center gap-2",children:[A===0&&n.jsx(BE,{size:14,className:"text-status-success"}),E.sheetName,E.isRotated&&n.jsx(H1,{size:12,className:"text-text-tertiary"}),A===0&&n.jsx(ut,{className:"bg-status-success/10 text-status-success text-[10px] border-0",children:"En Verimli"})]}),n.jsx("td",{className:"px-4 py-3 text-center font-bold text-text-primary",children:E.fitsPerSheet}),n.jsxs("td",{className:"px-4 py-3 text-center text-text-secondary",children:[E.fitCols,"  ",E.fitRows]}),n.jsx("td",{className:"px-4 py-3 text-center",children:(()=>{const D=lW(E.wastePercent),W=D.fire<=15?"text-status-success":D.fire<=30?"text-status-warning":"text-status-error";return n.jsx("span",{className:`font-bold ${W}`,title:`Toplam Fire: ${E.totalWasteM2.toLocaleString("tr-TR",{minimumFractionDigits:2})} m
Fire oran seilen en verimli dizilime gre hesaplanmtr.`,children:D.displayText})})()}),n.jsx("td",{className:"px-4 py-3 text-center text-text-primary font-medium",children:E.sheetsNeeded.toLocaleString("tr-TR")}),n.jsxs("td",{className:"px-4 py-3 text-center text-text-secondary",children:[E.totalWasteM2.toLocaleString("tr-TR",{minimumFractionDigits:2})," m"]})]},A))})]})}),n.jsx("div",{className:"px-4 py-3 border-t border-border",children:n.jsx("p",{className:"text-[10px] text-text-tertiary italic leading-relaxed",children:" Fire oran seilen en verimli dizilime gre (minimum fire alan) hesaplanmtr. Gerek retimdeki trim paylar ve kesim paylar dahil edilmitir."})})]})]})]})}const cW=[{id:1,name:"Testliner / C",pricePerM2:12.5},{id:2,name:"Kraft / B+C",pricePerM2:18.25},{id:3,name:"Beyaz / E",pricePerM2:22.1}],dW="excel_price_list";function oE(){try{const e=localStorage.getItem(dW);if(e){const t=JSON.parse(e);if(Array.isArray(t)&&t.length>0)return t}}catch{}return cW}function uW(e){const t=oE(),r=[];for(const a of t){const s=Eu({...e,pricePerM2:a.pricePerM2,qualityName:a.name});s&&r.push({qualityName:a.name,pricePerM2:a.pricePerM2,birimAlanM2:s.birimAlanM2,birimMaliyet:s.birimHamMaliyet,toplamMaliyet:s.toplamHamMaliyet,toplamAlan:s.toplamAlan})}return r.sort((a,s)=>a.toplamMaliyet-s.toplamMaliyet),r}function fW(){const[e,t]=b.useState(""),[r,a]=b.useState(""),[s,i]=b.useState(""),{user:l,userProfile:o,userRole:c}=vr(),[d,u]=b.useState(""),[f,h]=b.useState(""),[m,x]=b.useState("standard"),[p,g]=b.useState(!1),[y,N]=b.useState([]),[v,S]=b.useState(!1),_=oE(),F=async()=>{var Y,Q;const E=parseFloat(e),A=parseFloat(r),D=parseFloat(s),W=parseInt(d)||1e3,re=parseFloat(f)||0;if(!E||!A||!D)return;if(c!=="super_admin"&&o){const B=o.companyCode||(l==null?void 0:l.uid)||"";if(B){const V=await ha.checkQuota(B,"analysis");if(V.allowed)await ha.incrementAnalysisUsage(B);else{xe.error("Analiz Limiti Ald",{description:`Plannzn aylk analiz limitine (${V.limit}) ulatnz. Ltfen paketinizi ykseltin.`,duration:5e3});return}}}const M=uW({lengthMm:E,widthMm:A,heightMm:D,quantity:W,boxType:m,isDoublePiece:p,flap:(Y=o==null?void 0:o.settings)==null?void 0:Y.defaultFlap,rillMm:(Q=o==null?void 0:o.settings)==null?void 0:Q.defaultRillMm}).map(B=>{const V=re>0?parseFloat((re-B.birimMaliyet).toFixed(2)):0,P=re>0?parseFloat((V*W).toFixed(2)):0,T=re>0?parseFloat((V/re*100).toFixed(1)):0;return{...B,birimKar:V,toplamKar:P,marj:T}});re>0&&M.sort((B,V)=>V.marj-B.marj),N(M),S(!0)},k=y.length>0&&y[0].marj!==0,j=k?y[0]:null,w=k&&y.length>1?y[y.length-1]:null;return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"bg-blue-50/50 border border-blue-100 rounded-xl p-4 flex items-start gap-3",children:[n.jsx(e0,{size:20,className:"text-blue-500 mt-0.5 shrink-0"}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-bold text-slate-800",children:"Maliyet Kyaslama Nedir?"}),n.jsx("p",{className:"text-xs text-slate-600 mt-1 leading-relaxed",children:"Ayn kutu ls iin farkl kat kalitelerinin (rnein C, B+C, E vb.) maliyetlerini ve kr marjlarn saniyeler iinde karlatrmanz salayan aratr. Birim sat fiyatnz girerek, hangi kaliteden retim yaparsanz ne kadar kr edeceinizi tek ekranda grebilirsiniz."})]})]}),n.jsxs(tt,{className:"p-6 bg-surface border-border shadow-sm",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("h3",{className:"text-sm font-bold text-text-primary flex items-center gap-2",children:[n.jsx(e0,{size:16,className:"text-[var(--burgundy)]"}),"Koli lleri ve Sat Bilgisi"]}),n.jsxs(ut,{variant:"outline",className:"text-[10px] font-medium",children:[_.length," Kalite Ykl"]})]}),n.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-5 gap-4 mb-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-xs font-medium text-text-secondary mb-1 block",children:"Boy (mm)"}),n.jsx(ze,{value:e,onChange:E=>t(E.target.value),placeholder:"300",type:"number"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-xs font-medium text-text-secondary mb-1 block",children:"En (mm)"}),n.jsx(ze,{value:r,onChange:E=>a(E.target.value),placeholder:"200",type:"number"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-xs font-medium text-text-secondary mb-1 block",children:"Ykseklik (mm)"}),n.jsx(ze,{value:s,onChange:E=>i(E.target.value),placeholder:"150",type:"number"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-xs font-medium text-text-secondary mb-1 block",children:"Miktar (adet)"}),n.jsx(ze,{value:d,onChange:E=>u(E.target.value),placeholder:"1000",type:"number"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"text-xs font-medium text-text-secondary mb-1 block flex items-center gap-1",children:["Birim Sat ()",n.jsx(zE,{size:10,className:"text-text-tertiary"})]}),n.jsx(ze,{value:f,onChange:E=>h(E.target.value),placeholder:"5.00",type:"number",step:"0.01"})]})]}),n.jsxs("div",{className:"flex flex-wrap items-center gap-6 mb-5",children:[n.jsxs("div",{className:"space-y-1.5 w-48",children:[n.jsx(et,{className:"text-xs text-text-secondary",children:"Kutu Tipi"}),n.jsxs(jo,{value:m,onValueChange:E=>x(E),children:[n.jsx(So,{className:"h-10 text-sm bg-surface border-border focus:ring-[var(--burgundy)]",children:n.jsx(Eo,{placeholder:"Kutu Tipi Sein"})}),n.jsxs(To,{children:[n.jsx(_n,{value:"standard",children:"Standart Koli (0201)"}),n.jsx(_n,{value:"fullFlap",children:"Full Flap (0203)"})]})]})]}),n.jsxs("div",{className:"flex items-center gap-2 mt-5",children:[n.jsx(tm,{id:"double-piece-cost",checked:p,onCheckedChange:g,className:"data-[state=checked]:bg-[var(--burgundy)]"}),n.jsx(et,{htmlFor:"double-piece-cost",className:"text-sm font-medium text-text-secondary cursor-pointer select-none",children:"ift Para retim"})]})]}),n.jsx(Re,{onClick:F,className:"bg-[var(--burgundy)] hover:bg-[var(--burgundy-hover)] text-white",children:"Karlatr"}),!f&&n.jsx("p",{className:"text-[11px] text-text-tertiary mt-2 italic",children:" Birim Sat Fiyat girerseniz kr marj ve toplam kr bazl sralama yaplr."})]}),v&&y.length>0&&n.jsxs(tt,{className:"overflow-hidden border-border shadow-sm",children:[n.jsxs("div",{className:"p-4 border-b border-border bg-surface",children:[n.jsx("h3",{className:"text-sm font-bold text-text-primary",children:k?"Krllk Bazl Kyaslama":"Maliyet Bazl Kyaslama"}),n.jsx("p",{className:"text-xs text-text-tertiary mt-1",children:k?"Ayn sat fiyatna kar en yksek kr marj srasyla":"En dk toplam maliyetten en yksee"})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full text-sm",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"bg-surface-secondary text-text-secondary text-xs uppercase tracking-wider",children:[n.jsx("th",{className:"text-left px-4 py-3 font-semibold",children:"Kalite"}),n.jsx("th",{className:"text-center px-4 py-3 font-semibold",children:"m Fiyat"}),n.jsx("th",{className:"text-center px-4 py-3 font-semibold",children:"Birim Maliyet"}),n.jsx("th",{className:"text-center px-4 py-3 font-semibold",children:"Toplam Maliyet"}),k&&n.jsxs(n.Fragment,{children:[n.jsx("th",{className:"text-center px-4 py-3 font-semibold",children:"Birim Kr"}),n.jsx("th",{className:"text-center px-4 py-3 font-semibold",children:"Kr Marj"}),n.jsx("th",{className:"text-center px-4 py-3 font-semibold",children:"Toplam Kr"})]})]})}),n.jsx("tbody",{className:"divide-y divide-border",children:y.map((E,A)=>{const D=k&&(j==null?void 0:j.qualityName)===E.qualityName,W=k&&(w==null?void 0:w.qualityName)===E.qualityName&&y.length>1;return n.jsxs("tr",{className:`${D?"bg-status-success/5":W?"bg-status-error/5":"bg-surface"} hover:bg-surface-secondary/50 transition-colors`,children:[n.jsxs("td",{className:"px-4 py-3 font-medium text-text-primary flex items-center gap-2",children:[D&&n.jsx(fl,{size:14,className:"text-status-success"}),E.qualityName,D&&n.jsx(ut,{className:"bg-status-success/10 text-status-success text-[10px] border-0",children:"En Krl"}),W&&n.jsx(ut,{className:"bg-status-error/10 text-status-error text-[10px] border-0",children:"En Az Krl"})]}),n.jsxs("td",{className:"px-4 py-3 text-center text-text-secondary",children:["",E.pricePerM2.toFixed(2)]}),n.jsxs("td",{className:"px-4 py-3 text-center text-text-primary font-medium",children:["",E.birimMaliyet.toFixed(2)]}),n.jsxs("td",{className:"px-4 py-3 text-center text-text-primary",children:["",E.toplamMaliyet.toLocaleString("tr-TR",{minimumFractionDigits:2})]}),k&&n.jsxs(n.Fragment,{children:[n.jsxs("td",{className:`px-4 py-3 text-center font-bold ${E.birimKar>=0?"text-status-success":"text-status-error"}`,children:["",E.birimKar.toFixed(2)]}),n.jsx("td",{className:"px-4 py-3 text-center",children:n.jsxs("span",{className:`font-black ${E.marj>=20?"text-status-success":E.marj>=10?"text-status-warning":"text-status-error"}`,children:["%",E.marj]})}),n.jsxs("td",{className:`px-4 py-3 text-center font-bold ${E.toplamKar>=0?"text-status-success":"text-status-error"}`,children:["",E.toplamKar.toLocaleString("tr-TR",{minimumFractionDigits:2})]})]})]},A)})})]})})]})]})}function hW(e){const{fixedCosts:t,variableCostPerUnit:r,salePricePerUnit:a,quantity:s}=e;if(t<0||r<0||a<=0||s<=0)return null;const i=a-r,l=i>0?Math.ceil(t/i):1/0,o=parseFloat((a*s).toFixed(2)),c=parseFloat((t+r*s).toFixed(2)),d=parseFloat((o-c).toFixed(2)),u=d>0,f=Math.max(s,isFinite(l)?Math.ceil(l*1.5):s*2),m=Math.max(1,Math.ceil(f/20)),x=[];for(let p=0;p<=f;p+=m){const g=parseFloat((a*p).toFixed(2)),y=parseFloat((t+r*p).toFixed(2));x.push({qty:p,revenue:g,cost:y,profit:parseFloat((g-y).toFixed(2))})}return x.find(p=>p.qty===s)||(x.push({qty:s,revenue:o,cost:c,profit:d}),x.sort((p,g)=>p.qty-g.qty)),{breakEvenQty:isFinite(l)?l:-1,isProfitable:u,profitAtQuantity:d,revenueAtQuantity:o,totalCostAtQuantity:c,contributionMargin:parseFloat(i.toFixed(2)),chartData:x}}function mW(){const{user:e,userProfile:t,userRole:r}=vr(),[a,s]=b.useState(""),[i,l]=b.useState(""),[o,c]=b.useState(""),[d,u]=b.useState(""),[f,h]=b.useState(""),[m,x]=b.useState(""),[p,g]=b.useState(null),[y,N]=b.useState(!1),v=async()=>{const S=(parseFloat(a)||0)+(parseFloat(i)||0)+(parseFloat(o)||0),_=parseFloat(d)||0,F=parseFloat(f)||0,k=parseInt(m)||1e3;if(F<=0)return;if(r!=="super_admin"&&t){const w=t.companyCode||(e==null?void 0:e.uid)||"";if(w){const E=await ha.checkQuota(w,"analysis");if(E.allowed)await ha.incrementAnalysisUsage(w);else{xe.error("Analiz Limiti Ald",{description:`Plannzn aylk analiz limitine (${E.limit}) ulatnz. Ltfen paketinizi ykseltin.`,duration:5e3});return}}}const j=hW({fixedCosts:S,variableCostPerUnit:_,salePricePerUnit:F,quantity:k});g(j),N(!0)};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"bg-blue-50/50 border border-blue-100 rounded-xl p-4 flex items-start gap-3",children:[n.jsx(ei,{size:20,className:"text-blue-500 mt-0.5 shrink-0"}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-bold text-slate-800",children:"Baa Ba (Break-Even) Noktas Nedir?"}),n.jsxs("p",{className:"text-xs text-slate-600 mt-1 leading-relaxed",children:["Bir siparite elde edilen toplam gelirin, katlanlan toplam maliyete (sabit ve deiken) eit olduu retim adedidir. Bu adedin altndaki satlar ",n.jsx("strong",{children:"zarar"}),", stndeki satlar ise ",n.jsx("strong",{children:"kr"})," ile sonulanr."]})]})]}),n.jsxs(tt,{className:"p-6 bg-surface border-border shadow-sm",children:[n.jsxs("h3",{className:"text-sm font-bold text-text-primary mb-4 flex items-center gap-2",children:[n.jsx(ei,{size:16,className:"text-[var(--burgundy)]"}),"Maliyet Girdileri"]}),n.jsxs("div",{className:"mb-3",children:[n.jsx("p",{className:"text-xs font-semibold text-text-secondary uppercase tracking-wider mb-2",children:"Sabit Maliyetler ()"}),n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-xs font-medium text-text-secondary mb-1 block",children:"Klie"}),n.jsx(ze,{value:a,onChange:S=>s(S.target.value),placeholder:"500",type:"number"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-xs font-medium text-text-secondary mb-1 block",children:"Nakliye"}),n.jsx(ze,{value:i,onChange:S=>l(S.target.value),placeholder:"350",type:"number"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-xs font-medium text-text-secondary mb-1 block",children:"Hazrlk / Balama"}),n.jsx(ze,{value:o,onChange:S=>c(S.target.value),placeholder:"300",type:"number"})]})]})]}),n.jsxs("div",{className:"mb-4",children:[n.jsx("p",{className:"text-xs font-semibold text-text-secondary uppercase tracking-wider mb-2",children:"Birim Deerler (/adet)"}),n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-xs font-medium text-text-secondary mb-1 block",children:"Birim Ham Maliyet"}),n.jsx(ze,{value:d,onChange:S=>u(S.target.value),placeholder:"2.50",type:"number",step:"0.01"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-xs font-medium text-text-secondary mb-1 block",children:"Birim Sat Fiyat"}),n.jsx(ze,{value:f,onChange:S=>h(S.target.value),placeholder:"4.00",type:"number",step:"0.01"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-xs font-medium text-text-secondary mb-1 block",children:"Sipari Miktar"}),n.jsx(ze,{value:m,onChange:S=>x(S.target.value),placeholder:"1000",type:"number"})]})]})]}),n.jsx(Re,{onClick:v,className:"bg-[var(--burgundy)] hover:bg-[var(--burgundy-hover)] text-white",children:"Hesapla"})]}),y&&p&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[n.jsxs(tt,{className:"p-5 border-border shadow-sm bg-surface text-center",children:[n.jsx("p",{className:"text-[10px] font-bold text-text-tertiary uppercase tracking-wider mb-1",children:"Baa Ba Noktas"}),n.jsx("p",{className:"text-3xl font-black text-text-primary",children:p.breakEvenQty>0?p.breakEvenQty.toLocaleString("tr-TR"):""}),n.jsx("p",{className:"text-xs text-text-secondary mt-1",children:"adet"})]}),n.jsxs(tt,{className:`p-5 border shadow-sm text-center ${p.isProfitable?"border-status-success/30 bg-status-success/5":"border-status-error/30 bg-status-error/5"}`,children:[n.jsx("p",{className:"text-[10px] font-bold text-text-tertiary uppercase tracking-wider mb-1",children:"Sipari Kr/Zarar"}),n.jsxs("div",{className:"flex items-center justify-center gap-2",children:[p.isProfitable?n.jsx(fl,{size:20,className:"text-status-success"}):n.jsx($1,{size:20,className:"text-status-error"}),n.jsxs("p",{className:`text-3xl font-black ${p.isProfitable?"text-status-success":"text-status-error"}`,children:["",Math.abs(p.profitAtQuantity).toLocaleString("tr-TR",{minimumFractionDigits:2})]})]}),n.jsx(ut,{className:`mt-1 text-[10px] border-0 ${p.isProfitable?"bg-status-success/10 text-status-success":"bg-status-error/10 text-status-error"}`,children:p.isProfitable?"KRLI":"ZARARDA"})]}),n.jsxs(tt,{className:"p-5 border-border shadow-sm bg-surface text-center",children:[n.jsx("p",{className:"text-[10px] font-bold text-text-tertiary uppercase tracking-wider mb-1",children:"Katk Pay / Adet"}),n.jsxs("p",{className:"text-3xl font-black text-text-primary",children:["",p.contributionMargin.toFixed(2)]}),n.jsx("p",{className:"text-xs text-text-secondary mt-1",children:"sat  deiken maliyet"})]})]}),n.jsxs(tt,{className:"p-6 border-border shadow-sm bg-surface",children:[n.jsx("h3",{className:"text-sm font-bold text-text-primary mb-4",children:"Kr / Zarar Grafii"}),n.jsx("div",{className:"h-[320px]",children:n.jsx(zs,{width:"100%",height:"100%",children:n.jsxs(fo,{data:p.chartData,margin:{top:5,right:30,left:20,bottom:5},children:[n.jsx(Vi,{strokeDasharray:"3 3",stroke:"var(--border)"}),n.jsx(Hi,{dataKey:"qty",tick:{fontSize:11},label:{value:"Adet",position:"insideBottom",offset:-5,fontSize:11}}),n.jsx($i,{tick:{fontSize:11},tickFormatter:S=>`${S.toLocaleString("tr-TR")}`}),n.jsx(Di,{formatter:S=>[`${S.toLocaleString("tr-TR",{minimumFractionDigits:2})}`,""],labelFormatter:S=>`${S} adet`,contentStyle:{fontSize:12,borderRadius:8}}),n.jsx(rl,{type:"monotone",dataKey:"revenue",stroke:"var(--status-success)",strokeWidth:2,name:"Gelir",dot:!1}),n.jsx(rl,{type:"monotone",dataKey:"cost",stroke:"var(--status-error)",strokeWidth:2,name:"Maliyet",dot:!1}),p.breakEvenQty>0&&n.jsx(Jd,{x:p.breakEvenQty,stroke:"var(--burgundy)",strokeDasharray:"5 5",label:{value:"BEP",position:"top",fontSize:10,fill:"var(--burgundy)"}})]})})})]})]})]})}function xW(){return n.jsxs("div",{className:"w-full max-w-6xl mx-auto",children:[n.jsxs("div",{className:"mb-6",children:[n.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"Teknik Analiz"}),n.jsx("p",{className:"text-sm text-text-secondary mt-1",children:"retim verimlilii, maliyet kyaslama ve krllk analizlerinizi yapn."})]}),n.jsxs(nW,{defaultValue:"sheet",className:"w-full",children:[n.jsxs(sW,{className:"grid w-full grid-cols-3 mb-6",children:[n.jsxs(Of,{value:"sheet",className:"flex items-center gap-2 text-sm",children:[n.jsx(UE,{size:14}),"Safiha Optimizasyonu"]}),n.jsxs(Of,{value:"cost",className:"flex items-center gap-2 text-sm",children:[n.jsx(e0,{size:14}),"Maliyet Kyaslama"]}),n.jsxs(Of,{value:"breakeven",className:"flex items-center gap-2 text-sm",children:[n.jsx(ei,{size:14}),"Baa Ba (Break-Even)"]})]}),n.jsx(If,{value:"sheet",children:n.jsx(oW,{})}),n.jsx(If,{value:"cost",children:n.jsx(fW,{})}),n.jsx(If,{value:"breakeven",children:n.jsx(mW,{})})]})]})}function pW(){const{user:e}=vr(),[t,r]=b.useState([]),[a,s]=b.useState(!0),[i,l]=b.useState(!1),[o,c]=b.useState(""),[d,u]=b.useState(""),[f,h]=b.useState(""),[m,x]=b.useState(""),[p,g]=b.useState(""),[y,N]=b.useState(""),[v,S]=b.useState(""),[_,F]=b.useState({}),[k,j]=b.useState([]),w=b.useCallback(async()=>{if(e!=null&&e.uid)try{s(!0);const M=await Mi.getUserSheets(e.uid);r(M)}catch(M){console.error("Error fetching sheets:",M),xe.error("Safihalar yklenemedi.")}finally{s(!1)}},[e==null?void 0:e.uid]);b.useEffect(()=>{w()},[w]);const E=()=>{c(""),u(""),h(""),x(""),g(""),N(""),S(""),F({})},A=()=>{const M=[{"Kalite Kodu":"MKSSST","En (mm)":700,"Boy (mm)":1e3,Gramaj:125,"Flute Tipi":"BC","Min. retim Adedi":500,Aklama:"Standart ift Dalga Safiha"},{"Kalite Kodu":"KSSSSK","En (mm)":800,"Boy (mm)":1200,Gramaj:140,"Flute Tipi":"B","Min. retim Adedi":1e3,Aklama:"Mikro Dalga Kraft Safiha"},{"Kalite Kodu":"TSSSSB","En (mm)":600,"Boy (mm)":900,Gramaj:115,"Flute Tipi":"C","Min. retim Adedi":750,Aklama:"Tek Dalga Testliner Safiha"},{"Kalite Kodu":"MKSSSK","En (mm)":1e3,"Boy (mm)":2e3,Gramaj:150,"Flute Tipi":"E","Min. retim Adedi":300,Aklama:"Byk Boy nce Dalga"},{"Kalite Kodu":"KSSSSS","En (mm)":1200,"Boy (mm)":2400,Gramaj:135,"Flute Tipi":"B","Min. retim Adedi":500,Aklama:"zel retim Geni Safiha"}],Y=Ha.json_to_sheet(M),Q=Ha.book_new();Ha.book_append_sheet(Q,Y,"rnek"),bx(Q,"Safiha_Ornek_Dosya.xlsx")},D=()=>{const M={};return o.trim()||(M.code="Kalite Kodu zorunludur."),(!d||parseFloat(d)<=0)&&(M.width="En zorunludur ve 0'dan byk olmaldr."),(!f||parseFloat(f)<=0)&&(M.height="Boy zorunludur ve 0'dan byk olmaldr."),(!m||parseFloat(m)<=0)&&(M.gramaj="Gramaj zorunludur ve 0'dan byk olmaldr."),p.trim()||(M.flute="Flute Tipi zorunludur."),(!y||parseInt(y)<=0)&&(M.minQty="Min. retim Adedi zorunludur."),v.trim()||(M.note="Aklama zorunludur."),F(M),Object.keys(M).length===0},W=async()=>{if(!(e!=null&&e.uid))return;if(!D()){xe.error("Ltfen zorunlu alanlar kontrol edin.");return}const M=parseFloat(d),Y=parseFloat(f);l(!0);try{await Mi.addSheet(e.uid,{code:o.trim()||void 0,widthMm:M,heightMm:Y,gramaj:parseFloat(m)||void 0,flute:p.trim()||void 0,minQty:parseInt(y)||void 0,note:v.trim()||void 0}),xe.success("Safiha eklendi."),E(),await w()}catch(Q){console.error("Error adding sheet:",Q),xe.error("Safiha eklenemedi.")}finally{l(!1)}},re=async M=>{if(!(!(e!=null&&e.uid)||!M))try{await Mi.deleteSheet(e.uid,M),r(Y=>Y.filter(Q=>Q.id!==M)),xe.success("Safiha silindi.")}catch(Y){console.error("Error deleting sheet:",Y),xe.error("Safiha silinemedi.")}},U=M=>{var V,P;const Y=(V=M.target.files)==null?void 0:V[0];if(!Y||!(e!=null&&e.uid))return;const Q=new FileReader,B=(P=Y.name.split(".").pop())==null?void 0:P.toLowerCase();Q.onload=async T=>{var R;try{let L=[];const X=(R=T.target)==null?void 0:R.result;if(B==="csv")L=jx.parse(X,{header:!0,skipEmptyLines:!0}).data;else if(B==="xlsx"||B==="xls"){const Z=Wo(X,{type:"binary"}),ae=Z.Sheets[Z.SheetNames[0]];L=Ha.sheet_to_json(ae)}if(L.length===0){xe.error("Dosyada veri bulunamad.");return}const J=[],te=[];if(L.forEach((Z,ae)=>{const de=[],z=String(Z.code||Z.kaliteKodu||Z.kalite||Z["Kalite Kodu"]||"").trim(),Ee=String(Z.width||Z.en||Z["En (mm)"]||"").replace(",","."),ue=String(Z.height||Z.boy||Z["Boy (mm)"]||"").replace(",","."),Ce=String(Z.gramaj||Z.Gramaj||"").replace(",","."),ve=String(Z.flute||Z.dalga||Z["Flute Tipi"]||"").trim(),ge=String(Z.minQty||Z.min_qty||Z.minMiktar||Z["Min. retim Adedi"]||""),Fe=parseFloat(Ee),Ie=parseFloat(ue),Ze=parseFloat(Ce),yt=parseInt(ge);z||de.push({field:"Kalite Kodu",message:"Zorunlu alan bo."}),Ee.trim()?(isNaN(Fe)||Fe<=0)&&de.push({field:"En",message:"Geerli ve 0'dan byk bir say olmal."}):de.push({field:"En",message:"Zorunlu alan bo."}),ue.trim()?(isNaN(Ie)||Ie<=0)&&de.push({field:"Boy",message:"Geerli ve 0'dan byk bir say olmal."}):de.push({field:"Boy",message:"Zorunlu alan bo."}),Ce.trim()?(isNaN(Ze)||Ze<=0)&&de.push({field:"Gramaj",message:"Geerli ve 0'dan byk bir say olmal."}):de.push({field:"Gramaj",message:"Zorunlu alan bo."}),ve||de.push({field:"Flute Tipi",message:"Zorunlu alan bo."}),ge.trim()?(isNaN(yt)||yt<=0)&&de.push({field:"Min. retim Adedi",message:"Geerli ve 0'dan byk bir say olmal."}):de.push({field:"Min. retim Adedi",message:"Zorunlu alan bo."}),String(Z.note||Z.aciklama||Z.Aklama||"").trim()||de.push({field:"Aklama",message:"Zorunlu alan bo."}),de.length>0?te.push({row:ae+1,errors:de}):J.push({code:z,widthMm:Fe,heightMm:Ie,gramaj:Ze,flute:ve,minQty:yt,note:String(Z.note||Z.aciklama||Z.Aklama||"").trim()})}),te.length>0){j(te),xe.error("Kaydedilemedi: Eksik/Hatal alanlar var. Ltfen iaretli satrlar kontrol edin.");return}j([]),l(!0);const G=await Mi.addSheetsBatch(e.uid,J);await w(),xe.success(`${G} safiha baaryla eklendi.`)}catch(L){console.error("Excel import error:",L),xe.error("Dosya okunamad.")}finally{l(!1)}},B==="csv"?Q.readAsText(Y):Q.readAsBinaryString(Y),M.target.value=""};return n.jsxs(po,{children:[n.jsx(nu,{title:"Safihalarm",description:"Elinizde bulunan safiha ebatlarn tanmlayn. Safiha optimizasyonu bu listeye gre hesaplanr.",actions:n.jsx(n.Fragment,{})}),n.jsxs(tt,{className:"p-6 bg-surface border-border shadow-sm mb-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("h3",{className:"text-sm font-bold text-text-primary flex items-center gap-2",children:[n.jsx(ti,{size:16,className:"text-[var(--burgundy)]"}),"Yeni Safiha Ekle"]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs(Re,{variant:"ghost",size:"sm",className:"text-xs text-text-secondary flex items-center gap-2",onClick:A,children:[n.jsx(xh,{size:14}),"rnek Dosya ndir"]}),n.jsxs("div",{className:"relative",children:[n.jsxs(Re,{variant:"outline",size:"sm",className:"flex items-center gap-2",disabled:i,children:[n.jsx(VE,{size:14}),"Excel / CSV Ykle"]}),n.jsx(ze,{type:"file",className:"absolute inset-0 opacity-0 cursor-pointer z-10",accept:".xlsx,.xls,.csv",onChange:U})]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 mb-3",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"text-xs font-medium text-text-secondary mb-1 block",children:["Kalite Kodu ",n.jsx("span",{className:"text-status-error",children:"*"})]}),n.jsx(ze,{value:o,onChange:M=>{c(M.target.value),_.code&&F(Y=>({...Y,code:""}))},placeholder:"MKSSST",className:_.code?"border-status-error focus-visible:ring-status-error":""}),_.code&&n.jsx("p",{className:"text-[10px] text-status-error mt-1",children:_.code})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"text-xs font-medium text-text-secondary mb-1 block",children:["En (mm) ",n.jsx("span",{className:"text-status-error",children:"*"})]}),n.jsx(ze,{value:d,onChange:M=>{u(M.target.value),_.width&&F(Y=>({...Y,width:""}))},placeholder:"700",type:"number",className:_.width?"border-status-error focus-visible:ring-status-error":""}),_.width&&n.jsx("p",{className:"text-[10px] text-status-error mt-1",children:_.width})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"text-xs font-medium text-text-secondary mb-1 block",children:["Boy (mm) ",n.jsx("span",{className:"text-status-error",children:"*"})]}),n.jsx(ze,{value:f,onChange:M=>{h(M.target.value),_.height&&F(Y=>({...Y,height:""}))},placeholder:"1000",type:"number",className:_.height?"border-status-error focus-visible:ring-status-error":""}),_.height&&n.jsx("p",{className:"text-[10px] text-status-error mt-1",children:_.height})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"text-xs font-medium text-text-secondary mb-1 block",children:["Gramaj ",n.jsx("span",{className:"text-status-error",children:"*"})]}),n.jsx(ze,{value:m,onChange:M=>{x(M.target.value),_.gramaj&&F(Y=>({...Y,gramaj:""}))},placeholder:"125",type:"number",className:_.gramaj?"border-status-error focus-visible:ring-status-error":""}),_.gramaj&&n.jsx("p",{className:"text-[10px] text-status-error mt-1",children:_.gramaj})]})]}),n.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 mb-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"text-xs font-medium text-text-secondary mb-1 block",children:["Flute Tipi ",n.jsx("span",{className:"text-status-error",children:"*"})]}),n.jsx(ze,{value:p,onChange:M=>{g(M.target.value),_.flute&&F(Y=>({...Y,flute:""}))},placeholder:"B, C, E, BC...",className:_.flute?"border-status-error focus-visible:ring-status-error":""}),_.flute&&n.jsx("p",{className:"text-[10px] text-status-error mt-1",children:_.flute})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"text-xs font-medium text-text-secondary mb-1 block",children:["Min. retim Adedi ",n.jsx("span",{className:"text-status-error",children:"*"})]}),n.jsx(ze,{value:y,onChange:M=>{N(M.target.value),_.minQty&&F(Y=>({...Y,minQty:""}))},placeholder:"500",type:"number",className:_.minQty?"border-status-error focus-visible:ring-status-error":""}),_.minQty&&n.jsx("p",{className:"text-[10px] text-status-error mt-1",children:_.minQty})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"text-xs font-medium text-text-secondary mb-1 block",children:["Aklama ",n.jsx("span",{className:"text-status-error",children:"*"})]}),n.jsx(ze,{value:v,onChange:M=>{S(M.target.value),_.note&&F(Y=>({...Y,note:""}))},placeholder:"Not...",className:_.note?"border-status-error focus-visible:ring-status-error":""}),_.note&&n.jsx("p",{className:"text-[10px] text-status-error mt-1",children:_.note})]})]}),k.length>0&&n.jsxs("div",{className:"mb-4 p-4 bg-status-error/5 border border-status-error/20 rounded-lg",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2 text-status-error text-sm font-bold",children:[n.jsx(ms,{size:16}),"Hatal Satrlar Mevcut"]}),n.jsx("div",{className:"max-h-32 overflow-auto space-y-1",children:k.map((M,Y)=>n.jsxs("p",{className:"text-xs text-status-error flex gap-2",children:[n.jsxs("span",{className:"font-bold",children:["Satr ",M.row,":"]}),M.errors.map(Q=>`${Q.field} (${Q.message})`).join(", ")]},Y))}),n.jsx(Re,{variant:"ghost",size:"sm",className:"mt-2 text-[10px] text-gray-500 hover:text-gray-700",onClick:()=>j([]),children:"Hatalar Temizle"})]}),n.jsxs(Re,{onClick:W,disabled:i,className:"bg-[#1A1D1F] hover:bg-black text-white font-black uppercase tracking-widest gap-2 shadow-md",children:[i?n.jsx(Ar,{size:16,className:"animate-spin"}):n.jsx(ti,{size:16}),"Safiha Ekle"]})]}),n.jsxs(tt,{className:"overflow-hidden border-border shadow-sm",children:[n.jsxs("div",{className:"p-4 border-b border-border bg-surface flex items-center justify-between",children:[n.jsxs("h3",{className:"text-sm font-bold text-text-primary flex items-center gap-2",children:[n.jsx(N1,{size:16,className:"text-[var(--burgundy)]"}),"Kaytl Safihalar"]}),n.jsxs(ut,{variant:"outline",className:"text-[10px] font-medium",children:[t.length," Adet"]})]}),a?n.jsx("div",{className:"flex items-center justify-center py-16",children:n.jsx(Ar,{size:24,className:"animate-spin text-text-tertiary"})}):t.length===0?n.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[n.jsx(ms,{size:40,className:"text-status-warning mb-3"}),n.jsx("p",{className:"font-bold text-text-primary mb-1",children:"Henz safiha eklenmemi"}),n.jsx("p",{className:"text-sm text-text-secondary max-w-md",children:"Safiha optimizasyonu yapabilmek iin elinizdeki safiha ebatlarn yukardaki formdan ekleyin veya Excel dosyanz ykleyin."})]}):n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full text-sm",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"border-b-2 border-border/60 uppercase tracking-widest text-[#1A1D1F] text-xs",children:[n.jsx("th",{className:"text-left px-4 py-3 font-black",children:"Kod"}),n.jsx("th",{className:"text-center px-4 py-3 font-black",children:"En (mm)"}),n.jsx("th",{className:"text-center px-4 py-3 font-black",children:"Boy (mm)"}),n.jsx("th",{className:"text-center px-4 py-3 font-black",children:"Gramaj"}),n.jsx("th",{className:"text-center px-4 py-3 font-black",children:"Flute"}),n.jsx("th",{className:"text-center px-4 py-3 font-black",children:"Min. Adet"}),n.jsx("th",{className:"text-center px-4 py-3 font-black",children:"Not"}),n.jsx("th",{className:"text-center px-4 py-3 font-black w-16"})]})}),n.jsx("tbody",{className:"divide-y divide-border",children:t.map(M=>{var Y;return n.jsxs("tr",{className:"bg-surface hover:bg-surface-secondary/50 transition-colors",children:[n.jsx("td",{className:"px-4 py-3 font-medium text-text-primary",children:M.code||""}),n.jsx("td",{className:"px-4 py-3 text-center font-bold text-text-primary",children:M.widthMm}),n.jsx("td",{className:"px-4 py-3 text-center font-bold text-text-primary",children:M.heightMm}),n.jsx("td",{className:"px-4 py-3 text-center text-text-secondary",children:M.gramaj||""}),n.jsx("td",{className:"px-4 py-3 text-center",children:M.flute?n.jsx(ut,{variant:"outline",className:"text-[10px]",children:M.flute}):""}),n.jsx("td",{className:"px-4 py-3 text-center text-text-secondary",children:((Y=M.minQty)==null?void 0:Y.toLocaleString("tr-TR"))||""}),n.jsx("td",{className:"px-4 py-3 text-center text-text-tertiary text-xs max-w-[120px] truncate",children:M.note||""}),n.jsx("td",{className:"px-4 py-3 text-center",children:n.jsx(Re,{variant:"ghost",size:"icon",className:"h-8 w-8 text-status-error hover:bg-status-error/10",onClick:()=>re(M.id),children:n.jsx(sa,{size:14})})})]},M.id)})})]})})]})]})}function gW(e,t){const[r,a]=b.useState(!1);return b.useEffect(()=>{const s=e.current;if(!s||r)return;const i=new IntersectionObserver(([l])=>{l.isIntersecting&&(a(!0),i.unobserve(s))},{threshold:(t==null?void 0:t.threshold)||.1,root:(t==null?void 0:t.root)||null,rootMargin:(t==null?void 0:t.rootMargin)||"0px"});return i.observe(s),()=>{s&&i.unobserve(s)}},[e,r,t]),r}const at=({children:e,delay:t=0,className:r="",threshold:a=.1})=>{const s=b.useRef(null),i=gW(s,{threshold:a});return n.jsx("div",{ref:s,style:{transitionDelay:`${t}ms`},className:`reveal ${i?"reveal--in":""} ${r}`,children:e})};var Lf,x1;function vW(){if(x1)return Lf;x1=1;var e=typeof Element<"u",t=typeof Map=="function",r=typeof Set=="function",a=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function s(i,l){if(i===l)return!0;if(i&&l&&typeof i=="object"&&typeof l=="object"){if(i.constructor!==l.constructor)return!1;var o,c,d;if(Array.isArray(i)){if(o=i.length,o!=l.length)return!1;for(c=o;c--!==0;)if(!s(i[c],l[c]))return!1;return!0}var u;if(t&&i instanceof Map&&l instanceof Map){if(i.size!==l.size)return!1;for(u=i.entries();!(c=u.next()).done;)if(!l.has(c.value[0]))return!1;for(u=i.entries();!(c=u.next()).done;)if(!s(c.value[1],l.get(c.value[0])))return!1;return!0}if(r&&i instanceof Set&&l instanceof Set){if(i.size!==l.size)return!1;for(u=i.entries();!(c=u.next()).done;)if(!l.has(c.value[0]))return!1;return!0}if(a&&ArrayBuffer.isView(i)&&ArrayBuffer.isView(l)){if(o=i.length,o!=l.length)return!1;for(c=o;c--!==0;)if(i[c]!==l[c])return!1;return!0}if(i.constructor===RegExp)return i.source===l.source&&i.flags===l.flags;if(i.valueOf!==Object.prototype.valueOf&&typeof i.valueOf=="function"&&typeof l.valueOf=="function")return i.valueOf()===l.valueOf();if(i.toString!==Object.prototype.toString&&typeof i.toString=="function"&&typeof l.toString=="function")return i.toString()===l.toString();if(d=Object.keys(i),o=d.length,o!==Object.keys(l).length)return!1;for(c=o;c--!==0;)if(!Object.prototype.hasOwnProperty.call(l,d[c]))return!1;if(e&&i instanceof Element)return!1;for(c=o;c--!==0;)if(!((d[c]==="_owner"||d[c]==="__v"||d[c]==="__o")&&i.$$typeof)&&!s(i[d[c]],l[d[c]]))return!1;return!0}return i!==i&&l!==l}return Lf=function(l,o){try{return s(l,o)}catch(c){if((c.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw c}},Lf}var yW=vW();const bW=Yd(yW);var Bf,p1;function wW(){if(p1)return Bf;p1=1;var e=function(t,r,a,s,i,l,o,c){if(!t){var d;if(r===void 0)d=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[a,s,i,l,o,c],f=0;d=new Error(r.replace(/%s/g,function(){return u[f++]})),d.name="Invariant Violation"}throw d.framesToPop=1,d}};return Bf=e,Bf}var kW=wW();const g1=Yd(kW);var zf,v1;function NW(){return v1||(v1=1,zf=function(t,r,a,s){var i=a?a.call(s,t,r):void 0;if(i!==void 0)return!!i;if(t===r)return!0;if(typeof t!="object"||!t||typeof r!="object"||!r)return!1;var l=Object.keys(t),o=Object.keys(r);if(l.length!==o.length)return!1;for(var c=Object.prototype.hasOwnProperty.bind(r),d=0;d<l.length;d++){var u=l[d];if(!c(u))return!1;var f=t[u],h=r[u];if(i=a?a.call(s,f,h,u):void 0,i===!1||i===void 0&&f!==h)return!1}return!0}),zf}var jW=NW();const EW=Yd(jW);var cE=(e=>(e.BASE="base",e.BODY="body",e.HEAD="head",e.HTML="html",e.LINK="link",e.META="meta",e.NOSCRIPT="noscript",e.SCRIPT="script",e.STYLE="style",e.TITLE="title",e.FRAGMENT="Symbol(react.fragment)",e))(cE||{}),Uf={link:{rel:["amphtml","canonical","alternate"]},script:{type:["application/ld+json"]},meta:{charset:"",name:["generator","robots","description"],property:["og:type","og:title","og:url","og:image","og:image:alt","og:description","twitter:url","twitter:title","twitter:description","twitter:image","twitter:image:alt","twitter:card","twitter:site"]}},y1=Object.values(cE),Cx={accesskey:"accessKey",charset:"charSet",class:"className",contenteditable:"contentEditable",contextmenu:"contextMenu","http-equiv":"httpEquiv",itemprop:"itemProp",tabindex:"tabIndex"},SW=Object.entries(Cx).reduce((e,[t,r])=>(e[r]=t,e),{}),on="data-rh",Qi={DEFAULT_TITLE:"defaultTitle",DEFER:"defer",ENCODE_SPECIAL_CHARACTERS:"encodeSpecialCharacters",ON_CHANGE_CLIENT_STATE:"onChangeClientState",TITLE_TEMPLATE:"titleTemplate",PRIORITIZE_SEO_TAGS:"prioritizeSeoTags"},el=(e,t)=>{for(let r=e.length-1;r>=0;r-=1){const a=e[r];if(Object.prototype.hasOwnProperty.call(a,t))return a[t]}return null},TW=e=>{let t=el(e,"title");const r=el(e,Qi.TITLE_TEMPLATE);if(Array.isArray(t)&&(t=t.join("")),r&&t)return r.replace(/%s/g,()=>t);const a=el(e,Qi.DEFAULT_TITLE);return t||a||void 0},AW=e=>el(e,Qi.ON_CHANGE_CLIENT_STATE)||(()=>{}),Vf=(e,t)=>t.filter(r=>typeof r[e]<"u").map(r=>r[e]).reduce((r,a)=>({...r,...a}),{}),_W=(e,t)=>t.filter(r=>typeof r.base<"u").map(r=>r.base).reverse().reduce((r,a)=>{if(!r.length){const s=Object.keys(a);for(let i=0;i<s.length;i+=1){const o=s[i].toLowerCase();if(e.indexOf(o)!==-1&&a[o])return r.concat(a)}}return r},[]),CW=e=>console&&typeof console.warn=="function"&&console.warn(e),Ol=(e,t,r)=>{const a={};return r.filter(s=>Array.isArray(s[e])?!0:(typeof s[e]<"u"&&CW(`Helmet: ${e} should be of type "Array". Instead found type "${typeof s[e]}"`),!1)).map(s=>s[e]).reverse().reduce((s,i)=>{const l={};i.filter(c=>{let d;const u=Object.keys(c);for(let h=0;h<u.length;h+=1){const m=u[h],x=m.toLowerCase();t.indexOf(x)!==-1&&!(d==="rel"&&c[d].toLowerCase()==="canonical")&&!(x==="rel"&&c[x].toLowerCase()==="stylesheet")&&(d=x),t.indexOf(m)!==-1&&(m==="innerHTML"||m==="cssText"||m==="itemprop")&&(d=m)}if(!d||!c[d])return!1;const f=c[d].toLowerCase();return a[d]||(a[d]={}),l[d]||(l[d]={}),a[d][f]?!1:(l[d][f]=!0,!0)}).reverse().forEach(c=>s.push(c));const o=Object.keys(l);for(let c=0;c<o.length;c+=1){const d=o[c],u={...a[d],...l[d]};a[d]=u}return s},[]).reverse()},FW=(e,t)=>{if(Array.isArray(e)&&e.length){for(let r=0;r<e.length;r+=1)if(e[r][t])return!0}return!1},DW=e=>({baseTag:_W(["href"],e),bodyAttributes:Vf("bodyAttributes",e),defer:el(e,Qi.DEFER),encode:el(e,Qi.ENCODE_SPECIAL_CHARACTERS),htmlAttributes:Vf("htmlAttributes",e),linkTags:Ol("link",["rel","href"],e),metaTags:Ol("meta",["name","charset","http-equiv","property","itemprop"],e),noscriptTags:Ol("noscript",["innerHTML"],e),onChangeClientState:AW(e),scriptTags:Ol("script",["src","innerHTML"],e),styleTags:Ol("style",["cssText"],e),title:TW(e),titleAttributes:Vf("titleAttributes",e),prioritizeSeoTags:FW(e,Qi.PRIORITIZE_SEO_TAGS)}),dE=e=>Array.isArray(e)?e.join(""):e,RW=(e,t)=>{const r=Object.keys(e);for(let a=0;a<r.length;a+=1)if(t[r[a]]&&t[r[a]].includes(e[r[a]]))return!0;return!1},Hf=(e,t)=>Array.isArray(e)?e.reduce((r,a)=>(RW(a,t)?r.priority.push(a):r.default.push(a),r),{priority:[],default:[]}):{default:e,priority:[]},b1=(e,t)=>({...e,[t]:void 0}),MW=["noscript","script","style"],ah=(e,t=!0)=>t===!1?String(e):String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;"),uE=e=>Object.keys(e).reduce((t,r)=>{const a=typeof e[r]<"u"?`${r}="${e[r]}"`:`${r}`;return t?`${t} ${a}`:a},""),PW=(e,t,r,a)=>{const s=uE(r),i=dE(t);return s?`<${e} ${on}="true" ${s}>${ah(i,a)}</${e}>`:`<${e} ${on}="true">${ah(i,a)}</${e}>`},OW=(e,t,r=!0)=>t.reduce((a,s)=>{const i=s,l=Object.keys(i).filter(d=>!(d==="innerHTML"||d==="cssText")).reduce((d,u)=>{const f=typeof i[u]>"u"?u:`${u}="${ah(i[u],r)}"`;return d?`${d} ${f}`:f},""),o=i.innerHTML||i.cssText||"",c=MW.indexOf(e)===-1;return`${a}<${e} ${on}="true" ${l}${c?"/>":`>${o}</${e}>`}`},""),fE=(e,t={})=>Object.keys(e).reduce((r,a)=>{const s=Cx[a];return r[s||a]=e[a],r},t),IW=(e,t,r)=>{const a={key:t,[on]:!0},s=fE(r,a);return[me.createElement("title",s,t)]},cd=(e,t)=>t.map((r,a)=>{const s={key:a,[on]:!0};return Object.keys(r).forEach(i=>{const o=Cx[i]||i;if(o==="innerHTML"||o==="cssText"){const c=r.innerHTML||r.cssText;s.dangerouslySetInnerHTML={__html:c}}else s[o]=r[i]}),me.createElement(e,s)}),La=(e,t,r=!0)=>{switch(e){case"title":return{toComponent:()=>IW(e,t.title,t.titleAttributes),toString:()=>PW(e,t.title,t.titleAttributes,r)};case"bodyAttributes":case"htmlAttributes":return{toComponent:()=>fE(t),toString:()=>uE(t)};default:return{toComponent:()=>cd(e,t),toString:()=>OW(e,t,r)}}},LW=({metaTags:e,linkTags:t,scriptTags:r,encode:a})=>{const s=Hf(e,Uf.meta),i=Hf(t,Uf.link),l=Hf(r,Uf.script);return{priorityMethods:{toComponent:()=>[...cd("meta",s.priority),...cd("link",i.priority),...cd("script",l.priority)],toString:()=>`${La("meta",s.priority,a)} ${La("link",i.priority,a)} ${La("script",l.priority,a)}`},metaTags:s.default,linkTags:i.default,scriptTags:l.default}},BW=e=>{const{baseTag:t,bodyAttributes:r,encode:a=!0,htmlAttributes:s,noscriptTags:i,styleTags:l,title:o="",titleAttributes:c,prioritizeSeoTags:d}=e;let{linkTags:u,metaTags:f,scriptTags:h}=e,m={toComponent:()=>{},toString:()=>""};return d&&({priorityMethods:m,linkTags:u,metaTags:f,scriptTags:h}=LW(e)),{priority:m,base:La("base",t,a),bodyAttributes:La("bodyAttributes",r,a),htmlAttributes:La("htmlAttributes",s,a),link:La("link",u,a),meta:La("meta",f,a),noscript:La("noscript",i,a),script:La("script",h,a),style:La("style",l,a),title:La("title",{title:o,titleAttributes:c},a)}},nh=BW,Wc=[],hE=!!(typeof window<"u"&&window.document&&window.document.createElement),sh=class{constructor(e,t){Un(this,"instances",[]);Un(this,"canUseDOM",hE);Un(this,"context");Un(this,"value",{setHelmet:e=>{this.context.helmet=e},helmetInstances:{get:()=>this.canUseDOM?Wc:this.instances,add:e=>{(this.canUseDOM?Wc:this.instances).push(e)},remove:e=>{const t=(this.canUseDOM?Wc:this.instances).indexOf(e);(this.canUseDOM?Wc:this.instances).splice(t,1)}}});this.context=e,this.canUseDOM=t||!1,t||(e.helmet=nh({baseTag:[],bodyAttributes:{},htmlAttributes:{},linkTags:[],metaTags:[],noscriptTags:[],scriptTags:[],styleTags:[],title:"",titleAttributes:{}}))}},zW={},mE=me.createContext(zW),Ks,xE=(Ks=class extends b.Component{constructor(r){super(r);Un(this,"helmetData");this.helmetData=new sh(this.props.context||{},Ks.canUseDOM)}render(){return me.createElement(mE.Provider,{value:this.helmetData.value},this.props.children)}},Un(Ks,"canUseDOM",hE),Ks),Ai=(e,t)=>{const r=document.head||document.querySelector("head"),a=r.querySelectorAll(`${e}[${on}]`),s=[].slice.call(a),i=[];let l;return t&&t.length&&t.forEach(o=>{const c=document.createElement(e);for(const d in o)if(Object.prototype.hasOwnProperty.call(o,d))if(d==="innerHTML")c.innerHTML=o.innerHTML;else if(d==="cssText")c.styleSheet?c.styleSheet.cssText=o.cssText:c.appendChild(document.createTextNode(o.cssText));else{const u=d,f=typeof o[u]>"u"?"":o[u];c.setAttribute(d,f)}c.setAttribute(on,"true"),s.some((d,u)=>(l=u,c.isEqualNode(d)))?s.splice(l,1):i.push(c)}),s.forEach(o=>{var c;return(c=o.parentNode)==null?void 0:c.removeChild(o)}),i.forEach(o=>r.appendChild(o)),{oldTags:s,newTags:i}},ih=(e,t)=>{const r=document.getElementsByTagName(e)[0];if(!r)return;const a=r.getAttribute(on),s=a?a.split(","):[],i=[...s],l=Object.keys(t);for(const o of l){const c=t[o]||"";r.getAttribute(o)!==c&&r.setAttribute(o,c),s.indexOf(o)===-1&&s.push(o);const d=i.indexOf(o);d!==-1&&i.splice(d,1)}for(let o=i.length-1;o>=0;o-=1)r.removeAttribute(i[o]);s.length===i.length?r.removeAttribute(on):r.getAttribute(on)!==l.join(",")&&r.setAttribute(on,l.join(","))},UW=(e,t)=>{typeof e<"u"&&document.title!==e&&(document.title=dE(e)),ih("title",t)},w1=(e,t)=>{const{baseTag:r,bodyAttributes:a,htmlAttributes:s,linkTags:i,metaTags:l,noscriptTags:o,onChangeClientState:c,scriptTags:d,styleTags:u,title:f,titleAttributes:h}=e;ih("body",a),ih("html",s),UW(f,h);const m={baseTag:Ai("base",r),linkTags:Ai("link",i),metaTags:Ai("meta",l),noscriptTags:Ai("noscript",o),scriptTags:Ai("script",d),styleTags:Ai("style",u)},x={},p={};Object.keys(m).forEach(g=>{const{newTags:y,oldTags:N}=m[g];y.length&&(x[g]=y),N.length&&(p[g]=m[g].oldTags)}),t&&t(),c(e,x,p)},Il=null,VW=e=>{Il&&cancelAnimationFrame(Il),e.defer?Il=requestAnimationFrame(()=>{w1(e,()=>{Il=null})}):(w1(e),Il=null)},HW=VW,k1=class extends b.Component{constructor(){super(...arguments);Un(this,"rendered",!1)}shouldComponentUpdate(t){return!EW(t,this.props)}componentDidUpdate(){this.emitChange()}componentWillUnmount(){const{helmetInstances:t}=this.props.context;t.remove(this),this.emitChange()}emitChange(){const{helmetInstances:t,setHelmet:r}=this.props.context;let a=null;const s=DW(t.get().map(i=>{const l={...i.props};return delete l.context,l}));xE.canUseDOM?HW(s):nh&&(a=nh(s)),r(a)}init(){if(this.rendered)return;this.rendered=!0;const{helmetInstances:t}=this.props.context;t.add(this),this.emitChange()}render(){return this.init(),null}},Yf,yn=(Yf=class extends b.Component{shouldComponentUpdate(e){return!bW(b1(this.props,"helmetData"),b1(e,"helmetData"))}mapNestedChildrenToProps(e,t){if(!t)return null;switch(e.type){case"script":case"noscript":return{innerHTML:t};case"style":return{cssText:t};default:throw new Error(`<${e.type} /> elements are self-closing and can not contain children. Refer to our API for more information.`)}}flattenArrayTypeChildren(e,t,r,a){return{...t,[e.type]:[...t[e.type]||[],{...r,...this.mapNestedChildrenToProps(e,a)}]}}mapObjectTypeChildren(e,t,r,a){switch(e.type){case"title":return{...t,[e.type]:a,titleAttributes:{...r}};case"body":return{...t,bodyAttributes:{...r}};case"html":return{...t,htmlAttributes:{...r}};default:return{...t,[e.type]:{...r}}}}mapArrayTypeChildrenToProps(e,t){let r={...t};return Object.keys(e).forEach(a=>{r={...r,[a]:e[a]}}),r}warnOnInvalidChildren(e,t){return g1(y1.some(r=>e.type===r),typeof e.type=="function"?"You may be attempting to nest <Helmet> components within each other, which is not allowed. Refer to our API for more information.":`Only elements types ${y1.join(", ")} are allowed. Helmet does not support rendering <${e.type}> elements. Refer to our API for more information.`),g1(!t||typeof t=="string"||Array.isArray(t)&&!t.some(r=>typeof r!="string"),`Helmet expects a string as a child of <${e.type}>. Did you forget to wrap your children in braces? ( <${e.type}>{\`\`}</${e.type}> ) Refer to our API for more information.`),!0}mapChildrenToProps(e,t){let r={};return me.Children.forEach(e,a=>{if(!a||!a.props)return;const{children:s,...i}=a.props,l=Object.keys(i).reduce((c,d)=>(c[SW[d]||d]=i[d],c),{});let{type:o}=a;switch(typeof o=="symbol"?o=o.toString():this.warnOnInvalidChildren(a,s),o){case"Symbol(react.fragment)":t=this.mapChildrenToProps(s,t);break;case"link":case"meta":case"noscript":case"script":case"style":r=this.flattenArrayTypeChildren(a,r,l,s);break;default:t=this.mapObjectTypeChildren(a,t,l,s);break}}),this.mapArrayTypeChildrenToProps(r,t)}render(){const{children:e,...t}=this.props;let r={...t},{helmetData:a}=t;if(e&&(r=this.mapChildrenToProps(e,r)),a&&!(a instanceof sh)){const s=a;a=new sh(s.context,!0),delete r.helmetData}return a?me.createElement(k1,{...r,context:a.value}):me.createElement(mE.Consumer,null,s=>me.createElement(k1,{...r,context:s}))}},Un(Yf,"defaultProps",{defer:!0,encodeSpecialCharacters:!0,prioritizeSeoTags:!1}),Yf);function $W(){const{user:e,loading:t}=vr();return!t&&e?n.jsx(Zc,{to:"/dashboard",replace:!0}):t?n.jsx("div",{className:"min-h-screen flex items-center justify-center bg-white",children:n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#800020]"})}):n.jsxs(n.Fragment,{children:[n.jsxs(yn,{children:[n.jsx("title",{children:"Ulgen One | Endstriyel retim ve Fiyatlama Kontrol Sistemi"}),n.jsx("meta",{name:"description",content:"Oluklu koli retiminde deterministik safiha optimizasyonu, fire simlasyonu ve mhendislik tabanl maliyet analizi."})]}),n.jsxs("main",{className:"overflow-x-hidden pt-20",children:[n.jsx("section",{className:"relative py-24 lg:py-32 px-6 border-b border-[#E2E8F0] bg-[#F8FAFC]",children:n.jsxs("div",{className:"max-w-[1440px] mx-auto grid lg:grid-cols-2 gap-20 items-center",children:[n.jsxs(at,{className:"space-y-10",children:[n.jsxs("div",{className:"inline-flex items-center gap-3 px-4 py-2 rounded bg-white border border-[#E2E8F0] text-[#1A1D1F] text-[10px] font-black uppercase tracking-[0.2em] shadow-sm",children:[n.jsx("span",{className:"w-2 h-2 rounded-full bg-[#10B981] animate-pulse"})," SYSTEM STATUS: OPERATIONAL"]}),n.jsxs("h1",{className:"text-5xl lg:text-8xl font-black tracking-tighter text-[#1A1D1F] leading-[0.9] uppercase",children:["RETM ",n.jsx("br",{})," ",n.jsx("span",{className:"text-[#800020]",children:"OPTMZASYON"})," ",n.jsx("br",{})," PROTOKOL"]}),n.jsx("p",{className:"text-xl text-[#6B7280] leading-relaxed max-w-xl font-medium",children:"Oluklu mukavva retimindeki karmak fiyatlama ve safiha yerleim srelerini deterministik algoritmalarla dijitalletirin. Tahmine dayal deil, veriye dayal ynetim."}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 pt-4",children:[n.jsxs(At,{to:"/register",className:"px-10 py-5 bg-[#1A1D1F] text-white font-black rounded-sm text-center hover:bg-black transition-all shadow-xl shadow-black/10 flex items-center justify-center gap-3 uppercase text-xs tracking-widest",children:["Sistemi Balat ",n.jsx(Ta,{size:18})]}),n.jsx(At,{to:"/teknik-analiz",className:"px-10 py-5 border-2 border-[#1A1D1F] text-[#1A1D1F] font-black rounded-sm bg-transparent hover:bg-[#1A1D1F]/5 transition-all text-center flex items-center justify-center gap-3 uppercase text-xs tracking-widest",children:"Dokmantasyonu ncele"})]})]}),n.jsx(at,{delay:200,className:"relative",children:n.jsxs(tt,{className:"border-[#1A1D1F]/10 shadow-2xl overflow-hidden bg-white p-0",children:[n.jsxs("div",{className:"bg-[#1A1D1F] p-4 flex items-center justify-between border-b border-white/10",children:[n.jsxs("div",{className:"flex gap-2",children:[n.jsx("div",{className:"w-3 h-3 rounded-full bg-[#FF5F56]"}),n.jsx("div",{className:"w-3 h-3 rounded-full bg-[#FFBD2E]"}),n.jsx("div",{className:"w-3 h-3 rounded-full bg-[#27C93F]"})]}),n.jsx("span",{className:"text-[10px] font-bold text-white/40 tracking-[0.3em] uppercase",children:"Engine Preview v2.4"})]}),n.jsxs("div",{className:"p-8 space-y-8 bg-[#F8FAFC]",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"p-4 bg-white border border-[#E2E8F0] rounded shadow-sm space-y-2",children:[n.jsx("span",{className:"text-[10px] font-black text-[#94A3B8] uppercase tracking-widest",children:"Optimizasyon Skoru"}),n.jsx("div",{className:"text-3xl font-black text-[#10B981] tracking-tighter",children:"98.4%"})]}),n.jsxs("div",{className:"p-4 bg-white border border-[#E2E8F0] rounded shadow-sm space-y-2",children:[n.jsx("span",{className:"text-[10px] font-black text-[#94A3B8] uppercase tracking-widest",children:"Bakiye Fire"}),n.jsx("div",{className:"text-3xl font-black text-[#800020] tracking-tighter",children:"1.6%"})]})]}),n.jsxs("div",{className:"space-y-3 font-mono text-[11px] text-[#475569] bg-white p-6 border border-[#E2E8F0] rounded",children:[n.jsxs("div",{className:"flex justify-between border-b border-[#F1F5F9] pb-2",children:[n.jsx("span",{className:"text-[#94A3B8] tracking-widest uppercase",children:"Analysis Core"}),n.jsx("span",{className:"text-[#1A1D1F] font-bold",children:"DETERMINISTIC_BIN_PACKING"})]}),n.jsxs("div",{className:"pt-2 text-[#64748B]",children:["[BLG] 800x1200 safiha iin yerleim simlasyonu balatlyor...",n.jsx("br",{}),"[BLG] Rotasyonel permtasyonlar hesaplanyor...",n.jsx("br",{}),"[BAARILI] Optimal desen: 3x6 zgara (18 adet/safiha)",n.jsx("br",{}),"[METRK] Hesaplanan m verimi: 0.984"]})]})]})]})})]})}),n.jsx("section",{className:"py-24 px-6 border-b border-[#E2E8F0]",children:n.jsxs("div",{className:"max-w-[1440px] mx-auto",children:[n.jsxs(at,{className:"max-w-3xl mb-16 space-y-6",children:[n.jsxs("h2",{className:"text-3xl lg:text-5xl font-black tracking-tighter text-[#1A1D1F] uppercase italic",children:["FNANSAL ",n.jsx("span",{className:"text-[#800020]",children:"DARBOAZLAR"})]}),n.jsx("p",{className:"text-lg text-[#6B7280] font-medium leading-relaxed",children:"Geleneksel Excel tabanl fiyatlama yntemleri, yksek hacimli retimde milimetrik fireleri ve anlk hammadde dalgalanmalarn doru optimize edemez. Bu durum, yllk bazda %15'e varan gizli kr kayplarna yol aar."})]}),n.jsx("div",{className:"grid md:grid-cols-3 gap-8",children:[{icon:n.jsx(fl,{className:"text-[#800020]",size:24}),title:"Marj Daralmas",desc:"Doru hesaplanmayan fire paylar, birim ba kr marjnz beklenen seviyenin altna eker."},{icon:n.jsx(vh,{className:"text-[#800020]",size:24}),title:"Hz Entegre Deil",desc:"Teklif hazrlama sresinin uzunluu, sat ekibinin pazar dinamiklerine evik yant vermesini engeller."},{icon:n.jsx(hs,{className:"text-[#800020]",size:24}),title:"Verisiz Onay",desc:"Teknik detaylarn (rill, flap, fire) net grlmedii projelerde onay sreci riskli hale gelir."}].map((r,a)=>n.jsxs(at,{delay:a*100,className:"p-10 border border-[#E2E8F0] bg-white rounded shadow-sm hover:shadow-md transition-all",children:[n.jsx("div",{className:"mb-8",children:r.icon}),n.jsx("h3",{className:"text-xl font-black text-[#1A1D1F] uppercase mb-4 tracking-tighter",children:r.title}),n.jsx("p",{className:"text-sm text-[#6B7280] leading-relaxed font-medium",children:r.desc})]},a))})]})}),n.jsx("section",{className:"py-24 px-6 bg-[#1A1D1F] text-white",children:n.jsxs("div",{className:"max-w-[1440px] mx-auto grid lg:grid-cols-2 gap-24 items-center",children:[n.jsxs(at,{className:"space-y-8",children:[n.jsx(ut,{className:"bg-[#800020] text-white border-0 py-1.5 px-4 text-[10px] font-black uppercase tracking-widest",children:"Engine Methodology"}),n.jsxs("h2",{className:"text-4xl lg:text-6xl font-black tracking-tighter text-white uppercase leading-none",children:["MATEMATKSEL ",n.jsx("br",{})," ",n.jsx("span",{className:"text-white/40",children:"HASSASYET"})]}),n.jsx("p",{className:"text-lg text-white/80 leading-relaxed font-medium",children:"Ulgen One, rastgele tahminler yerine koli tipine ve makine toleranslarna bal olarak milimetrik alm formllerini kullanr. Her hesaplama, fabrikasyon kstlarn gzeterek yaplr."}),n.jsxs("div",{className:"p-8 border border-white/10 bg-white/5 rounded font-mono text-sm space-y-8",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx("div",{className:"text-white/40 text-[10px] font-black uppercase tracking-widest",children:"Formula Preview"}),n.jsx("div",{className:"text-[#10B981] font-bold",children:"n_yield = floor( (sheet_W - T) / item_w )  floor( (sheet_H - T) / item_h )"})]}),n.jsxs("p",{className:"text-[11px] text-white/40 italic leading-relaxed",children:["* T = retim tolerans ve kesim pay (trim). ",n.jsx("br",{}),"* floor fonksiyonu, fiziksel kapasitede asla hayali adet retilmemesini garanti eder."]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-8",children:[n.jsxs("div",{className:"space-y-4 p-8 border border-white/10 rounded",children:[n.jsx(is,{className:"text-[#800020]",size:32}),n.jsx("h4",{className:"text-lg font-black text-white uppercase tracking-tighter",children:"DETERMNSTK"}),n.jsx("p",{className:"text-xs text-white/50 leading-relaxed font-medium",children:"Ayn girdiler her zaman ayn en verimli sonucu verir. nsan hatas elenir."})]}),n.jsxs("div",{className:"space-y-4 p-8 border border-white/10 rounded",children:[n.jsx(ei,{className:"text-[#800020]",size:32}),n.jsx("h4",{className:"text-lg font-black text-white uppercase tracking-tighter",children:"EBAT ODAKLI"}),n.jsx("p",{className:"text-xs text-white/50 leading-relaxed font-medium",children:"Safiha en-boy oranlarn milimetrik analiz ederek fireyi en aza indirir."})]}),n.jsxs("div",{className:"space-y-4 p-8 border border-white/10 rounded",children:[n.jsx(Xr,{className:"text-[#800020]",size:32}),n.jsx("h4",{className:"text-lg font-black text-white uppercase tracking-tighter",children:"ANLIK"}),n.jsx("p",{className:"text-xs text-white/50 leading-relaxed font-medium",children:"Karmak bin-packing algoritmalar milisaniyeler iinde sonu retir."})]}),n.jsxs("div",{className:"space-y-4 p-8 border border-white/10 rounded",children:[n.jsx(us,{className:"text-[#800020]",size:32}),n.jsx("h4",{className:"text-lg font-black text-white uppercase tracking-tighter",children:"OKLU ANALZ"}),n.jsx("p",{className:"text-xs text-white/50 leading-relaxed font-medium",children:"Ayn koli iin yzlerce farkl safiha senaryosu ezamanl taranr."})]})]})]})}),n.jsx("section",{className:"py-24 px-6 border-b border-[#E2E8F0] bg-[#FAFBFC]",children:n.jsxs("div",{className:"max-w-[1440px] mx-auto space-y-16",children:[n.jsxs(at,{className:"text-center space-y-6",children:[n.jsx("h2",{className:"text-3xl lg:text-5xl font-black tracking-tighter text-[#1A1D1F] uppercase",children:"Safiha Verimlilik Matrisi"}),n.jsx("p",{className:"text-[#6B7280] max-w-2xl mx-auto font-medium leading-relaxed",children:"Farkl safiha ebatlarnn ayn koli tipi iin sunduu performans analizi. En dk fire oranna sahip ebat otomatik olarak iaretlenir."})]}),n.jsx(at,{delay:200,children:n.jsx(tt,{className:"border-[#E2E8F0] shadow-xl overflow-hidden bg-white",children:n.jsxs(hn,{children:[n.jsx(mn,{className:"bg-[#1A1D1F]",children:n.jsxs(zt,{className:"hover:bg-transparent border-0 lowercase",children:[n.jsx(Ve,{className:"text-white/80 font-black tracking-widest text-[10px] uppercase h-14",children:"Safiha Ebat (mm)"}),n.jsx(Ve,{className:"text-white/80 font-black tracking-widest text-center text-[10px] uppercase h-14",children:"Verimlilik (Adet)"}),n.jsx(Ve,{className:"text-white/80 font-black tracking-widest text-center text-[10px] uppercase h-14",children:"Dizilim"}),n.jsx(Ve,{className:"text-white/80 font-black tracking-widest text-center text-[10px] uppercase h-14",children:"Net Fire %"}),n.jsx(Ve,{className:"text-white/80 font-black tracking-widest text-center text-[10px] uppercase h-14",children:"Maliyet Etkisi"})]})}),n.jsx(xn,{children:[{ebat:"800 x 1200",adet:18,dizilim:"3 x 6",fire:"1.6%",status:"optimal"},{ebat:"900 x 1300",adet:20,dizilim:"4 x 5",fire:"12.4%",status:"normal"},{ebat:"1000 x 1400",adet:24,dizilim:"4 x 6",fire:"8.2%",status:"normal"},{ebat:"700 x 1100",adet:12,dizilim:"3 x 4",fire:"18.5%",status:"warning"}].map((r,a)=>n.jsxs(zt,{className:`hover:bg-transparent ${r.status==="optimal"?"bg-[#10B981]/5":""}`,children:[n.jsx(Oe,{className:"font-mono font-bold text-[#1A1D1F] h-16",children:r.ebat}),n.jsx(Oe,{className:"text-center font-black text-[#1A1D1F]",children:r.adet}),n.jsx(Oe,{className:"text-center font-bold text-[#6B7280]",children:r.dizilim}),n.jsx(Oe,{className:"text-center",children:n.jsx("span",{className:`font-black ${r.status==="optimal"?"text-[#10B981]":r.status==="warning"?"text-[#800020]":"text-[#1A1D1F]"}`,children:r.fire})}),n.jsx(Oe,{className:"text-center",children:r.status==="optimal"?n.jsx(ut,{className:"bg-[#10B981] text-white border-0 font-black text-[9px] uppercase tracking-widest",children:"En Verimli"}):n.jsx("span",{className:"text-[10px] font-bold text-[#94A3B8] uppercase",children:"Standart"})})]},a))})]})})})]})}),n.jsx("section",{className:"py-24 px-6 border-b border-[#E2E8F0]",children:n.jsxs("div",{className:"max-w-[1440px] mx-auto grid lg:grid-cols-2 gap-24 items-center",children:[n.jsxs(at,{className:"space-y-10",children:[n.jsxs("h2",{className:"text-3xl lg:text-5xl font-black tracking-tighter text-[#1A1D1F] uppercase leading-none",children:["OPERASYONEL ",n.jsx("br",{})," ",n.jsx("span",{className:"text-[#800020]",children:"KIYASLAMA"})]}),n.jsxs("div",{className:"space-y-8",children:[n.jsxs("div",{className:"p-8 border border-[#E2E8F0] rounded space-y-4 bg-white shadow-sm ring-1 ring-[#1A1D1F]/5 transition-all hover:ring-[#800020]/20",children:[n.jsxs("div",{className:"flex justify-between items-center opacity-40",children:[n.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Senaryo A"}),n.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Manuel Hesaplama"})]}),n.jsx("h4",{className:"text-xl font-black text-[#1A1D1F] uppercase",children:"Tahmini Fire %15"}),n.jsx("p",{className:"text-sm text-[#6B7280] font-medium leading-relaxed",children:"Standart ebatlara manuel yerleim yapldnda, gizli paylar ve rill kanallar kabaca hesaplanr. Bu durum %15 fire zerinden fiyatlama yaplmasna neden olur."})]}),n.jsxs("div",{className:"p-8 border-2 border-[#800020] rounded space-y-4 bg-white shadow-xl shadow-[#800020]/5",children:[n.jsxs("div",{className:"flex justify-between items-center text-[#800020]",children:[n.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Senaryo B"}),n.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Ulgen One Engine"})]}),n.jsx("h4",{className:"text-xl font-black text-[#1A1D1F] uppercase text-[#800020]",children:"Gerek Fire %4.82"}),n.jsx("p",{className:"text-sm text-[#6B7280] font-medium leading-relaxed",children:"Engine, tm rotasyonel varyasyonlar deneyerek en dar fire araln bulur. %10.18'lik fark, 100.000 adetlik retimde devasa bir kr marj iyiletirmesi salar."})]})]})]}),n.jsx(at,{delay:400,className:"space-y-8",children:n.jsxs("div",{className:"aspect-video bg-[#0D1117] rounded shadow-2xl overflow-hidden p-8 font-mono text-xs flex flex-col justify-between border border-white/5",children:[n.jsxs("div",{className:"flex justify-between border-b border-white/10 pb-4",children:[n.jsx("span",{className:"text-[#10B981] font-bold tracking-widest",children:"EKRDEK_SSTEM: HAZIR"}),n.jsx("span",{className:"text-white/40",children:"LOG_AKII: [AIK]"})]}),n.jsxs("div",{className:"flex-1 py-8 space-y-4",children:[n.jsx("div",{className:"text-white/60",children:"> EXEC yerlesim_optimizer(ebat: 300x200x150)"}),n.jsx("div",{className:"text-white/60",children:"> 240+ SAFHA KOMBNASYONU ANALZ EDLYOR..."}),n.jsx("div",{className:"text-white italic",children:"> [14.02ms] ELEME BULUNDU: OPTMAL_VERM_HESAPLANDI"}),n.jsxs("div",{className:"grid grid-cols-4 gap-4 pt-6",children:[n.jsx("div",{className:"h-12 bg-[#800020]/40 border border-[#800020] rounded"}),n.jsx("div",{className:"h-12 bg-[#800020]/40 border border-[#800020] rounded"}),n.jsx("div",{className:"h-12 bg-[#800020]/40 border border-[#800020] rounded"}),n.jsx("div",{className:"h-12 bg-white/5 border border-white/10 border-dashed rounded"})]})]}),n.jsx("div",{className:"text-[10px] text-white/30 border-t border-white/10 pt-4 uppercase tracking-[0.2em] font-black",children:"Hassas Analiz Motoru | UI Render Prototipi"})]})})]})}),n.jsx("section",{className:"py-24 px-6 bg-white",children:n.jsx("div",{className:"max-w-[1440px] mx-auto",children:n.jsxs(at,{className:"bg-[#1A1D1F] rounded-[4rem] px-8 py-20 lg:p-32 text-center space-y-12 relative overflow-hidden border-8 border-[#F8FAFC] shadow-2xl",children:[n.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-[#800020]"}),n.jsxs("div",{className:"space-y-6 relative z-10",children:[n.jsx(ut,{className:"bg-[#800020] text-white border-0 py-2 px-6 text-[11px] font-black uppercase tracking-[0.3em]",children:"Hemen Balayn"}),n.jsxs("h2",{className:"text-4xl lg:text-7xl font-black tracking-tighter text-white uppercase leading-none",children:["RETMNZ ",n.jsx("br",{})," ",n.jsx("span",{className:"text-white/40",children:"GVENLE YNETN"})]}),n.jsx("p",{className:"text-xl text-white/80 max-w-2xl mx-auto font-medium",children:"Endstriyel dnmn bir paras olun. Sisteme kayt olarak sre optimizasyonuna bugn balayn."})]}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 justify-center pt-8 relative z-10",children:[n.jsx(At,{to:"/register",className:"px-12 py-6 bg-white text-[#1A1D1F] font-black rounded-sm hover:-translate-y-1 transition-all shadow-xl uppercase text-xs tracking-[0.2em]",children:"Kayt Protokoln Balat"}),n.jsx(At,{to:"/iletisim",className:"px-12 py-6 border-2 border-white/20 text-white font-black rounded-sm hover:bg-white/5 transition-all uppercase text-xs tracking-[0.2em]",children:"Ekiple Gr"})]})]})})})]})]})}function KW(){const{user:e,userProfile:t,logout:r,refreshProfile:a}=vr(),[s,i]=b.useState(!1),[l,o]=b.useState(!0),[c,d]=b.useState(!1),[u,f]=b.useState(20),[h,m]=b.useState(20),[x,p]=b.useState(30),[g,y]=b.useState(4),[N,v]=b.useState("TRY"),[S,_]=b.useState(!0),[F,k]=b.useState({defaultVatRate:20,defaultMargin:20,defaultFlap:30,defaultRillMm:4,currency:"TRY",marketingEmails:!0});b.useEffect(()=>{if(t&&t.settings){const w=t.settings,E=w.defaultVatRate??20,A=w.defaultMargin??20,D=w.defaultFlap??30,W=w.defaultRillMm??4,re=w.currency??"TRY",U=w.marketingEmails??!0;f(E),m(A),p(D),y(W),v(re),_(U),k({defaultVatRate:E,defaultMargin:A,defaultFlap:D,defaultRillMm:W,currency:re,marketingEmails:U})}o(!1)},[t]),b.useEffect(()=>{const w=u!==F.defaultVatRate||h!==F.defaultMargin||x!==F.defaultFlap||g!==F.defaultRillMm||N!==F.currency||S!==F.marketingEmails;d(w)},[u,h,x,g,N,S,F]);const j=async()=>{if(!(!e||!t)){if(h<0||h>300){xe.error("Kr marj 0 ile 300 arasnda olmaldr.");return}if(x<0||x>100){xe.error("Varsaylan flap 0 ile 100 arasnda olmaldr.");return}if(g<0||g>20){xe.error("Varsaylan rill pay 0 ile 20 arasnda olmaldr.");return}i(!0);try{const w={defaultVatRate:u,defaultMargin:h,defaultFlap:x,defaultRillMm:g,currency:N,marketingEmails:S};await Ay(e.uid,{settings:w,updatedAt:new Date}),await a(),k(w),d(!1),xe.success("Ayarlar kaydedildi.")}catch(w){console.error("Ayarlar kaydedilemedi:",w),xe.error("Ayarlar kaydedilemedi. Ltfen tekrar deneyin.")}finally{i(!1)}}};return l?n.jsx("div",{className:"flex-1 p-8 bg-surface-secondary flex items-center justify-center min-h-[calc(100vh-4rem)]",children:n.jsx(Ar,{className:"w-8 h-8 animate-spin text-[var(--burgundy)]"})}):n.jsxs("div",{className:"flex-1 p-8 bg-surface-secondary min-h-[calc(100vh-4rem)]",children:[n.jsx(au,{position:"top-right"}),n.jsxs("div",{className:"max-w-4xl mx-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-8",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"Ayarlar"}),n.jsx("p",{className:"text-text-secondary mt-1",children:"Hesap tercihlerinizi ve uygulama ayarlarnz ynetin."})]}),n.jsxs(Re,{onClick:j,disabled:!c||s,className:"bg-[var(--burgundy)] hover:bg-[var(--burgundy-hover)] text-white",children:[s?n.jsx(Ar,{className:"w-4 h-4 mr-2 animate-spin"}):n.jsx(Gd,{className:"w-4 h-4 mr-2"}),"Kaydet"]})]}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs(tt,{className:"p-6",children:[n.jsxs("div",{className:"flex items-start gap-4 mb-6 pb-4 border-b border-border",children:[n.jsx("div",{className:"w-10 h-10 rounded-lg bg-[var(--burgundy)]/10 flex items-center justify-center flex-shrink-0",children:n.jsx(hs,{className:"w-5 h-5 text-[var(--burgundy)]"})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:"Hesap"}),n.jsx("p",{className:"text-sm text-text-secondary",children:"Oturum bilgilerinizi grntleyin."})]})]}),n.jsxs("div",{className:"space-y-4 max-w-xl",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(et,{children:"E-posta"}),n.jsx(ze,{className:"bg-surface-secondary text-text-secondary cursor-not-allowed",value:(e==null?void 0:e.email)||"",readOnly:!0,disabled:!0}),n.jsx("p",{className:"text-xs text-text-tertiary",children:"E-posta adresi deitirilemez."})]}),n.jsx("div",{className:"pt-2",children:n.jsxs(Re,{variant:"outline",onClick:r,className:"text-text-secondary hover:text-red-600 hover:bg-red-50 border-border",children:[n.jsx(Xf,{className:"w-4 h-4 mr-2"}),"k Yap"]})})]})]}),n.jsxs(tt,{className:"p-6",children:[n.jsxs("div",{className:"flex items-start gap-4 mb-6 pb-4 border-b border-border",children:[n.jsx("div",{className:"w-10 h-10 rounded-lg bg-[var(--burgundy)]/10 flex items-center justify-center flex-shrink-0",children:n.jsx(HE,{className:"w-5 h-5 text-[var(--burgundy)]"})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:"Uygulama Tercihleri"}),n.jsx("p",{className:"text-sm text-text-secondary",children:"Hesaplama motoru iin varsaylan deerleri belirleyin."})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 max-w-xl",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(et,{htmlFor:"vatRate",children:"Varsaylan KDV Oran (%)"}),n.jsx(ze,{id:"vatRate",type:"number",className:"bg-surface-secondary text-text-secondary cursor-not-allowed",value:"20",readOnly:!0,disabled:!0}),n.jsx("p",{className:"text-xs text-text-tertiary font-medium",children:"KDV oran %20 olarak sabitlenmitir ve deitirilemez."})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(et,{htmlFor:"margin",children:"Varsaylan Kr Marj (%)"}),n.jsx(ze,{id:"margin",type:"number",min:"0",max:"300",value:h.toString(),onChange:w=>m(Number(w.target.value))})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(et,{htmlFor:"flap",children:"Varsaylan Flap (Bindirme Pay) - mm"}),n.jsx(ze,{id:"flap",type:"number",min:"0",max:"100",value:x.toString(),onChange:w=>p(Number(w.target.value))}),n.jsx("p",{className:"text-xs text-text-tertiary",children:"Koli alm hesaplamasnda kullanlan varsaylan bindirme pay."})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(et,{htmlFor:"rill",children:"Varsaylan Rill Pay (mm)"}),n.jsx(ze,{id:"rill",type:"number",min:"0",max:"20",value:g.toString(),onChange:w=>y(Number(w.target.value))}),n.jsx("p",{className:"text-xs text-text-tertiary",children:"Rill (izgi) tolerans/ek pay. Alm hesaplamalarnda kullanlr."})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(et,{htmlFor:"currency",children:"Para Birimi"}),n.jsx("select",{id:"currency",value:N,onChange:w=>v(w.target.value),className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:n.jsx("option",{value:"TRY",children:"TRY (Trk Liras)"})})]})]})]}),n.jsxs(tt,{className:"p-6",children:[n.jsxs("div",{className:"flex items-start gap-4 mb-6 pb-4 border-b border-border",children:[n.jsx("div",{className:"w-10 h-10 rounded-lg bg-[var(--burgundy)]/10 flex items-center justify-center flex-shrink-0",children:n.jsx(S1,{className:"w-5 h-5 text-[var(--burgundy)]"})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:"Bildirimler"}),n.jsx("p",{className:"text-sm text-text-secondary",children:"E-posta iletiim tercihlerinizi ynetin."})]})]}),n.jsx("div",{className:"max-w-xl",children:n.jsxs("label",{className:"flex items-center justify-between cursor-pointer p-4 rounded-lg border border-border hover:bg-surface-secondary transition-colors",children:[n.jsxs("div",{className:"space-y-0.5",children:[n.jsx("div",{className:"text-sm font-medium text-text-primary",children:"Pazarlama E-postalar"}),n.jsx("div",{className:"text-xs text-text-secondary",children:"rn gncellemelerini e-posta ile almak istiyorum"})]}),n.jsxs("div",{className:"relative inline-flex items-center cursor-pointer",children:[n.jsx("input",{type:"checkbox",className:"sr-only peer",checked:S,onChange:w=>_(w.target.checked)}),n.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[var(--burgundy)]/20 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-[var(--burgundy)]"})]})]})})]})]})]})]})}function WW(){return n.jsxs("div",{className:"pt-24 lg:pt-32 pb-24 selection:bg-[#800020]/10",children:[n.jsxs(yn,{children:[n.jsx("title",{children:"rn Dokmantasyonu | Ulgen One Endstriyel zmler"}),n.jsx("meta",{name:"description",content:"Ulgen One teknik zellikleri, safiha optimizasyon motoru ve maliyet analizi dkmantasyonu."})]}),n.jsx("section",{className:"px-6 mb-32 border-b border-[#E2E8F0] pb-24 bg-[#FAFBFC]",children:n.jsx("div",{className:"max-w-[1440px] mx-auto text-left space-y-10",children:n.jsxs(at,{children:[n.jsx(ut,{className:"bg-[#1A1D1F] text-white border-0 py-1.5 px-4 text-[10px] font-black uppercase tracking-[0.2em] mb-4",children:"Product Documentation v2.4"}),n.jsxs("h1",{className:"text-5xl lg:text-8xl font-black tracking-tighter text-[#1A1D1F] mb-8 uppercase leading-[0.9]",children:["TEKNK ",n.jsx("br",{})," ",n.jsx("span",{className:"text-[#800020]",children:"ZELLKLER"})]}),n.jsx("p",{className:"text-xl text-[#6B7280] max-w-3xl leading-relaxed font-medium",children:"Ulgen One, oluklu mukavva retim tesisleri iin gelitirilmi modler bir iletim sistemidir. Her modl, deterministik matematiksel modeller zerine ina edilmitir."})]})})}),n.jsx("section",{className:"px-6 py-24 border-b border-[#E2E8F0]",children:n.jsxs("div",{className:"max-w-[1440px] mx-auto grid lg:grid-cols-2 gap-20",children:[n.jsxs(at,{className:"space-y-10",children:[n.jsxs("div",{className:"flex items-center gap-3 text-[#E11D48] font-black text-xs uppercase tracking-[0.3em]",children:[n.jsx(oo,{size:18})," Geleneksel Yntem Analizi"]}),n.jsx("h2",{className:"text-3xl lg:text-5xl font-black tracking-tighter text-[#1A1D1F] uppercase",children:"EXCEL NEDEN YETERSZDR?"}),n.jsxs("div",{className:"space-y-6",children:[n.jsx("p",{className:"text-[#6B7280] font-medium leading-relaxed",children:"Excel tabanl fiyatlama, manuel veri girii ve statik formllere dayanr. Bu durum retimde u kritik hatalara yol aar:"}),n.jsx("ul",{className:"space-y-4",children:[{t:"Dinamik Ebat Analizi Eksiklii",d:"Safiha boyutlar manuel girilir, tm olaslklar (bin-packing) taranamaz."},{t:"Rill ve Flap Pay Hatalar",d:"Her koli tipi iin deien rill Paylar gzden kaar, gerek fire oran sapar."},{t:"Veri Fragmentasyonu",d:"Dosyalarn srm kontrol yoktur, eski fiyat listeleriyle teklif verilir."}].map((e,t)=>n.jsx("li",{className:"flex gap-4 border-l-2 border-[#E2E8F0] pl-6 py-2 transition-all hover:border-[#800020]",children:n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-black text-[#1A1D1F] uppercase mb-1",children:e.t}),n.jsx("p",{className:"text-xs text-[#6B7280] font-medium leading-relaxed",children:e.d})]})},t))})]})]}),n.jsxs(at,{delay:200,className:"bg-[#1A1D1F] p-8 rounded shadow-2xl space-y-8 self-center border border-white/5",children:[n.jsxs("div",{className:"flex justify-between items-center border-b border-white/10 pb-4",children:[n.jsx("span",{className:"text-white/40 text-[10px] font-black uppercase tracking-[0.3em]",children:"System Comparison"}),n.jsx("span",{className:"text-white/40 text-[10px] font-mono",children:"CODE_REF: COMP_01"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-px bg-white/10",children:[n.jsxs("div",{className:"bg-[#1A1D1F] p-6 space-y-4",children:[n.jsx("div",{className:"text-[10px] text-white/30 uppercase font-black tracking-widest",children:"Excel / Manuel"}),n.jsx("div",{className:"text-2xl font-black text-[#E11D48]",children:"~%12-18 Fire"}),n.jsx("div",{className:"h-1 bg-white/10 w-full rounded-full overflow-hidden",children:n.jsx("div",{className:"w-3/4 h-full bg-[#E11D48]"})}),n.jsx("p",{className:"text-[10px] text-white/40 font-medium",children:"Tahmini hesaplama pay dahil."})]}),n.jsxs("div",{className:"bg-[#1A1D1F] p-6 space-y-4 border-l border-white/10",children:[n.jsx("div",{className:"text-[10px] text-white/40 uppercase font-black tracking-widest",children:"Ulgen One Engine"}),n.jsx("div",{className:"text-2xl font-black text-[#10B981]",children:"<%4 Fire"}),n.jsx("div",{className:"h-1 bg-white/10 w-full rounded-full overflow-hidden",children:n.jsx("div",{className:"w-1/4 h-full bg-[#10B981]"})}),n.jsx("p",{className:"text-[10px] text-white/50 font-medium",children:"Algoritmik optimizasyon neticesi."})]})]})]})]})}),n.jsx("section",{className:"px-6 py-24 bg-[#FAFBFC] border-b border-[#E2E8F0]",children:n.jsxs("div",{className:"max-w-[1440px] mx-auto space-y-20",children:[n.jsxs(at,{className:"text-center space-y-8",children:[n.jsx(ut,{className:"bg-[#800020] text-white border-0 py-1 px-4 text-[9px] font-black uppercase tracking-[0.3em]",children:"Core Module A"}),n.jsx("h2",{className:"text-3xl lg:text-6xl font-black tracking-tighter text-[#1A1D1F] uppercase",children:"SAFHA OPTMZASYON MOTORU"}),n.jsx("p",{className:"text-lg text-[#6B7280] max-w-3xl mx-auto font-medium leading-relaxed",children:"Algoritmamz, binlerce safiha ebat kombinasyonunu saniyeler iinde tarayarak, makine fire paylarn minimize eden deterministik yerleimi belirler."})]}),n.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-8",children:[n.jsx(Gc,{icon:n.jsx($E,{size:24}),title:"Alm Algoritmas",desc:"Koli i llerini, rill paylarn ve levha kalnln otomatik olarak toplar."}),n.jsx(Gc,{icon:n.jsx(Xr,{size:24}),title:"Rotasyonel Analiz",desc:"Dalga ynn (flute) bozmadan alm 90 derece dndrerek ek yerleim kasar."}),n.jsx(Gc,{icon:n.jsx(E1,{size:24}),title:"Trim Optimizasyonu",desc:"Kenar temizleme paylarn milimetrik hassasiyetle hesaplamaya dahil eder."}),n.jsx(Gc,{icon:n.jsx(yh,{size:24}),title:"Hata Kontrol",desc:"Mmkn olmayan ebat-kalite elemelerini sistemde otomatik bloke eder."})]}),n.jsx(at,{delay:300,children:n.jsxs(tt,{className:"border-[#E2E8F0] shadow-xl overflow-hidden bg-white",children:[n.jsx("div",{className:"bg-[#1A1D1F] px-8 py-4 border-b border-white/10 flex items-center justify-between",children:n.jsx("span",{className:"text-white/50 text-[10px] font-black uppercase tracking-widest",children:"Live Engine Dataset Example (Read-Only)"})}),n.jsxs(hn,{children:[n.jsx(mn,{className:"bg-[#F8FAFC]",children:n.jsxs(zt,{className:"border-b-[#E2E8F0]",children:[n.jsx(Ve,{className:"text-[#1A1D1F] font-black text-[10px] uppercase tracking-widest h-14",children:"Senaryo ID"}),n.jsx(Ve,{className:"text-[#1A1D1F] font-black text-[10px] uppercase tracking-widest h-14",children:"Safiha (mm)"}),n.jsx(Ve,{className:"text-[#1A1D1F] font-black text-[10px] uppercase tracking-widest h-14",children:"Alm (mm)"}),n.jsx(Ve,{className:"text-[#1A1D1F] font-black text-[10px] uppercase tracking-widest h-14 text-center",children:"Verim (Adet)"}),n.jsx(Ve,{className:"text-[#1A1D1F] font-black text-[10px] uppercase tracking-widest h-14 text-center",children:"Net Fire"}),n.jsx(Ve,{className:"text-[#1A1D1F] font-black text-[10px] uppercase tracking-widest h-14 text-center",children:"Birim Maliyet (m)"})]})}),n.jsx(xn,{children:[{id:"S-542",safiha:"850 x 1100",acilim:"302 x 205",verim:14,fire:"2.14%",cost:"1.42 "},{id:"S-543",safiha:"1000 x 1200",acilim:"302 x 205",verim:18,fire:"10.45%",cost:"1.58 "},{id:"S-544",safiha:"900 x 1400",acilim:"302 x 205",verim:18,fire:"14.80%",cost:"1.64 "},{id:"S-545",safiha:"800 x 1500",acilim:"302 x 205",verim:14,fire:"18.24%",cost:"1.72 "}].map((e,t)=>n.jsxs(zt,{className:`hover:bg-transparent ${t===0?"bg-[#10B981]/5":""}`,children:[n.jsx(Oe,{className:"font-mono text-[11px] text-[#6B7280]",children:e.id}),n.jsx(Oe,{className:"font-bold text-[#1A1D1F]",children:e.safiha}),n.jsx(Oe,{className:"font-mono text-[11px] text-[#6B7280]",children:e.acilim}),n.jsx(Oe,{className:"text-center font-black text-[#1A1D1F]",children:e.verim}),n.jsx(Oe,{className:"text-center",children:n.jsx("span",{className:`font-black ${t===0?"text-[#10B981]":"text-[#800020]"}`,children:e.fire})}),n.jsx(Oe,{className:"text-center font-bold text-[#1A1D1F]",children:e.cost})]},t))})]})]})})]})}),n.jsx("section",{className:"px-6 py-32 border-b border-[#E2E8F0]",children:n.jsxs("div",{className:"max-w-[1440px] mx-auto grid lg:grid-cols-2 gap-24 items-center",children:[n.jsxs(at,{className:"space-y-10",children:[n.jsxs("div",{className:"flex items-center gap-3 text-[#800020] font-black text-xs uppercase tracking-[0.3em]",children:[n.jsx(fl,{size:18})," Financial Core Module"]}),n.jsx("h2",{className:"text-3xl lg:text-5xl font-black tracking-tighter text-[#1A1D1F] uppercase",children:"FYATLAMA ALGORTMASI"}),n.jsx("p",{className:"text-lg text-[#6B7280] font-medium leading-relaxed",children:"Birim maliyet hesab, statik bir malzeme fiyatndan fazlasn gerektirir. Ulgen One, iilik, enerji, fire ve lojistik maliyetlerini dinamik kr marjnzla otomatik eletirir."}),n.jsxs("div",{className:"p-8 border-2 border-[#1A1D1F] rounded space-y-4 bg-[#F8FAFC]",children:[n.jsx("div",{className:"flex justify-between items-center opacity-40",children:n.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Equation Structure"})}),n.jsx("div",{className:"font-mono text-sm text-[#1A1D1F] leading-relaxed",children:"Unit_Price = ( (Material_Cost * (1 + Fire_Rate)) + Labor + Ops_Cost ) / (1 - Target_Margin)"})]})]}),n.jsxs(at,{delay:400,className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("span",{className:"text-[11px] font-black uppercase tracking-widest text-[#1A1D1F]",children:"Kr Marj Kararllk Analizi"}),n.jsx(ut,{variant:"outline",className:"border-[#800020]/20 text-[#800020] text-[9px] font-black uppercase tracking-widest",children:"Canl Veri"})]}),n.jsx("div",{className:"h-[300px] w-full bg-white border border-[#E2E8F0] p-6 rounded shadow-lg",children:n.jsx(zs,{width:"100%",height:"100%",children:n.jsxs(fo,{data:[{month:"Oca",margin:18,target:20},{month:"ub",margin:22,target:20},{month:"Mar",margin:19,target:20},{month:"Nis",margin:25,target:20}],children:[n.jsx(Vi,{strokeDasharray:"3 3",vertical:!1,stroke:"#F1F5F9"}),n.jsx(Hi,{dataKey:"month",axisLine:!1,tickLine:!1,tick:{fontSize:10,fontWeight:"bold"},stroke:"#94A3B8"}),n.jsx($i,{axisLine:!1,tickLine:!1,tick:{fontSize:10,fontWeight:"bold"},stroke:"#94A3B8",tickFormatter:e=>`%${e}`}),n.jsx(Di,{contentStyle:{borderRadius:"4px",border:"1px solid #E2E8F0",fontSize:"12px"}}),n.jsx(Jd,{y:20,stroke:"#800020",strokeDasharray:"5 5",label:{value:"HEDEF",position:"insideTopRight",fill:"#800020",fontSize:10,fontWeight:"bold"}}),n.jsx(rl,{type:"monotone",dataKey:"margin",stroke:"#1A1D1F",strokeWidth:3,dot:{fill:"#1A1D1F",r:4}})]})})})]})]})}),n.jsx("section",{className:"px-6 py-32 bg-[#1A1D1F] text-white",children:n.jsxs("div",{className:"max-w-[1440px] mx-auto space-y-24",children:[n.jsxs(at,{className:"text-center space-y-6",children:[n.jsx("h2",{className:"text-3xl lg:text-6xl font-black tracking-tighter text-white uppercase whitespace-nowrap",children:"SSTEM MMARS"}),n.jsx("p",{className:"text-white/80 max-w-2xl mx-auto font-medium leading-relaxed",children:"Mteri ynetiminden retim bandna kadar tm sre, modler bir entegrasyon protokol ile birleir."})]}),n.jsx("div",{className:"grid md:grid-cols-3 gap-12",children:[{icon:n.jsx(qd,{className:"text-[#800020]",size:32}),title:"CORE ENGINE",list:["Dinamik Safiha Optimizasyonu","Hassas Fire Hesaplama","Otomatik Rill & Flap Pay"]},{icon:n.jsx(bh,{className:"text-[#800020]",size:32}),title:"DATA REPOSITORY",list:["Merkezi Mteri Veri Taban","Gemi Teklif Log Kaytlar","Dinamik Malzeme Fiyat Listesi"]},{icon:n.jsx(ma,{className:"text-[#800020]",size:32}),title:"OUTPUT SYSTEM",list:["Teknik Detayl PDF retimi","Maliyet Onay Delegasyonu","Revizyon Kontrol Sistemi"]}].map((e,t)=>n.jsxs(at,{delay:t*150,className:"space-y-8 p-10 border border-white/10 rounded bg-white/5",children:[n.jsxs("div",{className:"flex items-center gap-4 border-b border-white/10 pb-6",children:[e.icon,n.jsx("h3",{className:"text-xl font-black tracking-tighter text-white uppercase",children:e.title})]}),n.jsx("ul",{className:"space-y-4",children:e.list.map((r,a)=>n.jsxs("li",{className:"flex items-center gap-3 text-sm text-white/80 font-medium",children:[n.jsx(Jr,{size:16,className:"text-[#10B981]"})," ",r]},a))})]},t))})]})}),n.jsx("section",{className:"px-6 py-24",children:n.jsx("div",{className:"max-w-[1440px] mx-auto bg-[#800020] rounded-[3rem] p-12 lg:p-24 text-center text-white space-y-12 shadow-2xl",children:n.jsxs(at,{className:"space-y-8",children:[n.jsxs("h2",{className:"text-4xl lg:text-7xl font-black tracking-tighter text-white uppercase leading-none",children:["retimi Saysal Olarak ",n.jsx("br",{})," Kontrol Altna Aln"]}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 justify-center",children:[n.jsxs(At,{to:"/register",className:"px-12 py-6 bg-white text-[#800020] font-black rounded-sm hover:-translate-y-1 transition-all shadow-xl uppercase text-xs tracking-widest flex items-center justify-center gap-3",children:["Sisteme Giri Yapn ",n.jsx(Ta,{size:18})]}),n.jsx(At,{to:"/iletisim",className:"px-12 py-6 border-2 border-white/20 text-white font-black rounded-sm hover:bg-white/5 transition-all uppercase text-xs tracking-widest",children:"Demo Talep Edin"})]})]})})})]})}function Gc({icon:e,title:t,desc:r}){return n.jsxs("div",{className:"p-10 bg-white border border-[#E2E8F0] rounded-sm shadow-sm transition-all hover:shadow-xl hover:-translate-y-1 group relative overflow-hidden",children:[n.jsx("div",{className:"absolute top-0 left-0 w-1 h-full bg-[#800020] opacity-0 group-hover:opacity-100 transition-opacity"}),n.jsx("div",{className:"w-14 h-14 rounded bg-[#F8FAFC] flex items-center justify-center text-[#800020] mb-8 group-hover:bg-[#1A1D1F] group-hover:text-white transition-all ring-1 ring-[#1A1D1F]/5",children:e}),n.jsx("h3",{className:"text-lg font-black text-[#1A1D1F] mb-4 uppercase tracking-tighter",children:t}),n.jsx("p",{className:"text-xs text-[#6B7280] leading-relaxed font-medium",children:r})]})}function GW(){return n.jsxs("div",{className:"pt-24 lg:pt-32 pb-24 selection:bg-[#800020]/10",children:[n.jsxs(yn,{children:[n.jsx("title",{children:"Teknik Analiz Motoru | Ulgen One Matematiksel Model"}),n.jsx("meta",{name:"description",content:"Ulgen One hesaplama motoru, deterministik algoritmalar ve oluklu mukavva retim formllerinin teknik dkmantasyonu."})]}),n.jsx("section",{className:"px-6 mb-24 border-b border-[#E2E8F0] pb-24 bg-[#FAFBFC]",children:n.jsx("div",{className:"max-w-[1440px] mx-auto text-left space-y-10",children:n.jsxs(at,{children:[n.jsx(ut,{className:"bg-[#800020] text-white border-0 py-1.5 px-4 text-[10px] font-black uppercase tracking-[0.2em] mb-4",children:"Engineering Core v2.4"}),n.jsxs("h1",{className:"text-5xl lg:text-8xl font-black tracking-tighter text-[#1A1D1F] mb-8 uppercase leading-[0.9]",children:["MATEMATKSEL ",n.jsx("br",{})," ",n.jsx("span",{className:"text-[#800020]",children:"MOTOR ANALZ"})]}),n.jsx("p",{className:"text-xl text-[#6B7280] max-w-4xl leading-relaxed font-medium",children:"Ulgen One hesaplama motoru, oluklu mukavva retimindeki fiziksel kstlar ve fire optimizasyonunu deterministik matematiksel modellerle simle eder."})]})})}),n.jsx("section",{className:"px-6 py-12",children:n.jsxs("div",{className:"max-w-[1440px] mx-auto space-y-32",children:[n.jsxs("div",{className:"grid lg:grid-cols-2 gap-20 items-start",children:[n.jsxs(at,{className:"space-y-10",children:[n.jsxs("div",{className:"flex items-center gap-3 text-[#800020] font-black text-xs uppercase tracking-[0.3em]",children:[n.jsx(KE,{size:20})," MODL 01: SAFHA YERLEM"]}),n.jsx("h2",{className:"text-3xl lg:text-5xl font-black tracking-tighter text-[#1A1D1F] uppercase",children:"DZLM VE EBAT ANALZ"}),n.jsx("p",{className:"text-[#6B7280] text-lg font-medium leading-relaxed italic border-l-4 border-[#800020] pl-6",children:'"Net verimlilik, safiha alannn para alanna oranndan ziyade, fiziksel sma kapasitesinin tam say (integer) sonucudur."'}),n.jsxs("div",{className:"bg-[#1A1D1F] p-8 rounded font-mono text-sm text-[#10B981] space-y-4 shadow-2xl border border-white/5",children:[n.jsx("div",{className:"text-white/60 text-[10px] uppercase tracking-widest font-black mb-4",children:"Temel Algoritma Mant"}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("p",{children:"piecesPerSheet = floor(W / w)  floor(H / h)"}),n.jsx("p",{children:"requiredSheets = ceil(orderQty / piecesPerSheet)"}),n.jsx("p",{children:"fireArea = totalSheetArea - (piecesPerSheet  itemArea)"}),n.jsx("p",{children:"firePercent = (fireArea / totalSheetArea)  100"})]})]}),n.jsx("ul",{className:"space-y-4",children:[{t:"Integer Constraint",d:"Hibir retim senaryosunda 'buuklu' para hesab yaplamaz. floor() fonksiyonu fiziksel gereklii yanstr."},{t:"Ceil Logii",d:"Sipari adedini tamamlamak iin gereken safiha says her zaman yukar yuvarlanr (ceil)."},{t:"Trim Allowance",d:"W ve H deikenleri, makine trim paylar dldkten sonraki net alan temsil eder."}].map((e,t)=>n.jsx("li",{className:"flex gap-4 border-l border-[#E2E8F0] pl-6 py-2 transition-all hover:border-[#800020]",children:n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-black text-[#1A1D1F] uppercase mb-1",children:e.t}),n.jsx("p",{className:"text-xs text-[#6B7280] font-medium leading-relaxed",children:e.d})]})},t))})]}),n.jsx(at,{delay:200,className:"space-y-8 sticky top-32",children:n.jsxs("div",{className:"p-10 bg-white border-2 border-[#1A1D1F] rounded shadow-xl relative overflow-hidden group",children:[n.jsx("div",{className:"absolute top-0 right-0 p-4 bg-[#1A1D1F] text-[9px] font-black text-white uppercase tracking-widest",children:"Simulation Case #A-42"}),n.jsxs("div",{className:"space-y-8",children:[n.jsxs("div",{className:"flex justify-between items-center border-b border-[#F1F5F9] pb-6",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx("span",{className:"text-[10px] font-black text-[#94A3B8] uppercase tracking-widest",children:"Safiha Yerleim Grnm"}),n.jsx("div",{className:"text-xl font-black text-[#1A1D1F]",children:"800 x 1200 mm"})]}),n.jsx(ut,{className:"bg-[#10B981] text-white uppercase text-[9px] font-black tracking-widest py-1 px-3",children:"OPTIMAL"})]}),n.jsxs("div",{className:"aspect-[1.5/1] bg-[#F8FAFC] border border-dashed border-[#CBD5E1] p-4 relative flex items-center justify-center overflow-hidden",children:[n.jsx("div",{className:"grid grid-cols-4 gap-1 w-full h-full opacity-80",children:Array.from({length:12}).map((e,t)=>n.jsx("div",{className:"bg-[#800020]/20 border border-[#800020] rounded-sm transition-transform group-hover:scale-[0.98]"},t))}),n.jsx("div",{className:"absolute inset-x-0 bottom-4 text-center",children:n.jsx("span",{className:"bg-white px-4 py-1 border border-[#E2E8F0] shadow-sm rounded-full text-[10px] font-black text-[#1A1D1F] uppercase tracking-widest",children:"Net Fire: %2.8"})})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"p-4 bg-[#F8FAFC] rounded border border-[#E2E8F0] space-y-1",children:[n.jsx("span",{className:"text-[9px] font-black text-[#94A3B8] uppercase",children:"Kapasite"}),n.jsx("div",{className:"text-lg font-black text-[#1A1D1F]",children:"12 Adet/Tabaka"})]}),n.jsxs("div",{className:"p-4 bg-[#F8FAFC] rounded border border-[#E2E8F0] space-y-1",children:[n.jsx("span",{className:"text-[9px] font-black text-[#94A3B8] uppercase",children:"Varyasyon"}),n.jsx("div",{className:"text-lg font-black text-[#1A1D1F]",children:"3 x 4 Grid"})]})]})]})]})})]}),n.jsxs("div",{className:"grid lg:grid-cols-2 gap-20 items-start",children:[n.jsx(at,{className:"space-y-10 order-2 lg:order-1",children:n.jsxs("div",{className:"bg-white border-2 border-[#1A1D1F] p-10 rounded shadow-xl space-y-8",children:[n.jsxs("div",{className:"flex items-center gap-3 text-[#800020] font-black text-xs uppercase tracking-[0.3em] border-b border-[#F1F5F9] pb-6",children:[n.jsx(wh,{size:20})," Statik Maliyet vs Dinamik Marj"]}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-[10px] font-black text-[#94A3B8] uppercase tracking-widest",children:"Maliyet Kararll (30 Gnlk)"}),n.jsx("div",{className:"h-[200px] mt-4",children:n.jsx(zs,{width:"100%",height:"100%",children:n.jsxs(fo,{data:[{d:"01.02",m:18},{d:"10.02",m:22},{d:"20.02",m:19},{d:"23.02",m:24}],children:[n.jsx(Vi,{strokeDasharray:"3 3",vertical:!1,stroke:"#f1f5f9"}),n.jsx(Hi,{dataKey:"d",axisLine:!1,tickLine:!1,tick:{fontSize:10,fontWeight:"bold"}}),n.jsx($i,{axisLine:!1,tickLine:!1,tick:{fontSize:10,fontWeight:"bold"},tickFormatter:e=>`%${e}`}),n.jsx(Jd,{y:20,stroke:"#800020",strokeDasharray:"5 5"}),n.jsx(rl,{type:"stepAfter",dataKey:"m",stroke:"#1A1D1F",strokeWidth:3,dot:{fill:"#1A1D1F",r:4}})]})})})]}),n.jsxs("div",{className:"p-6 bg-[#FAFBFC] border border-[#E2E8F0] rounded space-y-2",children:[n.jsx("div",{className:"text-[10px] font-black text-[#6B7280] uppercase tracking-widest",children:"Matematiksel Stabilite"}),n.jsx("p",{className:"text-xs font-medium text-[#6B7280] leading-relaxed",children:"Sistem, %20 hedef marjn korumak iin hammadde fiyat dalgalanmalarn birim fiyata anlk yanstr."})]})]})]})}),n.jsxs(at,{delay:200,className:"space-y-10 order-1 lg:order-2",children:[n.jsxs("div",{className:"flex items-center gap-3 text-[#800020] font-black text-xs uppercase tracking-[0.3em]",children:[n.jsx(fl,{size:20})," MODL 02: MARJ KONTROL"]}),n.jsx("h2",{className:"text-3xl lg:text-5xl font-black tracking-tighter text-[#1A1D1F] uppercase",children:"FYATLAMA VE TIE-BREAK MANTII"}),n.jsx("p",{className:"text-[#6B7280] text-lg font-medium leading-relaxed",children:'Eer birden fazla safiha seenei ayn verimlilii (adet) salyorsa, sistem otomatik olarak "Tie-Break" protokolne geer.'}),n.jsxs("div",{className:"space-y-12",children:[n.jsxs("div",{className:"space-y-4",children:[n.jsx("h3",{className:"text-xl font-black text-[#1A1D1F] uppercase tracking-tighter",children:"ROTASYON POLTKASI"}),n.jsx("p",{className:"text-sm text-[#6B7280] leading-relaxed font-medium",children:'Dikeylemesine yerleim (Vertical) ile Yataylamasna yerleim (Horizontal) arasndaki fark, dalga boyunun mukavemetini etkiler. Sistem, mteri spesifikasyonu verilmediyse fireyi en az tutan ay, fireler eitse "Dalga Ynne Paralel" olan seer.'})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsx("h3",{className:"text-xl font-black text-[#1A1D1F] uppercase tracking-tighter",children:"FLAP & RLL PARAMETRELER"}),n.jsx("p",{className:"text-sm text-[#6B7280] leading-relaxed font-medium",children:"0201 gibi standart koli tiplerinde kapak paylar (flap) ve krm mesafeleri (rill) sabit deil, malzeme kalitesi ve levha kalnlna (mikro, dopel vb.) bamldr. Motorumuz, her kalite iin zel offset deerlerini hesaba katar."})]})]})]})]}),n.jsxs("div",{className:"space-y-16",children:[n.jsxs(at,{className:"text-center space-y-6 max-w-3xl mx-auto",children:[n.jsx("div",{className:"flex justify-center mb-6 text-[#800020]",children:n.jsx(qd,{size:48})}),n.jsx("h2",{className:"text-3xl lg:text-6xl font-black tracking-tighter text-white uppercase",children:"SSTEM DETERMINIZM"}),n.jsx("p",{className:"text-[#6B7280] text-lg font-medium leading-relaxed",children:"Ulgen One, rastgele (heuristic) arama yerine kapsaml matematiksel tarama yntemini kullanr. Bu, ayn girdilerle ayn sonucun milisaniyeler iinde alnmasn salar."})]}),n.jsx("div",{className:"grid md:grid-cols-3 gap-8",children:[{t:"0.02ms Latency",d:"Optimizasyon kararlar, ekirdek motorumuzda mikro saniye seviyesinde ilenir."},{t:"Zero-Data Loss",d:"Tm hesaplama loglar teknik audit iin veri tabannda muhafaza edilir."},{t:"Cross-Platform Sync",d:"Mobil ve Web motorlar ayn ekirdek (core.js) ktphanesini kullanarak sonu tutarll salar."}].map((e,t)=>n.jsxs(at,{delay:t*100,className:"p-10 border border-[#E2E8F0] bg-white rounded flex flex-col items-center text-center space-y-6 transition-all hover:bg-[#1A1D1F] hover:border-[#1A1D1F] hover:text-white group",children:[n.jsx(ei,{className:"text-[#800020] transition-colors group-hover:text-white",size:32}),n.jsx("h4",{className:"text-xl font-black uppercase tracking-tighter text-[#1A1D1F] transition-colors group-hover:text-white",children:e.t}),n.jsx("p",{className:"text-xs font-medium leading-relaxed opacity-60 transition-colors group-hover:text-zinc-300 group-hover:opacity-100",children:e.d})]},t))})]})]})}),n.jsx("section",{className:"px-6 py-24",children:n.jsxs("div",{className:"max-w-[1440px] mx-auto bg-[#1A1D1F] rounded-[3rem] p-12 lg:p-24 text-center text-white space-y-12 relative overflow-hidden shadow-2xl",children:[n.jsx("div",{className:"absolute top-0 right-0 w-1/3 h-full bg-[#800020]/10 clip-path-slant pointer-events-none"}),n.jsxs(at,{className:"space-y-8 relative z-10",children:[n.jsxs("h2",{className:"text-4xl lg:text-7xl font-black tracking-tighter text-white uppercase leading-none italic",children:["Saysal Verimlilii ",n.jsx("br",{})," Standartlatrn"]}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 justify-center",children:[n.jsxs("button",{className:"px-12 py-6 bg-[#800020] text-white font-black rounded-sm hover:scale-[1.02] transition-all shadow-xl uppercase text-xs tracking-widest flex items-center justify-center gap-3",children:["White-Paper Talep Et ",n.jsx(Ta,{size:18})]}),n.jsx("button",{className:"px-12 py-6 border-2 border-white/20 text-white font-black rounded-sm hover:bg-white/5 transition-all text-center uppercase text-xs tracking-widest",children:"API Dokmantasyonu"})]})]})]})})]})}function YW(){const e=ca();return n.jsxs("div",{className:"pt-24 lg:pt-32 pb-24 selection:bg-[#800020]/10",children:[n.jsxs(yn,{children:[n.jsx("title",{children:"Fire Oran Hesaplama ve Optimizasyon Teorisi | Ulgen One"}),n.jsx("meta",{name:"description",content:"Oluklu mukavva retimindeki fire trleri, safiha yerleiminin krlla etkisi ve fire azaltma stratejileri zerine teknik rehber."})]}),n.jsx("section",{className:"px-6 mb-24 border-b border-[#E2E8F0] pb-24 bg-[#FAFBFC]",children:n.jsx("div",{className:"max-w-[1440px] mx-auto text-left space-y-10",children:n.jsxs(at,{children:[n.jsx(ut,{className:"bg-[#1A1D1F] text-white border-0 py-1.5 px-4 text-[10px] font-black uppercase tracking-[0.2em] mb-4",children:"Production Optimization Theory"}),n.jsxs("h1",{className:"text-5xl lg:text-8xl font-black tracking-tighter text-[#1A1D1F] mb-8 uppercase leading-[0.9]",children:["FRE ",n.jsx("br",{})," ",n.jsx("span",{className:"text-[#800020]",children:"SMLASYONU"})]}),n.jsx("p",{className:"text-xl text-[#6B7280] max-w-4xl leading-relaxed font-medium",children:"Oluklu mukavva retiminde fire miktarn %1 orannda azaltmak, tesis krlln dorudan %5 orannda artrabilir. Fire, kanlmaz bir maliyet deil, ynetilebilir bir deikendir."})]})})}),n.jsx("section",{className:"px-6 py-12",children:n.jsxs("div",{className:"max-w-[1440px] mx-auto space-y-32",children:[n.jsxs("div",{className:"grid lg:grid-cols-2 gap-20",children:[n.jsxs(at,{className:"space-y-10",children:[n.jsxs("div",{className:"flex items-center gap-3 text-[#E11D48] font-black text-xs uppercase tracking-[0.3em]",children:[n.jsx(ms,{size:20})," ANALZ: FRE NEDR?"]}),n.jsx("h2",{className:"text-3xl lg:text-5xl font-black tracking-tighter text-[#1A1D1F] uppercase",children:"RETMN GZL DMANI"}),n.jsx("p",{className:"text-[#6B7280] text-lg font-medium leading-relaxed font-medium",children:'Fire, hammadde giriinin son rne dnmeyen alandr. Genellikle "Net Fire" ve "Brt Fire" olarak ikiye ayrlr. Ulgen One, sadece net fireyi deil, retim hattndaki trim (kenar) kayplarn da simle eder.'}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[n.jsxs("div",{className:"p-8 bg-[#800020]/5 border border-[#800020]/10 rounded space-y-5",children:[n.jsxs("div",{className:"flex items-center gap-2 text-[#800020] font-black uppercase text-[10px] tracking-widest",children:[n.jsx($1,{size:18})," Fire Neden Oluur?"]}),n.jsxs("ul",{className:"space-y-3 text-xs font-bold text-[#6B7280] leading-relaxed",children:[n.jsxs("li",{className:"flex gap-2",children:[n.jsx("span",{children:""})," Safiha ebat uyumsuzluu (Mismatch)"]}),n.jsxs("li",{className:"flex gap-2",children:[n.jsx("span",{children:""})," Hatal alm yerleimi (Inefficient Layout)"]}),n.jsxs("li",{className:"flex gap-2",children:[n.jsx("span",{children:""})," Operasyonel pay fazlal (Over-trimming)"]}),n.jsxs("li",{className:"flex gap-2",children:[n.jsx("span",{children:""})," Rotasyon kstlar (Grain direction)"]})]})]}),n.jsxs("div",{className:"p-8 bg-[#10B981]/5 border border-[#10B981]/10 rounded space-y-5",children:[n.jsxs("div",{className:"flex items-center gap-2 text-[#10B981] font-black uppercase text-[10px] tracking-widest",children:[n.jsx(Jr,{size:18})," Optimizasyon Etkisi"]}),n.jsxs("ul",{className:"space-y-3 text-xs font-bold text-[#6B7280] leading-relaxed",children:[n.jsxs("li",{className:"flex gap-2",children:[n.jsx("span",{children:""})," Akll algoritma kullanm"]}),n.jsxs("li",{className:"flex gap-2",children:[n.jsx("span",{children:""})," Optimum safiha l seimi"]}),n.jsxs("li",{className:"flex gap-2",children:[n.jsx("span",{children:""})," Hassas milimetrik hesaplama"]}),n.jsxs("li",{className:"flex gap-2",children:[n.jsx("span",{children:""})," oklu yerleim simlasyonlar"]})]})]})]})]}),n.jsxs(at,{delay:200,className:"space-y-8 bg-[#1A1D1F] p-12 rounded shadow-2xl self-center border border-white/5 relative overflow-hidden",children:[n.jsx("div",{className:"absolute top-0 right-0 p-4 bg-[#800020] text-[8px] font-black text-white uppercase tracking-widest",children:"Technical Data Sheet"}),n.jsxs("div",{className:"space-y-10",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsxs("h4",{className:"text-white text-2xl font-black tracking-tighter text-white uppercase whitespace-nowrap leading-none",children:["Fire Kayp ",n.jsx("br",{})," Projeksiyonu"]}),n.jsx("p",{className:"text-white/60 text-[11px] font-medium leading-relaxed",children:"100.000 adetlik standart bir projede fire orannn maliyete etkisi."})]}),n.jsxs("div",{className:"space-y-8",children:[n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex justify-between items-end border-b border-white/5 pb-2",children:[n.jsx("span",{className:"text-white/60 text-[10px] uppercase font-black tracking-widest",children:"Geleneksel (%18 Fire)"}),n.jsx("span",{className:"text-white font-black text-lg text-[#E11D48]",children:"-45.200 "})]}),n.jsx("div",{className:"h-2 bg-white/5 rounded-full overflow-hidden",children:n.jsx("div",{className:"w-[80%] h-full bg-[#E11D48]"})})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex justify-between items-end border-b border-white/5 pb-2",children:[n.jsx("span",{className:"text-white/60 text-[10px] uppercase font-black tracking-widest",children:"Ulgen Optimized (%3.2 Fire)"}),n.jsx("span",{className:"text-[#10B981] font-black text-lg",children:"-8.400 "})]}),n.jsx("div",{className:"h-2 bg-white/5 rounded-full overflow-hidden",children:n.jsx("div",{className:"w-[15%] h-full bg-[#10B981]"})})]})]}),n.jsxs("div",{className:"pt-6 border-t border-white/10 flex items-center justify-between",children:[n.jsxs("div",{className:"flex flex-col",children:[n.jsx("span",{className:"text-white/60 text-[9px] uppercase font-black tracking-widest",children:"Ek Krllk"}),n.jsx("span",{className:"text-white font-black text-2xl tracking-tighter",children:"+36.800 "})]}),n.jsx(vh,{className:"text-[#800020] opacity-20",size:48})]})]})]})]}),n.jsxs("div",{className:"grid lg:grid-cols-2 gap-24 items-center",children:[n.jsxs(at,{className:"order-2 lg:order-1 relative px-10",children:[n.jsx("div",{className:"absolute top-0 left-0 w-full h-full border-2 border-dashed border-[#E2E8F0] rotate-2 rounded-2xl -z-10"}),n.jsxs("div",{className:"bg-white p-12 rounded shadow-xl border border-[#E2E8F0] space-y-12",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-12",children:[n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"p-4 bg-[#F8FAFC] border border-[#E2E8F0] rounded aspect-square flex flex-col items-center justify-center gap-4 group hover:border-[#800020] transition-all",children:[n.jsx(WE,{className:"text-[#94A3B8] group-hover:text-[#800020]",size:32}),n.jsx("span",{className:"text-[10px] font-black text-[#1A1D1F] uppercase tracking-widest",children:"Dikey (Vertical)"})]}),n.jsx("p",{className:"text-[11px] text-[#6B7280] font-bold leading-relaxed",children:"900mm genilie 3 adet sar. Fire: %12.4"})]}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"p-4 bg-[#F8FAFC] border border-[#E2E8F0] rounded aspect-square flex flex-col items-center justify-center gap-4 group hover:border-[#800020] transition-all",children:[n.jsx(H1,{className:"text-[#94A3B8] group-hover:text-[#800020] rotate-90",size:32}),n.jsx("span",{className:"text-[10px] font-black text-[#1A1D1F] uppercase tracking-widest",children:"Yatay (Horizontal)"})]}),n.jsx("p",{className:"text-[11px] text-[#6B7280] font-bold leading-relaxed",children:"900mm genilie 4 adet sar. Fire: %1.6"})]})]}),n.jsxs("div",{className:"p-6 bg-[#1A1D1F] text-white rounded flex items-center gap-6",children:[n.jsx(ei,{className:"text-[#800020]",size:32}),n.jsx("p",{className:"text-xs font-bold leading-relaxed opacity-80",children:"Sadece 90 derecelik bir rotasyon fark, toplam maliyeti %10.8 orannda aa ekebilir."})]})]})]}),n.jsxs(at,{delay:200,className:"space-y-10 order-1 lg:order-2",children:[n.jsxs("div",{className:"flex items-center gap-3 text-[#800020] font-black text-xs uppercase tracking-[0.3em]",children:[n.jsx(us,{size:20})," TEKNK PARAMETRE: ROTASYON"]}),n.jsxs("h2",{className:"text-3xl lg:text-5xl font-black tracking-tighter text-[#1A1D1F] uppercase italic leading-none whitespace-nowrap font-sans",children:["EBAT VE YN ",n.jsx("br",{})," ETKS"]}),n.jsx("p",{className:"text-[#6B7280] text-lg font-medium leading-relaxed font-medium",children:"Dalga yn (flute direction), mukavvann mukavemeti iin kritiktir. Optimizasyon yaplrken parann rotasyonu, hem dalga ynne uyum salamal hem de fireyi minimize etmelidir."}),n.jsx("div",{className:"space-y-8",children:[{t:"Fiziksel Kstlar",d:"Baz retim hatlar sadece belirli bir ynde besleme kabul eder. Ulgen One makine bazl kstlar simlasyona dahil eder."},{t:"M Bazl Verimlilik",d:"Safiha alannn her bir santimetrekaresi maliyettir. Algoritmamz tm boluklar (residue) milimetrik olarak raporlar."}].map((t,r)=>n.jsx("div",{className:"flex gap-6 border-l-4 border-[#800020]/20 pl-8 transition-all hover:border-[#800020]",children:n.jsxs("div",{className:"space-y-2",children:[n.jsx("h4",{className:"text-sm font-black text-[#1A1D1F] uppercase tracking-tighter",children:t.t}),n.jsx("p",{className:"text-xs text-[#6B7280] font-medium leading-relaxed",children:t.d})]})},r))})]})]}),n.jsxs("div",{className:"bg-[#FAFBFC] border border-[#E2E8F0] p-12 lg:p-24 rounded-3xl space-y-20 relative overflow-hidden",children:[n.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-[#800020]/5 rounded-bl-full pointer-events-none"}),n.jsxs(at,{className:"text-center space-y-6 max-w-3xl mx-auto",children:[n.jsx("h2",{className:"text-3xl lg:text-6xl font-black tracking-tighter text-[#1A1D1F] uppercase",children:"PRODKSYON ANALZ: PRATK RNEK"}),n.jsx("p",{className:"text-[#6B7280] font-medium leading-relaxed",children:"Farkl safiha ebatlarnn ayn koli tipi iin sunduu performans analizi. En dk fire oranna sahip ebat otomatik olarak iaretlenir."})]}),n.jsx("div",{className:"grid md:grid-cols-2 gap-12 lg:gap-24 relative z-10",children:[{t:"Geleneksel Metod",s:"Safiha: 100x120 cm | Adet: 2",f:"%32",c:"red",d:"Standart stok ebatlar zerinden, optimizasyon yaplmadan hazrlanan yerleim. Levha alannn %32'si dorudan ata dnr."},{t:"Ulgen One Simlasyonu",s:"Safiha: 85x115 cm | Adet: 3",f:"%4.2",c:"green",d:"En verimli safiha ebatnn algoritma tarafndan seildii senaryo. Adet artarken fire %87 orannda stabilize edilir."}].map((t,r)=>n.jsxs(at,{delay:r*150,className:`p-10 bg-white border-2 rounded ${t.c==="green"?"border-[#10B981] shadow-2xl scale-[1.05]":"border-[#E2E8F0] opacity-60"} space-y-10`,children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("h4",{className:`text-sm font-black uppercase tracking-widest ${t.c==="green"?"text-[#10B981]":"text-[#6B7280]"}`,children:t.t}),t.c==="green"&&n.jsx(ut,{className:"bg-[#10B981] text-white text-[9px] uppercase font-black tracking-widest px-3 py-1",children:"OPTIMAL_MATCH"})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{className:"text-2xl font-black text-[#1A1D1F] tracking-tighter uppercase",children:t.s}),n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-[#94A3B8]",children:"Hesaplanan Fire:"}),n.jsx("span",{className:`text-4xl font-black ${t.c==="green"?"text-[#10B981]":"text-[#E11D48]"} tracking-tighter`,children:t.f})]})]}),n.jsx("p",{className:"text-xs text-[#6B7280] font-bold leading-relaxed",children:t.d})]},r))})]})]})}),n.jsx("section",{className:"px-6 py-24",children:n.jsxs("div",{className:"max-w-[1440px] mx-auto bg-[#800020] rounded-[3rem] p-12 lg:p-24 text-center text-white space-y-12 shadow-2xl relative overflow-hidden",children:[n.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-[radial-gradient(circle_at_30%_50%,#00000020,transparent)]"}),n.jsxs(at,{className:"space-y-8 relative z-10 transition-transform active:scale-[0.99] cursor-pointer",children:[n.jsxs("h2",{className:"text-4xl lg:text-7xl font-black tracking-tighter text-white uppercase leading-none italic",children:["Kayp Maliyetleri ",n.jsx("br",{})," Geri Kazann"]}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 justify-center",children:[n.jsxs("button",{onClick:()=>e("/bize-ulasin"),className:"px-12 py-6 bg-white text-[#800020] font-black rounded-sm hover:-translate-y-1 transition-all shadow-xl uppercase text-xs tracking-widest flex items-center justify-center gap-3",children:["cretsiz Analiz Balat ",n.jsx(Ta,{size:18})]}),n.jsx("button",{onClick:()=>window.location.href="mailto:info@ulgen.one",className:"px-12 py-6 border-2 border-white/20 text-white font-black rounded-sm hover:bg-white/5 transition-all text-center uppercase text-xs tracking-widest",children:"Teknik Ekiple Gr"})]})]})]})})]})}function XW(){const e=[{slug:"koli-acilim-formulu",title:"0201 Koli Alm Forml Nedir? (En, Boy, Ykseklik Hesab + rnek Tablo)",excerpt:"FEFCO 0201 standart koli alm hesaplama yntemleri, rill pay etkileri ve milimetrik fire optimizasyonu rehberi.",date:"23 ubat 2026",category:"Teknik Rehber",readTime:"15 dk okuma"},{slug:"fire-orani-hesaplama",title:"Fire Oran Nasl Hesaplanr? (Forml + Safiha rnei)",excerpt:"Oluklu mukavva retiminde fire orannn matematiksel hesab, safiha yerleim rnekleri ve fire drme stratejileri.",date:"23 ubat 2026",category:"Verimlilik",readTime:"12 dk okuma"},{slug:"break-even-hesabi",title:"Break-Even (Baa Ba) Hesab Nasl Yaplr? Oluklu Koli rneiyle",excerpt:"Oluklu mukavva retim tesislerinde krllk eiini belirleyen Baa Ba Noktas (BEP) hesaplama yntemleri ve proje bazl maliyet analizi.",date:"23 ubat 2026",category:"Finansal Analiz",readTime:"14 dk okuma"},{slug:"flap-teknik-rehber",title:"Flap (Bindirme Pay) Ka mm Olmal? Oluklu Koli Teknik Rehberi",excerpt:"Koli mukavemetini belirleyen kritik detay: Flap (yaptrma pay) hesaplama yntemleri ve dalga tipine gre ideal ller.",date:"23 ubat 2026",category:"Teknik Rehber",readTime:"9 dk okuma"},{slug:"rill-payi-teknik-analiz",title:"Rill Pay Nedir? 4 mm Rill Neye Gre Belirlenir?",excerpt:"Oluklu mukavva retiminde krm (rill) paylarnn fiziksel temelleri, dalga tipine gre hesaplama yntemleri ve 4mm standardnn analizi.",date:"23 ubat 2026",category:"Teknik Analiz",readTime:"11 dk okuma"},{slug:"safiha-yerlesim-rehberi",title:"800x1200 Safihada Ka Adet kar? Safiha Yerleim Rehberi",excerpt:"Safiha yerleiminde floor() mant, milimetrik adet hesaplamalar ve 3 farkl senaryo ile verimlilik analizi.",date:"23 ubat 2026",category:"Teknik Analiz",readTime:"10 dk okuma"}];return n.jsxs("div",{className:"pt-24 lg:pt-32 pb-24 selection:bg-[#800020]/10",children:[n.jsxs(yn,{children:[n.jsx("title",{children:"Bilgi Merkezi | Ulgen One Teknik Blog"}),n.jsx("meta",{name:"description",content:"Oluklu mukavva retim sreleri, maliyet analizi ve teknik optimizasyon zerine endstriyel makaleler."})]}),n.jsx("section",{className:"px-6 mb-24 border-b border-[#E2E8F0] pb-24 bg-[#FAFBFC]",children:n.jsx("div",{className:"max-w-[1440px] mx-auto text-left space-y-10",children:n.jsxs(at,{children:[n.jsx(ut,{className:"bg-[#1A1D1F] text-white border-0 py-1.5 px-4 text-[10px] font-black uppercase tracking-[0.2em] mb-4",children:"Industrial Knowledge Hub"}),n.jsxs("h1",{className:"text-5xl lg:text-8xl font-black tracking-tighter text-[#1A1D1F] mb-8 uppercase leading-[0.9]",children:["BLG ",n.jsx("br",{})," ",n.jsx("span",{className:"text-[#800020]",children:"MERKEZ"})]}),n.jsx("p",{className:"text-xl text-[#6B7280] max-w-3xl leading-relaxed font-medium",children:"Endstriyel retim srelerini optimize etmek, fireyi azaltmak ve operasyonel verimlilii artrmak iin hazrladmz teknik makaleler dkmantasyonu."})]})})}),n.jsx("section",{className:"px-6 py-12",children:n.jsx("div",{className:"max-w-[1440px] mx-auto grid md:grid-cols-2 gap-12 lg:gap-8",children:e.map((t,r)=>n.jsx(at,{delay:r*100,children:n.jsxs("article",{className:"group h-full flex flex-col bg-white border border-[#E2E8F0] rounded-sm transition-all hover:border-[#1A1D1F] hover:shadow-2xl hover:shadow-[#1A1D1F]/5 overflow-hidden",children:[n.jsxs(At,{to:`/blog/${t.slug}`,className:"block p-10 space-y-8 flex-1",children:[n.jsxs("div",{className:"flex flex-wrap items-center gap-6 text-[10px] font-black uppercase tracking-[0.2em]",children:[n.jsxs("span",{className:"text-[#800020] flex items-center gap-2",children:[n.jsx(K1,{size:14})," ",t.category]}),n.jsxs("span",{className:"text-[#94A3B8] flex items-center gap-2",children:[n.jsx(Xd,{size:14})," ",t.date]}),n.jsxs("span",{className:"text-[#94A3B8] flex items-center gap-2",children:[n.jsx(kh,{size:14})," ",t.readTime]})]}),n.jsx("h3",{className:"text-2xl lg:text-3xl font-black text-[#1A1D1F] leading-tight tracking-tighter uppercase transition-colors group-hover:text-[#800020]",children:t.title}),n.jsx("p",{className:"text-sm text-[#6B7280] font-medium leading-relaxed line-clamp-3",children:t.excerpt})]}),n.jsx("div",{className:"p-10 pt-0",children:n.jsxs(At,{to:`/blog/${t.slug}`,className:"inline-flex items-center gap-4 text-xs font-black uppercase tracking-[0.2em] text-[#1A1D1F] group-hover:text-[#800020] transition-all",children:["DOKMANI OKU ",n.jsx(Ta,{size:16,className:"transition-transform group-hover:translate-x-2"})]})})]})},r))})}),n.jsx("section",{className:"px-6 mt-32",children:n.jsxs("div",{className:"max-w-[1440px] mx-auto bg-[#1A1D1F] rounded-[3rem] p-12 lg:p-24 flex flex-col lg:flex-row items-center justify-between gap-16 relative overflow-hidden shadow-2xl",children:[n.jsx("div",{className:"absolute top-0 right-0 w-1/2 h-full bg-[#800020]/5 clip-path-slant pointer-events-none"}),n.jsxs("div",{className:"space-y-6 text-left relative z-10 max-w-xl",children:[n.jsx(ut,{className:"bg-[#800020] text-white border-0 py-1 px-4 text-[9px] font-black uppercase tracking-[0.2em]",children:"Platform Access"}),n.jsx("h3",{className:"text-3xl lg:text-5xl font-black text-white tracking-tighter uppercase",children:"SSTEM KEFEDN"}),n.jsx("p",{className:"text-white/40 font-medium",children:"Oluklu mukavva retim srelerinizi optimize etmek ve maliyet avantaj salamak iin platformumuzun gelimi maliyet analizi ve optimizasyon aralarn uzmanlarmz eliinde inceleyin."})]}),n.jsxs("div",{className:"flex flex-col sm:flex-row w-full lg:w-auto gap-4 relative z-10",children:[n.jsx(At,{to:"/iletisim",className:"px-10 py-5 bg-white/5 border border-white/10 text-white font-black rounded-sm hover:bg-white/10 transition-all uppercase text-xs tracking-widest text-center",children:"BZE ULAIN"}),n.jsxs(At,{to:"/register",className:"px-10 py-5 bg-[#800020] text-white font-black rounded-sm hover:bg-[#A00028] shadow-[0_0_40px_rgba(128,0,32,0.3)] hover:shadow-[0_0_60px_rgba(128,0,32,0.5)] transition-all uppercase text-xs tracking-widest flex items-center justify-center gap-3",children:["DEMO TALEP EDN ",n.jsx(Ta,{size:16})]})]})]})})]})}const qW={"break-even-hesabi":{title:"Break-Even (Baa Ba) Hesab Nasl Yaplr? Oluklu Koli rneiyle",date:"23 ubat 2026",category:"Finansal Analiz",readTime:"14 dk",excerpt:"Oluklu mukavva retim tesislerinde krllk eiini belirleyen Baa Ba Noktas (BEP) hesaplama yntemleri ve proje bazl maliyet analizi.",content:n.jsxs("div",{className:"space-y-8 text-justify text-[#374151]",children:[n.jsxs("section",{children:[n.jsx("h2",{className:"text-3xl font-bold text-[#1A1D1F] mb-6",children:"1. Giri: Finansal Srdrlebilirlik iin Kr Eii Kavram"}),n.jsx("p",{children:'Oluklu mukavva ambalaj sektrnde, zellikle tek seferlik zel retimlerde krll belirleyen en kritik finansal metrik, kr elde etmeye baladnz o "sert dneme" yani **Baa Ba Noktas (Break-Even Point - BEP)** analizidir. Baa Ba Noktas, toplam gelirlerin toplam giderlere (sabit + deiken) tam olarak eit olduu, net krn sfr olduu operasyonel hacmi ifade eder.'}),n.jsx("p",{className:"mt-4",children:"Bir siparii almadan nce, zellikle klie ve kalp gibi proje bazl yksek ilk yatrm maliyetlerinin hangi adetlerde amorti edileceini bilmemek, finansal bir risk ynetimi adr. Bu makalede, Ulgen One ierisinde kullanlan gerek maliyet parametreleri zerinden profesyonel bir baa ba analizi disiplini oluturacaz."})]}),n.jsxs("section",{className:"bg-[#F8FAFC] p-8 rounded-2xl border border-[#E2E8F0]",children:[n.jsx("h2",{className:"text-2xl font-bold text-[#1A1D1F] mb-4",children:"2. Temel Baa Ba Forml ve Uygulamadaki Karl"}),n.jsx("p",{className:"mb-6",children:"Oluklu koli projelerinde baa ba noktas, projenin balangcnda yaplan sabit harcamalarn, her bir koliden elde edilen kr ile ne zaman ntrleneceini gsterir."}),n.jsxs("div",{className:"bg-[#1A1D1F] text-[#10B981] p-6 rounded-lg font-mono text-center mb-6",children:[n.jsx("div",{className:"text-white opacity-50 text-xs mb-2",children:"// Proje Bazl BEP Forml"}),n.jsx("div",{className:"text-xl",children:"BEP (Adet) = Proje Sabit Giderleri / (Birim Sat Fiyat - Birim Ham Maliyet)"})]}),n.jsxs("p",{className:"text-sm",children:["Burada payda yer alan ",n.jsx("strong",{children:"Katk Pay"}),', her bir koli satnn projenin ilk yatrm giderlerini demeye ne kadar "katkda bulunduunu" ifade eder.']})]}),n.jsxs("section",{children:[n.jsx("h2",{className:"text-2xl font-bold text-[#1A1D1F] mb-4",children:"3. Gerek Parametreler: Sabit ve Deiken Maliyetler"}),n.jsx("p",{children:"Uygulamada doru bir analiz yapabilmek iin maliyetleri u balklar altnda ele alyoruz:"}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-8 mt-6",children:[n.jsxs("div",{className:"p-6 border border-[#E2E8F0] rounded-xl",children:[n.jsx("h4",{className:"font-bold text-[#800020] mb-4",children:"A. Proje Sabit Giderleri"}),n.jsxs("ul",{className:"list-disc ml-5 space-y-2 text-xs",children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Klie Maliyeti:"})," Bask iin gereken tek seferlik klie bedeli."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Kalp Maliyeti:"})," Kesim iin gereken bak/kalp bedeli."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Hazrlk / Balama:"})," Makinenin o ie zel ayar sresindeki iilik ve operasyonel maliyeti."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Nakliye (Sabit):"})," Toplam sevkiyatn sabit lojistik pay."]})]})]}),n.jsxs("div",{className:"p-6 border border-[#E2E8F0] rounded-xl",children:[n.jsx("h4",{className:"font-bold text-[#1A1D1F] mb-4",children:"B. Birim Deiken Deerler"}),n.jsxs("ul",{className:"list-disc ml-5 space-y-2 text-xs",children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Birim Ham Maliyet:"})," Safiha m maliyeti ve retim firesinin bileiminden oluan, tek bir kolinin ham retim bedeli."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Birim Sat Fiyat:"})," Mteriye teklif edilen birim koli fiyat."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Sipari Miktar:"})," Hedeflenen retim adedi."]})]})]})]})]}),n.jsxs("section",{children:[n.jsx("h2",{className:"text-2xl font-bold text-[#1A1D1F] mb-4",children:"4. Fire ve Alan Hesabnn Maliyete Entegre Edilmesi"}),n.jsx("p",{children:"Oluklu mukavvada birim ham maliyet hesaplanrken, kolinin net alanndan ziyade o koliyi retmek iin harcanan toplam safiha alan (fire dahil) baz alnmaldr. Birim ham maliyet u ekilde oluur:"}),n.jsx("p",{className:"bg-gray-100 p-4 font-mono text-sm my-4 text-center rounded border",children:"Birim Ham Maliyet = Birim Safiha Alan (m) x m Fiyat"}),n.jsx("p",{children:'Burada "Safiha Alan", flap ve rill paylarn ieren brt alandr. Baa ba noktas, bu ham maliyetin zerine projenin sabit giderlerinin eklenmesiyle krlln balad noktay belirler.'})]}),n.jsxs("section",{className:"bg-[#1A1D1F] text-white p-10 rounded-2xl shadow-xl",children:[n.jsx("h2",{className:"text-2xl font-bold mb-8",children:"5. Saysal rnek: zel Baskl Bir Koli Projesi"}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full text-sm text-left",children:[n.jsx("thead",{className:"text-[10px] uppercase font-bold text-[#800020] border-b border-white/10",children:n.jsxs("tr",{children:[n.jsx("th",{className:"pb-4",children:"Maliyet Kalemi"}),n.jsx("th",{className:"pb-4 text-right",children:"Deer ()"})]})}),n.jsxs("tbody",{className:"divide-y divide-white/5 font-mono",children:[n.jsxs("tr",{children:[n.jsx("td",{className:"py-3",children:"Klie + Kalp Bedeli"}),n.jsx("td",{className:"py-3 text-right",children:"3.000 TL"})]}),n.jsxs("tr",{children:[n.jsx("td",{className:"py-3",children:"Hazrlk / Balama Gideri"}),n.jsx("td",{className:"py-3 text-right",children:"500 TL"})]}),n.jsxs("tr",{children:[n.jsx("td",{className:"py-3",children:"Nakliye (Proje Toplam)"}),n.jsx("td",{className:"py-3 text-right",children:"1.500 TL"})]}),n.jsxs("tr",{className:"bg-white/5",children:[n.jsx("td",{className:"py-3 font-bold text-[#800020]",children:"Toplam Sabit Gider"}),n.jsx("td",{className:"py-3 text-right font-bold",children:"5.000 TL"})]}),n.jsxs("tr",{children:[n.jsx("td",{className:"py-3",children:"Birim Sat Fiyat"}),n.jsx("td",{className:"py-3 text-right",children:"15,00 TL"})]}),n.jsxs("tr",{children:[n.jsx("td",{className:"py-3",children:"Birim Ham Maliyet"}),n.jsx("td",{className:"py-3 text-right",children:"10,00 TL"})]})]})]})}),n.jsxs("div",{className:"mt-8 p-6 bg-white/5 border border-white/10 rounded-xl leading-relaxed",children:[n.jsx("p",{className:"font-bold mb-2",children:"HESAPLAMA:"}),n.jsx("p",{children:"Birim Katk Pay = 15.00 - 10.00 = 5.00 TL"}),n.jsxs("p",{className:"text-xl mt-2 font-black",children:["BEP (Baa Ba Adedi) = 5.000 / 5.00 = ",n.jsx("strong",{children:"1.000 Adet"})]}),n.jsx("p",{className:"mt-4 text-xs opacity-70 italic text-yellow-500",children:"Analiz: Bu projede ilk 1.000 adetlik sat sadece sabit maliyetleri (klie, kalp, nakliye) kapatr. 1.001'inci koliden itibaren iletme net kr elde etmeye balar."})]})]}),n.jsxs("section",{children:[n.jsx("h2",{className:"text-2xl font-bold text-[#1A1D1F] mb-6",children:"6. Manuel vs. Sistem Analizi: Neden Otomasyon?"}),n.jsx("p",{children:'Geleneksel yntemlerle yaplan krllk analizlerinde rill paylar, flap paylar veya projenin toplam lojistik yk genellikle gz karar eklenir. Bu durum, zellikle dk adetli ilerde "kr ettiini sanrken zarar etme" riskini dourur.'}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mt-8",children:[n.jsxs("div",{className:"p-4 bg-red-50 border border-red-100 rounded-lg text-xs leading-relaxed",children:[n.jsx("span",{className:"font-bold block mb-1 text-red-900",children:"Risk:"})," Sabit giderleri (klie, nakliye) birim maliyete yanl datarak hatal baa ba noktas bulmak."]}),n.jsxs("div",{className:"p-4 bg-green-50 border border-green-100 rounded-lg text-xs leading-relaxed",children:[n.jsx("span",{className:"font-bold block mb-1 text-green-900",children:"Ulgen One Yaklam:"})," Tm proje sabitlerini ve milimetrik ham maliyeti birletirerek net kr eiini grsel grafikle sunmak."]})]})]}),n.jsxs("section",{className:"border-t pt-8",children:[n.jsx("h2",{className:"text-2xl font-bold text-[#1A1D1F] mb-4 text-[#800020]",children:"Sonu: Rakamlarla Ynetilen retim"}),n.jsx("p",{children:'Baa ba analizi, bir tekstil fabrikasndan metal atlyesine kadar her yerde kritiktir; ancak oluklu koli sektrnde firenin yksek etkisi nedeniyle "zorunluluktur". Ulgen One, teklif aamasnda sabit proje maliyetlerinizi (klie, kalp, sevkiyat) ve birim ham maliyetinizi saniyeler iinde analiz eder. Bylece hangi adetten itibaren kr edeceinizi bilerek, rekabeti ve gvenli teklifler verebilirsiniz.'})]})]})},"rill-payi-teknik-analiz":{title:"Rill Pay Nedir? 4 mm Rill Neye Gre Belirlenir?",date:"23 ubat 2026",category:"Teknik Analiz",readTime:"11 dk",excerpt:"Oluklu mukavva retiminde krm (rill) paylarnn fiziksel temelleri, dalga tipine gre hesaplama yntemleri ve 4mm standardnn analizi.",content:n.jsxs("div",{className:"space-y-8 text-justify text-[#374151]",children:[n.jsxs("section",{children:[n.jsx("h2",{className:"text-3xl font-bold text-[#1A1D1F] mb-6",children:"1. Rill Tanm: Malzemenin Plastik Deformasyon Matematii"}),n.jsx("p",{children:'Oluklu mukavva terminolojisinde "Rill" (veya krm), plakann koli formuna getirilmesi iin belirli hatlar boyunca ezilmesi ve bu sayede kontroll bir katlama hatt oluturulmas ilemidir. Mhendislik asndan rill, mukavvann lineer (yzey) katlarn koparmadan, fluting (ondle) katmann belirli bir geometride sktrarak malzemenin "katlanma direncini" yerel olarak drmektir.'})]}),n.jsxs("section",{children:[n.jsx("h2",{className:"text-2xl font-bold text-[#1A1D1F] mb-4",children:"2. Neden Hesaplamada Hayati nem Tar?"}),n.jsx("p",{children:'Bir mukavva katlandnda, katlama noktasnn d tarafndaki kat gerilirken, i tarafndaki kat ve ondle katman skr. Bu fiziksel deiim, malzemenin "ntr ekseninin" yer deitirmesine neden olur. Eer koli alm hesaplanrken bu rill paylar (krm kayplar) eklenmezse, ortaya kan koli i lleri hedeflenenden kk kalacaktr. Baka bir deyile rill pay, "teorik l" ile "fiziksel gerekleme" arasndaki kalnlk farkn kompanse eden matematiksel bir sabittir.'})]}),n.jsxs("section",{className:"bg-white border border-[#E2E8F0] p-8 rounded-xl",children:[n.jsx("h2",{className:"text-2xl font-bold text-[#1A1D1F] mb-4",children:"3. Dalga Tipine Gre Rill Farkll"}),n.jsx("p",{children:"Rill pay dorudan mukavvann et kalnl (caliper) ile ilintilidir. Katlanacak malzeme ne kadar kalnsa, krmn oluturaca yer deitirme o kadar byk olacaktr."}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-8 mt-6",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx("h4",{className:"font-bold text-[#800020] text-sm uppercase",children:"Tek Dalga (Single Wall)"}),n.jsx("p",{className:"text-xs",children:"E Dalga (1.5mm): 1 - 2 mm Rill"}),n.jsx("p",{className:"text-xs",children:"B Dalga (3.0mm): 3 mm Rill"}),n.jsx("p",{className:"text-xs",children:"C Dalga (4.0mm): 4 mm Rill"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("h4",{className:"font-bold text-[#800020] text-sm uppercase",children:"ift Dalga (Double Wall)"}),n.jsx("p",{className:"text-xs",children:"EB Dalga (4.5mm): 4 - 5 mm Rill"}),n.jsx("p",{className:"text-xs",children:"BC Dalga (7.0mm): 5 - 7 mm Rill*"}),n.jsx("p",{className:"text-[#6B7280] text-[10px]",children:'* Not: BC dalga iin kullanlan 4mm rill pay, genellikle "dar rill" baklar ve yksek sktrma oranlar iin bir alt limittir.'})]})]})]}),n.jsxs("section",{children:[n.jsx("h2",{className:"text-2xl font-bold text-[#1A1D1F] mb-4",children:"4. Hesaplamada Dahil Edilmezse Ne Olur?"}),n.jsx("p",{children:"Rill paynn ihmal edilmesi veya yanl girilmesi retimde  ana arzaya neden olur:"}),n.jsxs("ul",{className:"list-disc ml-6 space-y-3 mt-4 text-sm",children:[n.jsxs("li",{children:[n.jsx("strong",{children:"l Sapmas:"})," Kolinin iine girmesi gereken rn paketine smaz. 300mm boyunda olmas gereken koli 293mm olarak gerekleir."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Gnyesiz Kurulum (Fish-tailing):"})," Koli diki hattnda kulaklar tam kavumaz, koli yamuk (paralelkenar eklinde) kurulur."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Kapak akmas:"})," Karlkl kapaklarn ortada birlemesi gerekirken st ste binmesi veya arada aklk kalmas."]})]})]}),n.jsxs("section",{className:"bg-gray-100 p-8 rounded-2xl font-mono text-sm shadow-inner",children:[n.jsx("h2",{className:"text-2xl font-bold font-sans text-[#1A1D1F] mb-6 underline decoration-[#800020]",children:"5. Teknik Uygulama rnei"}),n.jsx("p",{className:"mb-4 text-[#800020] font-bold",children:"// BC Dalga (7mm) 0201 Koli Hesab"}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("p",{children:"Hedef  l: 400 mm"}),n.jsx("p",{children:"Uygulanan Rill Pay: 4 mm"}),n.jsx("p",{className:"mt-4 italic",children:"Analiz:"}),n.jsx("p",{children:"Plaka zerinde iki krm aras net mesafe =  l + (2 x Rill_Pay / 2)"}),n.jsxs("p",{children:["Pratik Uygulama (Slotter): 400 + 4 = ",n.jsx("strong",{children:"404 mm"})]}),n.jsx("p",{className:"text-[11px] text-[#6B7280] mt-2 underline",children:"Neden 404? nk krmn merkezinden itibaren malzemenin yars ieri, yars dar katlanr. ki krmn toplam etkisi bir tam rill payna eittir."})]})]}),n.jsxs("section",{children:[n.jsx("h2",{className:"text-2xl font-bold text-[#1A1D1F] mb-4",children:"6. Yanl Rill Sonucu Maliyet Kaymas"}),n.jsx("p",{children:'Rill paylarndaki milimetrik hatalar, teklif aamasnda "fire oran" hesaplamasn dorudan bozar. rnein, rill payn 4mm yerine 6mm aldnzda, 4 krm ieren bir koli anmnda toplam boy 8mm uzar. Bu 8mm, plaka yerleiminde parann bobin eninden tamasna neden olabilir.'}),n.jsx("p",{className:"mt-4",children:`Plana smayan o "fazladan" 8mm yznden bobin enini bir st boyuta (rnein 2200'den 2300'e) ekmek zorunda kaldnzda, tm sipari boyunca %4.5 orannda fazladan ham madde maliyeti dersiniz. Bu, binlerce tonluk retimde devasa bir zarar kalemidir.`})]}),n.jsxs("section",{className:"border-t pt-8",children:[n.jsx("h2",{className:"text-2xl font-bold text-[#1A1D1F] mb-4",children:"Sonu: Rill Bir Tahmin Deil, Kalibrasyondur"}),n.jsx("p",{children:"Rill pay, her fabrikann kendi makine parkuruna, bak kalnlna ve kulland kat kalitesine gre calibrate etmesi gereken bir deikendir. Ulgen One, bu teknik hassasiyeti matematiksel bir model olarak ierir ve hesaplama motorunda rill paylarn dinamik bir girdi olarak kabul eder. Doru kr marj, doru rill hesabyla balar."})]})]})},"flap-teknik-rehber":{title:"Flap (Bindirme Pay) Ka mm Olmal? Oluklu Koli Teknik Rehberi",date:"23 ubat 2026",category:"Teknik Rehber",readTime:"9 dk",excerpt:"Koli mukavemetini belirleyen kritik detay: Flap (yaptrma pay) hesaplama yntemleri ve dalga tipine gre ideal ller.",content:n.jsxs("div",{className:"space-y-8 text-justify text-[#374151]",children:[n.jsxs("section",{children:[n.jsx("h2",{className:"text-3xl font-bold text-[#1A1D1F] mb-6",children:"1. Giri: Kolinin Grnmez Gc, Flap"}),n.jsx("p",{children:'Oluklu mukavva tasarmnda, bir kolinin yapsal btnln salayan en kritik ancak genellikle en az zerinde durulan bileen "Flap" veya Trkesiyle "Bindirme Pay"dr. Yan diki kula olarak da adlandrlan bu blm, plakann tp formuna getirilip kapatlmasn salar. Yanl hesaplanan veya yetersiz tutulan bir flap pay, kolinin tama srasnda patlamasna, istifleme direncinin dmesine ve nihayetinde rn hasarlarna yol aar.'})]}),n.jsxs("section",{children:[n.jsx("h2",{className:"text-2xl font-bold text-[#1A1D1F] mb-4",children:"2. Neden Gereklidir? Yapsal Gereklilikler"}),n.jsx("p",{children:'Flap, kolinin yk altnda dahi eklini korumasn salayan bir "kilit" mekanizmasdr. Sadece yaptrma yzeyi sunmakla kalmaz, ayn zamanda dikey yklerin kelere dalmasnda bir kpr grevi grr. Endstriyel bir koli, zellikle nemli ortamlarda veya uzun sreli istiflemede yan dikiten alma eilimi gsterir. Bu dikiin mukavemeti, kullanlan yaptrcnn tr ve flap paynn genilii ile dorudan ilikilidir.'})]}),n.jsxs("section",{className:"bg-white border border-[#E2E8F0] p-8 rounded-xl shadow-sm",children:[n.jsx("h2",{className:"text-2xl font-bold text-[#1A1D1F] mb-4",children:"3. Standart ller: Ne Zaman, Hangisi Seilmeli?"}),n.jsx("p",{children:"Sektrel uygulamalarda flap paylar genellikle 3 ana grupta toplanr:"}),n.jsxs("div",{className:"grid md:grid-cols-3 gap-6 mt-6",children:[n.jsxs("div",{className:"p-4 bg-[#800020]/5 rounded-lg",children:[n.jsx("h4",{className:"font-bold text-[#800020] mb-2",children:"20 - 25 mm"}),n.jsx("p",{className:"text-xs",children:"Kk e-ticaret kutular ve hafif i kutular iin tercih edilir. Bantl kapamalarda yeterlidir."})]}),n.jsxs("div",{className:"p-4 bg-[#800020]/5 rounded-lg",children:[n.jsx("h4",{className:"font-bold text-[#800020] mb-2",children:"30 - 35 mm"}),n.jsxs("p",{className:"text-xs",children:[n.jsx("strong",{children:"Endstriyel Standart."})," Slotter makinelerinde ve otomatik tutkal hatlarnda en verimli allan ldr."]})]}),n.jsxs("div",{className:"p-4 bg-[#800020]/5 rounded-lg",children:[n.jsx("h4",{className:"font-bold text-[#800020] mb-2",children:"40 - 50 mm"}),n.jsx("p",{className:"text-xs",children:"Ar hizmet tipi koliler, tel diki (zmba) gerektiren Dopel veya Triplex projeler iin zorunludur."})]})]})]}),n.jsxs("section",{children:[n.jsx("h2",{className:"text-2xl font-bold text-[#1A1D1F] mb-4",children:"4. Dalga Tipine Gre Deiim ve Toleranslar"}),n.jsx("p",{children:"Mukavvann kalnl arttka, katlama noktasndaki gerilimi absorbe etmek iin ihtiya duyulan flap pay da artar. te dalga tiplerine gre ideal alt limitler:"}),n.jsxs("ul",{className:"list-none space-y-3 mt-4 font-mono text-sm",children:[n.jsxs("li",{className:"flex justify-between border-b pb-2",children:[n.jsx("span",{children:"E Dalga (Mikro):"})," ",n.jsx("span",{children:"25 - 30 mm"})]}),n.jsxs("li",{className:"flex justify-between border-b pb-2",children:[n.jsx("span",{children:"B Dalga (nce):"})," ",n.jsx("span",{children:"30 - 35 mm"})]}),n.jsxs("li",{className:"flex justify-between border-b pb-2",children:[n.jsx("span",{children:"C Dalga (ri):"})," ",n.jsx("span",{children:"35 mm"})]}),n.jsxs("li",{className:"flex justify-between border-b pb-2",children:[n.jsx("span",{children:"BC / EB Dalga (Dopel):"})," ",n.jsx("span",{children:"35 - 45 mm"})]})]})]}),n.jsxs("section",{children:[n.jsx("h2",{className:"text-2xl font-bold text-[#1A1D1F] mb-4",children:"5. Gl Yaptrma vs. Maliyet Dengesi"}),n.jsx("p",{children:'Her mhendislik probleminde olduu gibi, flap seiminde de bir "optimum" nokta vardr. Kula ok geni tutmak yaptrma yzeyini artrsa da, her koli iin fazladan 10mm kat harcamak demektir. 100.000 adetlik bir retimde fazladan verilen 10mm flap, m baznda ciddi bir maliyet kalemine dnr.'}),n.jsx("p",{className:"mt-4 italic",children:`Kritik Soru: "Yaptrcnzn (Hotmelt veya PVA) ekme kuvveti nedir?". Yksek tutu gcne sahip modern tutkallar kullanlyorsa, flap geniliini 40mm'den 30mm'ye ekerek mukavemetten dn vermeden tasarruf salanabilir.`})]}),n.jsxs("section",{className:"bg-[#1A1D1F] text-white p-8 rounded-2xl",children:[n.jsx("h2",{className:"text-2xl font-bold mb-4",children:"6. Flap Fazla Olursa Fire Artar m?"}),n.jsx("p",{className:"text-sm opacity-80 leading-relaxed text-yellow-500 font-bold mb-4",children:"CEVAP: EVET VE BAZEN DRAMATK EKLDE!"}),n.jsx("p",{className:"text-sm opacity-90 leading-relaxed",children:"Flap paynn sadece 5-10mm artmas, o parann toplam plaka enini (blank width) kritik bir eiin zerine karabilir. rnein, bobin eniniz 2400mm ise ve siz yan yana 4 para basyorsanz; flap payndaki 5mm'lik art (4 para iin toplam 20mm), plakann bobine smamasna neden olabilir. Bu durumda 4 para yerine 3 para basmak zorunda kalrsnz ve fire orannz bir anda %+25 artar."})]}),n.jsxs("section",{children:[n.jsx("h2",{className:"text-2xl font-bold text-[#1A1D1F] mb-6",children:"7. retim rnei: Optimizasyon Fark"}),n.jsx("p",{children:" lleri 400x300x200 mm olan bir 0201 koli iin hesaplama yapalm:"}),n.jsxs("div",{className:"bg-gray-100 p-6 rounded-xl space-y-4 font-mono text-sm text-[#1A1D1F]",children:[n.jsxs("div",{children:[n.jsx("strong",{children:"Durum A (40mm Flap):"}),n.jsx("br",{}),"Alm En: [2 x (400 + 300)] + 40 + riller = ",n.jsx("strong",{children:"1472 mm"})]}),n.jsxs("div",{children:[n.jsx("strong",{children:"Durum B (30mm Flap):"}),n.jsx("br",{}),"Alm En: [2 x (400 + 300)] + 30 + riller = ",n.jsx("strong",{children:"1462 mm"})]})]}),n.jsx("p",{className:"mt-4",children:'Eer retim bobininiz 1500mm ise, 1472mm ile almak risklidir (kenar tra azalr), 1462mm ise ok daha gvenli bir operasyon ve daha dk "setup firesi" sunar.'})]}),n.jsxs("section",{className:"border-t pt-8",children:[n.jsx("h2",{className:"text-2xl font-bold text-[#1A1D1F] mb-4",children:"Sonu: Detaylarda Gizli Krllk"}),n.jsx("p",{children:"Flap pay belirlemek sadece bir standart seimi deil, bir maliyet ynetimi karardr. Ulgen One, girdiiniz dalga tipine ve setiiniz koli formuna gre kendi belirlediiniz flap paynn fire zerindeki etkisini anlk olarak simle etmenize olanak tanr. Unutmayn; retimde verimlilik, grnmeyen detaylarn doru ynetilmesiyle balar."})]})]})},"safiha-yerlesim-rehberi":{title:"800x1200 Safihada Ka Adet kar? Safiha Yerleim Rehberi",date:"23 ubat 2026",category:"Teknik Analiz",readTime:"10 dk",excerpt:"Safiha yerleiminde floor() mant, milimetrik adet hesaplamalar ve 3 farkl senaryo ile verimlilik analizi.",content:n.jsxs("div",{className:"space-y-8 text-justify text-[#374151]",children:[n.jsxs("section",{children:[n.jsx("h2",{className:"text-3xl font-bold text-[#1A1D1F] mb-6",children:"1. Giri: Safiha Yerleimi ve Teklif Kesinlii"}),n.jsx("p",{children:'Oluklu mukavva retiminde en sk sorulan ve hata yapldnda en byk maliyet ykn douran soru udur: "Elimizdeki safihadan ka adet koli kar?". Bu soruya verilen yant, sadece basit bir blme ilemi deil; makine toleranslarn, rill (krm) paylarn ve rotasyon kstlarn ieren teknik bir optimizasyon srecidir.'}),n.jsx("p",{className:"mt-4",children:"zellikle Trkiye ve Avrupa pazarnda standart kabul edilen 800x1200 mm (Euro palet uyumlu) safiha ls, lojistik kolayl nedeniyle en ok tercih edilen ancak zerinde en ok fire verilen llerden biridir. Bu rehberde, bir retim mhendisinin hassasiyetiyle adet hesaplama yntemlerini inceleyeceiz."})]}),n.jsxs("section",{children:[n.jsx("h2",{className:"text-2xl font-bold text-[#1A1D1F] mb-4",children:"2. Matematiksel Temel: Neden floor() Mant Kullanlr?"}),n.jsxs("p",{children:['Hesaplamalarda yaplan en yaygn hata, "toplam alan para alanna blmek"tir. rnein, 1000 cm safiha alann 100 cm para alanna bldnzde matematiksel olarak 10 adet kar; ancak fiziksel olarak smayabilir. te bu noktada ',n.jsx("strong",{children:"floor()"})," (Aa yuvarla) fonksiyonu devreye girer."]}),n.jsx("p",{className:"mt-4",children:"Fiziksel dnyada bir parann bir plaka zerine smas iin, parann tam bir ktle olarak o alana yerlemesi gerekir. 1.9 adet san bir yere ancak 1 adet koyabilirsiniz; kalan 0.9'luk alan otomatik olarak firedir. Bu nedenle kapasite hesaplarnda her zaman aa yuvarlama kural uygulanr."})]}),n.jsxs("section",{className:"bg-gray-50 p-8 rounded-xl border border-gray-200 font-mono",children:[n.jsx("h2",{className:"text-xl font-bold text-[#1A1D1F] mb-4",children:"3. piecesPerSheet Hesaplama Forml"}),n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{className:"p-4 bg-white border rounded",children:n.jsx("span",{className:"text-[#800020] font-black",children:"Teorik Kapasite = floor(Safiha_En / Para_En) x floor(Safiha_Boy / Para_Boy)"})}),n.jsx("p",{className:"text-xs italic text-gray-500",children:'Not: Gerek hesaplamada "Safiha_En" ve "Safiha_Boy" deerlerinden 10-20mm kenar (trim) pay dlmelidir.'})]})]}),n.jsxs("section",{children:[n.jsx("h2",{className:"text-2xl font-bold text-[#1A1D1F] mb-6",children:"4. Gerek rnekler: 800x1200 Safiha Analizi"}),n.jsx("p",{children:"imdi 800x1200 mm safiha zerinde (paylar dldkten sonra net 780x1180 mm kullanm alan varsayarak) 3 farkl koli an mn test edelim."}),n.jsxs("div",{className:"space-y-8 mt-8",children:[n.jsxs("div",{className:"p-6 border rounded-2xl border-[#E2E8F0]",children:[n.jsx("h4",{className:"font-bold text-[#800020] mb-4",children:"Senaryo A: Kk Boy Koli (200x300 mm)"}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-8 text-sm",children:[n.jsxs("div",{children:[n.jsx("p",{className:"font-bold underline mb-2",children:"Normatif Yerleim:"}),n.jsx("p",{children:"En: floor(780 / 200) = 3 adet"}),n.jsx("p",{children:"Boy: floor(1180 / 300) = 3 adet"}),n.jsx("p",{className:"font-black mt-2",children:"Toplam: 9 Adet"})]}),n.jsxs("div",{children:[n.jsx("p",{className:"font-bold underline mb-2",children:"Rotasyonel Yerleim:"}),n.jsx("p",{children:"En: floor(780 / 300) = 2 adet"}),n.jsx("p",{children:"Boy: floor(1180 / 200) = 5 adet"}),n.jsx("p",{className:"font-black mt-2 text-[#10B981]",children:"Toplam: 10 Adet (Verimlilik %+11)"})]})]})]}),n.jsxs("div",{className:"p-6 border rounded-2xl border-[#E2E8F0]",children:[n.jsx("h4",{className:"font-bold text-[#800020] mb-4",children:"Senaryo B: Orta Boy Koli (400x500 mm)"}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-8 text-sm",children:[n.jsxs("div",{children:[n.jsx("p",{className:"font-bold underline mb-2",children:"Normatif Yerleim:"}),n.jsx("p",{children:"En: floor(780 / 400) = 1 adet"}),n.jsx("p",{children:"Boy: floor(1180 / 500) = 2 adet"}),n.jsx("p",{className:"font-black mt-2",children:"Toplam: 2 Adet"})]}),n.jsxs("div",{children:[n.jsx("p",{className:"font-bold underline mb-2",children:"Rotasyonel Yerleim:"}),n.jsx("p",{children:"En: floor(780 / 500) = 1 adet"}),n.jsx("p",{children:"Boy: floor(1180 / 400) = 2 adet"}),n.jsx("p",{className:"font-black mt-2",children:"Toplam: 2 Adet (Eit)"})]})]})]}),n.jsxs("div",{className:"p-6 border rounded-2xl border-[#E2E8F0]",children:[n.jsx("h4",{className:"font-bold text-[#800020] mb-4",children:"Senaryo C: Byk Boy Koli (600x700 mm)"}),n.jsx("div",{className:"text-sm",children:n.jsxs("p",{children:["Bu llerde 800x1200 safihaya ",n.jsx("strong",{children:"sadece 1 adet"})," sar. Kalan alan devasa bir firedir (%65+). Bu koli iin bu safiha ls finansal bir intihardr."]})})]})]})]}),n.jsxs("section",{children:[n.jsx("h2",{className:"text-2xl font-bold text-[#1A1D1F] mb-4",children:"5. Fire Fark Analizi: Milimetrenin Ekonomisi"}),n.jsx("p",{children:"Yukardaki Senaryo A'da rotasyon sayesinde 9 yerine 10 adet kardmzda ne deiti? 10.000 adetlik bir siparite, balangta 1.111 adet safiha sipari etmeniz gerekirken, optimize edilmi yerleimle 1.000 adet safiha yeterli olur. 111 adet safiha tasarrufu, yaklak %10'luk bir hammadde maliyet d demektir."}),n.jsx("p",{className:"mt-4",children:"Bu, ihaleyi kazanp kazanmamanz belirleyen temel rekabeti avantajdr."})]}),n.jsxs("section",{children:[n.jsx("h2",{className:"text-2xl font-bold text-[#1A1D1F] mb-4",children:"6. Minimum retim ve m Snrlar"}),n.jsx("p",{children:'Safiha yerleiminde adet hesab yaparken, makinenin minimum alma m veya tutar snrlamalarna dikkat edilmelidir. rnein koli ls ok kkse ve safihadan 20 adet kyorsa, ancak sipari adedi azsa, toplam m makineyi altrmaya yetmeyebilir. Bu durumda fire orannz dk olsa bile, setup maliyetleri nedeniyle "birim maliyet" frlayacaktr.'})]}),n.jsxs("section",{className:"bg-[#1A1D1F] text-white p-10 rounded-2xl",children:[n.jsx("h2",{className:"text-3xl font-bold mb-6",children:"Sonu: Grsellememi Veri Yanltr"}),n.jsx("p",{className:"opacity-80",children:"Manuel olarak yaplan yerleim hesaplamalar, zellikle rill paylarnn (krmlar aras mesafelerin) toplam genilii getii kritik eiklerde sizi yanltr. 780mm dediiniz alana 778mm bir para teorik olarak sar, ancak o parann zerindeki 5mm'lik bir kabanma (swell) o alan 783mm'ye karr ve yerleim patlar."}),n.jsx("p",{className:"mt-6 font-bold text-[#800020]",children:'Ulgen One, bu fiziksel deikenleri matematiksel formllerle birletirerek size her zaman "baslabilir" ve "kazanlabilir" en net adedi sunar.'})]})]})},"fire-orani-hesaplama":{title:"Fire Oran Nasl Hesaplanr? (Forml + Safiha rnei)",date:"23 ubat 2026",category:"Verimlilik",readTime:"12 dk",excerpt:"Oluklu mukavva retiminde fire orannn matematiksel hesab, safiha yerleim rnekleri ve fire drme stratejileri.",content:n.jsxs("div",{className:"space-y-8 text-justify text-[#374151]",children:[n.jsxs("section",{children:[n.jsx("h2",{className:"text-3xl font-bold text-[#1A1D1F] mb-6 border-b pb-2",children:"1. Giri: Endstriyel Kayp Olarak Fire Kavram"}),n.jsx("p",{children:'Oluklu mukavva ve kat ambalaj sektrnde "fire", ham maddenin son rne dnmeyen, ekonomik deerini (sekonder hammadde olarak geri dnm deeri hari) retim srecinde kaybeden ksmdr. Bir iletmenin brt kr marjn dorudan etkileyen en byk  kalemden biri (hammadde, iilik, enerji) ham maddedir ve fire dorudan bu kalemi eritir.'}),n.jsx("p",{className:"mt-4",children:`Mhendislik perspektifinden bakldnda fire, bir sistemin "verimsizlik katsays" olarak tanmlanabilir. %10 fire ile alan bir tesis, aslnda her gn kapasitesinin %10'unu sokaa atyor demektir. Bu makalede, firenin matematiksel anatomisini karacak ve teorik hesaplarn saha pratiiyle nasl elitiini teknik bir dille analiz edeceiz.`})]}),n.jsxs("section",{children:[n.jsx("h2",{className:"text-2xl font-bold text-[#1A1D1F] mb-4",children:"2. Fire Neden Oluur? Sistematik Kaynaklar"}),n.jsx("p",{children:'retimdeki fireyi ynetmenin ilk adm, onun kaynaklarn kategorize etmektir. Fire sadece "kesim art" deildir; o, srecin her aamasnda pusu kuran bir maliyet faktrdr:'}),n.jsxs("ul",{className:"list-disc ml-6 space-y-4 text-[#4B5563] mt-4",children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Geometrik Fire (Trim):"})," Koli anmnn (blank), safiha plakasnn (sheet) tam kat olmamasndan kaynaklanan kanlmaz artklardr. En temel optimizasyon buradadr."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Operasyonel Paylar (Technical Margins):"})," Slotter baklarnn, kesim kalplarnn veya ambalaj diki kulaklarnn ihtiya duyduu tutma ve tama mesafeleridir."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Makine Balang Kayplar:"})," Flekso veya ondle hatlarnda ayar (set-up) srasnda oluan bask ve krm hatal ilk retimler."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Atl Stok ve Nem Kayplar:"})," Yanl depolama sonucu bozulan mukavva mukavemeti nedeniyle ayrlan skartalar."]})]})]}),n.jsxs("section",{className:"bg-[#F8FAFC] p-8 rounded-2xl border border-[#E2E8F0]",children:[n.jsx("h2",{className:"text-2xl font-bold text-[#1A1D1F] mb-4",children:"3. Fire Hesaplama Forml: Deterministik Yaklam"}),n.jsx("p",{className:"mb-6",children:"Teorik fire hesaplamasnda kullanlan standart denklem, net kullanm verimi zerinden kurulur. te ham madde verimliliini len temel forml:"}),n.jsxs("div",{className:"bg-[#1A1D1F] text-[#10B981] p-6 rounded-lg font-mono text-center",children:[n.jsx("div",{className:"text-white opacity-50 text-xs mb-2",children:"// Temel Fire Denklemi"}),n.jsx("div",{className:"text-xl",children:"Fire = [ 1 - ( Net_Kullanlan_Alan / Toplam_Safiha_Alan ) ] x 100"})]}),n.jsxs("div",{className:"mt-8 space-y-4 text-sm",children:[n.jsxs("p",{children:[n.jsx("strong",{children:"Net Kullanlan Alan:"})," Sipari edilen adet x Tek bir parann net m'si (alm lsne gre)."]}),n.jsxs("p",{children:[n.jsx("strong",{children:"Toplam Safiha Alan:"})," Sipari edilen safiha adedi x Safiha d m ls."]}),n.jsx("p",{className:"italic text-[#800020] font-bold",children:"* Not: Hesaplama yaparken ham maddenin sadece o sipari iin ayrlan ksmn deil, o paray retmek iin satn alnan tm safiha ktlesini baz almalsnz."})]})]}),n.jsxs("section",{children:[n.jsx("h2",{className:"text-2xl font-bold text-[#1A1D1F] mb-6",children:"4. Detayl Hesaplama rnei: 800x1200 mm Safiha"}),n.jsx("p",{children:"Bir vaka analizi zerinden ilerleyelim. Elimizde teknik zellikleri aada belirtilen bir sipari olduunu varsayalm:"}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-8 my-8",children:[n.jsxs("div",{className:"p-6 bg-white border border-[#E2E8F0] rounded-xl",children:[n.jsx("h4",{className:"font-bold border-b mb-4 pb-2",children:"Girdi Parametreleri"}),n.jsxs("ul",{className:"space-y-2 font-mono text-sm",children:[n.jsx("li",{children:"Safiha ls: 800 x 1200 mm"}),n.jsx("li",{children:"Para Anm: 400 x 600 mm"}),n.jsx("li",{children:"Kenar Paylar: 10 mm (Her kenardan)"})]})]}),n.jsxs("div",{className:"p-6 bg-white border border-[#E2E8F0] rounded-xl",children:[n.jsx("h4",{className:"font-bold border-b mb-4 pb-2",children:"Hesaplama Mant"}),n.jsx("p",{className:"text-xs leading-relaxed italic",children:'Burada "Floor" (Aa yuvarla) mant kullanlr. nk bir plaka zerine tam olmayan bir para smaz.'})]})]}),n.jsxs("div",{className:"space-y-4 font-mono text-sm",children:[n.jsxs("div",{className:"p-4 border-l-4 border-[#800020] bg-gray-50",children:[n.jsx("strong",{children:"A. Safiha Kullanlabilir Alan:"}),n.jsx("br",{}),"(800 - 20) x (1200 - 20) = 780 x 1180 mm"]}),n.jsxs("div",{className:"p-4 border-l-4 border-[#800020] bg-gray-50",children:[n.jsx("strong",{children:"B. Para Yerleimi (Kapasite):"}),n.jsx("br",{}),"En boyunca: floor( 780 / 400 ) = 1 adet",n.jsx("br",{}),"Boy boyunca: floor( 1180 / 600 ) = 1 adet",n.jsx("br",{}),"Toplam Kapasite: 1 x 1 = ",n.jsx("strong",{children:"1 Adet/Safiha"})]}),n.jsxs("div",{className:"p-4 border-l-4 border-[#10B981] bg-gray-50",children:[n.jsx("strong",{children:"C. Fire Analizi:"}),n.jsx("br",{}),"Toplam Alan: 960,000 mm",n.jsx("br",{}),"Kullanlan Alan: 240,000 mm",n.jsx("br",{}),"Fire: 1 - (240k / 960k) = ",n.jsx("strong",{children:"%75 FIRE"})]})]}),n.jsx("p",{className:"mt-6 text-[#EF4444] font-bold",children:'Analiz: Bu yerleim, korkun bir verimsizlik rneidir. te devreye "Rotasyon Etkisi" girmektedir.'})]}),n.jsxs("section",{children:[n.jsx("h2",{className:"text-2xl font-bold text-[#1A1D1F] mb-4",children:"5. Rotasyon Etkisi: %75'ten %50'ye Yolculuk"}),n.jsx("p",{children:"Ayn rnei, paray 90 derece dndrerek tekrar hesaplayalm (Eer dalga yn kst yoksa):"}),n.jsxs("div",{className:"bg-[#1A1D1F] text-white p-6 rounded-xl font-mono text-sm mt-4",children:["En boyunca: floor( 780 / 600 ) = 1 adet",n.jsx("br",{}),"Boy boyunca: floor( 1180 / 400 ) = 2 adet",n.jsx("br",{}),"Toplam Kapasite: 1 x 2 = ",n.jsx("strong",{children:"2 Adet/Safiha"}),n.jsx("br",{}),"Yeni Fire: 1 - (480k / 960k) = ",n.jsx("strong",{children:"%50 FIRE"})]}),n.jsx("p",{className:"mt-4",children:"Sadece bir rotasyon hamlesi ile fire miktar %25 azaltld. Ancak hala %50 ok yksek bir oran. Bu durum, seilen safiha lsnn (800x1200) bu para (400x600) iin tamamen yanl olduunu kantlar. Doru safiha seimi iin 900x1300 veya 850x1250 gibi kombinasyonlar simle edilmelidir."})]}),n.jsxs("section",{children:[n.jsx("h2",{className:"text-2xl font-bold text-[#1A1D1F] mb-4",children:"6. %5 Alt Fire Mmkn m? Teknik Snrlar"}),n.jsx("p",{children:'Endstriyel retimde %5 fire oran "Gold Standard" olarak kabul edilir. Buna ulamak iin sadece yerleim deil, tm tedarik zinciri senkronize olmaldr. %5 alt fire iin gereken 3 temel stun:'}),n.jsxs("ul",{className:"space-y-4 mt-6",children:[n.jsxs("li",{className:"flex items-start gap-4",children:[n.jsx("span",{className:"text-[#800020] font-black text-xl",children:"1."}),n.jsx("p",{className:"text-sm font-bold",children:"Combo Layout (Karma Yerleim): Farkl siparilerin ayn safiha zerinde puzzle gibi birletirilmesi."})]}),n.jsxs("li",{className:"flex items-start gap-4",children:[n.jsx("span",{className:"text-[#800020] font-black text-xl",children:"2."}),n.jsx("p",{className:"text-sm font-bold",children:"Hassas Trim Ynetimi: Kenar tutma paylarnn 10mm'den makine snrna (rnein 6mm) ekilmesi."})]}),n.jsxs("li",{className:"flex items-start gap-4",children:[n.jsx("span",{className:"text-[#800020] font-black text-xl",children:"3."}),n.jsx("p",{className:"text-sm font-bold",children:"Dinamik Safiha llendirme: Standart plakalar yerine her siparie zel optimize edilmi bobin eni siparii."})]})]})]}),n.jsxs("section",{className:"border-2 border-[#E2E8F0] p-8 rounded-2xl bg-white shadow-sm",children:[n.jsx("h2",{className:"text-2xl font-bold text-[#1A1D1F] mb-6",children:"7. retimde En Byk 5 Fire Hatas"}),n.jsxs("div",{className:"space-y-6 text-sm",children:[n.jsxs("div",{className:"flex gap-4",children:[n.jsx("div",{className:"w-8 h-8 rounded bg-[#800020] text-white flex items-center justify-center shrink-0 font-bold",children:"1"}),n.jsxs("p",{children:[n.jsx("strong",{children:'Sadece "Kat Arl" Takibi:'})," Fireyi tonaj zerinden takip etmek yanltcdr. m bazl alan analizi gerek krll gsterir."]})]}),n.jsxs("div",{className:"flex gap-4",children:[n.jsx("div",{className:"w-8 h-8 rounded bg-[#800020] text-white flex items-center justify-center shrink-0 font-bold",children:"2"}),n.jsxs("p",{children:[n.jsx("strong",{children:"Dalga Yn hmali:"})," Paray dndrerek fireyi drrken mukavemeti (ECT) ldrmek. Bu koli patlamalarna ve iadelere yol aar."]})]}),n.jsxs("div",{className:"flex gap-4",children:[n.jsx("div",{className:"w-8 h-8 rounded bg-[#800020] text-white flex items-center justify-center shrink-0 font-bold",children:"3"}),n.jsxs("p",{children:[n.jsx("strong",{children:"Ayar (Set-up) Fireleri:"})," Makine ayar iin 50 adet safihay skartaya ayrmak. Dijital kontrol sistemleri bunu 5 adede indirmelidir."]})]}),n.jsxs("div",{className:"flex gap-4",children:[n.jsx("div",{className:"w-8 h-8 rounded bg-[#800020] text-white flex items-center justify-center shrink-0 font-bold",children:"4"}),n.jsxs("p",{children:[n.jsx("strong",{children:"Yanl Bobin Eni Seimi:"})," Ondle hattnda kenar tra (trim) olarak bobinin %10'unu jilete atmak."]})]}),n.jsxs("div",{className:"flex gap-4",children:[n.jsx("div",{className:"w-8 h-8 rounded bg-[#800020] text-white flex items-center justify-center shrink-0 font-bold",children:"5"}),n.jsxs("p",{children:[n.jsx("strong",{children:"Operasyonel Pay Korkusu:"}),' "Garanti olsun" diyerek ihtiyatan fazla pay brakmak. Her fazla milimetre krnzdan alnan bir paradr.']})]})]})]}),n.jsxs("section",{children:[n.jsx("h2",{className:"text-2xl font-bold text-[#1A1D1F] mb-4",children:"8. Sonu: Verimlilik Bir Tercih Deildir"}),n.jsx("p",{children:"Ham madde fiyatlarnn global lekte dalgaland bir ekonomide, retim tesisleri iin fire ynetimi bir lks deil, hayatta kalma stratejisidir. Manuel hesaplamalarla %10'un altna inmeye almak, karanlkta hedef vurmaya benzer. Gerek baar, binlerce olasl (safiha ls, rotasyon, karma yerleim) saniyeler iinde simle edebilen veri odakl altyaplarla mmkndr."}),n.jsx("p",{className:"mt-4 font-bold text-[#800020]",children:"Ulgen One, bu karmak hesaplamalar retim mhendislerinizin zihninden kodlarn iine tayarak operasyonel mkemmellii otomatie balar."})]})]})},"koli-acilim-formulu":{title:"0201 Koli Alm Forml Nedir? (En, Boy, Ykseklik Hesab + rnek Tablo)",date:"23 ubat 2026",category:"Teknik Rehber",readTime:"15 dk",excerpt:"FEFCO 0201 standart koli alm hesaplama yntemleri, rill pay etkileri ve milimetrik fire optimizasyonu rehberi.",content:n.jsxs("div",{className:"space-y-8 text-justify",children:[n.jsxs("section",{children:[n.jsx("h2",{className:"text-3xl font-bold text-[#1A1D1F] mb-6",children:"1. Giri: retim Hattnda Milimetrenin Ekonomik Deeri"}),n.jsx("p",{children:"Oluklu mukavva ambalaj sektrnde, retimin temel tan oluturan 0201 koli tipi (standart koli), dnya apnda en yaygn kullanlan tama ve depolama zmdr. Ancak, bu yaygnlk beraberinde ciddi bir optimizasyon sorumluluu getirir. Bir retim tesisinde gnde on binlerce adet baslan bir koli formunda, alm hesabnda yaplan sadece 2 milimetrelik bir hata, ay sonunda tonlarca kat firesine ve binlerce liralk ham madde kaybna yol aar."}),n.jsx("p",{className:"mt-4",children:"0201 koli alm forml, sadece matematiksel bir toplam deil, ayn zamanda malzemenin (lineer ve fluting katmanlarnn) fiziksel davrann, krm noktalarndaki gerilmeleri ve yaptrma kulaklarnn mukavemetini ieren teknik bir denklemdir. Bu makalede, bir mhendisin gznden standart bir kolinin nasl hatasz hesaplanacan ve bu hesabn krllk zerindeki dorudan etkisini inceleyeceiz."})]}),n.jsxs("section",{children:[n.jsx("h2",{className:"text-2xl font-bold text-[#1A1D1F] mb-4",children:"2. FEFCO 0201 Nedir? Teknik Tanm ve Standart Yap"}),n.jsx("p",{children:'FEFCO (Avrupa Oluklu Mukavva reticileri Federasyonu) kodlama sisteminde 0201, "Slotted-Type Boxes" (Yarkl Tip Kutular) kategorisinde yer alr. Tek bir mukavva plakasndan oluur, alt ve st kapaklar birleim yerinde yan yana gelir ancak st ste binmez (standart versiyonda). Yan dikii (kulak/flap) tel diki, tutkal veya bant ile birletirilir.'}),n.jsx("p",{className:"mt-4",children:"0201 yapsn dierlerinden ayran en byk zellik, ham madde kullanmndaki verimliliidir. retim srecinde slotter makinelerinde kesilen kapaklar, genellikle plakann ana gvdesinden fire vermeden (veya minimum fireyle) karlr. Ancak bu verimlilik, almn milimetrik olarak doru hesaplanmasna baldr."})]}),n.jsxs("section",{children:[n.jsx("h2",{className:"text-2xl font-bold text-[#1A1D1F] mb-4",children:"3. 0201 Alm Forml: Net Matematik ve Deikenler"}),n.jsx("p",{children:"Koli lleri her zaman  l (L x W x H) olarak ifade edilir. Ancak retimde kullanlan plaka ls, bu i llere mukavva kalnl ve krm paylarnn eklenmesiyle elde edilen D ldr."}),n.jsxs("div",{className:"bg-[#F8FAFC] p-8 rounded-xl border border-[#E2E8F0] font-mono list-none space-y-4",children:[n.jsxs("div",{className:"flex flex-col border-b border-[#D1D5DB] pb-4",children:[n.jsx("span",{className:"text-[#800020] font-black uppercase text-xs mb-1",children:"Alm En (Plaka Boyu) Hesab:"}),n.jsx("span",{className:"text-xl",children:"En(A) = [ 2  (Boy + En) ] + Yaptrma Flap Pay + (8  Rill Pay)"})]}),n.jsxs("div",{className:"flex flex-col",children:[n.jsx("span",{className:"text-[#800020] font-black uppercase text-xs mb-1",children:"Alm Boy (Plaka Eni) Hesab:"}),n.jsx("span",{className:"text-xl",children:"Boy(A) = Ykseklik + (2  Kapak Pay) + (4  Rill Pay)"})]})]}),n.jsx("p",{className:"mt-6 italic",children:"Not: Kapak pay, standart bir 0201 kolide genellikle En lsnn yarsdr (En / 2). nk drt kapak karlkl kapandnda ortada tam kavumas hedeflenir."})]}),n.jsxs("section",{children:[n.jsx("h2",{className:"text-2xl font-bold text-[#1A1D1F] mb-4",children:"4. Flap Nedir? Bindirme ve Yaptrma Pay Belirleme Kriterleri"}),n.jsx("p",{children:"Yaptrma kula (flap), kolisinin gvdesini kapal bir tp haline getirmek iin kullanlan uzantdr. Standart endstriyel uygulamalarda bu pay genellikle 30mm ile 40mm arasnda deiir. Ancak bu deer sabit deildir:"}),n.jsxs("ul",{className:"list-disc ml-6 space-y-2 mt-4 text-[#6B7280]",children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Tutkal ile Yaptrma:"})," Genellikle 30-35mm yeterlidir. Tutkaln yzeye yaylma alan mukavemet iin kritiktir."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Tel Diki (Stitch):"})," Tel zmbalarn mukavemeti iin kulan daha geni tutulmas (35-45mm) nerilir."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Koli Boyutu:"})," ok byk ve ar yk tayacak kolilerde, devrilme ve patlama riskine kar kulak pay artrlr."]})]})]}),n.jsxs("section",{children:[n.jsx("h2",{className:"text-2xl font-bold text-[#1A1D1F] mb-4",children:"5. Rill (Krm) Paynn Alma Fiziksel Etkisi"}),n.jsx("p",{children:"Mhendislik asndan koli almndaki en kritik hata rill paylarnn ihmal edilmesidir. Mukavva katlandnda, kadn kalnlndan dolay d yzey gerilir, i yzey skr. Bu durum, kolinin kurulan lsnn teorik hesaptan sapmasna neden olur."}),n.jsx("p",{className:"mt-4",children:"3mm kalnlndaki bir B dalga (nce) mukavva ile 7mm kalnlndaki bir BC dalga (Dopel) mukavvann rill pay ayn olamaz. Eer rill pay eksik verilirse koli kaba durur, tam kapanmaz; fazla verilirse koli gevek kalr ve istifleme dayanm (BCT) der. Ulgen One gibi sistemlerde bu paylar, mukavva kalitesine (B, C, E, BC, EB) gre dinamik olarak kalibre edilir."})]}),n.jsxs("section",{className:"bg-[#1A1D1F] text-white p-10 rounded-2xl",children:[n.jsxs("h2",{className:"text-2xl font-bold mb-8 flex items-center gap-3",children:[n.jsx("span",{className:"w-8 h-8 bg-[#800020] rounded-full flex items-center justify-center text-sm",children:"6"}),"Gerek Saysal rnek ve Adm Adm Hesaplama"]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-12",children:[n.jsxs("div",{className:"space-y-4",children:[n.jsx("h4",{className:"text-[#800020] font-black uppercase text-xs",children:"Girdi Parametreleri"}),n.jsxs("ul",{className:"space-y-2 font-mono text-sm opacity-80",children:[n.jsx("li",{children:"En: 300 mm"}),n.jsx("li",{children:"Boy: 200 mm"}),n.jsx("li",{children:"Ykseklik: 150 mm"}),n.jsx("li",{children:"Flap: 30 mm"}),n.jsx("li",{children:"Rill Pay: 4 mm (BC Dalga Standart)"})]})]}),n.jsxs("div",{className:"space-y-6",children:[n.jsx("h4",{className:"text-[#800020] font-black uppercase text-xs",children:"Hesaplama Sreci"}),n.jsxs("div",{className:"space-y-4 text-sm leading-relaxed",children:[n.jsxs("div",{children:[n.jsx("div",{className:"font-bold border-b border-white/10 pb-1 mb-1 italic",children:"Adm 1: Plaka Eni (Yatay l)"}),n.jsxs("p",{children:["[2  (300 + 200)] + 30 + (8  4) = 1.000 + 30 + 32 = ",n.jsx("strong",{children:"1.062 mm"})]})]}),n.jsxs("div",{children:[n.jsx("div",{className:"font-bold border-b border-white/10 pb-1 mb-1 italic",children:"Adm 2: Plaka Boyu (Dikey l)"}),n.jsxs("p",{children:["150 + (2  [200/2]) + (4  4) = 150 + 200 + 16 = ",n.jsx("strong",{children:"366 mm"})]})]}),n.jsxs("div",{className:"p-4 bg-white/5 border border-white/10 rounded",children:[n.jsx("span",{className:"block text-xs font-bold text-[#800020]",children:"SONU:"}),n.jsx("span",{className:"text-lg font-mono",children:"NET PLAKA LS: 1062 x 366 mm"})]})]})]})]})]}),n.jsxs("section",{children:[n.jsx("h2",{className:"text-2xl font-bold text-[#1A1D1F] mb-4",children:"7. Sk Yaplan Hatalar: Analiz ve nleme"}),n.jsxs("ul",{className:"space-y-6",children:[n.jsxs("li",{className:"flex gap-4",children:[n.jsx("div",{className:"w-6 h-6 rounded-full bg-[#EF4444] shrink-0 mt-1"}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-bold text-[#1A1D1F]",children:"Kapak Kavuma Hatas"}),n.jsx("p",{className:"text-sm text-[#6B7280]",children:"En lsnn yarsndan daha az kapak pay vermek, kolinin ortasnda boluk kalmasna neden olur. Bu durum toz girmesine ve ambalajn mukavemetinin %15 orannda azalmasna neden olur."})]})]}),n.jsxs("li",{className:"flex gap-4",children:[n.jsx("div",{className:"w-6 h-6 rounded-full bg-[#EF4444] shrink-0 mt-1"}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-bold text-[#1A1D1F]",children:"Rill Payn Sabit Varsaymak"}),n.jsx("p",{className:"text-sm text-[#6B7280]",children:'Mikro dalga (E) ile Dopel (BC) koli iin ayn rill payn kullanmak, kolinin montajnda "arplma" yapar. Koli gnyesinde olmaz, bu da otomatik paketleme hatlarnda tkanmalara yol aar.'})]})]})]})]}),n.jsxs("section",{children:[n.jsx("h2",{className:"text-2xl font-bold text-[#1A1D1F] mb-4",children:"8. Fire (Waste) ile likisi ve Krllk"}),n.jsx("p",{children:"Oluklu mukavva retiminde fire, sadece bir kat kayb deil, ayn zamanda iilik ve enerji kaybdr. 0201 alm formlndeki milimetrik hassasiyet, plakann fireli veya firesiz baslmasn belirler. rnein, bir bobin eni 2200mm ise ve sizin koli almnz 366mm ise, yan yana 6 koli yerletirebilirsiniz. Eer rill payn yanl hesaplayp 368mm yaparsanz, 6. koli bobine smaz ve fire orannz bir anda %16 artar."})]}),n.jsxs("section",{className:"border-t border-[#E2E8F0] pt-12",children:[n.jsx("h2",{className:"text-2xl font-bold text-[#1A1D1F] mb-6",children:"9. Sonu: Manuel Hesap vs. Otomatik Sistemler"}),n.jsx("p",{children:"Geleneksel yntemlerle Excel veya hesap makinesi kullanarak yaplan alm hesaplamalar, insan hatasna son derece aktr. zellikle yzlerce farkl kalem ieren bir ihale srecinde bu hatalar telafi edilemez zararlara yol aabilir."}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-8 mt-8",children:[n.jsxs("div",{className:"p-6 border border-[#E2E8F0] rounded-xl",children:[n.jsx("h5",{className:"font-bold mb-2",children:"Manuel Hesaplama"}),n.jsx("p",{className:"text-xs text-[#6B7280] leading-relaxed",children:"Yava sre, yksek hata pay, deiken rill paylarn takip etme zorluu, fire optimizasyonu ile balantsz yap."})]}),n.jsxs("div",{className:"p-6 bg-[#800020] text-white rounded-xl",children:[n.jsx("h5",{className:"font-bold mb-2",children:"Ulgen One Otomasyonu"}),n.jsx("p",{className:"text-xs opacity-80 leading-relaxed",children:"Saniyeler iinde hatasz alm, kaliteye gre dinamik rill pay, bobin enine gre otomatik yerleim ve milimetrik fire takibi."})]})]}),n.jsx("p",{className:"mt-8",children:'Modern retim tesisleri iin artk soru "nasl hesaplarz?" deil, "bu hesab retim bandyla nasl entegre ederiz?" olmaldr. Ulgen One, bu teknik karmaay ortadan kaldrarak odak noktanz retimden krlla kaydrr.'})]})]})}};function ZW(){const{slug:e}=Ch(),t=e?qW[e]:null;return t?n.jsxs("article",{className:"pt-24 lg:pt-32 pb-24",children:[n.jsxs(yn,{children:[n.jsxs("title",{children:[t.title," | Ulgen One Blog"]}),n.jsx("meta",{name:"description",content:t.excerpt})]}),n.jsx("div",{className:"max-w-[800px] mx-auto px-6",children:n.jsxs(at,{children:[n.jsxs(At,{to:"/blog",className:"flex items-center gap-2 text-sm font-bold text-[#6B7280] hover:text-[#800020] mb-12 transition-colors",children:[n.jsx(GE,{size:16})," Bloga Geri Dn"]}),n.jsxs("header",{className:"space-y-6 mb-12 border-b border-[#E2E8F0] pb-12",children:[n.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-xs font-bold uppercase tracking-widest text-[#800020]",children:[n.jsxs("span",{className:"flex items-center gap-1 bg-[#800020]/5 px-2 py-1 rounded",children:[n.jsx(K1,{size:12})," ",t.category]}),n.jsxs("span",{className:"flex items-center gap-1 text-[#94A3B8]",children:[n.jsx(Xd,{size:14})," ",t.date]}),n.jsxs("span",{className:"flex items-center gap-1 text-[#94A3B8]",children:[n.jsx(kh,{size:14})," ",t.readTime," okuma"]})]}),n.jsx("h1",{className:"text-4xl lg:text-6xl font-black tracking-tight text-[#1A1D1F] leading-tight",children:t.title})]}),n.jsx("div",{className:"prose prose-slate prose-lg max-w-none prose-headings:text-[#1A1D1F] prose-a:text-[#800020]",children:t.content}),n.jsx("footer",{className:"mt-20 pt-12 border-t border-[#E2E8F0]",children:n.jsxs("div",{className:"bg-[#F8FAFC] rounded-2xl p-8 flex flex-col md:flex-row items-center justify-between gap-8",children:[n.jsxs("div",{className:"space-y-2 text-center md:text-left",children:[n.jsx("h4",{className:"font-bold text-[#1A1D1F]",children:"Bu konu ilginizi mi ekti?"}),n.jsx("p",{className:"text-sm text-[#6B7280]",children:"Ulgen One ile kendi retim verilerinizi analiz etmeye balayn."})]}),n.jsx(At,{to:"/register",className:"px-8 py-3 bg-[#800020] text-white font-bold rounded-lg hover:bg-[#660019] transition-all whitespace-nowrap",children:"cretsiz Dene"})]})})]})})]}):n.jsxs("div",{className:"pt-32 pb-24 text-center",children:[n.jsx("h2",{className:"text-2xl font-bold",children:"Yaz bulunamad."}),n.jsx(At,{to:"/blog",className:"text-[#800020] mt-4 inline-block font-bold",children:"Bloga geri dn"})]})}function JW(){return n.jsxs("div",{className:"pt-24 lg:pt-32 pb-24 selection:bg-[#800020]/10",children:[n.jsxs(yn,{children:[n.jsx("title",{children:"Hakkmzda | Ulgen One Endstriyel Misyon"}),n.jsx("meta",{name:"description",content:"Ulgen One'n endstriyel odakl, matematiksel drstlk ve deterministik felsefeye dayanan kurulu hikayesi ve vizyonu."})]}),n.jsx("section",{className:"px-6 mb-24 border-b border-[#E2E8F0] pb-24 bg-[#FAFBFC]",children:n.jsx("div",{className:"max-w-[1440px] mx-auto text-left space-y-10",children:n.jsxs(at,{children:[n.jsx(ut,{className:"bg-[#1A1D1F] text-white border-0 py-1.5 px-4 text-[10px] font-black uppercase tracking-[0.2em] mb-4",children:"Kurulu Hikayesi"}),n.jsxs("h1",{className:"text-5xl lg:text-8xl font-black tracking-tighter text-[#1A1D1F] mb-8 uppercase leading-[0.9]",children:["SEZGY ",n.jsx("br",{})," ",n.jsx("span",{className:"text-[#800020]",children:"SSTEMLETRMEK"})]}),n.jsx("p",{className:"text-xl text-[#6B7280] max-w-4xl leading-relaxed font-medium",children:'Endstriyel retim dinamiklerini gzlemlerken unu net bir ekilde fark ettim: Bir sektrdeki en byk g, herkesin bildii ama kimsenin sistemletirmedii bilgidir. Ulgen One, ambalaj sektrndeki bu "rtk bilgiyi" llebilir bir karar modeline dntrmek iin dodu.'})]})})}),n.jsx("section",{className:"px-6 py-12",children:n.jsxs("div",{className:"max-w-[1440px] mx-auto space-y-32",children:[n.jsxs("div",{className:"grid lg:grid-cols-2 gap-24 items-center",children:[n.jsxs(at,{className:"space-y-10",children:[n.jsxs("div",{className:"flex items-center gap-3 text-[#800020] font-black text-xs uppercase tracking-[0.3em]",children:[n.jsx(YE,{size:20})," NEDEN ULGEN ONE?"]}),n.jsxs("h2",{className:"text-3xl lg:text-5xl font-black tracking-tighter text-[#1A1D1F] uppercase italic leading-none font-sans",children:["KAOSTAN ",n.jsx("br",{})," NTEGRASYONA"]}),n.jsxs("p",{className:"text-[#6B7280] text-lg leading-relaxed font-medium",children:["Ambalaj ve koli sektrnde geirdiim zaman, fiyat hesaplama ve maliyet karma srelerinin sistematik deil, ",n.jsx("strong",{children:"kiiye bal olduunu"})," gsterdi. Sorun teknik deildi; ",n.jsx("em",{children:"sorun sistemsizlikti."})]}),n.jsx("div",{className:"space-y-6",children:[{t:"Yazl Olmayan Bilgi",d:"Ustann kafasndaki kombinasyon bilgisi yazl deildi. Safiha seimi ezbere dayanyordu."},{t:"Tahmini Hesaplar",d:"Marj hesaplar ou zaman tahmini yaplyor, Excel dosyalar kontrol deil kaos retiyordu."}].map((e,t)=>n.jsx("div",{className:"flex gap-6 border-l-4 border-[#1A1D1F]/10 pl-8 transition-all hover:border-[#800020]",children:n.jsxs("div",{className:"space-y-2",children:[n.jsx("h4",{className:"text-sm font-black text-[#1A1D1F] uppercase tracking-tighter",children:e.t}),n.jsx("p",{className:"text-xs text-[#6B7280] font-medium leading-relaxed",children:e.d})]})},t))})]}),n.jsx(at,{delay:200,className:"relative",children:n.jsxs("div",{className:"aspect-square bg-[#1A1D1F] border-2 border-[#1A1D1F] rounded-3xl shadow-2xl overflow-hidden p-12 lg:p-16 flex flex-col justify-center relative",children:[n.jsx("div",{className:"absolute inset-0 opacity-5 pointer-events-none",children:n.jsx("div",{className:"w-full h-full",style:{backgroundImage:"radial-gradient(#ffffff 1px, transparent 1px)",backgroundSize:"30px 30px"}})}),n.jsxs("div",{className:"space-y-8 relative z-10 text-white",children:[n.jsxs("div",{className:"flex items-center gap-3 text-[#10B981] font-black text-xs uppercase tracking-[0.3em] mb-6 border-b border-white/10 pb-4",children:[n.jsx(qd,{size:20})," ZM BEYANI"]}),n.jsx("h3",{className:"text-2xl lg:text-4xl font-black tracking-tighter text-white uppercase leading-tight font-sans",children:"BR HESAP MAKNESNDEN FAZLASI"}),n.jsxs("ul",{className:"space-y-4 text-sm font-medium text-white/80",children:[n.jsxs("li",{className:"flex gap-3 items-start",children:[n.jsx(Jr,{size:18,className:"text-[#10B981] shrink-0 mt-0.5"})," ",n.jsxs("span",{children:["Safiha bazl maliyet hesaplamasn ",n.jsx("strong",{children:"standartlatrr"}),"."]})]}),n.jsxs("li",{className:"flex gap-3 items-start",children:[n.jsx(Jr,{size:18,className:"text-[#10B981] shrink-0 mt-0.5"})," ",n.jsxs("span",{children:["Kar marjn ",n.jsx("strong",{children:"grnr klar"}),"."]})]}),n.jsxs("li",{className:"flex gap-3 items-start",children:[n.jsx(Jr,{size:18,className:"text-[#10B981] shrink-0 mt-0.5"})," ",n.jsxs("span",{children:["Teklif oluturma sresini ",n.jsx("strong",{children:"dramatik ekilde azaltr"}),"."]})]}),n.jsxs("li",{className:"flex gap-3 items-start",children:[n.jsx(Jr,{size:18,className:"text-[#10B981] shrink-0 mt-0.5"})," ",n.jsxs("span",{children:["Sezgisel deil, ",n.jsx("strong",{children:"matematiksel karar"})," retir."]})]})]})]})]})})]}),n.jsxs("div",{className:"space-y-16",children:[n.jsxs(at,{className:"text-left space-y-6",children:[n.jsxs("div",{className:"flex items-center gap-3 text-[#800020] font-black text-xs uppercase tracking-[0.3em]",children:[n.jsx(wh,{size:20})," VZYON"]}),n.jsx("h2",{className:"text-3xl lg:text-5xl font-black tracking-tighter text-[#1A1D1F] uppercase",children:"lemediin eyi Bytemezsin"}),n.jsxs("p",{className:"text-[#6B7280] text-lg font-medium leading-relaxed max-w-3xl",children:["Benim temel inancm basit: Ambalaj sektrnde marj ou zaman llmez, hissedilir. Kombinasyon riski hesaplanmaz, tahmin edilir. Ulgen One olarak ",n.jsx("strong",{children:"sezgiye kar deiliz, sezgiyi sistemletiriyoruz."})]})]}),n.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[n.jsx($f,{icon:n.jsx(XE,{size:32}),title:"ATLYELER",desc:"Atlye leinde retim yapan, leklenmek isteyen ancak kiiye bamllk yznden tkanan firmalar."}),n.jsx($f,{icon:n.jsx(ud,{size:32}),title:"SATI EKPLER",desc:"reticiye baml kalmadan hzl ve hatasz teklif retmek zorunda olan dinamik sat departmanlar."}),n.jsx($f,{icon:n.jsx(j1,{size:32}),title:"BYYEN LETMELER",desc:"Maliyet hatas yznden kr kaybeden ve iletmesini leklenebilir bir sisteme kavuturmak isteyenler."})]})]}),n.jsxs("div",{className:"bg-[#1A1D1F] text-white p-12 lg:p-24 rounded-3xl space-y-12 relative overflow-hidden shadow-2xl",children:[n.jsx("div",{className:"absolute top-0 right-0 w-64 h-full bg-[#800020]/10 clip-path-slant pointer-events-none"}),n.jsxs(at,{className:"space-y-8 relative z-10 flex flex-col items-center text-center",children:[n.jsxs("div",{className:"flex items-center gap-4 text-[#800020] font-black text-xs uppercase tracking-[0.3em]",children:[n.jsx(qE,{size:24})," BUGN GELDMZ NOKTA"]}),n.jsx("h3",{className:"text-3xl lg:text-5xl font-black tracking-tighter text-white uppercase leading-none max-w-2xl",children:"retim Karar Altyaps"}),n.jsx("p",{className:"text-white/80 text-xl font-medium leading-relaxed max-w-3xl",children:"Ulgen One u an sadece bir ara deil; sipari senaryolaryla test edilmi, sektr iinden kullanclarla valide edilmi bir retim karar altyapsdr."}),n.jsxs("div",{className:"w-full pt-12 flex flex-col md:flex-row gap-8 md:gap-4 justify-between text-left border-t border-white/10 mt-8",children:[n.jsx(Kf,{year:"2024",title:"ekirdek Motor",desc:"ekirdek maliyet motoru gelitirildi ve gerek sipari senaryolar zerinden test edildi."}),n.jsx(Kf,{year:"Validasyon",title:"Sektrel Onay",desc:"Sektr iinden kullanclarla validasyon sreci yrtld. Platform organik ekilde byd."}),n.jsx(Kf,{year:"Gelecek",title:"SaaS Dnm",desc:"Aktif kullanc taban ile cretsiz modelden leklenebilir bir SaaS yapsna gei planland."})]})]})]})]})}),n.jsx("section",{className:"px-6 py-24",children:n.jsx("div",{className:"max-w-[1440px] mx-auto text-center space-y-10",children:n.jsxs(at,{className:"space-y-8",children:[n.jsxs("h2",{className:"text-3xl lg:text-5xl font-black text-[#1A1D1F] tracking-tighter uppercase leading-none italic",children:["Sistemin ",n.jsx("br",{})," Bir Paras Olun"]}),n.jsxs("div",{className:"flex gap-6 justify-center",children:[n.jsxs(At,{to:"/register",className:"px-12 py-6 bg-[#1A1D1F] text-white font-black rounded-sm hover:bg-black transition-all shadow-xl uppercase text-xs tracking-widest flex items-center justify-center gap-3",children:["ye Ol ",n.jsx(Ta,{size:18})]}),n.jsx(At,{to:"/iletisim",className:"px-12 py-6 border-2 border-[#1A1D1F] text-[#1A1D1F] font-black rounded-sm hover:bg-[#1A1D1F]/5 transition-all uppercase text-xs tracking-widest",children:"Bize Ulan"})]})]})})})]})}function $f({icon:e,title:t,desc:r}){return n.jsxs("div",{className:"p-12 bg-white border border-[#E2E8F0] rounded-sm shadow-sm transition-all hover:border-[#1A1D1F] group relative overflow-hidden flex flex-col items-center text-center",children:[n.jsx("div",{className:"text-[#800020] mb-8 group-hover:scale-110 transition-transform",children:e}),n.jsx("h3",{className:"text-xl font-black text-[#1A1D1F] mb-4 uppercase tracking-tighter",children:t}),n.jsx("p",{className:"text-sm text-[#6B7280] leading-relaxed font-medium",children:r})]})}function Kf({year:e,title:t,desc:r}){return n.jsxs("div",{className:"flex-1 space-y-4 relative",children:[n.jsx("div",{className:"text-[#800020] font-black text-2xl font-sans tracking-tighter",children:e}),n.jsx("div",{className:"h-1 w-12 bg-white/20 rounded"}),n.jsx("h4",{className:"text-white font-bold text-lg",children:t}),n.jsx("p",{className:"text-white/60 text-sm leading-relaxed",children:r})]})}function QW(){return n.jsxs("div",{className:"pt-24 lg:pt-32 pb-24 selection:bg-[#800020]/10",children:[n.jsxs(yn,{children:[n.jsx("title",{children:"letiim | Ulgen One Teknik Destek Hatt"}),n.jsx("meta",{name:"description",content:"Ulgen One teknik destek, demo talepleri ve kurumsal i birlikleri iin iletiim protokol."})]}),n.jsx("section",{className:"px-6 mb-24 border-b border-[#E2E8F0] pb-24 bg-[#FAFBFC]",children:n.jsx("div",{className:"max-w-[1440px] mx-auto text-left space-y-10",children:n.jsxs(at,{children:[n.jsx(ut,{className:"bg-[#1A1D1F] text-white border-0 py-1.5 px-4 text-[10px] font-black uppercase tracking-[0.2em] mb-4",children:"Communication Protocol v1.0"}),n.jsxs("h1",{className:"text-5xl lg:text-8xl font-black tracking-tighter text-[#1A1D1F] mb-8 uppercase leading-[0.9]",children:["TEKNK ",n.jsx("br",{})," ",n.jsx("span",{className:"text-[#800020]",children:"LETM"})]}),n.jsx("p",{className:"text-xl text-[#6B7280] max-w-3xl leading-relaxed font-medium",children:"Sistem entegrasyonu, kurumsal demo talepleri veya teknik destek iin resmi kanallarmz zerinden bizimle iletiime geebilirsiniz."})]})})}),n.jsx("section",{className:"px-6 py-12",children:n.jsxs("div",{className:"max-w-[1440px] mx-auto grid lg:grid-cols-2 gap-24 items-start",children:[n.jsxs(at,{className:"space-y-12",children:[n.jsxs("div",{className:"space-y-10",children:[n.jsxs("div",{className:"flex items-center gap-3 text-[#10B981] font-black text-xs uppercase tracking-[0.3em]",children:[n.jsx(vh,{size:20})," DESTEK DURUMU: AKTF"]}),n.jsxs("h2",{className:"text-3xl lg:text-5xl font-black tracking-tighter text-[#1A1D1F] uppercase italic leading-none font-sans",children:["RESM ",n.jsx("br",{})," KANALLAR"]})]}),n.jsxs("div",{className:"grid sm:grid-cols-2 lg:grid-cols-1 gap-8",children:[n.jsx(Wf,{icon:n.jsx(W1,{size:24}),title:"TEKNK E-POSTA",value:"destek@ulgen.one",desc:"Proje bazl teknik sorularnz iin 24 saat iinde yant protokol."}),n.jsx(Wf,{icon:n.jsx(V1,{size:24}),title:"KURUMSAL HAT",value:"+90 (212) 555 01 23",desc:"Pazartesi - Cuma, 09:00 - 18:00 (GMT+3)"}),n.jsx(Wf,{icon:n.jsx(Qf,{size:24}),title:"OPERASYON MERKEZ",value:"Maslak, stanbul - Trkiye",desc:"Teknik gelitirme ve Ar-Ge laboratuvar."}),n.jsxs("div",{className:"p-8 border-2 border-dashed border-[#E2E8F0] rounded space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-[#94A3B8] font-black text-[10px] uppercase tracking-widest",children:[n.jsx(kh,{size:16})," Yant Sresi SLA"]}),n.jsx("p",{className:"text-xs text-[#6B7280] leading-relaxed font-bold",children:"Kritik sistem hatalar iin < 2 saat, genel talepler iin < 24 saat yant garantisi veriyoruz."})]})]})]}),n.jsxs(at,{delay:200,className:"bg-white border-2 border-[#1A1D1F] p-8 lg:p-12 rounded shadow-2xl relative",children:[n.jsx("div",{className:"absolute -top-4 left-8 bg-[#800020] text-white px-4 py-2 text-[10px] font-black uppercase tracking-widest shadow-lg",children:"DEMO TALEP FORMU"}),n.jsxs("form",{className:"space-y-8",onSubmit:e=>e.preventDefault(),children:[n.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[n.jsx(Gf,{label:"AD SOYAD",placeholder:"Mhendis / Ynetici"}),n.jsx(Gf,{label:"KURUMSAL E-POSTA",placeholder:"isim@sirket.com"})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[n.jsx(Gf,{label:"RKET NVANI",placeholder:"Oluklu Mukavva A.."}),n.jsx(eG,{label:"TALEP TR",options:["Kurumsal Demo","Teknik Entegrasyon","Fiyatlama Bilgisi","Dier"]})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsx("label",{className:"text-[10px] font-black text-[#1A1D1F] tracking-widest uppercase",children:"MESAJINIZ / PROJE DETAYLARI"}),n.jsx("textarea",{className:"w-full bg-[#F8FAFC] border border-[#E2E8F0] p-5 rounded font-medium text-sm focus:outline-none focus:ring-2 focus:ring-[#800020] transition-all min-h-[150px] placeholder:text-[#94A3B8]",placeholder:"retim kapasiteniz ve ihtiyacnz olan modller hakknda ksa bilgi veriniz..."})]}),n.jsxs("div",{className:"flex items-start gap-4 p-4 bg-[#F8FAFC] rounded border border-[#E2E8F0]",children:[n.jsx("input",{type:"checkbox",className:"mt-1 accent-[#800020]",id:"terms"}),n.jsxs("label",{htmlFor:"terms",className:"text-[10px] text-[#6B7280] leading-relaxed font-bold",children:[n.jsx(ut,{variant:"outline",className:"mr-2 text-[8px] py-0 h-4 border-[#800020]/20 text-[#800020]",children:"KVKK"}),"Verilerimin iletiim protokol kapsamnda ilenmesini ve teknik dkmanlarn iletilmesini kabul ediyorum."]})]}),n.jsxs("button",{className:"w-full py-6 bg-[#1A1D1F] text-white font-black rounded-sm hover:bg-black transition-all shadow-xl uppercase text-xs tracking-[0.2em] flex items-center justify-center gap-3 active:scale-[0.99]",children:["TALEB GNDER ",n.jsx(dd,{size:18})]})]})]})]})})]})}function Wf({icon:e,title:t,value:r,desc:a}){return n.jsxs("div",{className:"flex gap-8 group",children:[n.jsx("div",{className:"w-14 h-14 shrink-0 rounded bg-[#F8FAFC] border border-[#E2E8F0] flex items-center justify-center text-[#800020] transition-all group-hover:bg-[#1A1D1F] group-hover:text-white group-hover:border-[#1A1D1F] shadow-sm",children:e}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("h4",{className:"text-[10px] font-black text-[#94A3B8] uppercase tracking-[0.2em]",children:t}),n.jsx("div",{className:"text-xl font-black text-[#1A1D1F] tracking-tighter",children:r}),n.jsx("p",{className:"text-xs text-[#6B7280] font-medium leading-relaxed",children:a})]})]})}function Gf({label:e,placeholder:t}){return n.jsxs("div",{className:"space-y-4",children:[n.jsx("label",{className:"text-[10px] font-black text-[#1A1D1F] tracking-widest uppercase",children:e}),n.jsx("input",{type:"text",className:"w-full bg-[#F8FAFC] border border-[#E2E8F0] p-5 rounded font-medium text-sm focus:outline-none focus:ring-2 focus:ring-[#800020] transition-all placeholder:text-[#94A3B8]",placeholder:t})]})}function eG({label:e,options:t}){return n.jsxs("div",{className:"space-y-4",children:[n.jsx("label",{className:"text-[10px] font-black text-[#1A1D1F] tracking-widest uppercase",children:e}),n.jsx("select",{className:"w-full bg-[#F8FAFC] border border-[#E2E8F0] p-5 rounded font-medium text-sm focus:outline-none focus:ring-2 focus:ring-[#800020] transition-all appearance-none cursor-pointer text-[#1A1D1F]",children:t.map(r=>n.jsx("option",{value:r,children:r},r))})]})}function tG(){return n.jsxs("div",{className:"pt-24 lg:pt-32 pb-24 selection:bg-[#800020]/10",children:[n.jsxs(yn,{children:[n.jsx("title",{children:"KVKK Aydnlatma Metni | Ulgen One"}),n.jsx("meta",{name:"description",content:"Kiisel Verilerin Korunmas Kanunu kapsamnda aydnlatma metni ve veri ileme politikas. effaf veri ynetimi."})]}),n.jsx("section",{className:"px-6 mb-16",children:n.jsx("div",{className:"max-w-[1000px] mx-auto space-y-8",children:n.jsxs(at,{children:[n.jsx(ut,{className:"bg-[#1A1D1F] text-white border-0 py-1.5 px-4 text-[10px] font-black uppercase tracking-[0.2em] mb-4",children:"Legal Document #KVKK-2026"}),n.jsxs("h1",{className:"text-4xl lg:text-5xl font-black tracking-tighter text-[#1A1D1F] uppercase",children:["KSEL VERLERN KORUNMASI ",n.jsx("br",{})," ",n.jsx("span",{className:"text-[#800020] italic",children:"AYDINLATMA METN"})]}),n.jsx("p",{className:"text-sm text-[#6B7280] font-bold uppercase tracking-widest border-l-4 border-[#800020] pl-4",children:"Son Gncelleme: 25 ubat 2026"})]})})}),n.jsx("section",{className:"px-6",children:n.jsx("div",{className:"max-w-[1000px] mx-auto p-12 lg:p-16 bg-white border border-[#E2E8F0] shadow-sm rounded-sm space-y-16",children:n.jsxs(at,{className:"space-y-12",children:[n.jsxs("section",{className:"space-y-4",children:[n.jsxs("h2",{className:"text-xl font-black text-[#1A1D1F] uppercase tracking-tighter flex items-center gap-3 border-b pb-2",children:[n.jsx(hs,{size:22,className:"text-[#800020]"})," 1. VER SORUMLUSUNUN KML VE BEYANI"]}),n.jsxs("p",{className:"text-sm text-[#6B7280] leading-relaxed font-medium",children:['6698 sayl Kiisel Verilerin Korunmas Kanunu ("KVKK") uyarnca, ',n.jsx("strong",{children:"Ulgen One Industry Solutions"}),' (bundan sonra "irket" veya "Platform" olarak anlacaktr) bnyesinde barndrdnz maliyet, teklif ve teknik hesaplama verilerinizin gvenlii temel nceliimizdir. Veri sorumlusu sfatyla; kullanclarmzn verilerini effaf, llebilir ve deterministik bir yaklamla ilemekteyiz.']})]}),n.jsxs("section",{className:"space-y-6",children:[n.jsxs("h2",{className:"text-xl font-black text-[#1A1D1F] uppercase tracking-tighter flex items-center gap-3 border-b pb-2",children:[n.jsx(bh,{size:22,className:"text-[#800020]"})," 2. LENEN KSEL VERLER VE STSNALAR"]}),n.jsxs("p",{className:"text-sm text-[#6B7280] leading-relaxed font-medium",children:["B2B (letmeden letmeye) modeliyle alan endstriyel bir SaaS platformu olduumuz iin, sistemimizde ",n.jsx("strong",{children:"Kimlik Dorulama Servisleri (rn: T.C. Kimlik numaras sorgulama, Pasaport dorulama, Biyometrik veri ileme) KESNLKLE BULUNMAMAKTADIR."})," Sistem yalnzca temel hesap tabanl kullanm verilerini iler."]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6 pt-2",children:[n.jsxs("div",{className:"p-6 bg-[#F8FAFC] border border-[#E2E8F0] rounded space-y-3",children:[n.jsxs("h4",{className:"text-xs font-black text-[#1A1D1F] uppercase tracking-widest flex items-center gap-2",children:[n.jsx(Jr,{size:16,className:"text-[#10B981]"})," LEDMZ VERLER"]}),n.jsxs("ul",{className:"space-y-2 text-xs text-[#6B7280]",children:[n.jsxs("li",{children:[" ",n.jsx("strong",{children:"Kimlik Bilgisi:"})," Ad, Soyad."]}),n.jsxs("li",{children:[" ",n.jsx("strong",{children:"letiim Bilgisi:"})," Kurumsal e-posta adresi, telefon numaras."]}),n.jsxs("li",{children:[" ",n.jsx("strong",{children:"Kurumsal Veriler:"})," irket unvan, vergi no/dairesi, irket lokasyonu."]}),n.jsxs("li",{children:[" ",n.jsx("strong",{children:"lem Gvenlii:"})," IP adresi, giri k loglar (Sisteme eriimi dorulamak iin)."]}),n.jsxs("li",{children:[" ",n.jsx("strong",{children:"Platform Verileri:"})," Teklif taslaklar, maliyet hesaplamalar, safiha tercihleri."]})]})]}),n.jsxs("div",{className:"p-6 bg-[#1A1D1F] border border-white/10 rounded space-y-3",children:[n.jsxs("h4",{className:"text-xs font-black text-white uppercase tracking-widest flex items-center gap-2",children:[n.jsx(ZE,{size:16,className:"text-[#EF4444]"})," LEMEDMZ VERLER"]}),n.jsxs("ul",{className:"space-y-2 text-xs text-white/70",children:[n.jsx("li",{children:" T.C. Kimlik Numaras (Sisteme girilemez)"}),n.jsx("li",{children:" Kredi Kart Numaranz (deme altyapsnda tutulmaz)"}),n.jsx("li",{children:" Biyometrik ve Genetik Veriler"}),n.jsx("li",{children:" Pasaport, Ehliyet gibi resmi kimlik belgeleri"}),n.jsx("li",{children:" zel nitelikli kiisel veriler (Din, rk, mezhep vb.)"})]})]})]})]}),n.jsxs("section",{className:"space-y-4",children:[n.jsxs("h2",{className:"text-xl font-black text-[#1A1D1F] uppercase tracking-tighter flex items-center gap-3 border-b pb-2",children:[n.jsx(ma,{size:22,className:"text-[#800020]"})," 3. LENME AMALARI VE HUKUK SEBEPLER"]}),n.jsxs("p",{className:"text-sm text-[#6B7280] leading-relaxed font-medium",children:["Yukarda listelenen temel verileriniz, 6698 sayl Kanun'un 5. maddesinde yer alan ",n.jsx("em",{children:'"Szlemenin kurulmas veya ifasyla dorudan doruya ilgili olmas kaydyla, szlemenin taraflarna ait kiisel verilerin ilenmesinin gerekli olmas"'})," ile ",n.jsx("em",{children:'"Veri sorumlusunun hukuki ykmlln yerine getirebilmesi iin zorunlu olmas"'})," artlarna dayal olarak u amalarla ilenmektedir:"]}),n.jsxs("ul",{className:"list-disc ml-6 space-y-2 text-sm text-[#6B7280]",children:[n.jsx("li",{children:"Kurumsal hesap allarnn yaplmas ve hesap yetkilendirmesi,"}),n.jsx("li",{children:"Algoritmik maliyet motorumuzun (Safiha, Fire, Break-even analizi) iletilmesi,"}),n.jsx("li",{children:"Oluturulan PDF ve Excel teklif belgelerine kurumsal antetinizin otomatik baslmas,"}),n.jsx("li",{children:"Yetkisiz girilerin tespit edilmesi ve sistem mimarisinin (Log kaytlar ile) gvenliinin salanmas,"}),n.jsx("li",{children:"Teknik destek taleplerinin zlmesi amacyla iletiim kurulmas."})]})]}),n.jsxs("section",{className:"space-y-4",children:[n.jsxs("h2",{className:"text-xl font-black text-[#1A1D1F] uppercase tracking-tighter flex items-center gap-3 border-b pb-2",children:[n.jsx(G1,{size:22,className:"text-[#800020]"})," 4. VER AKTARIMI VE NC TARAFLAR"]}),n.jsxs("p",{className:"text-sm text-[#6B7280] leading-relaxed font-medium",children:["irketimiz deterministik felsefesi gerei, kurumsal teklif verilerinizi ve iletiim kaytlarnz ticari maksatla ",n.jsx("strong",{children:"HBR veri komisyoncusu, reklam ajans veya pazar aratrma irketi ile paylamaz."})]}),n.jsx("p",{className:"text-sm text-[#6B7280] leading-relaxed font-medium",children:"Verileriniz KVKK'nn 8. ve 9. maddeleri kapsamnda sadece mecburi hizmet yrttmz altyap salayclarna aktarlmaktadr:"}),n.jsxs("ul",{className:"list-disc ml-6 space-y-2 text-sm text-[#6B7280]",children:[n.jsx("li",{children:"Bulut sunucu operasyonlar iin Firebase / Google Cloud Platform altyaps,"}),n.jsx("li",{children:"Kanuni bir zorunluluk domas halinde ilgili resmi merciiler (Bilgi Teknolojileri ve letiim Kurumu, Mahkemeler vb.),"}),n.jsx("li",{children:"Elektronik fatura entegrasyonu salayan lisansl e-Dnm merkezleri."})]})]}),n.jsxs("section",{className:"space-y-4",children:[n.jsxs("h2",{className:"text-xl font-black text-[#1A1D1F] uppercase tracking-tighter flex items-center gap-3 border-b pb-2",children:[n.jsx(Y1,{size:22,className:"text-[#800020]"})," 5. VER BTNL VE MHA POLTKASI"]}),n.jsxs("p",{className:"text-sm text-[#6B7280] leading-relaxed font-medium",children:["Sistemde yer alan tekliflerinizin ve maliyet krlmlarnzn btnl AES standartlarnda ifreleme yntemleriyle korunur. Ulgen One yeliinizi iptal ettiinizde veya szleme sresi dolduunda, size ait olan tm teklif taslaklar, maliyet parametreleri ve iletiim bilgileriniz (mevzuatn saklanmasn zorunlu kld log kaytlar hari) irket veri tabanmzdan ",n.jsx("strong",{children:"geri dndrlemez biimde"})," anonimletirilir veya imha edilir."]})]}),n.jsxs("section",{className:"space-y-4",children:[n.jsx("h2",{className:"text-xl font-black text-[#1A1D1F] uppercase tracking-tighter border-b pb-2",children:"6. KANUN HAKLARINIZ (MADDE 11)"}),n.jsx("p",{className:"text-sm text-[#6B7280] leading-relaxed font-medium",children:"KVKK Madde 11 uyarnca, veri sorumlusu olarak irketimize bavurarak;"}),n.jsxs("ul",{className:"list-disc ml-6 space-y-2 text-sm text-[#6B7280]",children:[n.jsx("li",{children:"Kiisel verilerinizin ilenip ilenmediini renme, ilenmise bilgi talep etme,"}),n.jsx("li",{children:"lenme amacna uygun kullanlp kullanlmadn renme,"}),n.jsx("li",{children:"Yurt iinde veya yurt dnda aktarld nc kiileri bilme,"}),n.jsx("li",{children:"Eksik veya yanl ilenmise dzeltilmesini isteme,"}),n.jsx("li",{children:"Kanunda ngrlen artlar erevesinde silinmesini veya yok edilmesini isteme"})]}),n.jsx("p",{className:"text-sm text-[#6B7280] leading-relaxed font-medium mt-2",children:"haklarna sahipsiniz."})]}),n.jsxs("div",{className:"pt-12 mt-12 border-t-2 border-[#1A1D1F] text-center",children:[n.jsx("p",{className:"text-xs text-[#1A1D1F] font-black uppercase tracking-widest mb-4",children:"RESM BAVURU KANALLARI"}),n.jsxs("div",{className:"inline-flex flex-col md:flex-row gap-6 p-6 bg-[#F8FAFC] border border-[#E2E8F0] rounded-lg",children:[n.jsxs("div",{className:"text-left space-y-1",children:[n.jsx("div",{className:"text-[10px] text-[#94A3B8] font-bold uppercase tracking-widest",children:"Bavuru E-Posta"}),n.jsx("div",{className:"text-sm font-black text-[#800020] cursor-pointer",children:"kvkk@ulgen.one"})]}),n.jsx("div",{className:"hidden md:block w-px bg-gray-300"}),n.jsxs("div",{className:"text-left space-y-1",children:[n.jsx("div",{className:"text-[10px] text-[#94A3B8] font-bold uppercase tracking-widest",children:"Tebligat Adresi"}),n.jsx("div",{className:"text-sm font-bold text-[#1A1D1F]",children:"Veri Sorumlusu rtibat Ofisi"})]})]}),n.jsx("p",{className:"text-xs text-[#6B7280] font-medium mt-6 max-w-lg mx-auto",children:"Talepleriniz, yasal mevzuata uygun olarak en ge otuz (30) gn ierisinde cretsiz olarak sonulandrlacaktr."})]})]})})})]})}function rG(){return n.jsxs("div",{className:"pt-24 lg:pt-32 pb-24 selection:bg-[#800020]/10",children:[n.jsxs(yn,{children:[n.jsx("title",{children:"Gizlilik Politikas | Ulgen One Veri Gvenlii"}),n.jsx("meta",{name:"description",content:"Ulgen One B2B SaaS platformu gizlilik politikas ve kurumsal veri gvenlii standartlar."})]}),n.jsx("section",{className:"px-6 mb-16",children:n.jsx("div",{className:"max-w-[1000px] mx-auto space-y-8",children:n.jsxs(at,{children:[n.jsx(ut,{className:"bg-[#1A1D1F] text-white border-0 py-1.5 px-4 text-[10px] font-black uppercase tracking-[0.2em] mb-4",children:"Security Protocol #PRIV-2026"}),n.jsxs("h1",{className:"text-4xl lg:text-5xl font-black tracking-tighter text-[#1A1D1F] uppercase",children:["GZLLK ",n.jsx("br",{})," ",n.jsx("span",{className:"text-[#800020] italic",children:"POLTKASI"})]}),n.jsx("p",{className:"text-sm text-[#6B7280] font-bold uppercase tracking-widest border-l-4 border-[#800020] pl-4",children:"Son Gncelleme: 25 ubat 2026"})]})})}),n.jsx("section",{className:"px-6",children:n.jsx("div",{className:"max-w-[1000px] mx-auto p-12 lg:p-16 bg-white border border-[#E2E8F0] shadow-sm rounded-sm space-y-16",children:n.jsxs(at,{className:"space-y-12",children:[n.jsxs("section",{className:"space-y-4",children:[n.jsxs("h2",{className:"text-xl font-black text-[#1A1D1F] uppercase tracking-tighter flex items-center gap-3 border-b pb-2",children:[n.jsx(Y1,{size:22,className:"text-[#800020]"})," 1. KURUMSAL VER GZLL TAAHHD"]}),n.jsxs("p",{className:"text-sm text-[#6B7280] leading-relaxed font-medium",children:[n.jsx("strong",{children:"Ulgen One Industry Solutions"})," olarak, sisteme kaydettiiniz kurumsal iletme bilgilerinizin ticari sr statsnde olduunun bilincindeyiz. B2B mimarimiz kapsamnda, platform zerinde yer alan iletme verilerinizin gizliliini en st dzeyde korumay, bu verileri hibir sebeple nc taraf reklam verenlerle, arac kurumlarla veya sektrdeki veri toplayc veri irketleriyle paylamamay taahht ederiz."]})]}),n.jsxs("section",{className:"space-y-6",children:[n.jsxs("h2",{className:"text-xl font-black text-[#1A1D1F] uppercase tracking-tighter flex items-center gap-3 border-b pb-2",children:[n.jsx(bh,{size:22,className:"text-[#800020]"})," 2. BLG GVENL VE ZOLASYON"]}),n.jsx("p",{className:"text-sm text-[#6B7280] leading-relaxed font-medium",children:"Sistem, izole edilmi bulut veri tabanlar zerinde almaktadr."}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6 pt-2",children:[n.jsxs("div",{className:"p-6 bg-[#F8FAFC] border border-[#E2E8F0] rounded space-y-4",children:[n.jsx("div",{className:"text-[#800020]",children:n.jsx(G1,{size:24})}),n.jsx("h4",{className:"text-xs font-black uppercase tracking-widest text-[#1A1D1F]",children:"Uluslararas Veri Depolama"}),n.jsx("p",{className:"text-xs text-[#6B7280] leading-relaxed font-medium",children:"Kurumsal verileriniz AES-256 standartlarnda ifrelenerek, global dzeyde gvenlik reglasyonlarna (ISO 27001) uyan yksek gvenlikli bulut altyaplarnda barndrlmaktadr. Fiziksel sunucu eriimi tamamen kstlanmtr."})]}),n.jsxs("div",{className:"p-6 bg-[#F8FAFC] border border-[#E2E8F0] rounded space-y-4",children:[n.jsx("div",{className:"text-[#800020]",children:n.jsx(yh,{size:24})}),n.jsx("h4",{className:"text-xs font-black uppercase tracking-widest text-[#1A1D1F]",children:"Sfr Gven (Zero Trust) Mimarisi"}),n.jsx("p",{className:"text-xs text-[#6B7280] leading-relaxed font-medium",children:"irketinize ait olan alma alanna (Workspace) sadece sizin kendi panelinizden yetkilendirdiiniz i kullanclarnz eriebilir. Gelitirici ekibimiz dahil hi kimse, idari onaynz olmadan operasyonel kaytlarnza nfuz edemez."})]})]})]}),n.jsxs("section",{className:"space-y-4",children:[n.jsxs("h2",{className:"text-xl font-black text-[#1A1D1F] uppercase tracking-tighter flex items-center gap-3 border-b pb-2",children:[n.jsx(JE,{size:22,className:"text-[#800020]"})," 3. PLATFORM LEY KAPSAMINDA LOG KAYITLARI"]}),n.jsx("p",{className:"text-sm text-[#6B7280] leading-relaxed font-medium",children:"evrimii hizmet veren her B2B yazlmnda olduu gibi, hesap gvenliinizi salamak ve sisteme yaplan yetkisiz giri denemelerini tespit etmek amacyla oturum balant bilgileri (IP adresi, balant tarihi ve saati, tarayc tr) kayt altna alnmaktadr. Bu veriler yalnzca siber gvenlik denetimleri ve platform stabilitesini srdrmek amacyla kullanlr; kullanc alkanlklarn profillemek veya takip etmek iin deerlendirilmez."})]}),n.jsxs("section",{className:"space-y-4",children:[n.jsxs("h2",{className:"text-xl font-black text-[#1A1D1F] uppercase tracking-tighter flex items-center gap-3 border-b pb-2",children:[n.jsx(uo,{size:22,className:"text-[#800020]"})," 4. EREZ (COOKIE) PRENSPLER"]}),n.jsx("p",{className:"text-sm text-[#6B7280] leading-relaxed font-medium",children:"Kullanc deneyimini stabilize etmek iin cihaznzn taraycsna kk veri dosyalar olan erezler yerletiriyoruz."}),n.jsxs("ul",{className:"list-disc ml-6 space-y-2 text-sm text-[#6B7280]",children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Zorunlu erezler:"})," Platforma gvenli giri yapabilmeniz ve oturumunuzun aktif kalmas iin teknik olarak mecburi olan erezlerdir."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Reklam ve Pazarlama erezleri:"})," Ulgen One, nc taraf reklam alarnn (Google Ads, Facebook Pixel vb.) sizi dier sitelerde hedeflemesine sebep olan d platform erezlerini taraycnza ",n.jsx("strong",{children:"KESNLKLE ENJEKTE ETMEZ."})]})]})]}),n.jsxs("section",{className:"space-y-4",children:[n.jsx("h2",{className:"text-xl font-black text-[#1A1D1F] uppercase tracking-tighter border-b pb-2",children:"5. 3. TARAF HZMET SALAYICILARI"}),n.jsx("p",{className:"text-sm text-[#6B7280] leading-relaxed font-medium",children:"Hizmetin kesintisiz devam edebilmesi adna baz global teknoloji partnerleri ile almaktayz (Bulut hosting salayclar ve deme geidi servisleri vb.). Setiimiz tm partnerlerin, en kat global gizlilik standartlarna (GDPR gibi) uyumlu olduunu dzenli olarak kontrol etmekteyiz. Kredi kart gibi hassas finansal verileriniz bizim sistemimizde deil, yalnzca yetkili BDDK/PCI-DSS lisansl deme kurulularnda ifreli olarak ilenir."})]}),n.jsxs("div",{className:"pt-12 mt-12 border-t border-[#E2E8F0] text-center",children:[n.jsx("div",{className:"inline-flex items-center justify-center p-4 bg-[#F8FAFC] border border-[#E2E8F0] rounded-full mb-6",children:n.jsx(W1,{size:24,className:"text-[#800020]"})}),n.jsx("h3",{className:"text-lg font-black text-[#1A1D1F] uppercase tracking-widest mb-2",children:"Bize Ulan"}),n.jsx("p",{className:"text-sm text-[#6B7280] mb-6 max-w-lg mx-auto",children:"Gizlilik politikamz hakknda sorularnz varsa veya kurumsal verilerinizin korunmasna dair teknik detaylar grmek isterseniz, ltfen bizimle iletiime gein."}),n.jsx("a",{href:"mailto:destek@ulgen.one",className:"inline-block px-8 py-4 bg-[#1A1D1F] text-white text-xs font-black uppercase tracking-[0.2em] rounded hover:bg-[#800020] transition-colors duration-300",children:"destek@ulgen.one"})]})]})})})]})}function aG(){return n.jsxs("div",{className:"pt-24 lg:pt-32 pb-24 selection:bg-[#800020]/10",children:[n.jsxs(yn,{children:[n.jsx("title",{children:"Kullanm artlar | Ulgen One Lisans Szlemesi"}),n.jsx("meta",{name:"description",content:"Ulgen One B2B SaaS platformu kullanm koullar, lisans artlar ve endstriyel hizmet szlemesi."})]}),n.jsx("section",{className:"px-6 mb-16",children:n.jsx("div",{className:"max-w-[1000px] mx-auto space-y-8",children:n.jsxs(at,{children:[n.jsx(ut,{className:"bg-[#1A1D1F] text-white border-0 py-1.5 px-4 text-[10px] font-black uppercase tracking-[0.2em] mb-4",children:"SaaS License Agreement v2.2"}),n.jsxs("h1",{className:"text-4xl lg:text-5xl font-black tracking-tighter text-[#1A1D1F] uppercase",children:["SON KULLANICI LSANS ",n.jsx("br",{})," ",n.jsx("span",{className:"text-[#800020] italic",children:"VE HZMET SZLEMES"})]}),n.jsx("p",{className:"text-sm text-[#6B7280] font-bold uppercase tracking-widest border-l-4 border-[#800020] pl-4",children:"Son Gncelleme: 25 ubat 2026"})]})})}),n.jsx("section",{className:"px-6",children:n.jsx("div",{className:"max-w-[1000px] mx-auto p-12 lg:p-16 bg-white border border-[#E2E8F0] shadow-sm rounded-sm space-y-16",children:n.jsxs(at,{className:"space-y-12",children:[n.jsxs("section",{className:"space-y-4",children:[n.jsxs("h2",{className:"text-xl font-black text-[#1A1D1F] uppercase tracking-tighter flex items-center gap-3 border-b pb-2",children:[n.jsx(tl,{size:22,className:"text-[#800020]"})," 1. TARAFLAR VE AMACIN BEYANI"]}),n.jsxs("p",{className:"text-sm text-[#6B7280] leading-relaxed font-medium",children:['bu Son Kullanc Lisans ve Hizmet Szlemesi ("Szleme"), bir B2B (letmeden letmeye) bulut mimarisi olan ',n.jsx("strong",{children:"Ulgen One Industry Solutions"}),' ("Lisansr" veya "Platform") ile, sisteme kurumsal bilgilerini girerek kayt olan tzel kii ("Mteri" veya "Kullanc") arasnda evrimii ortamda akdedilmitir. Mteri, platforma kayt olarak bu szlemenin teknik ve hukuki tm sonularn basiretli bir tacir olarak kabul ettiini beyan eder.']})]}),n.jsxs("section",{className:"space-y-4",children:[n.jsxs("h2",{className:"text-xl font-black text-[#1A1D1F] uppercase tracking-tighter flex items-center gap-3 border-b pb-2",children:[n.jsx(qd,{size:22,className:"text-[#800020]"}),' 2. PLATFORMUN NTEL VE "KARAR DESTEK" PRENSB']}),n.jsxs("p",{className:"text-sm text-[#6B7280] leading-relaxed font-medium",children:["Ulgen One, ambalaj ve koli sektrnde faaliyet gsteren reticilere ynelik, ",n.jsx("strong",{children:"deterministik algoritmalarla alan bir maliyet, fire ve fiyatlama simlatrdr."})," Platform, Mteri'nin girdii veri (rn: Kat fiyatlar, makine lleri) dorultusunda matematiksel bir sonu retir."]}),n.jsx("p",{className:"text-sm text-[#6B7280] leading-relaxed font-medium",children:`Platform kesinlikle fiziksel retim talimat veren bir sistem donanm (SCADA / PLC arayz) deildir, bir "Karar Destek Sistemi"dir. Ticari kararlarn alnmasndaki nihai tasarruf tamamen Mteri'ye aittir.`})]}),n.jsxs("section",{className:"space-y-4",children:[n.jsxs("h2",{className:"text-xl font-black text-[#1A1D1F] uppercase tracking-tighter flex items-center gap-3 border-b pb-2",children:[n.jsx(yh,{size:22,className:"text-[#800020]"}),' 3. FKR MLKYET VE "TCAR SIR" DOKUNULMAZLII']}),n.jsxs("p",{className:"text-sm text-[#6B7280] leading-relaxed font-medium",children:["Ulgen One'n altyapsn oluturan kaynak kodlar, veri taban mimarisi, safiha optimizasyon motoru (engine), algoritma hesaplama mant ve arayz tasarmlarnn mlkiyeti tamamen Ulgen One'a aittir. Szleme kapsamnda Mteri'ye ",n.jsx("strong",{children:"mnhasr olmayan, devredilemez ve alt lisanslama yaplamaz (SaaS)"})," bir kullanm hakk tahsis edilmektedir."]}),n.jsx("div",{className:"p-4 bg-red-50 border border-red-100 rounded text-sm text-[#800020] font-bold",children:"Mteri; yazlm ana szmaya alamaz, platformu klonlayamaz, kodlara tersine mhendislik (reverse engineering) uygulayamaz. Aksi tespit edildii anda hesap tek tarafl feshedilir ve hukuki ilem balatlr."})]}),n.jsxs("section",{className:"space-y-4",children:[n.jsxs("h2",{className:"text-xl font-black text-[#1A1D1F] uppercase tracking-tighter flex items-center gap-3 border-b pb-2",children:[n.jsx(QE,{size:22,className:"text-[#800020]"})," 4. HESAP KULLANIMI VE KMLK DORULAMASIZ YAPI"]}),n.jsxs("p",{className:"text-sm text-[#6B7280] leading-relaxed font-medium",children:["KVKK politikamzda da beyan edildii zere, sistemimizde resmi bir kimlik dorulama API'si ",n.jsx("strong",{children:"yoktur."})," Hesaba girilen bilgilerin (irket Unvan, Vergi No) doruluundan Mteri sorumludur. Kurumsal hesabn parolas ile yaplan tm teknik ve ticari ilemler (Teklif gnderme, maliyet gncelleme vb.) hesab aan tzel kiiyi balar. ifrelerin kurum ii szdrlmasndan Ulgen One sorumlu deildir."]})]}),n.jsxs("section",{className:"space-y-6",children:[n.jsxs("h2",{className:"text-xl font-black text-[#1A1D1F] uppercase tracking-tighter flex items-center gap-3 border-b pb-2",children:[n.jsx(ms,{size:22,className:"text-[#800020]"})," 5. SORUMLULUK REDD (LIMITATION OF LIABILITY)"]}),n.jsx("p",{className:"text-sm text-[#6B7280] leading-relaxed font-medium",children:`Ulgen One algoritmik hassasiyetle almasna ramen, "AS IS" (Olduu gibi) prensibiyle lisanslanr. Mteri aada saylan senaryolardan doacak dorudan veya dolayl maddi zararlar iin Ulgen One'dan hak talep edemeyeceini peinen kabul eder:`}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[n.jsxs("div",{className:"p-5 border border-[#E2E8F0] bg-[#F8FAFC] rounded-lg",children:[n.jsx("h4",{className:"font-bold text-[#1A1D1F] text-xs mb-2",children:"Makine Kalibrasyon Hatalar"}),n.jsx("p",{className:"text-xs text-[#6B7280] leading-relaxed",children:"Platformun hesaplad 'Net Anm Boyu' fabrikadaki kesim makinelerinin fiziksel (bak/tolerans) sorunlar nedeniyle tutmadnda doan fireler."})]}),n.jsxs("div",{className:"p-5 border border-[#E2E8F0] bg-[#F8FAFC] rounded-lg",children:[n.jsx("h4",{className:"font-bold text-[#1A1D1F] text-xs mb-2",children:"Hatal Parametre Girii"}),n.jsx("p",{className:"text-xs text-[#6B7280] leading-relaxed",children:"Mterinin sisteme kt m gramajn veya kt tonluk fiyat parametrelerini yanl girmesi sonucu oluan hatal kr/zarar tablolar."})]}),n.jsxs("div",{className:"p-5 border border-[#E2E8F0] bg-[#F8FAFC] rounded-lg",children:[n.jsx("h4",{className:"font-bold text-[#1A1D1F] text-xs mb-2",children:"Operasyonel Kayplar"}),n.jsx("p",{className:"text-xs text-[#6B7280] leading-relaxed",children:"Sistem zerinden oluturulan ve mteriye giderek fiiliyata dklen teklifler sonras yaanan tahsilat veya lojistik problemleri."})]}),n.jsxs("div",{className:"p-5 border border-[#E2E8F0] bg-[#F8FAFC] rounded-lg",children:[n.jsx("h4",{className:"font-bold text-[#1A1D1F] text-xs mb-2",children:"nternet Kesintileri"}),n.jsx("p",{className:"text-xs text-[#6B7280] leading-relaxed",children:"Bulut sunucu operatrnden (Google/Firebase) veya yerel servis salaycdan kaynakl eriim kopukluklarndan doan ticaret gecikmeleri."})]})]})]}),n.jsxs("section",{className:"space-y-4",children:[n.jsxs("h2",{className:"text-xl font-black text-[#1A1D1F] uppercase tracking-tighter flex items-center gap-3 border-b pb-2",children:[n.jsx(ma,{size:22,className:"text-[#800020]"})," 6. FESH VE ERM KISITLAMASI"]}),n.jsx("p",{className:"text-sm text-[#6B7280] leading-relaxed font-medium",children:"Seilen SaaS paketine ait faturalandrma ykmllklerinin yerine getirilmemesi durumunda Ulgen One, uyar sresi (7 i gn) tandktan sonra hesab salt okunur moda (read-only) alabilir veya tamamen kapatabilir. irket itibarn sarsc, teknik altyapy tehdit eden (DDOS vb.) durumlarda ise szleme tek tarafl ve tazminatsz, derhal feshedilir."})]}),n.jsxs("section",{className:"space-y-4",children:[n.jsxs("h2",{className:"text-xl font-black text-[#1A1D1F] uppercase tracking-tighter flex items-center gap-3 border-b pb-2",children:[n.jsx(wh,{size:22,className:"text-[#800020]"})," 7. YETKL MAHKEMELER"]}),n.jsxs("p",{className:"text-sm text-[#6B7280] leading-relaxed font-medium",children:['bu "B2B Lisans ve Hizmet Szlemesi"nden doacak her trl ticari uyumazln zmnde Trk Hukuku uygulanacak olup, ',n.jsx("strong",{children:"stanbul (alayan) Mahkemeleri ve cra Daireleri"})," mnhasran yetkilidir."]})]}),n.jsx("div",{className:"pt-12 mt-12 border-t border-[#E2E8F0]",children:n.jsxs("div",{className:"p-8 bg-[#1A1D1F] rounded-xl text-center space-y-3 relative overflow-hidden",children:[n.jsx("div",{className:"absolute inset-0 opacity-10 pointer-events-none",children:n.jsx("div",{className:"w-full h-full",style:{backgroundImage:"linear-gradient(45deg, #ffffff 25%, transparent 25%, transparent 75%, #ffffff 75%, #ffffff), linear-gradient(45deg, #ffffff 25%, transparent 25%, transparent 75%, #ffffff 75%, #ffffff)",backgroundSize:"20px 20px",backgroundPosition:"0 0, 10px 10px"}})}),n.jsxs("div",{className:"relative z-10 space-y-2",children:[n.jsxs("p",{className:"text-lg font-black text-white uppercase tracking-[0.2em] flex items-center justify-center gap-2",children:[n.jsx(Jr,{size:24,className:"text-[#10B981]"})," TCAR KABUL BEYANI"]}),n.jsx("p",{className:"text-sm text-white/70 font-bold max-w-xl mx-auto",children:"Sisteme kayt olarak bir hesap oluturan taraf, tacir sfatyla dijital log kaytlarnda eletirilmek artyla bu protokoldeki tm maddeleri okuduunu ve anladn beyan eder."})]})]})})]})})})]})}const nG=RA([{path:"/",element:n.jsx(K_,{}),children:[{index:!0,element:n.jsx($W,{})},{path:"urun",element:n.jsx(WW,{})},{path:"teknik-analiz",element:n.jsx(GW,{})},{path:"fire-simulasyonu",element:n.jsx(YW,{})},{path:"blog",element:n.jsx(XW,{})},{path:"blog/:slug",element:n.jsx(ZW,{})},{path:"hakkimizda",element:n.jsx(JW,{})},{path:"iletisim",element:n.jsx(QW,{})},{path:"kvkk",element:n.jsx(tG,{})},{path:"gizlilik",element:n.jsx(rG,{})},{path:"kullanim-sartlari",element:n.jsx(aG,{})}]},{path:"/login",Component:$K},{path:"/register",Component:WK},{path:"/",Component:Kc,children:[{path:"/",Component:V_,children:[{path:"dashboard",Component:Q_},{path:"create-offer",Component:i1},{path:"edit-offer/:id",Component:i1},{path:"bulk-offer",Component:o1},{path:"edit-bulk-offer/:id",Component:o1},{path:"my-offers",Component:j$},{path:"profile",Component:ZK},{path:"settings",Component:KW},{path:"upgrade",Component:YK},{path:"technical-analysis",Component:xW},{path:"my-sheets",Component:pW},{path:"approval",element:n.jsx(Kc,{allowedRoles:[Jt.SUPER_ADMIN,Jt.COMPANY_ADMIN]}),children:[{index:!0,Component:E$}]},{path:"company",element:n.jsx(Kc,{allowedRoles:[Jt.SUPER_ADMIN,Jt.COMPANY_ADMIN]}),children:[{index:!0,Component:T$}]},{path:"super-admin",element:n.jsx(Kc,{allowedRoles:[Jt.SUPER_ADMIN]}),children:[{index:!0,Component:A$},{path:"offers",Component:UK},{path:"calculation-logs",Component:XK}]},{path:"*",Component:HK}]}]}]);function sG(){return n.jsx(xE,{children:n.jsx(i_,{children:n.jsx(WA,{router:nG})})})}yS.createRoot(document.getElementById("root")).render(n.jsx(sG,{}));
